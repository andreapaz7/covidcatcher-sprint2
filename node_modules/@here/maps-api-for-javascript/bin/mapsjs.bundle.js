
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.21.2/HERE_NOTICE
 */

(function(){var n,aa=[];function ba(a){return function(){return aa[a].apply(this,arguments)}}function ca(a,b){return aa[a]=b}var da="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},fa="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function ha(a,b){if(b){var c=fa;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&da(c,a,{configurable:!0,writable:!0,value:b})}}function ia(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ja(){ja=function(){};fa.Symbol||(fa.Symbol=ka)}function la(a,b){this.a=a;da(this,"description",{configurable:!0,writable:!0,value:b})}la.prototype.toString=function(){return this.a};
var ka=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new la("jscomp_symbol_"+(c||"")+"_"+b++,c)}var b=0;return a}();function ma(){ja();var a=fa.Symbol.iterator;a||(a=fa.Symbol.iterator=fa.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&da(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return na(ia(this))}});ma=function(){}}
function na(a){ma();a={next:a};a[fa.Symbol.iterator]=function(){return this};return a}function oa(a,b){ma();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d}ha("Array.prototype.keys",function(a){return a?a:function(){return oa(this,function(b){return b})}});var pa;
if("function"==typeof Object.setPrototypeOf)pa=Object.setPrototypeOf;else{var qa;a:{var ra={Kg:!0},sa={};try{sa.__proto__=ra;qa=sa.Kg;break a}catch(a){}qa=!1}pa=qa?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ta=pa;ha("Object.setPrototypeOf",function(a){return a||ta});function va(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:ia(a)}}
ha("Promise",function(a){function b(g){this.A=0;this.b=void 0;this.a=[];var h=this.c();try{g(h.resolve,h.reject)}catch(k){h.reject(k)}}function c(){this.a=null}function d(g){return g instanceof b?g:new b(function(h){h(g)})}if(a)return a;c.prototype.b=function(g){if(null==this.a){this.a=[];var h=this;this.c(function(){h.g()})}this.a.push(g)};var e=fa.setTimeout;c.prototype.c=function(g){e(g,0)};c.prototype.g=function(){for(;this.a&&this.a.length;){var g=this.a;this.a=[];for(var h=0;h<g.length;++h){var k=
g[h];g[h]=null;try{k()}catch(l){this.f(l)}}}this.a=null};c.prototype.f=function(g){this.c(function(){throw g;})};b.prototype.c=function(){function g(l){return function(m){k||(k=!0,l.call(h,m))}}var h=this,k=!1;return{resolve:g(this.o),reject:g(this.f)}};b.prototype.o=function(g){if(g===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof b)this.aa(g);else{a:switch(typeof g){case "object":var h=null!=g;break a;case "function":h=!0;break a;default:h=!1}h?this.m(g):this.g(g)}};
b.prototype.m=function(g){var h=void 0;try{h=g.then}catch(k){this.f(k);return}"function"==typeof h?this.s(h,g):this.g(g)};b.prototype.f=function(g){this.i(2,g)};b.prototype.g=function(g){this.i(1,g)};b.prototype.i=function(g,h){if(0!=this.A)throw Error("Cannot settle("+g+", "+h+"): Promise already settled in state"+this.A);this.A=g;this.b=h;this.j()};b.prototype.j=function(){if(null!=this.a){for(var g=0;g<this.a.length;++g)f.b(this.a[g]);this.a=null}};var f=new c;b.prototype.aa=function(g){var h=
this.c();g.Cf(h.resolve,h.reject)};b.prototype.s=function(g,h){var k=this.c();try{g.call(h,k.resolve,k.reject)}catch(l){k.reject(l)}};b.prototype.then=function(g,h){function k(p,r){return"function"==typeof p?function(v){try{l(p(v))}catch(w){m(w)}}:r}var l,m,q=new b(function(p,r){l=p;m=r});this.Cf(k(g,l),k(h,m));return q};b.prototype.catch=function(g){return this.then(void 0,g)};b.prototype.Cf=function(g,h){function k(){switch(l.A){case 1:g(l.b);break;case 2:h(l.b);break;default:throw Error("Unexpected state: "+
l.A);}}var l=this;null==this.a?f.b(k):this.a.push(k)};b.resolve=d;b.reject=function(g){return new b(function(h,k){k(g)})};b.race=function(g){return new b(function(h,k){for(var l=va(g),m=l.next();!m.done;m=l.next())d(m.value).Cf(h,k)})};b.all=function(g){var h=va(g),k=h.next();return k.done?d([]):new b(function(l,m){function q(v){return function(w){p[v]=w;r--;0==r&&l(p)}}var p=[],r=0;do p.push(void 0),r++,d(k.value).Cf(q(p.length-1),m),k=h.next();while(!k.done)})};return b});
ha("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;0>c&&(c=Math.max(0,e+c));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});ha("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});var wa="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a};
ha("Object.assign",function(a){return a||wa});var xa=this||self;function ya(a,b,c){a=a.split(".");c=c||xa;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function za(){}
function Aa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function Ba(a){var b=Aa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function Ca(a){return"function"==Aa(a)}function Da(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var Ea="closure_uid_"+(1E9*Math.random()>>>0),Fa=0;function Ga(a,b,c){return a.call.apply(a.bind,arguments)}
function Ha(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function Ia(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ia=Ga:Ia=Ha;return Ia.apply(null,arguments)}
function Ja(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){ya(a,b,void 0)}function u(a,b){function c(){}c.prototype=b.prototype;a.l=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Zo=function(d,e,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[e].apply(d,g)}};function Ka(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Ka);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}u(Ka,Error);Ka.prototype.name="CustomError";function La(a,b){this.c=a;this.f=b;this.b=0;this.a=null}La.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};La.prototype.put=function(a){this.f(a);100>this.b&&(this.b++,a.next=this.a,this.a=a)};function Ma(){this.b=this.a=null}var Oa=new La(function(){return new Na},function(a){a.reset()});Ma.prototype.add=function(a,b){var c=Oa.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};Ma.prototype.remove=function(){var a=null;this.a&&(a=this.a,this.a=this.a.next,this.a||(this.b=null),a.next=null);return a};function Na(){this.next=this.b=this.a=null}Na.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};Na.prototype.reset=function(){this.next=this.b=this.a=null};var Pa=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function Qa(a,b){return-1!=a.indexOf(b)}function Ra(a,b){return a<b?-1:a>b?1:0};function Sa(a,b){for(var c in a)if(b.call(void 0,a[c],c,a))return!0;return!1}function Ta(a){for(var b in a)return!1;return!0}function Ua(a){var b={},c;for(c in a)b[c]=a[c];return b}var Va="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Wa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Va.length;f++)c=Va[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Xa;a:{var Ya=xa.navigator;if(Ya){var Za=Ya.userAgent;if(Za){Xa=Za;break a}}Xa=""}function $a(a){return Qa(Xa,a)};var ab=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};function bb(a,b){this.b=a===cb&&b||"";this.a=db}var db={},cb={},eb=new bb(cb,"");function fb(a,b){this.b=a===gb&&b||"";this.a=hb}fb.prototype.xc=function(){return 1};var hb={},gb={};function ib(){this.b="";this.c=jb;this.a=null}ib.prototype.xc=function(){return this.a};function kb(){var a=lb;if(a instanceof ib&&a.constructor===ib&&a.c===jb)return a.b;Aa(a);return"type_error:SafeHtml"}var jb={};function mb(a){var b=new ib;b.b=a;b.a=0;return b}mb("<!DOCTYPE html>");var lb=mb("");mb("<br>");function nb(a){var b=new fb(gb,eb instanceof bb&&eb.constructor===bb&&eb.a===db?eb.b:"type_error:Const");b instanceof fb&&b.constructor===fb&&b.a===hb?b=b.b:(Aa(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function ob(a){ob[" "](a);return a}ob[" "]=za;function pb(a,b){var c=qb;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)};var rb=$a("Opera"),tb=$a("Trident")||$a("MSIE"),ub=$a("Edge"),vb=$a("Gecko")&&!(Qa(Xa.toLowerCase(),"webkit")&&!$a("Edge"))&&!($a("Trident")||$a("MSIE"))&&!$a("Edge"),wb=Qa(Xa.toLowerCase(),"webkit")&&!$a("Edge");function xb(){var a=xa.document;return a?a.documentMode:void 0}var yb;
a:{var zb="",Ab=function(){var a=Xa;if(vb)return/rv:([^\);]+)(\)|;)/.exec(a);if(ub)return/Edge\/([\d\.]+)/.exec(a);if(tb)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(wb)return/WebKit\/(\S+)/.exec(a);if(rb)return/(?:Version)[ \/]?(\S+)/.exec(a)}();Ab&&(zb=Ab?Ab[1]:"");if(tb){var Bb=xb();if(null!=Bb&&Bb>parseFloat(zb)){yb=String(Bb);break a}}yb=zb}var qb={};
function Cb(a){return pb(a,function(){for(var b=0,c=Pa(String(yb)).split("."),d=Pa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"";do{g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];h=/(\d*)(\D*)(.*)/.exec(h)||["","","",""];if(0==g[0].length&&0==h[0].length)break;b=0==g[1].length?0:parseInt(g[1],10);var k=0==h[1].length?0:parseInt(h[1],10);b=Ra(b,k)||Ra(0==g[2].length,0==h[2].length)||Ra(g[2],h[2]);g=g[3];h=h[3]}while(0==b)}return 0<=b})}var Db;
Db=xa.document&&tb?xb():void 0;!vb&&!tb||tb&&9<=Number(Db)||vb&&Cb("1.9.1");tb&&Cb("9");function Eb(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function Fb(a){xa.setTimeout(function(){throw a;},0)}var Gb;
function Hb(){var a=xa.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!$a("Presto")&&(a=function(){var e=Eb("IFRAME");e.style.display="none";nb(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(kb());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=Ia(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},
this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!$a("Trident")&&!$a("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.nj;c.nj=null;e()}};return function(e){d.next={nj:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in Eb("SCRIPT")?function(e){var f=Eb("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;
f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){xa.setTimeout(e,0)}};function Ib(a,b){Jb||Kb();Lb||(Jb(),Lb=!0);Mb.add(a,b)}var Jb;function Kb(){if(xa.Promise&&xa.Promise.resolve){var a=xa.Promise.resolve(void 0);Jb=function(){a.then(Nb)}}else Jb=function(){var b=Nb;!Ca(xa.setImmediate)||xa.Window&&xa.Window.prototype&&!$a("Edge")&&xa.Window.prototype.setImmediate==xa.setImmediate?(Gb||(Gb=Hb()),Gb(b)):xa.setImmediate(b)}}var Lb=!1,Mb=new Ma;function Nb(){for(var a;a=Mb.remove();){try{a.a.call(a.b)}catch(b){Fb(b)}Oa.put(a)}Lb=!1};function Ob(a){this.A=Qb;this.i=void 0;this.c=this.a=this.b=null;this.f=this.g=!1;if(a!=za)try{var b=this;a.call(void 0,function(c){Rb(b,Sb,c)},function(c){Rb(b,Tb,c)})}catch(c){Rb(this,Tb,c)}}var Qb=0,Sb=2,Tb=3;function Ub(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}Ub.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var Vb=new La(function(){return new Ub},function(a){a.reset()});function Wb(a,b,c){var d=Vb.get();d.f=a;d.b=b;d.c=c;return d}
function Xb(a){if(a instanceof Ob)return a;var b=new Ob(za);Rb(b,Sb,a);return b}function Yb(a){return new Ob(function(b,c){c(a)})}function Zb(){var a,b,c=new Ob(function(d,e){a=d;b=e});return new $b(c,a,b)}Ob.prototype.then=function(a,b,c){return bc(this,Ca(a)?a:null,Ca(b)?b:null,c)};Ob.prototype.$goog_Thenable=!0;Ob.prototype.cancel=function(a){if(this.A==Qb){var b=new cc(a);Ib(function(){dc(this,b)},this)}};
function dc(a,b){if(a.A==Qb)if(a.b){var c=a.b;if(c.a){for(var d=0,e=null,f=null,g=c.a;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.A==Qb&&1==d?dc(c,b):(f?(d=f,d.next==c.c&&(c.c=d),d.next=d.next.next):ec(c),fc(c,e,Tb,b)))}a.b=null}else Rb(a,Tb,b)}function gc(a,b){a.a||a.A!=Sb&&a.A!=Tb||hc(a);a.c?a.c.next=b:a.a=b;a.c=b}
function bc(a,b,c,d){var e=Wb(null,null,null);e.a=new Ob(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(l){g(l)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof cc?g(h):f(k)}catch(l){g(l)}}:g});e.a.b=a;gc(a,e);return e.a}Ob.prototype.m=function(a){this.A=Qb;Rb(this,Sb,a)};Ob.prototype.o=function(a){this.A=Qb;Rb(this,Tb,a)};
function Rb(a,b,c){if(a.A==Qb){a===c&&(b=Tb,c=new TypeError("Promise cannot resolve to itself"));a.A=1;a:{var d=c,e=a.m,f=a.o;if(d instanceof Ob){gc(d,Wb(e||za,f||null,a));var g=!0}else{if(d)try{var h=!!d.$goog_Thenable}catch(l){h=!1}else h=!1;if(h)d.then(e,f,a),g=!0;else{if(Da(d))try{var k=d.then;if(Ca(k)){ic(d,k,e,f,a);g=!0;break a}}catch(l){f.call(a,l);g=!0;break a}g=!1}}}g||(a.i=c,a.A=b,a.b=null,hc(a),b!=Tb||c instanceof cc||jc(a,c))}}
function ic(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function hc(a){a.g||(a.g=!0,Ib(a.j,a))}function ec(a){var b=null;a.a&&(b=a.a,a.a=b.next,b.next=null);a.a||(a.c=null);return b}Ob.prototype.j=function(){for(var a;a=ec(this);)fc(this,a,this.A,this.i);this.g=!1};
function fc(a,b,c,d){if(c==Tb&&b.b&&!b.g)for(;a&&a.f;a=a.b)a.f=!1;if(b.a)b.a.b=null,kc(b,c,d);else try{b.g?b.f.call(b.c):kc(b,c,d)}catch(e){lc.call(null,e)}Vb.put(b)}function kc(a,b,c){b==Sb?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function jc(a,b){a.f=!0;Ib(function(){a.f&&lc.call(null,b)})}var lc=Fb;function cc(a){Ka.call(this,a)}u(cc,Ka);cc.prototype.name="cancel";function $b(a,b,c){this.pi=a;this.resolve=b;this.reject=c};var x=this;function mc(){return Object.create(y,void 0)}var A=Ia,nc=String,oc=x.Object.freeze||function(a){return a};function pc(a){for(var b=Object.keys(a),c=b.length,d;c--;)d=a[b[c]],Da(d)&&pc(d);return oc(a)}function qc(a){var b=Aa(a);if("object"==b||"array"==b){if(Ca(a.clone))return a.clone();b="array"==b?[]:{};for(var c in a)a.hasOwnProperty(c)&&(b[c]=qc(a[c]));return b}return a}var B=self.eval("undefined"),y=self.eval("null");function rc(a,b){return nc(a).split(b!==B?b:" ")}var sc="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function C(a,b,c,d,e){if(!(b=a instanceof b)&&c)throw new D(c,d,tc(e)?e:a);return b}function uc(a,b){if(!0===(C(a,b)&&a.constructor===b))throw new TypeError("Illegal constructor "+vc(b));}function wc(a,b,c,d,e){if(!(b=xc(a)===b)&&c)throw new D(c,d,tc(e)?e:a);return b}function yc(a,b,c,d){return wc(a,"Array",b,c,d)}t("H.lang.isArray",yc);function tc(a){return a!==B}function zc(a){return"string"===typeof a}t("H.lang.isString",zc);var Ac=parseInt,Bc=parseFloat,E=isNaN;
function Cc(a){return a===+a}t("H.lang.isNumber",Cc);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Dc(a){return!E(+a)}function xc(a){var b=Object[sc[0]][sc[6]].call(a).match(/^\[object (\w+)\]$/);return b?b[1]:typeof a}var Ec=[];function Fc(a){0>Ec.indexOf(a)&&Ec.push(a)}Fc(Ec);
function vc(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:x.H},c="",d=Ec.slice());Gc(b,!0,function(h,k){try{if(g=h[k],k=Hc(h,g),!(Da(g)&&g.window===g&&g.self===g||Da(g)&&0<g.nodeType&&Ca(g.cloneNode))&&Da(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=vc(a,g,c+"."+k,d)))return!0}}catch(l){}});f&&(e=e?e.substr(1).replace("."+sc[0]+".","#"):"~"+(Ca(a)?Ic(a)+"()":xc(a)));return e}
function Hc(a,b){var c=[];Gc(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Jc)[0]}function Jc(a,b){return b.length-a.length}var Kc=Object[sc[0]][sc[2]];function Gc(a,b,c){var d;if(a){for(e in a)if((!b||Kc.call(a,e))&&c(a,e,!0))return;for(d=sc.length;d--;){var e=sc[d];if((!b||Kc.call(a,e))&&c(a,e,!1))break}}}function Ic(a){return(a=/^\s*function ([^\( ]+)/.exec(a))?a[1]:"anonymous"}function Lc(a,b,c){c[b]="#"+b}var Mc=!!x.__karma__;function Nc(){throw Error("unimplemented method");};function Oc(a,b){b=b||{};"status"in b&&(this.status=+b.status);"statusText"in b&&(this.statusText=b.statusText);this.ok=200<=this.status&&300>this.status;this.bodyUsed=!1;a?"string"===typeof a?this.c=a:ArrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||a.buffer)?this.a=a.buffer||a:Blob.prototype.isPrototypeOf(a)&&(this.b=a):this.c=""}t("H.net.Response",Oc);Oc.prototype.type="default";Oc.prototype.type=Oc.prototype.type;Oc.prototype.status=200;Oc.prototype.status=Oc.prototype.status;
Oc.prototype.statusText="OK";Oc.prototype.statusText=Oc.prototype.statusText;function Pc(a){if(a.bodyUsed)return Yb(new TypeError("Already read"));a.bodyUsed=!0}Oc.error=function(){Oc.a||(Oc.a=new Oc(null,{status:0,statusText:""}),Oc.a.type="error");return Oc.a};Oc.error=Oc.error;
Oc.prototype.text=function(){var a=Pc(this);if(!a)if(this.c)a=Xb(this.c);else if(this.a){a=new Uint8Array(this.a);var b=a.length,c=Array(b),d;for(d=0;d<b;d++)c[d]=String.fromCharCode(a[d]);a=Xb(c.join(""))}else this.b?a=Qc(this.b):a=Yb("Unsupported response body");return a};Oc.prototype.json=function(){return this.text().then(x.JSON.parse)};Oc.prototype.blob=function(){var a,b=Pc(this);b||(this.b?a=this.b:this.a&&(a=new Blob([this.a],{type:"application/octet-stream"})));return b||Xb(a)};
Oc.prototype.arrayBuffer=function(){return this.a?Pc(this)||Xb(this.a.slice(0)):this.blob().then(Oc.b)};Oc.b=function(a){var b=new FileReader;b.readAsArrayBuffer(a);return new Ob(function(c,d){b.onload=function(){c(b.result)};b.onerror=function(){d(b.error)}})};function Qc(a){var b=new FileReader;b.readAsText(a);return new Ob(function(c,d){b.onload=function(){c(b.result)};b.onerror=function(){d(b.error)}})}!Mc&&x.Response&&x.Response.error&&(Oc=x.Response,Fc(Oc.prototype));function Rc(a,b,c){function d(){var m=A(l.a,l),q=+k.timeout||0;Tc?(Uc(l,"timeout",m),e.timeout=q):q&&(l.c=setTimeout(function(){e.abort();l.a({type:"timeout"})},q));Uc(l,"error",m);Uc(l,"load",m);e.send(k.data)}var e,f,g,h=c&&c.headers||{},k={},l=this;if(!Ca(b))throw new D(Rc,1,"function required");Wa(h,Vc.headers,h);Wa(k,Vc,c||{});k.headers=h;this.b=b;this.va=e=new XMLHttpRequest;b=k.method;try{e.open(b,a,!0);for(f in h)h.hasOwnProperty(f)&&(g=h[f])&&e.setRequestHeader(f,g);e.withCredentials=!!k.withCredentials;
d()}catch(m){this.a({type:"cors"})}}t("H.net.Xhr",Rc);var Vc={method:"GET",headers:{},data:null},Wc="withCredentials"in new XMLHttpRequest,Tc="timeout"in new XMLHttpRequest;function Uc(a,b,c){Wc?a.va.addEventListener(b,c):a.va["on"+b]=c}function Xc(a,b,c){Wc?a.va.removeEventListener(b,c):a.va["on"+b]=null}Rc.prototype.abort=function(){this.va&&(this.va.abort(),this.va&&this.a({type:"abort"}))};Rc.prototype.abort=Rc.prototype.abort;
Rc.prototype.a=function(a){var b=a.type;a=this.va;var c,d;this.c&&clearTimeout(this.c);"load"===b?a instanceof XMLHttpRequest&&200!==a.status&&(c="network"):c=4===a.readyState&&0===a.status&&"error"==b?"cors":"error"!=b?b:"network";b=this.a;Xc(this,"timeout",b);Xc(this,"error",b);Xc(this,"load",b);0===a.status||c&&"network"!==c?d=Oc.error():d=new Oc(a.responseText,a);c=this.b;delete this.a;delete this.b;delete this.va;c(d)};function Yc(a,b){var c=[];a&&c.push(vc(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,Yc.prototype);return c}u(Yc,Error);t("H.lang.IllegalOperationError",Yc);Yc.prototype.name="IllegalOperationError";var Zc,$c,bd;function D(a,b,c){var d=arguments.length;b=b!==B?+b:b;if(b!==B){var e=(e=/^.*?\(([^\)]+)/.exec((""+a).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?rc(e[1].replace(/\s+/g,""),","):[];e.forEach(Lc);e=e[b]||"#"+b}var f=a?vc(a):"";d=2<d?nc(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,D.prototype);return d}u(D,Error);t("H.lang.InvalidArgumentError",D);D.prototype.name="InvalidArgumentError";function cd(){if(!zc("STATIC_DB"))throw new D(this.constructor,0);this.g=x.indexedDB||x.Ro||x.fo||x.ho;if(!this.g)throw new Yc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.ki=A(this.ki,this)}var dd,ed;n=cd.prototype;n.put=function(a,b,c,d){if(!zc(a)&&!Cc(a))throw new D(this.put,0);if(!fd(b))throw new D(this.put,1);gd(this,function(e){hd(e.put(b,a),c,d)},d)};
n.get=function(a,b,c){var d;if(!zc(a)&&!Cc(a))throw new D(this.get,0);if(!Ca(b))throw new D(this.get,1);gd(this,function(e){d=e.get(a);hd(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=id)}}};n.remove=function(a,b,c){if(!zc(a)&&!Cc(a))throw new D(this.remove,0);gd(this,function(d){hd(d["delete"](a),b,c)},c)};n.clear=function(a,b){gd(this,function(c){hd(c.clear(),a,b)},b)};n.ki=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};
function jd(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.g.open(kd+"STATIC_DB",1);a.b.onupgradeneeded=a.ki;var d=a.b.onerror=function(){clearTimeout(a.i);a.f=this.error;a.c.forEach(function(e){e(a.f)});a.a=a.c=null};a.i=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.i);a.a?(a.a.forEach(function(e){e(this.result)},this),a.a=a.c=null):(a.b=a.f=null,a.a=[],a.c=[])};a.a.push(b);c&&a.c.push(c)}}
function gd(a,b,c){jd(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function hd(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}function fd(a){var b=Object.prototype.toString.call(a);return"[object Blob]"===b||"[object ArrayBuffer]"===b||zc(a)||Da(a)}function ld(){dd||(dd=new cd);return dd}t("H.util.IndexedDBStorage.getInstance",ld);var kd="H_";
function md(){if(!tc(ed))if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)ed=!1;else{var a=x.indexedDB||x.Ro||x.fo||x.ho;var b=kd+"TEST_DB";try{var c=a&&a.open(b,1)}catch(d){}ed=!!c&&null===c.onupgradeneeded;c&&a.deleteDatabase&&a.deleteDatabase(b)}return ed}t("H.util.IndexedDBStorage.isSupported",md);function nd(){0!=od&&(pd[this[Ea]||(this[Ea]=++Fa)]=this);this.Ed=this.Ed;this.rb=this.rb}var od=0,pd={};nd.prototype.Ed=!1;nd.prototype.C=function(){if(!this.Ed&&(this.Ed=!0,this.u(),0!=od)){var a=this[Ea]||(this[Ea]=++Fa);if(0!=od&&this.rb&&0<this.rb.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pd[a]}};
nd.prototype.wb=function(a,b){this.Ed?void 0!==b?a.call(b):a():(this.rb||(this.rb=[]),this.rb.push(void 0!==b?Ia(a,b):a))};nd.prototype.u=function(){if(this.rb)for(;this.rb.length;)this.rb.shift()()};function qd(a){a&&"function"==typeof a.C&&a.C()};function rd(a,b){this.type=a;this.currentTarget=this.target=b;this.f=this.a=!1;this.Rk=!0}rd.prototype.stopPropagation=function(){this.a=!0};rd.prototype.preventDefault=function(){this.f=!0;this.Rk=!1};t("H.util.Event",rd);rd.prototype.stopPropagation=rd.prototype.stopPropagation;rd.prototype.stopPropagation=rd.prototype.stopPropagation;rd.prototype.CAPTURING_PHASE=1;rd.prototype.CAPTURING_PHASE=rd.prototype.CAPTURING_PHASE;rd.prototype.AT_TARGET=2;rd.prototype.AT_TARGET=rd.prototype.AT_TARGET;rd.prototype.BUBBLING_PHASE=3;rd.prototype.BUBBLING_PHASE=rd.prototype.BUBBLING_PHASE;rd.prototype.eventPhase=0;rd.prototype.eventPhase=rd.prototype.eventPhase;function sd(a,b,c){sd.l.constructor.call(this,a,c);this.data=b}u(sd,rd);t("H.util.DataEvent",sd);function td(a,b,c){td.l.constructor.call(this,a,c);this.message=b}u(td,rd);t("H.util.ErrorEvent",td);var ud=Math,vd=ud.min,wd=ud.max,xd=ud.round,yd=ud.floor,zd=ud.ceil,Ad=ud.abs,Bd=ud.log,Cd=ud.sqrt,Dd=ud.pow,Ed=ud.exp,Fd=ud.sin,Gd=ud.asin,Hd=ud.cos,Id=ud.tan,Jd=ud.atan,Kd=ud.atan2,Ld=ud.LN2,Md=ud.PI,Nd=Md/2,Od=Md/4,Pd=2*Md,Qd=3*Md,Rd=Md/180,Sd=180/Md,Td=1/0,Ud=Dd(-2,53),Vd=Vd||function(a){return Bd(a)/Ld};function Wd(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}function Xd(a,b,c){b-=c=c||0;a-=c;return a-yd(a/b)*b+c}t("H.math.normalize",Xd);function Yd(a,b,c){return a>c?c:a<b?b:a}
t("H.math.clamp",Yd);function Zd(a,b,c,d){d||(d=0);return b<c?a>=b-d&&a<=c+d:a>=c-d&&a<=b+d}function $d(a,b,c,d,e,f){return Cd(Dd((a-e)*(d-f)-(b-f)*(c-e),2)/(Dd(c-e,2)+Dd(d-f,2)))}var ae={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",ae);
function be(a,b,c,d,e,f){var g=c.length,h=g,k=c[0],l=0,m=0,q=0;d=d/2||0;var p=f||2;f=p*(e?0:1)+1;for(var r=p-2;1!=l&&h>f;){h-=r;var v=c[--h];p=c[--h];var w=c[h?h-r-1:(g+(h-r-1))%g];var z=c[h?h-r-2:(g+(h-r-2))%g];if(p>=a-d&&p<=a+d&&v>=b-d&&v<=b+d||z>=a-d&&z<=a+d&&w>=b-d&&w<=b+d)l=1;else if(!l&&p===a)z===a&&(v<b&&w>b||v>b&&w<b)||(k<=a&&z>a||k>=a&&z<a)&&(v>=b?++m:++q),l=Zd(b,v,w,d)&&$d(a,b,p,v,z,w)<=d?2:0;else if(!l&&Zd(a,p,z,d)){if(p<a&&z>a||p>a&&z<a)k=v+(a-p)/(z-p)*(w-v),m+=k>b,q+=k<b;l=Zd(b,v,w,d)&&
$d(a,b,p,v,z,w)<=d?2:0}k=p}!l&&e&&0!==q&&0!==m%2&&(l=3);return l}function ce(a,b){return be(a.x,a.y,b,0,!0)!==ae.NONE}t("H.math.isPointInsidePolygon",ce);function de(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&tc(a[0].x);b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",de);function ee(a,b,c){this.type=a;this.data=b;this.c=Zb();this.resolve=A(this.resolve,this);this.reject=A(this.reject,this);this.priority=fe;c!==B&&(this.priority=c);this.sh().add(this)}var fe=1,ge={Vo:0,Yo:fe,Uo:2};n=ee.prototype;n.then=function(a,b,c){return this.c.pi.then(a,b,c)};n.resolve=function(a){this.ee=3;this.c.resolve(a)};n.reject=function(a){this.ee=5;this.c.reject(a)};n.ee=0;n.cancel=function(){this.c.pi.cancel();3>this.ee&&(this.ve(),this.sh().remove(this),this.ee=4)};function he(a){var b;this.a={};for(b in ge)this.a[ge[b]]=[];this.ug=a;this.ug.addEventListener("allocatable",A(this.b,this))}t("H.util.JobManager",he);var ie=Object.keys(ge).map(function(a){return ge[a]}).sort().reverse();he.prototype.add=function(a){C(a,ee,this.add,0);this.a[a.priority].push(a);this.b()};he.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};he.prototype.remove=function(a){var b=a.priority;a=this.a[b].indexOf(a);return-1<a?(this.a[b].splice(a,1),!0):!1};
he.prototype.b=function(){ie.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ug.Pg(b))!==y){var d=A(this.ug.dh,this.ug,c,b);b.then(d,d);b.ee=b.Cj(c)?1:5}else return!0},this)},this)};function je(a,b,c){var d=[],e=arguments.length;a&&d.push(vc(a));1<e&&(e=2<e&&yc(c)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,je.prototype);return d}u(je,Error);t("H.lang.OutOfRangeError",je);je.prototype.name="OutOfRangeError";var ke="closure_listenable_"+(1E6*Math.random()|0);function le(a){return!(!a||!a[ke])}var me=0;function ne(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.Yf=e;this.key=++me;this.ge=this.Bf=!1}function oe(a){a.ge=!0;a.listener=null;a.proxy=null;a.src=null;a.Yf=null};function pe(a){this.src=a;this.a={};this.b=0}pe.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=qe(a,b,d,e);-1<g?(b=a[g],c||(b.Bf=!1)):(b=new ne(b,this.src,f,!!d,e),b.Bf=c,a.push(b));return b};pe.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.a))return!1;var e=this.a[a];b=qe(e,b,c,d);return-1<b?(oe(e[b]),Array.prototype.splice.call(e,b,1),0==e.length&&(delete this.a[a],this.b--),!0):!1};
function re(a,b){var c=b.type;if(!(c in a.a))return!1;var d=a.a[c],e=ab(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(oe(b),0==a.a[c].length&&(delete a.a[c],a.b--));return f}pe.prototype.ra=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,oe(d[e]);delete this.a[c];this.b--}return b};
function se(a,b){var c=void 0!==b,d=c?b.toString():"";return Sa(a.a,function(e){for(var f=0;f<e.length;++f)if(!c||e[f].type==d)return!0;return!1})}function qe(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.ge&&f.listener==b&&f.capture==!!c&&f.Yf==d)return e}return-1};var te=!tb||9<=Number(Db),ue=tb&&!Cb("9");!wb||Cb("528");vb&&Cb("1.9b")||tb&&Cb("8")||rb&&Cb("9.5")||wb&&Cb("528");vb&&!Cb("8")||tb&&Cb("9");var ve=function(){if(!xa.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{xa.addEventListener("test",za,b),xa.removeEventListener("test",za,b)}catch(c){}return a}();function we(a,b){rd.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(vb){a:{try{ob(b.nodeName);var e=!0;break a}catch(f){}e=
!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=
a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:xe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.preventDefault()}}u(we,rd);var xe={2:"touch",3:"pen",4:"mouse"};we.prototype.stopPropagation=function(){we.l.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};
we.prototype.preventDefault=function(){we.l.preventDefault.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ue)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var ye="closure_lm_"+(1E6*Math.random()|0),ze={},Ae=0;function Be(a,b,c,d,e){if(d&&d.once)return Ce(a,b,c,d,e);if("array"==Aa(b)){for(var f=0;f<b.length;f++)Be(a,b[f],c,d,e);return null}c=De(c);return le(a)?a.aa.add(String(b),c,!1,Da(d)?!!d.capture:!!d,e):Ee(a,b,c,!1,d,e)}
function Ee(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=Da(e)?!!e.capture:!!e,h=Fe(a);h||(a[ye]=h=new pe(a));c=h.add(b,c,d,g,f);if(c.proxy)return c;d=Ge();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ve||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(He(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Ae++;return c}
function Ge(){var a=Je,b=te?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function Ce(a,b,c,d,e){if("array"==Aa(b)){for(var f=0;f<b.length;f++)Ce(a,b[f],c,d,e);return null}c=De(c);return le(a)?a.aa.add(String(b),c,!0,Da(d)?!!d.capture:!!d,e):Ee(a,b,c,!0,d,e)}
function Ke(a,b,c,d,e){if("array"==Aa(b)){for(var f=0;f<b.length;f++)Ke(a,b[f],c,d,e);return null}d=Da(d)?!!d.capture:!!d;c=De(c);if(le(a))return a.aa.remove(String(b),c,d,e);if(!a)return!1;if(a=Fe(a))if(b=a.a[b.toString()],a=-1,b&&(a=qe(b,c,d,e)),c=-1<a?b[a]:null)return Le(c);return!1}
function Le(a){if("number"===typeof a||!a||a.ge)return!1;var b=a.src;if(le(b))return re(b.aa,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(He(c),d):b.addListener&&b.removeListener&&b.removeListener(d);Ae--;(c=Fe(b))?(re(c,a),0==c.b&&(c.src=null,b[ye]=null)):oe(a);return!0}function He(a){return a in ze?ze[a]:ze[a]="on"+a}
function Me(a,b,c,d){var e=!0;if(a=Fe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.ge&&(f=Ne(f,d),e=e&&!1!==f)}return e}function Ne(a,b){var c=a.listener,d=a.Yf||a.src;a.Bf&&Le(a);return c.call(d,b)}
function Je(a,b){if(a.ge)return!0;if(!te){if(!b)a:{b=["window","event"];for(var c=xa,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new we(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=Me(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=
d[e],f=Me(d[e],a,!1,b),c=c&&f}return c}return Ne(a,new we(b,this))}function Fe(a){a=a[ye];return a instanceof pe?a:null}var Oe="__closure_events_fn_"+(1E9*Math.random()>>>0);function De(a){if(Ca(a))return a;a[Oe]||(a[Oe]=function(b){return a.handleEvent(b)});return a[Oe]};function F(){nd.call(this);this.aa=new pe(this);this.Bn=this;this.$g=null}u(F,nd);F.prototype[ke]=!0;n=F.prototype;n.ic=function(){return this.$g};n.ja=function(a){this.$g=a};n.addEventListener=function(a,b,c,d){Be(this,a,b,c,d)};n.removeEventListener=function(a,b,c,d){Ke(this,a,b,c,d)};
n.dispatchEvent=function(a){var b,c=this.ic();if(c)for(b=[];c;c=c.ic())b.push(c);c=this.Bn;var d=a.type||a;if("string"===typeof a)a=new rd(a,c);else if(a instanceof rd)a.target=a.target||c;else{var e=a;a=new rd(d,c);Wa(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.ld(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.ld(d,!0,a)&&e,a.a||(e=g.ld(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.ld(d,!1,a)&&e;return e};
n.u=function(){F.l.u.call(this);this.aa&&this.aa.ra(void 0);this.$g=null};n.ld=function(a,b,c){a=this.aa.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.ge&&f.capture==b){var g=f.listener,h=f.Yf||f.src;f.Bf&&re(this.aa,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.Rk};t("H.util.EventTarget",F);F.prototype.ja=F.prototype.ja;F.prototype.setParentEventTarget=F.prototype.ja;F.prototype.ic=F.prototype.ic;F.prototype.getParentEventTarget=F.prototype.ic;F.prototype.addEventListener=F.prototype.addEventListener;F.prototype.addEventListener=F.prototype.addEventListener;F.prototype.removeEventListener=F.prototype.removeEventListener;F.prototype.removeEventListener=F.prototype.removeEventListener;F.prototype.dispatchEvent=F.prototype.dispatchEvent;
F.prototype.dispatchEvent=F.prototype.dispatchEvent;F.prototype.C=F.prototype.C;F.prototype.dispose=F.prototype.C;F.prototype.wb=F.prototype.wb;F.prototype.addOnDisposeCallback=F.prototype.wb;F.prototype.Kn=F.prototype.ld;
F.prototype.ld=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=F.prototype.Kn.apply(this,arguments),d&&this.ic&&null===this.ic()&&delete c.eventPhase;return f};function Pe(a){a=a||{};var b=a.callback;this.a=a.label;Ca(b)&&(this.callback=b);this.b=!!a.disabled;Pe.l.constructor.call(this)}u(Pe,F);t("H.util.ContextItem",Pe);Pe.prototype.Me=function(){return this.a};Pe.prototype.getLabel=Pe.prototype.Me;Pe.prototype.Pc=function(a){this.a!==a&&(this.a=a,this.dispatchEvent("update"));return this};Pe.prototype.setLabel=Pe.prototype.Pc;Pe.prototype.lc=function(){return this.b};Pe.prototype.isDisabled=Pe.prototype.lc;
Pe.prototype.Ca=function(a){a^this.b&&(this.b=a,this.dispatchEvent("update"));return this};Pe.prototype.setDisabled=Pe.prototype.Ca;var Qe=new Pe;Pe.SEPARATOR=Qe;function Re(){if(x.document){var a=document.createElement("canvas");a.width=a.height=1;return a.getContext("2d")}return null}function Se(){return window.devicePixelRatio||1}t("H.util.getPixelRatio",Se);var Te=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;
function Ue(a){var b=Ve[a],c=x.RegExp;b||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(d){return d instanceof Number?Array(d):d.map(function(e){return Yd(xd(e),0,255)})}),"none"===a?b=new Uint8ClampedArray([0,0,0,0]):(We.fillStyle="black",We.fillStyle=a,Te.test(We.fillStyle)?b=new Uint8ClampedArray([c.$1,c.$2,c.$3,255*c.$4]):(We.clearRect(0,0,1,1),We.fillRect(0,0,1,1),b=We.getImageData(0,0,1,1).data)),Ve[a]=b);return b}function Xe(a){return"none"!==a&&0<Ue(a)[3]}var Ve=mc(),Ye=!!x.VBArray;
t("H.util.eval",function(a){return eval(a)});function Ze(a,b){return a!==B?a:b}function $e(a){return/^<svg/.test(a)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a):a}t("H.util.provide",function(a){var b=xa.$jscomp;if(b&&("function"!=typeof b.nm?0:b.nm()))throw Error("goog.provide cannot be used within a module.");ya(a,void 0)});function af(a){this.nc=0<a?ud.round(a):0}af.prototype.next=function(a){if(9007199254740992===this.nc)throw new je(a,this.nc,[0,9007199254740991]);return this.nc++};
var bf=new af,cf=A(bf.next,bf);function df(){return!0}function ef(){return!1}function id(){}var ff=oc([]),gf=oc({});function hf(a){return"CANVAS"===a.tagName?[a]:a.getElementsByTagName("CANVAS")}function jf(a,b,c){var d;b=a.ownerDocument===b?a.cloneNode(!0):b.importNode(a,!0);if(c)for(a=hf(a),c=hf(b),d=c.length;d--;)c[d].getContext("2d").drawImage(a[d],0,0);return b}var We=Re(),kf=Re();
function lf(a){var b=a.complete,c=0<a.naturalWidth;if(b&&!c&&Ye)try{kf.drawImage(a,0,0),c=!0}catch(d){}return b&&c}var mf=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function nf(a,b){b=b||"";if(mf){var c=new mf;c.append(a);a=c.getBlob(b)}else a=new Blob([a],{type:b});return a}var of=x.navigator;$c=/Edge\/\d+/.test(of.appVersion);bd=/(A|a)ndroid/.test(of.appVersion);function pf(){var a=pf.a;a||(a=this,pf.a=a,Fc(pf.a),F.call(a),qf(this));return a}u(pf,F);pf.prototype.u=function(){pf.l.u.call(this);qf(this)};function qf(a){a.g=10;a.i=6;a.a=mc();a.b=mc();a.c=0}pf.prototype.Pg=function(a){a=a.type;var b=this.a[a]||0;if(this.c<this.g&&b<this.i){var c=++this.f;this.c++;this.a[a]=b+1;this.b[c+""]=a;return c}return y};
pf.prototype.dh=function(a){var b=this.b[a];if(!tc(b)||!this.a[b])throw new Yc(this.dh,"Unknown requestId");this.c--;this.a[b]--;this.a[b]||delete this.a[b];delete this.b[a];this.dispatchEvent("allocatable")};pf.prototype.f=-1;function rf(a,b,c,d){if(!this.b[a])throw new D(rf,0,"Mime type is not supported");this.g=a;a=d?Ua(d):{};"crossOrigin"in a||(a.crossOrigin="anonymous");this.a=a;sf.href=b.toString();ee.call(this,sf.protocol+"//"+sf.hostname,b,c)}u(rf,ee);rf.prototype.Cj=function(){this.f=this.b[this.g].call(this);return!0};rf.prototype.ve=function(){this.f&&(this.f.abort(),this.f=null)};
rf.prototype.b={"application/json":function(){var a=this,b=tf(this.a),c=b.headers;b.headers=c=c?Ua(c):{};c.Accept="application/json";return new Rc(this.data,function(d){200<=d.status&&300>d.status?a.resolve(d.json()):a.reject(d)},b)},"text/plain":function(){var a=this;return new Rc(this.data,function(b){200<=b.status&&300>b.status?a.resolve(b.text()):a.reject(b)},tf(this.a))},image:function(){var a=x.document.createElement("img"),b=this,c=this.data;a.onload=A(this.resolve,this,a);a.onerror=function(){b.reject(Oc.error())};
a.crossOrigin=this.a.crossOrigin;a.src=c;return{abort:function(){a.onerror=a.onload=null;Ye&&lf(a)||a.removeAttribute("src")}}}};
(function(){try{var a=new XMLHttpRequest;a.open("get","/",!0)}catch(b){a={}}"response"in a&&(rf.prototype.b.arraybuffer=function(){var b=new XMLHttpRequest,c=this,d=this.a,e=d.headers,f;b.open("GET",this.data);uf(b,d);b.responseType="arraybuffer";if(e)for(f in e)b.setRequestHeader(f,e[f]);b.onerror=b.ontimeout=function(){c.reject(Oc.error())};b.onload=function(){c.resolve(new Oc(b.response))};b.send();return b})})();var vf=new he(new pf);rf.prototype.sh=function(){return vf};var sf=x.document.createElement("a");
function tf(a){var b=Ua(a);delete b.crossOrigin;uf(b,a);return b}function uf(a,b){a.withCredentials="use-credentials"===b.crossOrigin};function I(a,b){this.x=+a;this.y=+b}t("H.math.Point",I);I.prototype.set=I;I.prototype.set=I.prototype.set;I.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new I(this.x,this.y);return a};I.prototype.clone=I.prototype.clone;I.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};I.prototype.add=I.prototype.add;I.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};I.prototype.sub=I.prototype.sub;I.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};
I.prototype.scale=I.prototype.scale;I.prototype.round=function(){this.x=xd(this.x);this.y=xd(this.y);return this};I.prototype.round=I.prototype.round;I.prototype.floor=function(){this.x=yd(this.x);this.y=yd(this.y);return this};I.prototype.floor=I.prototype.floor;I.prototype.ceil=function(){this.x=zd(this.x);this.y=zd(this.y);return this};I.prototype.ceil=I.prototype.ceil;I.prototype.na=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};I.prototype.equals=I.prototype.na;
I.prototype.Kj=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new I(a.x+f*c,a.y+f*d)}return e};I.prototype.getNearest=I.prototype.Kj;I.prototype.Ya=function(a){return Cd(Dd(this.x-a.x,2)+Dd(this.y-a.y,2))};I.prototype.distance=I.prototype.Ya;function wf(a){if(!a)throw Error("invalid argument");return a instanceof I?a:new I(a.x,a.y)}I.fromIPoint=wf;function xf(a){var b=yf[a];if(!b)if(a in zf)b=yf[a]=a;else{b=Af.length;var c="",d=a.charAt(0).toUpperCase()+a.substr(1),e="",f=!1;Bf&&(e=Bf+d,f=e in zf);for(;b--&&!f;)c=Af[b],e=c+d,f=e in zf;f&&(Bf=c);if(b=f?e:null)yf[a]=b;else throw Error("Could not find any variant of CSS property ["+a+"]");}return b}t("H.dom.cssPrefixer.prefix",xf);var Af=["O","Ms","ms","Moz","Webkit"],yf={},Bf="",zf=document.createElement("span").style;function Cf(a,b,c,d){if(!a||!b||!c)throw new D(Cf,null,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Wa(this,d)}t("H.util.BuildInfo",Cf);Cf.prototype.toString=function(){var a,b=[];for(a in this)zc(this[a])&&b.push(this[a]);return b.join(";")};var Df={};function Ef(a,b,c,d){if(!a)throw new D(Ef,1,"Must specify a name parameter");return Df[a]||(Df[a]=new Cf(a,b,c,d))}Cf.get=Ef;function Ff(){Ff.l.constructor.call(this);this.a=Gf(this);this.f=mc();this.c=A(this.c,this);this.a.addEventListener("message",this.c);this.b={}}u(Ff,F);Ff.prototype.u=function(){this.a.terminate()};Ff.prototype.i=function(a){var b=a.type,c=!!this.f[b],d=a.data,e=Hf++,f=d&&d.Oo?d.Oo:B,g=!0;c?(this.b[e]=a,If(this,b,e,d&&d.message,f)):(a.reject(new D(this.i,0,"processor_not_found")),g=!1);return g};
Ff.prototype.c=function(a){a=a.data;var b=this.b[a.taskId],c=a.taskId,d=a.data,e=this;if(2===a.type)(new rf("arraybuffer",d)).then(function(f){return f.arrayBuffer()}).then(function(f){e.a.postMessage(["3",c,[f]],[f])},function(){e.a.postMessage(["3",c,[null,"ERROR"]])});else{if(b){switch(a.type){case 1:b.resolve(d);break;case 0:b.reject(d)}delete this.b[c]}this.dispatchEvent(new rd(this.g.IDLE))}};var Hf=0;function Jf(a,b,c){var d=Hf++,e;a.b[d]=e=Zb();If(a,b,d,c);return e.pi}
function If(a,b,c,d,e){d===B||Ba(d)||(d=[d]);try{a.a.postMessage([b,c,d],e)}catch(f){a=a.b[c],a.reject(f.message)}}Ff.prototype.g={IDLE:"idle",$i:"error"};Ff.prototype.j=function(a,b){var c=this.m||(this.m=new rd(this.g.$i));c.data=b;delete this.f[a];this.dispatchEvent(c)};
function Gf(a){var b=x.H.__bootstrap__;b=Ca(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b;if(x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(nf(b,"application/javascript")))}catch(d){}c||(a=new Kf(a),function(){eval("var self = arguments[0];"+b)}(a),c=new Lf(a));return c}function Lf(a){F.call(this);this.a=a}u(Lf,F);Lf.prototype.postMessage=function(a){x.setTimeout(A(this.b,this,a),0)};Lf.prototype.b=function(a){var b=new rd("message");b.data=a;this.a.dispatchEvent(b)};
Lf.prototype.terminate=function(){this.a.C();this.C()};function Kf(a){F.call(this);this.a=a;this.addEventListener=A(this.addEventListener,this);this.removeEventListener=A(this.removeEventListener,this);this.postMessage=A(this.postMessage,this);this.eval=A(eval,this)}u(Kf,F);Kf.prototype.postMessage=function(a){var b=new rd("message");b.data=a;x.setTimeout(A(this.a.c,this.a,b),0)};function Mf(){var a=Nf;a||(a=Nf=this,F.call(a),Pf(this));return a}var Nf;u(Mf,F);Mf.prototype.u=function(){Mf.l.u.call(this);Pf(this)};function Pf(a){var b=a.b,c;if(b)for(c=b.length;c--;)b[c].C();a.b=[];Fc(a.b);a.c=mc();a.f=mc()}
Mf.prototype.Pg=function(a){var b;a=a.type;if(b=this.f[a]){var c=this.b;var d=c[0];d||(d=c[0]=new Ff,this.wb(Ja(qd,d)),Ta(this.c)||(c=x.Object.keys(this.c),Jf(d,"0",c)));c=d;c.f[a]||(c.f[a]=b,Jf(c,"1",[a,Ca(b)?b+"":b]).then(id,A(c.j,c,a)))}else throw new Yc(this.Pg,'Unknown type "'+a+'"');return d};Mf.prototype.dh=function(){};Mf.prototype.a=function(a,b){var c=this.f,d=c[a];if(d){if(b!==d)throw new Yc(this.a,'Type "'+a+'" is already registered');}else c[a]=b};function Qf(a,b,c){ee.call(this,a,b,c)}var Rf;u(Qf,ee);Qf.prototype.sh=function(){Rf||(Rf=new he(new Mf));return Rf};Qf.prototype.ve=function(){};Qf.prototype.Cj=function(a){return a.i(this)};function Sf(a,b,c){var d=Yd(+a,-90,90);if(b&&E(d))throw new D(b,c,a);return d}function Tf(a,b,c){var d=+a;if(-180>d||180<d)d=Wd(d+180,360)-180;if(b&&E(d))throw new D(b,c,a);return d}function Uf(a,b,c){var d;if(a!==B&&E(d=+a)&&b)throw new D(b,c,a);return d}function Vf(a,b){return 0!==(0>a^0>b)&&180<Ad(b-a)}t("H.geo.isDBC",Vf);function Wf(){uc(this,Wf)}t("H.geo.AbstractGeometry",Wf);Wf.prototype.getBoundingBox=Wf.prototype.F;Wf.prototype.equals=Wf.prototype.na;Wf.prototype.qb="";Wf.prototype.Mb="";Wf.prototype.toString=function(){return this.Sc([this.qb.toUpperCase()," "]).join("")};Wf.prototype.toString=Wf.prototype.toString;Wf.prototype.Rc=function(){return{type:this.Mb,coordinates:this.gd()}};Wf.prototype.toGeoJSON=Wf.prototype.Rc;Wf.prototype.W=function(){return{type:this.qb,coordinates:this.wc(),boundingBox:this.F().W()}};
Wf.prototype.forWorkerMessage=Wf.prototype.W;function Xf(a,b,c){this.lat=Sf(a,Xf,0);this.lng=Tf(b,Xf,1);c!==B&&(this.alt=Uf(c,Xf,2))}u(Xf,Wf);t("H.geo.Point",Xf);Xf.prototype.na=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};Xf.prototype.equals=Xf.prototype.na;Xf.prototype.Ya=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Rd;var c=a.lat*Rd;a=1.274200158E7*Gd(vd(1,Cd(Dd(Fd((b-c)/2),2)+Hd(b)*Hd(c)*Dd(Fd((this.lng*Rd-a.lng*Rd)/2),2))))}return a};
Xf.prototype.distance=Xf.prototype.Ya;
Xf.prototype.Dg=function(a,b,c){if(c){if(b/=6371000.79){a*=Rd;var d=Rd*this.lat;var e=Fd(d);var f=Fd(b);var g=Hd(b);var h=Rd*this.lng;var k=Hd(d);d=Gd(k*Hd(a)*f+e*g);a=Kd(Fd(a)*k*f,g-e*Fd(d));a=(h+a+Md)%(2*Md)-Md;k=a*Sd}return b?new Xf(d*Sd,(k+540)%360-180):this}a=(a%360+360)%360;if(0===(a+90)%180)return d=this.lng+b/(6371000.79*Pd*Hd(this.lat*Rd))*(270===a?-360:360),new Xf(this.lat,(d+540)%360-180);if(b/=6371000.79){a*=Rd;h=this.lat*Rd;e=this.lng*Rd;f=h+b*Hd(a);g=f-h;d=Bd(Id(f/2+Od)/Id(h/2+Od));
d=E(g/d)?Hd(h):g/d;var l=b*Fd(a)/d;Ad(f)>Nd&&(f=0<f?Md-f:-(Md+f))}return b?new Xf(f*Sd,((e+l+Qd+(Ad(h+g)>Nd?Md:0))%Pd-Md)*Sd):this};Xf.prototype.walk=Xf.prototype.Dg;Xf.prototype.F=function(){return new K(this.lat,this.lng,this.lat,this.lng)};Xf.prototype.getBoundingBox=Xf.prototype.F;function Yf(a,b,c){var d=Da(a)&&!(E(a.lat=Sf(a.lat))||E(a.lng=Tf(a.lng))||a.alt!==B&&E(a.alt=Uf(a.alt)));if(!d&&b)throw new D(b,c,a);return d}Xf.validate=Yf;
function Zf(a){if(!a)throw new D(Zf,0,a);return new Xf(a.lat,a.lng,a.alt)}Xf.fromIPoint=Zf;n=Xf.prototype;n.qb="Point";n.Sc=function(a){a.push("(",this.lng," ",this.lat,")");return a};n.Mb="Point";n.gd=function(){return[this.lng,this.lat,this.alt||0]};n.wc=function(){return[this.lat,this.lng,this.alt||0]};function K(a,b,c,d){$f(this,Sf(a,K,0),Tf(b,K,1),Sf(c,K,2),Tf(d,K,3))}u(K,Wf);t("H.geo.Rect",K);K.prototype.qb="Polygon";K.prototype.Sc=function(a){var b=this.ka,c=this.ca,d=this.ma,e=this.ga;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};K.prototype.na=function(a){return this===a||!!a&&this.ka===a.ka&&this.ca===a.ca&&this.ma===a.ma&&this.ga===a.ga};K.prototype.equals=K.prototype.na;K.prototype.clone=function(){return new K(this.ka,this.ca,this.ma,this.ga)};
K.prototype.clone=K.prototype.clone;function $f(a,b,c,d,e){a.ca=c;a.ga=e;b<d&&(c=b,b=d,d=c);a.ka=b;a.ma=d;a.c=a.a=a.b=null;return a}K.prototype.Rb=function(){this.c||(this.c=new Xf(this.ka,this.ca));return this.c};K.prototype.getTopLeft=K.prototype.Rb;K.prototype.Ob=function(){this.a||(this.a=new Xf(this.ma,this.ga));return this.a};K.prototype.getBottomRight=K.prototype.Ob;K.prototype.on=function(){return this.ka};K.prototype.getTop=K.prototype.on;K.prototype.hm=function(){return this.ma};
K.prototype.getBottom=K.prototype.hm;K.prototype.Km=function(){return this.ca};K.prototype.getLeft=K.prototype.Km;K.prototype.fn=function(){return this.ga};K.prototype.getRight=K.prototype.fn;K.prototype.lb=function(){this.b||(this.b=new Xf(this.ma+(this.ka-this.ma)/2,ag(this.ca,this.Eb())));return this.b};K.prototype.getCenter=K.prototype.lb;K.prototype.Eb=function(){return bg(this.ca,this.ga)};K.prototype.getWidth=K.prototype.Eb;K.prototype.Sd=function(){return this.ka-this.ma};
K.prototype.getHeight=K.prototype.Sd;K.prototype.Fb=function(){return this.ca>this.ga};K.prototype.isCDB=K.prototype.Fb;K.prototype.ag=function(){return!this.Eb()&&!this.Sd()};K.prototype.isEmpty=K.prototype.ag;K.prototype.F=function(){return new K(this.ka,this.ca,this.ma,this.ga)};K.prototype.getBoundingBox=K.prototype.F;
K.prototype.Gf=function(a,b,c){var d=this.lb();c||(a=Sf(a,this.Gf,0),b=Tf(b,this.Gf,1));b=this.cd(a,b,c);a=b.lb();return a.lat===d.lat&&a.lng===d.lng&&this.Sd()===b.Sd()&&this.Eb()===b.Eb()};K.prototype.containsLatLng=K.prototype.Gf;K.prototype.Kd=function(a,b){b||Yf(a,this.Kd,0);return this.Gf(a.lat,a.lng,b)};K.prototype.containsPoint=K.prototype.Kd;
K.prototype.Xg=function(a,b){var c=this.lb();if(!b&&!C(a,K))throw new D(this.Xg,0,a);b=this.mc(a,b);a=b.lb();return a.lat===c.lat&&a.lng===c.lng&&this.Sd()===b.Sd()&&this.Eb()===b.Eb()};K.prototype.containsRect=K.prototype.Xg;K.prototype.cd=function(a,b,c,d){if(!c){if(E(a=Sf(a)))throw new D(this.cd,0,a);if(E(b=Tf(b)))throw new D(this.cd,1,b);}return cg(this.ka,this.ca,this.ma,this.ga,a,b,a,b,d)};K.prototype.mergeLatLng=K.prototype.cd;
K.prototype.uk=function(a,b,c){b||Yf(a,this.uk,0);return this.cd(a.lat,a.lng,b,c)};K.prototype.mergePoint=K.prototype.uk;K.prototype.mc=function(a,b,c){if(!b&&!C(a,K))throw new D(this.mc,0,a);return cg(this.ka,this.ca,this.ma,this.ga,a.ka,a.ca,a.ma,a.ga,c)};K.prototype.mergeRect=K.prototype.mc;K.prototype.Hc=function(a,b,c,d,e,f){e||(a=Sf(a,this.Hc,0),b=Tf(b,this.Hc,1),c=Sf(c,this.Hc,2),d=Tf(d,this.Hc,3));return cg(this.ka,this.ca,this.ma,this.ga,a,b,c,d,f)};K.prototype.mergeTopLeftBottomRight=K.prototype.Hc;
K.prototype.sd=function(a,b){var c=this.ca<=this.ga,d=a.ca<=a.ga,e=this.ca<a.ga,f=a.ca<this.ga;if(!b&&!C(a,K))throw new D(this.sd,0,a);return this.ma<=a.ka&&a.ma<=this.ka&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};K.prototype.intersects=K.prototype.sd;function bg(a,b){a=b-a;return a+(0>a?360:0)}function ag(a,b){a+=b/2;return a-(180<a?360:0)}
function cg(a,b,c,d,e,f,g,h,k){c=vd(c,g);a=wd(a,e);e=bg(b,d);var l=ag(b,e);g=bg(f,h);var m=ag(f,g)-l;m+=0>m-1E-6?360:0;if(180>m-1E-6){l=b;var q=h}else m=360-m,l=f,q=d;m=m+e/2+g/2;360<=m+5E-7?(l=-180,q=180):m-5E-7<e?(l=b,q=d):m-5E-7<g&&(l=f,q=h);return k?$f(k,a,l,c,q):new K(a,l,c,q)}K.merge=cg;function dg(a,b,c){c||(Yf(a,dg,0),Yf(b,dg,1));return new K(a.lat,a.lng,b.lat,b.lng)}K.fromPoints=dg;
function eg(a,b){var c=1,d=a.length,e=null;if(!Ba(a))throw new D(eg,0,a);if(0<d){var f=a[0];for(e=dg(f,f,b);c<d;c++)f=a[c],e.cd(f.lat,f.lng,b,e)}return e}K.coverPoints=eg;function fg(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new D(fg,0,a);if(0<d)for(e=new K(a[0],a[1],a[0],a[1]);c<d;c+=3)e.cd(a[c],a[c+1],b,e);return e}K.coverLatLngAlts=fg;
function gg(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new D(gg,0,a);if(0<d)for(e=new K(a[0].ka,a[0].ca,a[0].ma,a[0].ga);c<d;c++)e.mc(a[c],b,e);return e}K.coverRects=gg;
K.prototype.Qk=function(a,b){var c=this.ca,d=this.ka,e=this.ga,f=this.ma,g=this.lb().lng;Yf(a,this.Qk,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?$f(b,d,a,f,e):new K(d,a,f,e)};K.prototype.resizeToCenter=K.prototype.Qk;K.prototype.Mb="Polygon";
K.prototype.gd=function(){return[[this.ca,this.ka,0],[this.ga,this.ka,0],[this.ga,this.ma,0],[this.ca,this.ma,0],[this.ca,this.ka,0]]};K.prototype.W=function(){return this.wc()};K.prototype.wc=function(){return[this.ka,this.ca,this.ma,this.ga]};function hg(a,b,c,d,e,f){uc(this,hg);this.c=a||10;this.b=this.a=null;this.f=d||0;this.g=e||0;this.i=b||1;this.j=c||1;this.o=!!f;this.flush()}function ig(a){var b=a.b;if(a.o&&!b){var c=a.head;if(c.entries||c[0]||c[1]||c[2]||c[3])b=[c],b=jg([b,b,b,b],[c[6],c[7],c[4],c[5]]),a.b=b}return b}
function jg(a,b){var c,d,e,f,g=0;for(c=3;0<=c;c--){var h=c+4;var k=0<c%3;var l=[];var m=b[c];var q=a[c];for(d=q.length;d--;){var p=q[d];if(e=p.entries)for(f=e.length;f--;){var r=e[f].od(c);if(k?r>m:r<m)m=r}for(f=4;f--;)(e=p[f])&&(k?e[h]>m:e[h]<m)&&l.push(e)}g+=l.length;b[c]=m;a[c]=l}g&&(b=jg(a,b));return b}function kg(a,b,c){var d,e;if(a.o&&(d=a.b))for(e=3;0<=e;e--){var f=b.od(e);if(e%3?f>=d[e]:f<=d[e])if(c)d[e]=f;else{a.b=null;break}}}
hg.prototype.remove=function(a){var b,c,d,e=!1;a&&(b=a.node)&&b.b===this&&(c=b.entries)&&0<=(d=c.indexOf(a))&&(c.splice(d,1),this.m(b),kg(this,a,!1),e=!0);return e};hg.prototype.flush=function(){var a=new lg(null,NaN,this.f-this.i,this.g-this.j,this.f+this.i,this.g+this.j);a.b=this;this.head=this.a=a;this.b=null};function mg(a,b){var c=a.head,d;if(b){var e=b;if(e!==c)for(c=e;e=e.parent;)if(e.entries||1<e.a)c=e}else for(;!c.entries&&2>(d=c.a);)if(d)c=e;else break;a.head=c}
hg.prototype.$a=function(a,b,c,d,e,f){var g=[],h=this.head,k=this.a;a<=h[5]&&b<=h[6]&&(e?c>=h[7]:c>h[7])&&(f?d>=h[4]:d>h[4])&&ng(this,h,g,a,b,c,d,f||d>=k[6],e||c>=k[5]);return g};
function ng(a,b,c,d,e,f,g,h,k){var l=b.entries,m=b[7],q=b[4],p=b[5],r=b[6],v=b[8],w=b[9],z;if(l){var J=l.length;if(e>q||d>m||g<r||f<p)for(;J--;){m=l[J];q=m.od(3);p=m.od(0);r=m.od(1);var G=m.od(2);G>=e&&r>=d&&(p<g||h&&p==g)&&(q<f||k&&q==f)&&c.push(m)}else for(;J--;)c.push(l[J])}if(f>v||k&&f==v)e<w&&(z=b[1])&&ng(a,z,c,d,e,f,g,h,k),(g>w||h&&g==w)&&(z=b[3])&&ng(a,z,c,d,e,f,g,h,k);d<v&&(e<w&&(z=b[0])&&ng(a,z,c,d,e,f,g,h,k),(g>w||h&&g==w)&&(z=b[2])&&ng(a,z,c,d,e,f,g,h,k))}hg.prototype.Tc=ba(1);var og=0;
function lg(a,b,c,d,e,f){this.c=b;a&&(this.parent=a,this.b=a.b,b&1?(c=a[8],e=a[5]):(c=a[7],e=a[8]),b&2?(d=a[9],f=a[6]):(d=a[4],f=a[9]));this[7]=c;this[5]=e;this[8]=(c+e)/2;this[4]=d;this[6]=f;this[9]=(d+f)/2}lg.prototype.a=0;function pg(a,b){return a[b]||(++a.a,a[b]=new lg(a,b))}lg.prototype.removeChild=function(a){var b=a.c;this[b]===a&&(delete this[b],delete a.parent,--this.a)};lg.prototype.Tc=ba(0);function qg(a,b){(a.entries||(a.entries=[])).push(b);b.node=a}
function rg(a,b,c,d,e){var f=a[5],g=a[6];return a[7]<=b&&a[4]<=c&&(f>d||f===d&&f===a.b.a[5])&&(g>e||g===e&&g===a.b.a[6])};function sg(a,b,c,d,e,f){sg.l.constructor.apply(this,arguments)}u(sg,hg);sg.prototype.m=function(a){for(var b,c,d=this.head;a;){if(!(b=a.entries)||!b.length)if(b&&delete a.entries,!a.a&&(c=a.parent)){c.removeChild(a);d===a&&(d=c);a=c;continue}a=y}this.head!==d&&(this.head=d,mg(this))};function tg(a,b,c,d,e){if(rg(a.a,b,c,d,e))return ug(a,a.a,b,c,d,e,a.c);throw Error("Coordinates out of bounds");}sg.prototype.Ec=function(a,b){return tg(this,a,b,a,b)};
function ug(a,b,c,d,e,f,g){var h=b[8],k=b[9],l,m;g&&(e<h||(l=c>=h))&&(f<k||(m=d>=k))?c=ug(a,pg(b,l|m<<1),c,d,e,f,g-1):(qg(b,c=new vg(c,d,e,f)),kg(a,c,!0),mg(a,b));return c}function vg(a,b,c,d){this.id=og++;this[0]=b;this[1]=c;this[2]=d;this[3]=a}vg.prototype.od=function(a){return this[a]};function wg(a){this.f=new sg(+a||10,180,90,0,0,!0);this.c=[];this.g=!1;this.a=this.b=this.R=null}t("H.geo.QuadTree",wg);n=wg.prototype;n.Rh=0;n.$c=function(){return this.Rh};n.Fb=function(){return this.g};
n.F=function(){var a,b;if(!this.R){var c=[];!this.b&&(a=ig(this.f))&&(this.b=new K(-a[0],a[3],-a[2],a[1]));(b=this.b)&&c.push(b);var d,e,f;if(!this.a&&(f=(e=this.c).length)){a=90;var g=360;var h=-90;for(d=0;f--;){var k=e[f];a=vd(a,k[0]);g=vd(g,k[3]);h=wd(h,k[2]);d=wd(d,k[1])}this.a=new K(-a,g,-h,d-360)}(b=this.a)&&c.push(b);if(b=c[0])c[1]&&(b=b.mc(c[1],!0)),this.R=b}return this.R};
function xg(a,b,c,d,e,f){f?(f=new vg(e,-b,c+360,-d),a.c.push(f),a.g=!0,a.a&&a.a.Hc(b,c,d,e,!0,a.a)):(f=tg(a.f,c,-b,e,-d),a.b&&a.b.Hc(b,c,d,e,!0,a.b));++a.Rh;a.R=null;return f}n.Ec=function(a){var b=a.lng;a=a.lat;return xg(this,a,b,a,b,!1)};n.Yj=function(a){var b=a.Rb(),c=a.Ob();return(a=a.Fb())?xg(this,b.lat,c.lng,c.lat,b.lng,a):xg(this,b.lat,b.lng,c.lat,c.lng,a)};wg.prototype.insertBoundingBox=wg.prototype.Yj;
wg.prototype.remove=function(a){var b;if(a.node){var c=this.f.remove(a);this.b=null}else if(a=(b=this.c).indexOf(a),c=0<=a)b.splice(a,1),this.g=0<b.length,this.a=null;c&&(--this.Rh,this.R=null);return c};wg.prototype.remove=wg.prototype.remove;function yg(a,b,c,d,e,f,g){a=a.c;var h=a.length,k=[],l;if(h){var m=c+360;for(l=e+360;h--;){var q=a[h];zg(q,b,c,d,e,f,g)?k.push(q):zg(q,b,m,d,l,f,g)&&k.push(q)}}return k}
function zg(a,b,c,d,e,f,g){var h=a[3],k=a[0],l=a[1];a=a[2];return(f?k<=d:k<d)&&(g?h<=e:h<e)&&a>=b&&l>=c}function Ag(a,b){var c,d,e;if(c=b.length){var f=a.length;for(d={};f--;)d[a[f].id]=1;for(;c--;)(e=b[c]).id in d||a.push(e)}}wg.prototype.$f=function(a,b,c){var d=this.f,e=a.Rb(),f=a.Ob(),g=-e.lat;e=e.lng;var h=-f.lat;f=f.lng;!b&&g===h||!c&&e===f?a=[]:a.Fb()?(a=d.$a(-180,g,f,h,c,b),Ag(a,d.$a(e,g,180,h,!1,b)),Ag(a,yg(this,g,f,h,e+360,b,c))):(a=d.$a(e,g,f,h,c,b),Ag(a,yg(this,g,e,h,f,b,c)));return a};
wg.prototype.intersectBoundingBox=wg.prototype.$f;function Bg(a){return x.H.gl.flexpolyline.encode(a)}t("H.util.flexiblePolyline.encode",Bg);function Cg(a){return x.H.gl.flexpolyline.decode(a)}t("H.util.flexiblePolyline.decode",Cg);function L(a){L.l.constructor.call(this);a&&Dg(a,L,0);this.X=a||[];this.a=Eg(this,0,this.X.length)}u(L,Wf);t("H.geo.LineString",L);function Eg(a,b,c){a=a.X;var d=0;b=wd(b,0);c=vd(c,a.length);c-=2;for(b+=1;b<c;)d+=Vf(a[b],a[b+=3]);return d}L.prototype.ui=function(a,b,c){Fg(this,a,b,c,this.ui)};L.prototype.pushLatLngAlt=L.prototype.ui;function Fg(a,b,c,d,e){var f=a.X.length;b=Sf(b,e);c=Tf(c,e);a.X.push(Sf(b,e),Tf(c,e),d===B?0:Uf(d,e));f&&(a.a+=Vf(a.X[f-2],c));delete a.R;delete a.b}
L.prototype.tf=function(a,b,c){c&&Dg(c,this.tf,2);void 0===b&&(b=this.X.length);b&&(this.a-=Eg(this,a-3,a+b+3));var d=c?this.X.splice.apply(this.X,[a,b].concat(c)):this.X.splice(a,b);c&&(this.a+=Eg(this,a-3,a+c.length+3));b&&!c&&(this.a+=Eg(this,a-3,a-3));delete this.R;delete this.b;return d};L.prototype.spliceLatLngAlts=L.prototype.tf;L.prototype.Zj=function(a,b,c,d){this.tf(a,0,[b,c,d])};L.prototype.insertLatLngAlt=L.prototype.Zj;L.prototype.Mk=function(a){this.tf(a,3)};
L.prototype.removeLatLngAlt=L.prototype.Mk;L.prototype.wd=function(a){Fg(this,a.lat,a.lng,a.alt,this.wd)};L.prototype.pushPoint=L.prototype.wd;L.prototype.Ec=function(a,b){this.Zj(3*a,b.lat,b.lng,b.alt)};L.prototype.insertPoint=L.prototype.Ec;L.prototype.ef=function(a){this.Mk(3*a)};L.prototype.removePoint=L.prototype.ef;L.prototype.De=function(a,b){var c=this.X,d=3*a;a=c[d];var e=c[d+1];c=c[d+2];b&&(b.lat=a,b.lng=e,b.alt=c);return b||new Xf(a,e,c)};L.prototype.extractPoint=L.prototype.De;
L.prototype.Wl=function(a,b,c){var d=this.X;b=b||0;c=Ze(c,d.length/3);for(var e=3*b;b<c;)a(d[e++],d[e++],d[e++],b++)};L.prototype.eachLatLngAlt=L.prototype.Wl;L.isDBC=Vf;L.prototype.ph=function(a){var b=this.a;a&&(a=this.X,b+=Vf(a[a.length-2],a[1]));return b};L.prototype.getDBCs=L.prototype.ph;L.prototype.Ne=function(){return this.X.length/3};L.prototype.getPointCount=L.prototype.Ne;L.prototype.Im=function(){return this.X};L.prototype.getLatLngAltArray=L.prototype.Im;L.prototype.R=y;
L.prototype.F=function(){var a;if(!(a=this.R)){a=this.X;var b=a.length,c=3,d,e,f=y;if(3<=b){var g=d=a[0];var h=e=a[1];for(f=new K(g,h,d,e);c<b;c+=3){g=a[c-3];h=a[c-2];d=a[c];e=a[c+1];if(h>e&&180<e-h||h<e&&-180>h-e||e<h&&180>Ad(e-h)){var k=h;h=e;e=k}g<d&&(k=g,g=d,d=k);cg(f.ka,f.ca,f.ma,f.ga,g,h,d,e,f)}}a=this.R=f}return a};L.prototype.getBoundingBox=L.prototype.F;L.prototype.zn=function(){return this.R!==y};L.prototype.hasBoundingBox=L.prototype.zn;
function Dg(a,b,c){for(var d=a.length,e=!(d%3),f;e&&d;)e=!(E(a[--d]=Uf((f=a[d])===B?0:f))||E(a[--d]=Tf(a[d]))||E(a[--d]=Sf(a[d])));if(!e&&b)throw new D(b,c,a);}function Gg(a){var b=new L,c=0,d=a.length;if(d%2)throw new D(Gg,0,a);for(;c<d;)Fg(b,a[c++],a[c++],0,Gg);return b}L.fromLatLngArray=Gg;L.prototype.na=function(a){var b=this===a,c;if(!b&&(b=C(a,L))){var d=this.X;a=a.X;for(b=(c=d.length)===a.length;b&&c--;)b=d[c]==a[c]}return b};L.prototype.equals=L.prototype.na;
function Hg(a,b){return a.a-b.a}
function Ig(a,b){var c=a.X,d=-2,e=[],f;var g=a.b;if(!g){g=a.b=new wg;var h=0;var k=a.X;var l=k.length;for(f=0;f<l;f+=3){var m=k[f];var q=k[f+1];if(f){if(r<q){var p=r;var r=q}else p=q;if(w<m)var v=m;else{v=w;var w=m}p=xg(g,v,p,w,r,180<r-p);p.a=h++}w=m;r=q}}g=g.$f(b).sort(Hg);k=g.length;for(b=0;b<k;b++){h=g[b];h=h.a;l=3*h;if(h>d+1){var z=[c[l],c[l+1]];e.push(z)}d=h;z.push(c[l+3],c[l+4])}if(a.a){c=[];d=e.length;for(b=0;b<d;b++)if(z=e[b],g=z.length){k=[];for(a=0;a<g;a+=2)h=z[a],l=z[a+1],k.push(h,l),f=
z[a-1],a&&Vf(l,f)&&(c.push(k),k=[],f+=0>f?360:-360,k.push(z[a-2],f,h,l));c.push(k)}e=c}return e}n=L.prototype;n.qb="LineString";n.Sc=function(a,b){var c=this.X,d=c.length,e;if(d){a.push("(");for(e=0;e<d;e+=3)e&&a.push(","),a.push(c[e+1]," ",c[e]);b&&(c[0]!==c[d-3]||c[1]!==c[d-2])&&a.push(",",c[1]," ",c[0]);a.push(")")}else a.push("EMPTY");return a};n.Mb="LineString";n.gd=function(){var a=[],b=this.X,c=b.length,d;for(d=0;d<c;d+=3)a.push([b[d+1],b[d],b[d+2]]);return a};
n.wc=function(){var a=this.X,b;if(this.F().Fb()){a=a.slice();var c=1;for(b=a.length;c<b;c+=3)0>a[c]&&(a[c]+=360)}return a};n.Mo=function(a){a=void 0===a?5:a;for(var b=this.X,c=b.length,d=[],e=0;e<c;e+=3)d.push([b[e],b[e+1],b[e+2]]);return Bg({polyline:d,precision:a,thirdDim:2,thirdDimPrecision:a})};L.prototype.toFlexiblePolyline=L.prototype.Mo;
function Jg(a){var b=Cg(a);a=b.polyline;var c=b.thirdDim;b=2===c||3===c;c=0===c;if(!a)throw new D(Jg,0,"data");if(b||c){c=a.length;var d=Array(3*c);for(var e=0,f=0;e<c;e++){var g=a[e];d[f++]=g[0];d[f++]=g[1];d[f++]=b?g[2]:0}}if(!d)throw new D(Jg,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new L(d)}L.fromFlexiblePolyline=Jg;function Kg(a){Kg.l.constructor.call(this);void 0!==a&&(this.data=a)}u(Kg,F);t("H.map.Feature",Kg);Kg.prototype.getData=function(){return this.data};Kg.prototype.getData=Kg.prototype.getData;Kg.prototype.u=function(){Kg.l.u.call(this);delete this.data};function Lg(){}t("H.map.provider.Invalidations",Lg);Lg.MARK_INITIAL=Ud;Lg.prototype.update=function(a,b){b!==Mg.NONE&&(this.a=a,b&Mg.SPATIAL&&(this.f=a),b&Mg.VISUAL&&(this.g=a),b&Mg.ADD&&(this.b=a),b&Mg.REMOVE&&(this.c=a),b&Mg.Z_ORDER&&(this.j=a),b&Mg.VOLATILITY&&(this.i=a))};Lg.prototype.update=Lg.prototype.update;Lg.prototype.Om=function(){return this.a};Lg.prototype.getMark=Lg.prototype.Om;Lg.prototype.a=Ud;Lg.prototype.En=function(a){return this.a>a};Lg.prototype.isAny=Lg.prototype.En;
Lg.prototype.g=Ud;Lg.prototype.be=function(a){return this.g>a};Lg.prototype.isVisual=Lg.prototype.be;Lg.prototype.f=Ud;Lg.prototype.Kh=function(a){return this.f>a};Lg.prototype.isSpatial=Lg.prototype.Kh;Lg.prototype.b=Ud;Lg.prototype.$j=function(a){return this.b>a};Lg.prototype.isAdd=Lg.prototype.$j;Lg.prototype.c=Ud;Lg.prototype.bg=function(a){return this.c>a};Lg.prototype.isRemove=Lg.prototype.bg;Lg.prototype.j=Ud;Lg.prototype.Lh=function(a){return this.j>a};Lg.prototype.isZOrder=Lg.prototype.Lh;
Lg.prototype.i=Ud;Lg.prototype.Jn=function(a){return this.i>a};Lg.prototype.isVolatility=Lg.prototype.Jn;var Mg={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};Lg.Flag=Mg;function Ng(a,b,c){Ng.l.constructor.call(this,a);this.oldValue=c;this.newValue=b}u(Ng,rd);t("H.util.ChangeEvent",Ng);function M(a){uc(this,M);M.l.constructor.call(this,a?a.data:B);this.K=Og.next();if(a){var b="min";Cc(a[b])&&(this.v=a[b]);b="max";Cc(a[b])&&(this.s=a[b]);b="visibility";b in a&&(this.c=!!a[b]);b="volatility";b in a&&(this.B=!!a[b]);b="zIndex";b in a&&(this.o=+a[b]||0);b="provider";b in a&&!C(a[b],N)&&(this.a=a[b],this.ua(Mg.ADD))}}u(M,Kg);t("H.map.Object",M);var Og=new af(1),Pg={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};M.Type=Pg;M.prototype.fb=function(){return this.K};
M.prototype.getId=M.prototype.fb;M.prototype.Ji=function(a){if(!Cc(a)&&!zc(a))throw new D(this.Ji,0,"id must be a number or a string");this.m=a;return this};M.prototype.setRemoteId=M.prototype.Ji;M.prototype.en=function(){return this.m};M.prototype.getRemoteId=M.prototype.en;M.prototype.v=-1/0;M.prototype.s=1/0;M.prototype.Pm=function(){return this.s};M.prototype.getMax=M.prototype.Pm;M.prototype.Rm=function(){return this.v};M.prototype.getMin=M.prototype.Rm;M.prototype.c=!0;
M.prototype.ub=function(a){var b=this.c;(a=!!a)^b&&(this.c=a,this.invalidate(Mg.VISUAL));return this};M.prototype.setVisibility=M.prototype.ub;M.prototype.Cc=function(a){for(var b=this,c;(c=b.c)&&a&&(b=b.Va););return c};M.prototype.getVisibility=M.prototype.Cc;M.prototype.B=!1;M.prototype.Xf=function(a){for(var b=this,c;!(c=b.B)&&a&&(b=b.Va););return c};M.prototype.getVolatility=M.prototype.Xf;M.prototype.hl=function(a){var b=this.B;b^a&&(this.B=!b,this.invalidate(Mg.VOLATILITY));return this};
M.prototype.setVolatility=M.prototype.hl;M.prototype.o=B;M.prototype.Rj=function(){return this.o};M.prototype.getZIndex=M.prototype.Rj;M.prototype.qf=function(a){a!==this.o&&(this.hf(),this.o=a,this.invalidate(Mg.Z_ORDER));return this};M.prototype.setZIndex=M.prototype.qf;M.prototype.D=B;function Qg(a){var b=a.D,c,d;if(!b){var e=(c=a.o)!==B;(b=a.Va)?(b=Qg(b).slice(),b[0]|=e):b=[e|0];b.push(c||0,0>(d=a.Mi)?a.K:d);a.D=b}return b}M.prototype.hf=function(){this.D=B};
function Rg(a,b,c){var d,e;if(!c||a[0]|b[0]){var f=a.length;var g=b.length;var h=vd(f,g);var k=1;for(e=1+c;k<h;k+=e)if(d=a[k]-b[k])return d}return c?0:f-g}function Sg(a,b){return a.oj(b)}M.compareZOrder=Sg;M.prototype.oj=function(a){return this.Eg-a.Eg||Rg(Qg(this),Qg(a),!1)};M.prototype.compareZOrder=M.prototype.oj;n=M.prototype;n.previousSibling=y;n.nextSibling=y;n.Mi=-1;n.Va=y;n.Um=function(){return this.Va};M.prototype.getParentGroup=M.prototype.Um;
M.prototype.jc=function(){for(var a=this,b;b=a.Va;)a=b;return a};M.prototype.getRootGroup=M.prototype.jc;M.prototype.contains=function(a){return this===a};M.prototype.contains=M.prototype.contains;M.prototype.ja=function(a){if(this.Va)throw new Yc(this.ja,"Not allowed for a child of a group");M.l.ja.call(this,a)};M.prototype.setParentEventTarget=M.prototype.ja;M.prototype.a=y;M.prototype.pa=function(){return this.a};M.prototype.getProvider=M.prototype.pa;
M.prototype.le=function(a,b){var c=this.a,d;if(d=c!==a){if(b&&(c&&!C(c,N)||a&&!C(a,N)))throw new Yc(b,"Only LocalObjectProvider allows an object transfers");b=this.type!==Pg.GROUP;c&&(this.invalidate(Mg.REMOVE),b&&c.Ha(this));if(this.a=a)b&&a.ea(this),this.za=y,this.invalidate(Mg.ADD)}return d};M.prototype.Qb=function(){return this.za||(this.za=new Lg)};M.prototype.getInvalidations=M.prototype.Qb;M.prototype.ua=function(a){var b=this.pa(),c;(c=!!b)&&b.invalidateObject(this,a);return c};
M.prototype.invalidate=M.prototype.ua;M.prototype.u=function(){this.Va&&this.Va.Ha(this);M.l.u.call(this)};M.prototype.setData=function(a){this.data=a;return this};M.prototype.setData=M.prototype.setData;M.prototype.Rc=function(a){if(a&&!Ca(a))throw new D(M.prototype.Rc,0,"opt_callback must be a function");a={type:"Feature",properties:Tg(this,a?a(this.data):this.data,!!a),geometry:this.ba().Rc()};this.m&&(a.id=this.m);return a};M.prototype.toGeoJSON=M.prototype.Rc;
function Tg(a,b,c){if(null===b||b===B)return null;if(0<=Object.keys(b).length&&"[object Object]"!==Object.prototype.toString.call(b))throw Error(Ug(a,c));try{return JSON.stringify(b),b}catch(d){throw Error(Ug(a,c));}}function Ug(a,b){return"Object Remote-Id: "+a.m+" - "+(b?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}
M.prototype.W=function(){return{id:this.K,properties:{min:this.v,max:this.s,zIdx:this.o,sIdx:this.Mi,parent:this.Va?this.Va.fb():0,visible:this.Cc(),"volatile":this.Xf()},type:"Feature"}};M.prototype.forWorkerMessage=M.prototype.W;function O(a){var b;if(a){var c=Vg;for(b=C(a,O);c--;){var d=Wg[c];if(a.hasOwnProperty(d)){var e=a[d];if(b)this[d]=e;else{if((e=Xg[c](e))===Yg)throw new D(O,0,d+": "+a[d]);e!==this[d]&&e!==B&&(this[d]=e)}}}c=b?a.Re:this.lineWidth&&Xe(this.strokeColor);c||(this.Re=c);c=b?a.Sb:Xe(this.fillColor);c||(this.Sb=c);c=b?a.Qe:"none"!==this.strokeColor&&this.lineWidth;c||(this.Qe=c)}oc(this)}t("H.map.SpatialStyle",O);O.prototype.Sb=!0;O.prototype.Re=!0;O.prototype.Qe=!0;var Wg="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineHeadCap lineTailCap".split(" ");
O.prototype.strokeColor="rgba(0,85,170,.6)";O.prototype.strokeColor=O.prototype.strokeColor;O.prototype.fillColor="rgba(0,85,170,.4)";O.prototype.fillColor=O.prototype.fillColor;O.prototype.lineWidth=2;O.prototype.lineWidth=O.prototype.lineWidth;O.prototype.lineCap="round";O.prototype.lineCap=O.prototype.lineCap;O.prototype.lineJoin="miter";O.prototype.lineJoin=O.prototype.lineJoin;O.prototype.miterLimit=1;O.prototype.miterLimit=O.prototype.miterLimit;O.prototype.On=ff;O.prototype.lineDash=O.prototype.On;
O.prototype.lineDashOffset=0;O.prototype.lineDashOffset=O.prototype.lineDashOffset;O.prototype.Pn=B;O.prototype.lineHeadCap=O.prototype.Pn;O.prototype.Qn=B;O.prototype.lineTailCap=O.prototype.Qn;var Vg=Wg.length;O.prototype.na=function(a){var b=this===a;if(!b&&a){for(b=0;b<Vg;b++){var c=Wg[b];if(this[c]!==a[c])break}b=b===Vg}return b};O.prototype.equals=O.prototype.na;O.prototype.Ij=function(a){if(a){var b={};Wa(b,this,a)}else b=this;return new O(b)};O.prototype.getCopy=O.prototype.Ij;
var Yg=oc({}),Xg=[function(a){return a?nc(a):Yg},function(a){return a?nc(a):Yg},function(a){return 0<=a&&100>=a?+a:Yg},function(a){a=nc(a);return"butt"===a||"square"===a||"round"===a||"arrow-head"===a||"arrow-tail"===a?a:Yg},function(a){return"round"===a||"bevel"===a||"miter"===a?a:Yg},function(a){return 0<a&&100>=a?+a:Yg},function(a){return a&&a.every&&a.every(Dc)?a:Yg},function(a){return E(+a)?Yg:+a},function(a){return tc(a)?Xg[3](a):B},function(a){return tc(a)?Xg[3](a):B}];O.MAX_LINE_WIDTH=100;
var Zg=new O;O.DEFAULT_STYLE=Zg;var $g="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");O.prototype.W=function(){for(var a={},b=$g.length,c;b--;)c=$g[b],a[c]=this[c];return a};O.prototype.forWorkerMessage=O.prototype.W;function ah(a){var b;if(a){var c=C(a,ah);for(b in a)if(b in this){var d=a[b];d!==this[b]&&("fillColor"===b||0<(d=+d))&&(this[b]=d)}a=c?a.Sb:!!(Xe(this.fillColor)&&this.width&&this.width);a||(this.Sb=a)}oc(this)}t("H.map.ArrowStyle",ah);ah.prototype.Sb=!0;ah.prototype.fillColor="rgba(255,255,255,.75)";ah.prototype.width=1.2;ah.prototype.length=1.6;ah.prototype.frequency=5;ah.prototype.Hj=function(){return new ah(this)};
ah.prototype.na=function(a){var b=this===a;!b&&a&&(b=a.width===this.width&&a.fillColor===this.fillColor&&a.length===this.length&&a.frequency===this.frequency);return b};ah.prototype.equals=ah.prototype.na;function bh(a,b){var c;bh.l.constructor.call(this,b);b&&this.fd(b.style);a&&(this.j=!0);b&&(c=b.arrows)&&this.Wk(c)}u(bh,M);t("H.map.Spatial",bh);bh.prototype.type=Pg.SPATIAL;bh.prototype.Eg=0;bh.prototype.style=Zg;bh.prototype.ta=function(){return this.style};bh.prototype.getStyle=bh.prototype.ta;bh.prototype.fd=function(a){var b=!0;a?this.style=C(a,O)?a:new O(a):this.style?delete this.style:b=!1;b&&this.invalidate(Mg.VISUAL);return this};bh.prototype.setStyle=bh.prototype.fd;
bh.prototype.em=function(){return this.g};bh.prototype.getArrows=bh.prototype.em;bh.prototype.Wk=function(a){var b=this.g,c=!1;!a&&b?(delete this.g,c=!0):!a||b&&b.na(a)||(this.g=new ah(a),c=!0);c&&"none"!==this.style.strokeColor&&this.ua(1);return this};bh.prototype.setArrows=bh.prototype.Wk;function ch(a,b){var c=!1,d=!1,e;if(b.length){for(c=0;c<b.length;c++)if(b[c]!==dh){d=!0;break}b=a.style;c=d?b.Re||b.Sb&&a.j||(e=a.g||!1)&&b.Qe&&e.Sb:b.Sb}return c&&a.Cc(!0)}bh.prototype.j=!1;bh.prototype.Gn=function(){return this.j};
bh.prototype.isClosed=bh.prototype.Gn;bh.prototype.getGeometriesForTile=bh.prototype.Rd;bh.prototype.th=function(){return y};bh.prototype.getLabels=bh.prototype.th;function eh(a,b){eh.l.constructor.call(this,a,b)}u(eh,bh);t("H.map.GeoShape",eh);eh.prototype.getBoundingBox=eh.prototype.F;function fh(a,b,c,d){var e=[],f=b.length,g;for(g=0;g<f;g++){var h=b[g];h.length&&e.push(gh(a,h,c,d))}return e}function gh(a,b,c,d){var e,f=[],g=b.length,h=0;a.V=0;for(e=e||0;h<g;)f.push(hh(a,b[h++],b[h++],e,d));c&&f.push(hh(a,b[0],b[1],e,d));return f}function hh(a,b,c,d,e){var f=a.V;f&&180<Ad(f-c)&&(c+=0>f?-360:360);a.V=c;return e.Mh(b,c+d)}
function ih(a,b,c){for(var d=b,e,f=a.length+b,g,h;d--;){b=a[d];g=b.length;for(e=Array(g);g--;)h=b[g],e[g]=new I(h.x+c,h.y);a[--f]=e}}var jh=new L([0,0,0,0,0,0,0,0,0]);function kh(a){uc(this,kh);kh.l.constructor.call(this);this.oa=lh(this,a,this.constructor,0)}u(kh,Wf);t("H.geo.MultiGeometry",kh);kh.prototype.splice=function(a,b,c){a=[a];b!==B&&a.push(b);c&&(b=lh(this,c,this.splice,2),a=a.concat(b));this.R=y;return this.oa.splice.apply(this.oa,a)};kh.prototype.splice=kh.prototype.splice;kh.prototype.oc=function(a){var b=this.oa.length;if(!(0<=a&&a<b))throw new je(this.oc,a,[0,b-1]);this.R=y;return this.oa.splice(a,1)[0]};kh.prototype.removeAt=kh.prototype.oc;
kh.prototype.remove=function(a){a=this.oa.indexOf(a);if(0<=a){var b=this.oa.splice(a,1)[0];this.R=y}return b||y};kh.prototype.remove=kh.prototype.remove;kh.prototype.Bm=function(){return this.oa};kh.prototype.getGeometries=kh.prototype.Bm;kh.prototype.push=function(a){var b=lh(this,[a],this.push,0)[0];this.R&&(this.R=this.R.mc(a.F()));this.oa.push(b)};kh.prototype.push=kh.prototype.push;
kh.prototype.F=function(){var a;if(!(a=this.R)){a=y;var b,c;if(this.oa.length)for(a=this.oa[0].F(),c=1;c<this.oa.length;c++)if(b=this.oa[c].F())a=a?a.mc(b):b}return this.R=a};kh.prototype.getBoundingBox=kh.prototype.F;kh.prototype.R=y;function lh(a,b,c,d){var e,f=[];if(!yc(b))throw new D(c,d);for(e=0;e<b.length;e++)if(a.a(b[e]))f.push(a.b(b[e]));else throw new D(c,d);return f}kh.prototype.b=function(a){return a};
kh.prototype.na=function(a){var b=this===a,c;if(!b&&(b=C(a,this.constructor))){var d=this.oa;a=a.oa;for(b=(c=d.length)===a.length;b&&c--;)b=d[c].na(a[c])}return b};kh.prototype.equals=kh.prototype.na;n=kh.prototype;n.Sc=function(a){var b=this.oa,c=b.length,d,e,f=!1;if(c){a.push("(");for(d=0;d<c;d++)(e=0<d&&f)&&a.push(","),b[d].Sc(a),"EMPTY"===a[a.length-1]?a.splice(-1-e,1+e):f=!0;f?a.push(")"):a.splice(-1,1,"EMPTY")}else a.push("EMPTY");return a};
n.toString=function(){return this.Sc([this.qb.toUpperCase()," "]).join("")};n.wc=function(){for(var a=[],b=this.oa,c=b.length;c--;)a[c]=b[c].wc();return a};n.W=function(){var a=kh.l.W.call(this);a.type=this.qb;return a};n.gd=function(){for(var a=[],b=this.oa,c=b.length;c--;)a[c]=b[c].gd();return a};function mh(a){mh.l.constructor.call(this,a)}u(mh,kh);t("H.geo.MultiLineString",mh);mh.prototype.a=function(a){return C(a,L)};mh.prototype.qb="Multi"+L.prototype.qb;mh.prototype.Mb="Multi"+L.prototype.Mb;function nh(a,b){nh.l.constructor.call(this,!1,b);this.da(a)}u(nh,eh);t("H.map.Polyline",nh);nh.prototype.F=function(){return this.eb.F()};nh.prototype.getBoundingBox=nh.prototype.F;nh.prototype.eb=y;nh.prototype.da=function(a){var b=this.da,c,d;if(C(a,mh)){var e=a.oa;if(c=e.length)for(d=0;d<c;d++)oh(e[d],b);else throw new D(b,0);}else oh(a,b);this.rd=!!e;this.eb=a;this.ua(Mg.SPATIAL);return this};nh.prototype.setGeometry=nh.prototype.da;nh.prototype.ba=function(){return this.eb};
nh.prototype.getGeometry=nh.prototype.ba;nh.prototype.clip=function(a){var b=this.eb;return Ig(this.rd?b.oa[0]:b,a)};nh.prototype.clip=nh.prototype.clip;nh.prototype.Rd=function(a){var b=this.eb;var c,d=[];if(this.rd)for(b=b.oa,c=b.length;c--;)ph(this,b[c],a,d);else ph(this,b,a,d);return d.length?d:B};nh.prototype.getGeometriesForTile=nh.prototype.Rd;function oh(a,b){if(!C(a,L)||2>a.Ne())throw new D(b,0);}
function ph(a,b,c,d){var e=Ig(b,c.Sf());if(e.length&&(b=c.Uf(),a=fh(a,e,!1,b),e=a.length)){var f=c.Pe();b=b.w;c.x||ih(a,e,-b);c.x===(1<<c.z)-1&&ih(a,e,b);c=qh(a,f.left,f.top,f.right,f.bottom,!1);c.length&&d.push(new rh(c))}}nh.prototype.W=function(){var a=nh.l.W.call(this),b=a.properties;a.geometry=this.ba().W();b.style=this.ta().W();b.height=0;return a};nh.prototype.forWorkerMessage=nh.prototype.W;var sh;function th(a,b){if(x.URL)return(new x.URL(a,b)).toString();if(!a||!uh(a))return a;if(!b||uh(b))throw new TypeError("Failed to construct 'URL': Invalid base URL");sh||(sh=document.createElement("a"),Fc(sh));var c=sh;c.href=b;"/"!==a[0]?a=c.href.replace(/\/[^\/]*$/,"/")+a:((b=c.origin)||(b=c.protocol+"//"+c.host),a=b+a);return a}function uh(a){var b=!1;"string"===typeof a&&(b=!(-1<a.search(/^(http|https|data|blob):/)||"//"===a.substr(0,2)));return b};function vh(a,b){var c,d=arguments.length,e,f;for(c=1;c<d;c++)if((e=arguments[c])&&e!==a&&e!==g){var g=e;for(f in e){var h=e[f];a[f]!==h&&(wh(h)?wh(a[f])?a[f]=vh(a[f],h):a[f]=qc(h):void 0!==h&&(a[f]=qc(h)))}}return a}t("H.util.webgl.mergeObjects",vh);var xh=mc();function yh(a,b,c){var d=c[a];return b&&d in b&&0>sc.indexOf(d)?(b=b[d],++a<c.length?yh(a,b,c):b):xh}
var zh=yh.bind(null,0),Ah={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},Bh={data:1,draw:1,enabled:1,filter:1,properties:1},Ch=Object.keys(Bh);function Dh(a,b,c,d,e,f){var g=d[a],h=c[g];if(++a<d.length){var k=b[g]||{};for(c=Ch.length;c--;){var l=Ch[c];if("draw"!==l||!f){var m=h[l];m!==B&&(k[l]=qc(m))}}Dh(a,k,h,d,e,f)}else e?k=qc(h):(k=h,delete c[g]);b[g]=b[g]?vh(b[g],k):k}var Eh=Dh.bind(null,0);function Fh(a,b){a in Ah&&(b[a]=1)}
function Gh(a,b,c){var d,e,f;for(d in a)if(Bh[d]){if("draw"===d){var g=a[d];for(e in g){var h=g[e];(f=h.style)?(h.style=b+f,Fh(f,c)):(delete g[e],g[b+e]=h,Fh(e,c))}}}else Gh(a[d],b,c)}
function Hh(a,b){var c={},d,e,f,g;b+="_";a=vh({},a);if(d=a.styles)for(e in d){var h=d[e];delete d[e];d[b+e]=h;if(f=h.mix)for(zc(f)&&(f=[f]),g=f.length;g--;)Fh(f[g],c),f[g]=b+f[g];if(g=h.base)f||(f=h.mix=[]),f.unshift(b+g),delete h.base,Fh(g,c);Fh(e,c)}else d=a.styles={};if(h=a.layers)for(e in h)f=h[e],delete h[e],(g=f.data)&&!g.layer&&(g.layer=e),h[b+e]=f,Gh(f,b,c);for(e in c)d[b+e]={base:e};return a}
function Ih(a,b){var c=a.sources,d=Object.keys(c)[0],e=vh(c[d],{uid:b});c=a.layers;var f;a.sources={};a.sources[b]=e;for(f in c)a=c[f],a.data?a.data.source===d&&(a.data.source=b):a.data={source:b}}function Jh(a,b){var c;var d=a.textures;var e=a.fonts;for(c in d){var f=d[c];f.url&&(f.url=th(f.url,b))}for(c in e)if(d=e[c],yc(d))for(f=0;f<d.length;f++){var g=d[f];g.url=g.url&&th(g.url,b)}else g=a.fonts[c],g.url=g.url&&th(g.url,b)}
function Kh(a,b){return"function(){return "+("feature."+a+(b||""))+";}"}function Lh(a){return Kh("style."+a,void 0)}function Mh(a,b,c,d){a={base:a,blend:b,blend_order:c};d&&(a.clean_depth=!!d);return a}function Nh(a){var b={};b["translucent-"+(a?"extruded-":"")+"polygons"]={color:Lh("fillColor"),order:1,interactive:!0,extrude:a};return b}function Oh(a,b,c,d){a={data:{source:a,layer:b}};c&&(a.draw=c);d&&(a.filter=d);return a}function wh(a){return Da(a)&&!yc(a)};function Ph(a,b){Ph.l.constructor.call(this);if(b&&uh(b))throw new D(Ph,1,"Base URL must be absolute");this.A=Qh.INIT;this.a=null;this.c=b}u(Ph,F);t("H.map.render.Style",Ph);Ph.prototype.load=Ph.prototype.load;Ph.prototype.getState=function(){return this.A};Ph.prototype.getState=Ph.prototype.getState;Ph.prototype.P=function(a){this.A=a};Ph.prototype.setState=Ph.prototype.P;Ph.prototype.gc=function(){return this.c};Ph.prototype.getBaseUrl=Ph.prototype.gc;Ph.prototype.nd=function(){return qc(this.a)};
Ph.prototype.getConfig=Ph.prototype.nd;Ph.prototype.lm=function(){return this.a};Ph.prototype.getConfigReference=Ph.prototype.lm;Ph.prototype.Cd=function(a){this.a=a};Ph.prototype.setConfig=Ph.prototype.Cd;Ph.prototype.Lb=function(a){this.a=null;this.P(Qh.ERROR);var b=Rh;se(this.aa,void 0!==b?String(b):void 0)?this.dispatchEvent(new td(Rh,a,this)):console.error(a)};Ph.prototype.dispatchError=Ph.prototype.Lb;Ph.prototype.u=function(){Ph.l.u.call(this);this.a=null};
var Rh="error",Sh={hd:"change",$i:Rh},Qh={ERROR:-1,INIT:0,LOADING:1,READY:2};Ph.State=Qh;function Th(a,b){Th.l.constructor.call(this,a,b);if(zc(a))Uh.test(a)&&-1===a.indexOf("import:")?(this.f=a,b||(this.j=uh(this.f)?B:this.f)):this.g=a;else if(Da(a))this.Cd(qc(a));else throw new D(Th,0,Vh);}u(Th,Ph);t("H.map.render.webgl.Style",Th);
Th.prototype.load=function(){var a=this,b=this.gc();this.f?(this.P(Qh.LOADING),(new rf("text/plain",this.f)).then(function(c){var d={};return Wh(c,b,!1,(d[b]=!0,d))}).then(function(c){return a.Cd(c)},function(c){return a.Lb(c.message)}),this.f=null):this.g&&(this.P(Qh.LOADING),Wh(this.g,b).then(function(c){return a.Cd(c)},function(c){return a.Lb(c.message)}),this.g=null)};
Th.prototype.bl=function(a,b,c){var d;Xh(this);a=Yh(this,a,this.bl,c);for(c=0;c<a.length;c++){var e=a[c].gb.draw;for(d in e){var f=e[d];wh(f)&&(f.interactive=!!b)}}Zh(this)};Th.prototype.setInteractive=Th.prototype.bl;
Th.prototype.setProperty=function(a,b,c){var d,e=a.split("."),f=0,g=e.length;Xh(this);if(!tc(b))throw new D(this.setProperty,1,"value");if(d=$h(this.a,e)){if(!(d.parent instanceof Object)||d.parent instanceof Array)if(c)e.pop(),e=$h(this.a,e),d.parent=e.parent[e.og]={};else throw new D(this.setProperty,0,a+" property is not primitive type");d.parent[d.og]=b}else{for(d=this.a;f!==g-1;)d[e[f]]={},d=d[e[f++]];d[e[f]]=b}ai(this)&&Zh(this)};Th.prototype.setProperty=Th.prototype.setProperty;
Th.prototype.xh=function(a){Xh(this);return(a=$h(this.a,a.split(".")))?qc(a.node):void 0};Th.prototype.getProperty=Th.prototype.xh;Th.prototype.removeProperty=function(a){Xh(this);(a=$h(this.a,a.split(".")))&&a.parent&&a.parent.hasOwnProperty(a.og)&&(delete a.parent[a.og],ai(this)&&Zh(this))};Th.prototype.removeProperty=Th.prototype.removeProperty;
Th.prototype.Ce=function(a,b,c){var d;Xh(this);var e=this.a;var f=e.layers;var g=Yh(this,a,this.Ce,!1);a=g.length;for(d={};a--;)Eh(d,f,g[a].id,!!b,!!c);c={};g=Object.keys(e);for(a=g.length;a--;){var h=g[a];var k=e[h];c[h]=k===f?d:qc(k)}b||Zh(this);return c};Th.prototype.extractConfig=Th.prototype.Ce;Th.prototype.Ve=function(a){Xh(this);if(!Da(a))throw new D(this.Ve,0,"config");this.Cd(vh(this.a,a))};Th.prototype.mergeConfig=Th.prototype.Ve;Th.prototype.b=ba(2);
Th.prototype.toString=function(){return this.getState()===Qh.READY?x.H.gl.yaml.safeDump(this.a,{lineWidth:120}):""};Th.prototype.u=function(){Th.l.u.call(this);this.g=this.f=null};function ai(a){var b=a.a,c;if(Da(b)){var d;if(d=a.i){b=b&&b.sources;d=!1;for(var e in b)if(b[e].type===a.i){d=!0;break}d=!(b?d:1)}d&&(c="invalid source, the only valid type is "+a.i)}else c=Vh;c&&a.Lb(c);return!c}function Zh(a){a.dispatchEvent(new rd("change",a))}
function Xh(a){if(a.getState()!==Qh.READY)throw new Yc(a.Ve,"style is not ready yet");}function Yh(a,b,c,d){var e=[],f=yc(b)?b:[b],g,h;void 0===d&&(d=!0);for(f=f.sort().reverse();g=f.pop();){b=String(g).split(".");a:{var k=a.a;for(var l=b.length;l--&&!Bh[b[l]];);if(k&&0>l&&(k=zh(k.layers,b),wh(k)))break a;k=xh}if(k===xh)throw new D(c,0,'Unresolvable layer ID "'+g+'"');e.push({id:b,gb:k});if(d)for(h in k)!Bh[h]&&wh(k[h])&&f.push(g+"."+h)}return e}
function $h(a,b){var c=0,d;for(d=b.length;c!==d;){var e=b[c++];var f=a;a=f[e];if(!a)break}return c===d?{node:a,parent:f,og:e}:void 0}var Uh=/^(http[s]?)?.*\.ya?ml/i,Vh="invalid style configuration";
function Wh(a,b,c,d){c=void 0===c?!1:c;d=void 0===d?{}:d;try{var e=x.H.gl.yaml.safeLoad(a,{json:!0})}catch(f){return Promise.reject(f)}return e&&(a=e["import"],zc(a)&&(a=[a]),c&&b&&bi(e,b),delete e["import"],yc(a)&&a.length)?(c=a.reduce(function(f,g){var h=b?th(g,b):g;d[h]||(d[h]=!0,f.push((new rf("text/plain",h)).then(function(k){return Wh(k,h,!0,d)})));return f},[]),Promise.all(c).then(function(f){var g={};f.forEach(function(h){return h&&vh(g,h)});vh(g,e);return g})):Promise.resolve(e)}
function bi(a,b){function c(g){g.url&&(g.url=th(g.url,b))}var d=a&&a.fonts;if(d)for(var e in d)yc(d[e])?d[e].forEach(c):c(d[e]);if(a=a&&a.textures)for(var f in a)c(a[f])}Th.normalize=bi;Th.prototype.Cd=function(a){Th.l.Cd.call(this,a);ai(this)&&(this.P(Qh.READY),Zh(this))};Th.prototype.nd=function(){return Th.l.nd.call(this)};Th.prototype.gc=function(){return this.j||Th.l.gc.call(this)};t("H.map.Style",Th);Th.State=Qh;function qh(a,b,c,d,e,f){var g,h,k=a.length,l,m;if(k)for(g=[];k--;){var q=a[k];var p=q.length;var r=0;for(l=1;l<p;l++)if(m=ci(q[l-1],q[l],c,b,d,e)){var v=m[0];var w=m[1];r&&r.na(v)?h.push(w):g.push(h=m);r=w;f&&(l=p,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",qh);
function ci(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var l=a;g=h;a=b;h=k;b=l;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var m=1;a=-a;b=-b;l=f;f=-c;c=-l}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);m&&(a=-a,b=-b);return k?[new I(h,-b),new I(g,-a)]:[new I(g,-a),new I(h,-b)]}
function di(a,b,c){a=ei(a,!0);b=ei(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.If=fi(b.x,b.y,null,gi(b));a.If=fi(a.x,a.y,null,gi(a));for(g=b;g.next;g=g.next)if(!g.$a)for(d=a;d.next;d=d.next)if(!d.$a){var k=hi(g.next);var l=hi(d.next);if(e=ii(g,k,d,l,f)){e=f.Fl;var m=f.Gl;var q=f.So;var p=f.To;e=fi(q,p,null,null,null,null,!0,0,0,e);ji(e,g,k);k=fi(q,p,null,null,null,null,!0,0,0,m);ji(k,d,l);e.ei=k;k.ei=e}}f=ce(b,ki(a));
c&&(f=!f);for(g=b;g;g=g.next)g.$a&&(g.gh=f,f=!f);f=ce(a,ki(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.$a&&(d.gh=f,f=!f);li(b);for(li(a);(a=mi(b))!=b;){for(c=null;!a.Cg;a=a.ei){for(f=a.gh;;){c=fi(a.x,a.y,c);c.artificial=a.$a||a.Fn;a.Cg=1;a=f?a.next:a.Ub;if(!a)break;if(a.$a){a.Cg=1;break}}if(!a)break}c.fi=r;var r=c}return r}}t("H.math.clipping.clipPolygon",di);
function fi(a,b,c,d,e,f,g,h,k,l){a={x:a,y:b,next:c||null,Ub:d||null,fi:e||null,ei:f||null,$a:!!g,gh:h||0,Cg:k||0,alpha:l||0};d&&(a.Ub.next=a);c&&(a.next.Ub=a);return a}function hi(a){for(;a&&a.$a;)a=a.next;return a}function gi(a){if(a)for(;a.next;)a=a.next;return a}function mi(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.$a||b.$a&&b.Cg))}return b}function li(a){var b=gi(a);b.Ub.next=a;a.Ub=b.Ub}
function ii(a,b,c,d,e,f){var g,h=b.x-a.x,k=b.y-a.y;var l=d.x-c.x;var m=d.y-c.y;var q=h*m-k*l;if(!q)return 0;l=((c.x-a.x)*m-(c.y-a.y)*l)/q;q=(k*(c.x-a.x)-h*(c.y-a.y))/q;if(0>l||1<l||0>q||1<q)return 0;0===l?g=a:1===l?g=b:0===q?g=c:1===q&&(g=d);if(g&&!f)return g.x+=2.480549651603763E-5,g.y+=7.321997314118067E-5,g.If&&(g.If.x=g.x,g.If.y=g.y),ii(a,b,c,d,e);e.So=a.x+l*h;e.To=a.y+l*k;e.Fl=l;e.Gl=q;return 1}function ki(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}
function ji(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.Ub=b.Ub;a.next.Ub=a;a.Ub.next=a}function ei(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=fi(a[e].x,a[e].y,d);c.Fn=b;if(c.next=d)d.Ub=c;d=c}return d};function P(a,b){var c;P.l.constructor.call(this);C(a,L,P,0);if(b!==B&&yc(b,P,1)){for(c=0;c<b.length;c++)C(b[c],L,P,1,"index "+c);this.Na=b}else this.Na=[];this.cb=a;this.a=[]}u(P,Wf);t("H.geo.Polygon",P);function ni(a){var b=P,c=L,d=a.ka,e=a.ca,f=a.ma,g=a.ga;e=[d,e,B,d,g,B,f,g,B,f,e,B];180<=a.Eb()&&(e.splice(9,0,f,a=a.lb().lng,B),e.splice(3,0,d,a,B));return new b(new c(e))}var oi={NORTH:90,SOUTH:-90};P.Direction=oi;P.prototype.ud=oi.NORTH;
P.prototype.cl=function(a){this.ud!==a&&(this.R=y,this.a.length=0,this.ud=a);return this};P.prototype.setPoleCovering=P.prototype.cl;P.prototype.Zm=function(){return this.ud};P.prototype.getPoleCovering=P.prototype.Zm;P.prototype.vm=function(){return this.cb};P.prototype.getExterior=P.prototype.vm;P.prototype.$k=function(a){if(!C(a,L))throw new D(this.$k,0,a);this.cb=a;this.R=y};P.prototype.setExterior=P.prototype.$k;P.prototype.Fm=function(){return this.Na};P.prototype.getInteriors=P.prototype.Fm;
P.prototype.Bg=function(a,b,c){var d=arguments.length,e;for(e=2;e<d;e++)C(arguments[e],L,this.Bg,e);var f=this.Na.splice.apply(this.Na,arguments);for(e=2;e<d;e++)arguments[e]=B;this.a.splice.apply(this.a,arguments);return f};P.prototype.spliceInteriors=P.prototype.Bg;P.prototype.vo=function(a){return this.Bg(a,1)[0]};P.prototype.removeInteriorAt=P.prototype.vo;P.prototype.uo=function(a){a=this.Na.indexOf(a);return 0>a?B:this.Bg(a,1)[0]};P.prototype.removeInterior=P.prototype.uo;
P.prototype.Kk=function(a){if(!C(a,L))throw new D(this.Kk,0,a);this.Na.push(a)};P.prototype.pushInterior=P.prototype.Kk;P.prototype.F=function(){var a=this.R;a||(this.R=a=pi(this.cb,this.ud));return a};P.prototype.getBoundingBox=P.prototype.F;n=P.prototype;n.Gj=function(a){var b=this.Na.length;if(0>a||a>=b)throw new je(this.Gj,a,[0,b-1]);(b=this.a[a])||(this.a[a]=b=pi(this.Na[a],this.ud));return b};n.cb=y;n.Na=[];
function pi(a,b){var c,d,e;if(e=a.F())(c=a.ph(!0))&&(d=a.Ne())&&(e=e.mc(eg([a.De(0),a.De(d-1)],!0),!0)),360===e.Eb()&&1===c%2&&(e=e.cd(b,0));return e}n.qb="Polygon";n.Sc=function(a){var b=this.Na,c=b.length,d;if(this.cb.Ne()){a.push("(");this.cb.Sc(a,!0);for(d=0;d<c;d++)b[d].Ne()&&(a.push(","),b[d].Sc(a,!0));a.push(")")}else a.push("EMPTY");return a};n.Mb="Polygon";
n.gd=function(){var a,b=[],c=this.Na,d=this.cb.gd();d[0].toString()!==d[d.length-1].toString()&&d.push(d[0]);b.push(d);for(a=0;a<c.length;a++)d=c[a].gd(),d[0].toString()!==d[d.length-1].toString()&&d.push(d[0]),b.push(d);return b};n.W=function(){var a=P.l.W.call(this);this.F().Fb()&&(a.type="Multi"+a.type);return a};n.wc=function(){var a=[],b=this.Na,c=b.length;for(a.push(this.cb.wc());c--;)a[c+1]=b[c].wc();return this.F().Fb()?[a]:a};
n.na=function(a){var b=!1;if(C(a,P)){var c=a.Na,d=this.Na.length;b=c.length;var e=0;for(b=this.cb.na(a.cb)&&d===b;b&&e<d;)b=b&&this.Na[e].na(c[e]),e++}return b};function qi(a,b,c){var d=void 0===d?!0:d;var e=a.Na,f=ri.bind(null,b,c);return be(b,c,a.cb.X,0,!0,3)!==ae.NONE?d?!e.some(f):!0:!1}function ri(a,b,c){return be(a,b,c.X,0,!0,3)===ae.SURFACE}
function ti(a,b){b=b.X;a=a.cb.X;var c,d,e=b.length-3,f=a.length-3,g={};for(c=0;c<e;c+=3){var h=b[c];var k=b[c+1];var l=b[c+3];var m=b[c+4];for(d=0;d<f;d+=3){var q=a[d];var p=a[d+1];var r=a[d+3];var v=a[d+4];if(ii({x:k,y:h},{x:m,y:l},{x:p,y:q},{x:v,y:r},g,!0))return!0}}return!1}
function ui(a,b){var c=b.cb,d=b.Na,e=d.length,f=c.X,g=f.length,h=a.cb.X,k=h.length;if(ti(a,c))return!0;for(c=0;c<g;c+=3)if(qi(a,f[c],f[c+1]))return!0;for(c=0;c<k;c+=3)if(qi(b,h[c],h[c+1]))return!0;for(c=0;c<e;c++)if(ti(a,d[c]))return!0;return!1};function vi(a){vi.l.constructor.call(this,a)}u(vi,kh);t("H.geo.MultiPolygon",vi);vi.prototype.a=function(a){return C(a,P)};vi.prototype.qb="Multi"+P.prototype.qb;vi.prototype.Mb="Multi"+P.prototype.Mb;function rh(a,b,c){this.paths=this.a=a;b!==B&&(this.interiorsIndex=this.b=b);c!==B&&(this.outlinesIndex=this.c=c)}rh.prototype.interiorsIndex=rh.prototype.b=Td;rh.prototype.outlinesIndex=rh.prototype.c=Td;var dh=pc(new rh([])),wi=oc([]);function xi(a,b){var c=b&&(+b.extrusion||+b.extrude),d=b&&+b.elevation,e=0;xi.l.constructor.call(this,!0,b);0<d&&(e+=d,this.f=d);0<c&&(e+=c,this.i=c);if(e>yi)throw new je(xi,e,[0,yi]);C(a,L)?this.da(new P(a)):this.da(a)}u(xi,eh);t("H.map.Polygon",xi);xi.prototype.i=0;xi.prototype.f=0;xi.prototype.eb=y;var yi=2047;xi.MAX_EXTRUDE_HEIGHT=yi;xi.prototype.zi=function(a){var b=+a;if(b!==a)throw new D(this.zi,0,a);if(0>b||this.f+b>yi)throw new je(this.zi,this.f+b,[0,yi]);this.i=b;this.ua(Mg.SPATIAL)};
xi.prototype.setExtrusion=xi.prototype.zi;xi.prototype.wm=function(){return this.i};xi.prototype.getExtrusion=xi.prototype.wm;xi.prototype.yi=function(a){var b=+a;if(b!==a)throw new D(this.yi,0,a);if(0>b||this.i+b>yi)throw new je(this.yi,this.i+b,[0,yi]);this.f=b;this.ua(Mg.SPATIAL)};xi.prototype.setElevation=xi.prototype.yi;xi.prototype.um=function(){return this.f};xi.prototype.getElevation=xi.prototype.um;xi.prototype.ba=function(){return this.eb};xi.prototype.getGeometry=xi.prototype.ba;
xi.prototype.da=function(a){if(a===y||C(a,P))var b=!1;else C(a,vi,this.da,0),b=!0;this.rd=b;b=this.eb;this.eb=a;b!==y&&this.ua(Mg.SPATIAL);return this};xi.prototype.setGeometry=xi.prototype.da;xi.prototype.F=function(){return this.ba().F()};xi.prototype.getBoundingBox=xi.prototype.F;
xi.prototype.Rd=function(a){var b,c=this.ba(),d,e;if(this.rd){c=c.oa;var f=0;for(e=c.length;f<e;f++)if(d=zi(this,c[f],a,c[f].ud))b||(b=[]),b.push(d)}else d=this.Xa,d===B&&(d=this.rd?oi.NORTH:this.ba().ud),(d=zi(this,c,a,d))&&(b=[d]);return b};xi.prototype.getGeometriesForTile=xi.prototype.Rd;
function zi(a,b,c,d){var e,f,g=0,h=!0;if(e=Ai(a,b.cb,c,d,b.F())){var k=new rh(e);var l=b.Na;if(f=l.length)for(k.b=k.a.length;g<f;g++)if(e=Ai(a,l[g],c,d,b.Gj(g)))k.a=k.a.concat(e);f=k.a.length;for(g=0;g<f;g++)if(k.a[g]!==wi){h=!1;break}h&&(k=g%2?dh:B)}return k}
function Ai(a,b,c,d,e){var f=c.Pe(),g=e,h=g.Eb();var k=[[]];var l=b.X;var m=[],q=l.length,p,r=!1;for(p=0;p<q;p+=3){var v=l[p];var w=l[p+1];r||180!=Ad(w)||(m.push(v),m.push(w),m.push(v),m.push(-w),r=!0);m.push(v);m.push(w)}l=m;360>h&&-180==g.ca&&(g=new K(g.ka,180,g.ma,g.ga));360>h&&180==g.ga&&(g=new K(g.ka,g.ca,g.ma,-180));if(g.Fb()){h=l;v=h.length;l=-1;for(m=0;m<v-2;m+=2)if(Vf(h[m+1],h[m+3])){l=m+2;break}-1===l&&Vf(h[v-1],h[1])&&(l=v);-1!==l&&(q=h[l-2],m=h[l-1],p=h[l%v],r=h[(l+1)%v],180!==Ad(q)&&
180!==Ad(p)&&(w=Ad(p-q),v=Ad(r-m),v+=180<v?-360:0,r=Ad(180-r),r+=180<r?-360:0,v&&r&&(w/=Ad(v)/Ad(r),q=p+(p>q?-w:w),m=0<m?180:-180,h.splice(l,0,q,m,q,-m))));l=h}k[0]=Bi([].concat(l),g.ca);360>g.Eb()&&g.Kd(new Xf(g.ka,180))&&(l=Bi([].concat(l),g.ga),k.push(l));g=c.Uf();a=fh(a,k,!0,g);if(360===e.Eb()&&1===b.ph(!0)%2){b=a;a=c.Pe();b[0][1].x>b[0][b[0].length-1].x&&(b[0]=b[0].reverse());l=[];h=b[0].length-1;for(k=0;k<h;k++)m=b[0][k],l[k]=new I(m.x-2*g.w,m.y),l[k+h]=new I(m.x-g.w,m.y),l[k+2*h]=new I(m.x,
m.y),l[k+3*h]=new I(m.x+g.w,m.y),l[k+4*h]=new I(m.x+2*g.w,m.y);b[0]=l;k=g.Mh(d,0);k.y=2*a[d===oi.NORTH?"top":"bottom"];d=k.clone();k.x=b[0][b[0].length-1].x+1;d.x=b[0][0].x-1;b[0].push(k,d);a=b}d=f.left;b=f.top;k=f.right;f=f.bottom;if(qh(a,d,b,k,f,!0).length){if(!c.Sf().Xg(e)){c=a;e=[new I(d,b),new I(k,b),new I(k,f),new I(d,f)];f=[];for(a=c.length;a--;)if(d=di(e,c[a]))for(b=Ci(d),f.push(b);d.fi;)d=d.fi,b=Ci(d),f.push(b);a=f}}else c=Di(d,b,a[0]),a[1]&&(c^=Di(d,b,a[1])),a=c?[wi]:B;return a}
function Di(a,b,c){var d,e,f;var g=d=c[0].x;var h=e=c[0].y;var k=1;for(f=c.length;k<f;k++){var l=c[k].x;var m=c[k].y;l>d?d=l:l<g&&(g=l);m>e?e=m:m<h&&(h=m)}return g<=a&&a<=d&&h<=b&&b<=e&&ce({x:a,y:b},de(c.concat(c[0])))}function Ci(a){var b=[],c=a;do{var d=xd(100*(c.mo?c.mo:c.x))/100;var e=xd(100*(c.no?c.no:c.y))/100;if(!f||.01<Cd(Dd(f.x-d,2)+Dd(f.y-e,2))){var f=new I(d,e);b.push(f)}c=c.next}while(c&&c!==a);return b}xi.prototype.T=y;
function Bi(a,b){var c,d=Number.POSITIVE_INFINITY,e=-1,f=a.length;for(c=0;c<f;c+=2){var g=Ad(a[c+1]-b);g+=180<g?360-g:g;g<d&&(d=g,e=c)}return 0<c?(b=a.splice(e,a.length-e),b.concat(a)):a}
xi.prototype.W=function(){var a=xi.l.W.call(this),b=this.ba(),c=this.rd?b.oa:[b],d,e=a.properties;var f=a.geometry=b.W();e.style=this.ta().W();e.height=this.i+this.f;e.min_height=this.f;if(this.F().Fb()&&(f.type="MultiPolygon",this.rd)){var g=[];c.forEach(function(h,k){d=f.coordinates[k];h.F().Fb()?g=g.concat(d):g.push(d)});f.coordinates=g}return a};xi.prototype.forWorkerMessage=xi.prototype.W;function Ei(a,b,c){Ei.l.constructor.call(this,jh,c);this.xg(a);this.Ii(b);c&&"precision"in c&&this.Gi(c.precision)}u(Ei,xi);t("H.map.Circle",Ei);Ei.prototype.xg=function(a){(a=Zf(a)).na(this.b)||(this.b=a,Fi(this))};Ei.prototype.setCenter=Ei.prototype.xg;Ei.prototype.lb=function(){return this.b};Ei.prototype.getCenter=Ei.prototype.lb;Ei.prototype.Ii=function(a){if(E(a=Yd(a,0,6371000.79*Md/2)))throw new D(this.Ii,0,a);this.fa!==a&&(this.fa=a,Fi(this))};Ei.prototype.setRadius=Ei.prototype.Ii;
Ei.prototype.dn=function(){return this.fa};Ei.prototype.getRadius=Ei.prototype.dn;Ei.prototype.O=60;Ei.prototype.Gi=function(a){if(!Cc(a))throw new D(this.Gi,0,a);this.O!==(a=Yd(xd(a),4,360))&&(this.O=a,Fi(this))};Ei.prototype.setPrecision=Ei.prototype.Gi;Ei.prototype.an=function(){return this.O};Ei.prototype.getPrecision=Ei.prototype.an;Ei.prototype.da=function(){return this};Ei.prototype.setGeometry=Ei.prototype.da;Ei.prototype.ba=function(){this.eb||Ei.l.da.call(this,Gi(this));return this.eb};
Ei.prototype.getGeometry=Ei.prototype.ba;function Fi(a){a.eb!==y&&Ei.l.da.call(a,Gi(a))}function Gi(a){var b=a.b,c=b.lat,d=a.fa,e=0,f=new L;if(90===Ad(c))for(c=b.Dg(0,d,!0).lat;360>e;e+=120)f.ui(c,e-180,B);else for(a=a.O,a=360/a;360>e;e+=a)f.wd(b.Dg(e,d,!0));b=new P(f);0>c&&b.cl(oi.SOUTH);return b};function Hi(a,b){if(!C(a,Element)){Ii.innerHTML=a;a=Ii.firstElementChild;if(!a)throw new D(Hi,0,"No element data");Ii.removeChild(a);var c=!0;Ii.innerHTML=""}this.a=0!==hf(a).length;this.c=c?a:jf(a,x.document,this.a);b&&(c="onAttach",c in b&&wc(a=b[c],"Function",Hi,1,c)&&(this.gi=a),c="onDetach",c in b&&wc(a=b[c],"Function",Hi,1,c)&&(this.b=a))}t("H.map.DomIcon",Hi);var Ii=document.createElement("DIV");Hi.prototype.gi=null;Hi.prototype.b=null;Hi.prototype.Hj=function(a){return jf(this.c,a,this.a)};
Hi.prototype.a=!1;function Ji(a){Ji.l.constructor.call(this,a)}u(Ji,kh);t("H.geo.MultiPoint",Ji);Ji.prototype.a=function(a){return Yf(a)};Ji.prototype.b=function(a){return C(a,Xf)?a:Zf(a)};Ji.prototype.qb="Multi"+Xf.prototype.qb;Ji.prototype.Mb="Multi"+Xf.prototype.Mb;function Ki(a,b){this.w=+a;this.h=+b}t("H.math.Size",Ki);function Li(a,b){var c;var d=a;var e=b||[];if(a!==Mi.NONE){b=c=e.length;if(-1===this.b.indexOf(d))throw new D(Li,0,a);if(!e)throw new D(Li,1,e);for(;c--;)if(E(e[c]))throw new D(Li,1,e);d===Mi.RECT&&3<b&&(e=[e[0],e[1],e[2],e[1],e[2],e[3],e[0],e[3]],d=Mi.POLYGON);if(d===Mi.CIRCLE&&2<b&&(a=e[2],0<a)){d=e[0];var f=e[1];c=vd(2*zd(a),40);var g=360/c;for(e=[];c--;){var h=g*c*Rd;e.push(d+Fd(h)*a,f+Hd(h)*a)}d=Mi.POLYGON}if(d!==Mi.POLYGON||!b||e.length%2)throw new D(Li,1,e);this.a=e}}
t("H.map.HitArea",Li);var Mi={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};Li.ShapeType=Mi;Li.prototype.b=[Mi.RECT,Mi.CIRCLE,Mi.POLYGON];Li.prototype.Zf=function(a,b,c){return this.a?be(a,b,this.a,c,!0):ae.NONE};Li.prototype.hitTest=Li.prototype.Zf;function Ni(a,b){var c;uc(this,Ni);Ni.l.constructor.call(this,b);this.da(a);b&&"icon"in b&&(c=b.icon);this.Oc(c||Oi(this))}u(Ni,M);t("H.map.AbstractMarker",Ni);Ni.prototype.ba=function(){return this.b};Ni.prototype.getGeometry=Ni.prototype.ba;Ni.prototype.da=function(a){var b=this.b;C(a,Xf)||C(a,Ji)?this.b=a:(Yf(a,this.da,0),this.b=Zf(a));b&&this.ua(Mg.SPATIAL);return this};Ni.prototype.setGeometry=Ni.prototype.da;Ni.prototype.F=function(){return this.b.F()};Ni.prototype.zb=function(){return this.icon};
Ni.prototype.getIcon=Ni.prototype.zb;Ni.prototype.Oc=function(a){var b=this.icon,c=!b;if(b!==a){if(!this.ck(a)){if(c)throw new D(this.constructor,1,a);throw new D(this.Oc,0,a);}this.icon=a;c||this.ua(Mg.VISUAL)}return this};Ni.prototype.setIcon=Ni.prototype.Oc;function Oi(a){var b=a.g;b||(b=a.constructor.prototype.g=a.f(Pi));return b}
var Pi={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Ki(38,
47),anchor:new I(19,45),hitArea:new Li(Mi.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};Ni.prototype.W=function(){var a=Ni.l.W.call(this),b=this.zb(),c=b.Bb(),d=b.md();a.geometry=this.ba().W();c&&(b=a.properties.icon={id:b.uid},b.size={w:c.w,h:c.h},b.offset=[c.w/2-(d?d.x:0),c.h/2-(d?d.y:0)]);return a};Ni.prototype.forWorkerMessage=Ni.prototype.W;function Qi(a,b){Qi.l.constructor.call(this,a,b)}u(Qi,Ni);t("H.map.DomMarker",Qi);Qi.prototype.type=Pg.DOM_MARKER;Qi.prototype.Eg=2;Qi.prototype.f=function(a){var b=new Hi(a.svg,a);a=a.anchor;b.c.style.margin=-a.y+"px 0 0 -"+a.x+"px";return b};Qi.prototype.ck=function(a){return C(a,Hi)};function Ri(a,b,c,d){Ri.l.constructor.call(this,a,b,c);this.modifiers=d}u(Ri,Ng);t("H.map.ChangeEvent",Ri);var Si={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};Ri.Type=Si;Ri.prototype.Bl=Si.SIZE;Ri.prototype.SIZE=Ri.prototype.Bl;Ri.prototype.gj=Si.POSITION;Ri.prototype.POSITION=Ri.prototype.gj;Ri.prototype.aj=Si.HEADING;Ri.prototype.HEADING=Ri.prototype.aj;Ri.prototype.ij=Si.TILT;Ri.prototype.TILT=Ri.prototype.ij;Ri.prototype.bj=Si.INCLINE;Ri.prototype.INCLINE=Ri.prototype.bj;
Ri.prototype.jj=Si.ZOOM;Ri.prototype.ZOOM=Ri.prototype.jj;Ri.prototype.Yi=Si.BOUNDS;Ri.prototype.BOUNDS=Ri.prototype.Yi;function Ti(){this.a=[];Ti.l.constructor.call(this)}u(Ti,F);t("H.util.OList",Ti);function Ui(a,b,c){a=a.a.length;if(c)var d=a;else if(E(d=0>(d=+b)?wd(0,a+d):vd(a,d)))throw new je(Ti,b,[0,a-1]);return d}Ti.prototype.add=function(a,b){b=Ui(this,b,E(b));this.a.splice(b,0,a);this.dispatchEvent(new Vi(this,this.b.oe,b,a,null,null))};Ti.prototype.add=Ti.prototype.add;function Wi(a,b){var c=a.a.splice(b,1)[0];a.dispatchEvent(new Vi(a,a.b.qe,b,null,c,null));return c}
Ti.prototype.oc=function(a){this.get(a);return Wi(this,a)};Ti.prototype.removeAt=Ti.prototype.oc;Ti.prototype.remove=function(a){a=this.indexOf(a);return 0<=a?(Wi(this,a),!0):!1};Ti.prototype.remove=Ti.prototype.remove;Ti.prototype.set=function(a,b){if(0!==this.a.length||0!==a){this.get(a);a=Ui(this,a,!1);var c=this.a[a]}this.a[a]=b;this.dispatchEvent(new Vi(this,this.b.re,a,b,c,null));return c};Ti.prototype.set=Ti.prototype.set;Ti.prototype.indexOf=function(a){return this.a.indexOf(a)};
Ti.prototype.indexOf=Ti.prototype.indexOf;Ti.prototype.get=function(a){var b=Ui(this,a,!1),c=this.a;if(b>=c.length)throw new je(this.get,a,[0,c.length-1]);return c[b]};Ti.prototype.get=Ti.prototype.get;Ti.prototype.Lm=function(){return this.a.length};Ti.prototype.getLength=Ti.prototype.Lm;Ti.prototype.La=function(){return[].concat(this.a)};Ti.prototype.asArray=Ti.prototype.La;Ti.prototype.flush=function(){for(var a=this.a.length;a--;)Wi(this,a)};Ti.prototype.flush=Ti.prototype.flush;
Ti.prototype.u=function(){this.flush();Ti.l.u.call(this)};Ti.prototype.b={oe:"add",qe:"remove",re:"set",Xo:"move"};function Vi(a,b,c,d,e,f){Vi.l.constructor.call(this,b,a);this.idx=c;this.added=d;this.removed=e;this.moved=f}u(Vi,rd);var Xi={};t("H.geo.mercator",Xi);Xi.a=function(a){return vd(1,wd(0,.5-Bd(Id(Od+Nd*a/180))/Md/2))};Xi.b=function(a){return a/360+.5};Xi.cg=function(a,b,c){c?(c.x=Xi.b(b),c.y=Xi.a(a)):c=new I(Xi.b(b),Xi.a(a));return c};Xi.latLngToPoint=Xi.cg;Xi.Nb=function(a,b){return Xi.cg(a.lat,a.lng,b)};Xi.geoToPoint=Xi.Nb;Xi.f=function(a){return 0>=a?90:1<=a?-90:Sd*(2*Jd(Ed(Md*(1-2*a)))-Nd)};Xi.c=function(a){return 360*(1===a?1:Wd(a,1))-180};
Xi.Pa=function(a,b,c){c?(c.lat=Xi.f(b),c.lng=Xi.c(a)):c=new Xf(Xi.f(b),Xi.c(a));return c};Xi.xyToGeo=Xi.Pa;Xi.ng=function(a,b){return Xi.Pa(a.x,a.y,b)};Xi.pointToGeo=Xi.ng;t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function Yi(a,b){this.projection=a||Xi;this.b=0;this.a=this.exp=Bd(b||256)/Ld;Zi(this);this.y=this.x=0}t("H.geo.PixelProjection",Yi);var $i=Ad(24)+Ad(-8);Yi.prototype.Jk=Xi;Yi.prototype.projection=Yi.prototype.Jk;Yi.prototype.x=0;Yi.prototype.x=Yi.prototype.x;Yi.prototype.y=0;Yi.prototype.y=Yi.prototype.y;Yi.prototype.Qo=Dd(2,$i);Yi.prototype.w=Yi.prototype.Qo;Yi.prototype.xn=Dd(2,$i);Yi.prototype.h=Yi.prototype.xn;
Yi.prototype.Fa=function(a){if(E(a))throw new D(this.Fa,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Zi(this);this.x=b*this.w;this.y=c*this.h};Yi.prototype.rescale=Yi.prototype.Fa;function Zi(a){a.a>$i&&(a.a=$i);a.w=Dd(2,a.a);a.h=Dd(2,a.a)}Yi.prototype.Sj=function(){return this.b||0};Yi.prototype.getZoomScale=Yi.prototype.Sj;Yi.prototype.kb=function(a,b){a=this.projection.cg(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};Yi.prototype.geoToPixel=Yi.prototype.kb;
Yi.prototype.Ye=function(a,b){return this.projection.Pa((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};Yi.prototype.pixelToGeo=Yi.prototype.Ye;Yi.prototype.Pa=function(a,b,c){return this.projection.Pa((a+this.x)/this.w,(b+this.y)/this.h,c)};Yi.prototype.xyToGeo=Yi.prototype.Pa;Yi.prototype.Mh=function(a,b,c){a=this.projection.cg(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};Yi.prototype.latLngToPixel=Yi.prototype.Mh;
Yi.prototype.dd=function(a){return new I(a.x*this.w-this.x,a.y*this.h-this.y)};Yi.prototype.pointToPixel=Yi.prototype.dd;function aj(a){a=a||{};aj.l.constructor.call(this);this.min=0;this.max=22;this.Ql=this.dark=!!a.dark;a.min&&this.Di(a.min);a.max&&this.Bi(a.max);this.pixelProjection=new Yi(a.projection,a.minWorldSize);a.provider&&(this.a=a.provider,this.g=A(this.g,this),this.a.addEventListener(bj.prototype.g.Da,this.g,!1,this),this.i=A(this.i,this),this.a.addEventListener(bj.prototype.g.pe,this.i,!1,this))}u(aj,F);t("H.map.layer.Layer",aj);aj.prototype.min=0;aj.prototype.min=aj.prototype.min;
aj.prototype.max=22;aj.prototype.max=aj.prototype.max;aj.prototype.U=y;aj.prototype.pixelProjection=aj.prototype.U;aj.prototype.b={Da:"update",pe:"configchange",fj:"minchange",ej:"maxchange"};aj.prototype.pa=function(){return this.a};aj.prototype.getProvider=aj.prototype.pa;aj.prototype.In=function(a){return this.min<=a&&a<=this.max};aj.prototype.isValid=aj.prototype.In;
function cj(a,b,c){var d=a[b],e="min"===b,f=e?a.Di:a.Bi;if(c!==d)if(e?c<=a.max:c>=a.min)a[b]=c,a.g(),a.i(),a.dispatchEvent(new Ng(e?a.b.fj:a.b.ej,c,d));else throw new D(f,0,"Invalid condition min <= max");return a}aj.prototype.Di=function(a){return cj(this,"min",+a)};aj.prototype.setMin=aj.prototype.Di;aj.prototype.Bi=function(a){return cj(this,"max",+a)};aj.prototype.setMax=aj.prototype.Bi;aj.prototype.g=function(){this.dispatchEvent(this.b.Da)};aj.prototype.i=function(){this.dispatchEvent(this.b.pe)};
aj.prototype.u=function(){aj.l.u.call(this)};aj.prototype.sa=function(){return null};aj.prototype.getCopyrights=aj.prototype.sa;function dj(a){var b;dj.l.constructor.call(this);this.dispatchEvent=A(this.dispatchEvent,this);if(a){var c=a.length;for(b=0;b<c;b++)this.add(a[b])}}u(dj,Ti);t("H.map.DataModel",dj);function ej(a,b){var c=b.getProvider&&b.getProvider();c&&(fj[c.uid]=c);b.ja(a)}function gj(a){var b=a.getProvider&&a.getProvider();b&&delete fj[b.uid];a.ja(null)}dj.prototype.add=function(a,b){C(a,aj,this.add,0);ej(this,a);dj.l.add.call(this,a,b)};dj.prototype.add=dj.prototype.add;
dj.prototype.set=function(a,b){C(b,aj,this.set,0);ej(this,b);(a=dj.l.set.call(this,a,b))&&gj(a);return a};dj.prototype.set=dj.prototype.set;dj.prototype.oc=function(a){var b;(b=dj.l.oc.call(this,a))&&gj(b);return b};dj.prototype.removeAt=dj.prototype.oc;dj.prototype.remove=function(a){var b;(b=dj.l.remove.call(this,a))&&gj(a);return b};dj.prototype.remove=dj.prototype.remove;dj.prototype.flush=function(){for(var a=this.a.length;a--;)this.oc(a);dj.l.flush.call(this)};dj.prototype.flush=dj.prototype.flush;
var fj={};Fc(fj);function hj(a,b,c){if(a=fj[a])return C(a[b],Function,hj,1,"invalid method"),a[b].apply(a,c)}dj.invoke=hj;function ij(a,b){Ca(a)&&(this.i=a);Cc(b)&&(this.a=b)}t("H.util.Request",ij);ij.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var jj=[0,1,2,3,4];ij.prototype.A=0;ij.prototype.getState=function(){return this.A};ij.prototype.getState=ij.prototype.getState;ij.prototype.P=function(a){if(0>jj.indexOf(a))throw new D(this.P,0,a);if(this.A!==a||1===a&&1<this.a)this.A=a,this.i&&this.i(this)};ij.prototype.a=1;ij.prototype.pn=function(){return this.a};ij.prototype.getTotal=ij.prototype.pn;
ij.prototype.b=0;ij.prototype.bn=function(){return this.b};ij.prototype.getProcessed=ij.prototype.bn;ij.prototype.g=0;ij.prototype.xm=function(){return this.g};ij.prototype.getFailed=ij.prototype.xm;function kj(a,b){a.b<a.a&&(tc(b)||(b=2),0===b||1===b||0!==a.A&&1!==a.A||(a.b++,2!==b&&a.g++,a.P(a.b<a.a?1:2)))}ij.prototype.ve=function(){};ij.prototype.cancel=function(){3!==this.A&&(this.ve(),this.P(3))};ij.prototype.cancel=ij.prototype.cancel;function lj(){}t("H.util.ICapturable",lj);lj.prototype.capture=function(){};lj.prototype.capture=lj.prototype.capture;t("H.util.Disposable",nd);nd.prototype.wb=nd.prototype.wb;nd.prototype.addOnDisposeCallback=nd.prototype.wb;t("H.util.dispose",qd);function mj(a,b){var c=a.G(),d=c.ownerDocument;mj.l.constructor.call(this);this.a=a;this.S=c=c.appendChild(nj(d,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint"));this.Af=nj(d,"DIV","margin: 0 0 "+oj+"px "+oj+"px;display:inline-block;",pj,"H_logo");c.appendChild(this.Af);c=c.appendChild(nj(d,
"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright"));this.g=c.appendChild(nj(d,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use"));this.g.target="_blank";this.f=c.appendChild(nj(d,"SPAN","margin:0px 8px"));this.j=Ua(qj);this.Ei(b);this.c=A(this.c,this);this.b=A(this.b,this);this.a.addEventListener(this.a.o.dj,this.c);this.a.a.addEventListener("add",this.b);this.a.a.addEventListener("remove",
this.b);this.a.a.addEventListener("set",this.b);this.b()}var rj;u(mj,nd);t("H.map.Imprint",mj);var oj=16,qj={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US"};
mj.prototype.Ei=function(a){var b,c=this.Af.firstChild.firstChild.childNodes;a||(this.j=Ua(qj));var d=this.j;for(b in d)a&&b in a&&(d[b]=a[b]);a=(this.Ih=a=d.invert)?sj:tj;c[0].style.fill=a.il;c[0].style.fillOpacity=a.jl;c[1].style.fill=a.nl;c[1].style.fillOpacity=a.ol;a=d.locale;uj[a]||(a="en-US",d.locale=a);this.g.innerHTML=uj[a];a=a.split("-");this.g.href=d.href.replace("{LN}",a[0]).replace("{CN}",a[1].toLowerCase());this.S.style.font=d.font};mj.prototype.setOptions=mj.prototype.Ei;
function nj(a,b,c,d,e){a=a.createElement(b);c&&(a.style.cssText=c);d&&(a.innerHTML=d);e&&(a.className=e);return a}mj.prototype.G=function(){return this.S};mj.prototype.c=function(){this.f.innerHTML=this.i+" "+this.sa()};mj.prototype.b=function(){this.c();setTimeout(this.c,5E3)};
var pj='<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',tj=
{nl:"#0F1621",ol:.3,il:"#fff",jl:.6},sj={nl:"#fff",ol:1,il:"#0F1621",jl:.7},vj="1987&ndash;"+wd(2015,(new Date).getFullYear())+" HERE";mj.prototype.sa=function(){var a=this.a,b=a.tb(),c=a.b.sb().bounds;a=a.a;var d=a.a.length,e={},f=0,g,h,k,l=[vj];if(c)for(;f<d;f++)if(h=a.get(f).getCopyrights(c.F(),b))for(g=0;g<h.length;g++)e[k=h[g].label]||(l.push(k),e[k]=1);return l.join(", ")};mj.prototype.getCopyrights=mj.prototype.sa;mj.prototype.ta=function(){return this.S.style};mj.prototype.i=String.fromCharCode(169);
mj.prototype.u=function(){this.a.removeEventListener(this.a.o.dj,this.c);this.a.a.removeEventListener("add",this.b);this.a.a.removeEventListener("remove",this.b);this.a.a.removeEventListener("set",this.b);if(this.S.parentNode){var a=this.S;a.parentNode.removeChild(a)}};
mj.prototype.capture=function(a,b,c,d){var e=a.getContext("2d"),f=window.getComputedStyle(this.f.parentElement),g=2*Ac(f.paddingLeft,10),h=(this.f.offsetWidth+2*g)*b,k=this.f.offsetHeight*b,l=Bc(f.getPropertyValue("font-size")),m=this.S.ownerDocument,q=+a.width,p=+a.height,r=oj*b,v=this.Af.childNodes[0].getBoundingClientRect(),w=v.width*b,z=v.height*b,J=id;Ca(d)&&(J=function(){d("capture_error")});e.fillStyle=f.backgroundColor;e.fillRect(q-h,p-k,h,k);h=this.i+" "+function(G){G=nj(m,"div",null,G);
return G.textContent||G.innerText||""}(this.sa());e.font=l*b+"px "+f.getPropertyValue("font-family");e.fillStyle=f.getPropertyValue("color");e.textBaseline="bottom";e.textAlign="right";e.fillText(h,q-g*b,p);wj(this,e.font,function(G){(new rf("image",G)).then(function(V){e.drawImage(V,r,p-(z+r),w,z);c(a)},J)},J)};mj.prototype.capture=mj.prototype.capture;
function wj(a,b,c,d){xj(A(function(e){e?this.Ih?c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC"):c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):
(e=this.Af.cloneNode(!0),e.firstChild.setAttribute("style","font:"+b),c($e(e.innerHTML)))},a),d)}mj.prototype.Ih=!1;function xj(a,b){var c="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(pj),d=rj;tc(d)?a(d):(new rf("image",c)).then(function(e){We.drawImage(e,0,0);try{We.getImageData(0,0,1,1),d=!1}catch(f){d=18===f.code}finally{rj=d,a(d)}},b)}
var uj={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki \u015bwiadczenia us\u0142ugi","pt-BR":"Termos de servi\u00e7o","pt-PT":"Termos do servi\u00e7o","ru-RU":"\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f","tr-TR":"Servis Ko\u015fullar\u0131",
"zh-CN":"\u4f7f\u7528\u6761\u6b3e"};function Q(a){var b={};this.i=b.previousSibling=b.nextSibling=b;this.j=new af;Q.l.constructor.call(this,a);a&&"objects"in a&&this.ec(a.objects)}u(Q,M);t("H.map.Group",Q);Q.prototype.type=Pg.GROUP;Q.prototype.le=function(a,b){this.f=!0;a=Q.l.le.call(this,a,b);this.f=!1;a&&this.forEach(yj,!0);return a};Q.prototype.setProvider=Q.prototype.le;function yj(a,b,c){a.le(c.a)}Q.prototype.contains=function(a){var b=this===a;if(!b&&this.b&&C(a,M))for(;!b&&a;)a===this?b=!0:a=a.Va;return b};
Q.prototype.contains=Q.prototype.contains;Q.prototype.hf=function(){this.D=B;this.forEach(zj,!0)};Q.prototype.resetZInfo=Q.prototype.hf;function zj(a){a.hf()}Q.prototype.f=!1;Q.prototype.ua=function(a){var b=Q.l.ua.call(this,a);b&&!this.f&&(this.g=a,this.forEach(Aj,!0),delete this.g);return b};Q.prototype.invalidate=Q.prototype.ua;function Aj(a,b,c){a.ua(c.g)}
Q.prototype.forEach=function(a,b,c){var d;if(this.b){var e=this.i;var f=e.nextSibling;for(d=0;f!==e;){var g=f.nextSibling;a.call(c,f,d++,this);b&&C(f,Q)&&f.forEach(a,b,c);f=g}}};Q.prototype.forEach=Q.prototype.forEach;Q.prototype.Ta=function(a){var b=[];this.forEach(Bj,a,b);return b};Q.prototype.getObjects=Q.prototype.Ta;Q.prototype.F=function(){var a=null;this.b&&this.forEach(function(b){(b=b.F())&&(a?a=a.mc(b):a=b)});return a};Q.prototype.getBoundingBox=Q.prototype.F;
function Bj(a){this.push(a)}Q.prototype.b=0;Q.prototype.jm=function(){return this.b};Q.prototype.getChildCount=Q.prototype.jm;
Q.prototype.ea=function(a){var b=this.i,c=b.previousSibling;C(a,M,this.ea,0);if(a.contains(this))throw new Yc(this.ea,"The new object contains the parent group");var d=a.Xf(!0);var e=a.Va;if(e!==this){if(e){e=a.previousSibling;var f=a.nextSibling;e.nextSibling=f;f.previousSibling=e}a.Va=this;M.l.ja.call(a,this);c.nextSibling=a;a.previousSibling=c;a.nextSibling=b;b.previousSibling=a;this.b++}a.Mi=this.j.next();a.hf();b=a.le(this.a,this.ea);a.Xf(!0)^d&&a.ua(Mg.VOLATILITY);b||a.ua(Mg.Z_ORDER);return a};
Q.prototype.addObject=Q.prototype.ea;Q.prototype.ec=function(a){var b;yc(a,this.ec,0);var c=a.length;for(b=0;b<c;b++)this.ea(a[b])};Q.prototype.addObjects=Q.prototype.ec;Q.prototype.Ha=function(a){if(!a||a.Va!==this)throw new Yc(this.Ha,"object not found");var b=a.previousSibling,c=a.nextSibling;b.nextSibling=c;c.previousSibling=b;a.Va=null;M.l.ja.call(a,null);delete a.previousSibling;delete a.nextSibling;C(a.a,N)&&a.le(null,this.Ha);this.b--;return a};Q.prototype.removeObject=Q.prototype.Ha;
Q.prototype.xd=function(a){var b;yc(a,this.xd,0);var c=a.length;for(b=0;b<c;b++)this.Ha(a[b])};Q.prototype.removeObjects=Q.prototype.xd;Q.prototype.ra=function(){var a=this.Ta();this.xd(a)};Q.prototype.removeAll=Q.prototype.ra;
Q.prototype.Rc=function(a){for(var b=this.Ta(),c=0,d=b.length,e=[],f,g,h;c<d;c++)h=b[c],h instanceof Q?(f=a?a(h.getData()):h.getData(),g=Tg(this,f,!!a),f={type:"Feature"},f.properties=g,h.m&&(f.id=h.m),f.geometry={},f.geometry.type="GeometryCollection",f.geometry.geometries=Cj(this,h.Ta()),e.push(f)):e.push(h.Rc(a));return{type:"FeatureCollection",features:e}};Q.prototype.toGeoJSON=Q.prototype.Rc;
function Cj(a,b){for(var c=0,d=b.length,e,f,g=[];c<d;c++)e=b[c],f={},e instanceof Q?(f.type="GeometryCollection",f.geometries=Cj(a,e.Ta())):f=e.ba().Rc(),g.push(f);return g}Q.prototype.W=function(){var a=Q.l.W.call(this);a.type="Group";return a};Q.prototype.forWorkerMessage=Q.prototype.W;function Dj(a,b,c,d,e){b&&(this.b=b);tc(c)&&(this.Qg=!!c);this.Qg&&d&&(this.Sg=new Ki(d.w,d.h));tc(e)&&(this.c={crossOrigin:e});switch(Ej[xc(a)]){case 2:this.vd=a;Fj(this,1);break;case 1:if(lf(a)){this.vd=a;Gj(this);Fj(this,1);break}a=a.src;case 0:if(a){a=$e(a);this.a=new rf("image",a,B,this.c);this.a.then(A(this.jo,this),A(this.io,this));break}default:throw Fj(this,-1),new D(Dj,0,"No image data");}}n=Dj.prototype;n.A=0;n.getState=function(){return this.A};
function Fj(a,b){a.A=b;delete a.a;a.b&&a.b(b,a)}n.Qg=!0;function Gj(a){if(a.Qg){var b=a.vd,c=Hj(a),d=c&&c.w||+b.width,e=c&&c.h||+b.height,f=Se();if(C(b,x.HTMLCanvasElement))c=b;else{c=b.ownerDocument.createElement("canvas");c.width=zd(d*f);c.height=zd(e*f);var g=c.getContext("2d");g.scale(f,f);g.drawImage(b,0,0,d,e);$c&&(g.clearRect(0,0,d,e),g.drawImage(b,0,0,d,e))}a.vd=c}}n.vd=y;n.getData=function(){return this.vd};var Ej={String:0,HTMLImageElement:1,HTMLCanvasElement:2};n=Dj.prototype;n.Sg=y;
n.Bb=function(){return 1===this.A?Hj(this):y};function Hj(a){var b=a.Sg,c;if(!b){var d=a.vd;b=d.naturalWidth||d.width;if(0===b&&Ye&&1===Ej[xc(d)]){var e=!0;if(c=d.parentNode)var f=d.nextSibling;document.body.appendChild(d)}a.Sg=b=new Ki(d.naturalWidth||d.width,d.naturalHeight||d.height);e&&(c?c.insertBefore(d,f):document.body.removeChild(d))}return b}n.jo=function(a){this.vd=a;Gj(this);Fj(this,1)};n.io=function(){Fj(this,-1)};n.cancel=function(){this.a&&this.a.cancel()};function Ij(a,b){var c,d="anonymous";this.uid=Jj.next();Ij.l.constructor.call(this);if(b){var e="size";if(e in b){var f=b[e];if(!f||isNaN(f.w)||isNaN(f.h))throw new D(Ij,1,e);this.c=new Ki(f.w,f.h)}e="anchor";if(e in b){f=b[e];if(!f||isNaN(f.x)||isNaN(f.y))throw new D(Ij,1,e);this.b=new I(f.x,f.y)}e="hitArea";e in b&&(f=b[e],C(f,Li,Ij,1),this.g=b[e]);e="asCanvas";e in b&&(c=b[e]);e="crossOrigin";e in b&&(d=b[e]);f=b.stickHeight;f===+f&&0<f&&(this.Ho=f);e="stickColor";f=b[e];e in b&&zc(f)&&(this.Go=
f)}a=new Dj(a,A(this.i,this),c,this.c,d);b=this.A=a.getState();0!==b?this.i(b,a):this.f=a}u(Ij,F);t("H.map.Icon",Ij);var Jj=new af;Ij.State={ERROR:-1,LOADING:0,READY:1};Ij.prototype.getState=function(){return this.A};Ij.prototype.getState=Ij.prototype.getState;Ij.prototype.i=function(a,b){this.a=b.getData();if(1===a){var c=this.c;c||(c=this.c=b.Bb());this.b||(this.b=new I(c.w/2|0,c.h))}this.f&&(this.A=a,delete this.f,this.dispatchEvent("statechange"))};Ij.prototype.a=y;Ij.prototype.Zc=function(){return this.a};
Ij.prototype.getBitmap=Ij.prototype.Zc;Ij.prototype.c=y;Ij.prototype.Bb=function(){return this.c};Ij.prototype.getSize=Ij.prototype.Bb;Ij.prototype.b=y;Ij.prototype.md=function(){return this.b};Ij.prototype.getAnchor=Ij.prototype.md;Ij.prototype.g=y;Ij.prototype.Cm=function(){return this.g};Ij.prototype.getHitArea=Ij.prototype.Cm;Ij.prototype.u=function(){Ij.l.u.call(this);this.a?(this.a.removeAttribute("src"),delete this.a):(this.f.cancel(),delete this.f)};function Kj(a,b,c,d,e,f){Kj.l.constructor.call(this,isNaN(a)?15:a,b,c,d,e,f)}u(Kj,hg);Kj.prototype.m=function(a){for(var b,c,d,e=this.head;a;){if(b=a.entries)if(c=b.length){if(2>c&&(d=a.parent)&&1===d.a){d.removeChild(a);e===a&&(e=d);d.entries=b;a=b[0].node=d;continue}}else if(delete a.entries,d=a.parent)if(d.removeChild(a),e===a&&(e=d),1===d.a){a=d.a?d[0]||d[1]||d[2]||d[3]:null;continue}a=y}this.head!==e&&(this.head=e,mg(this))};
Kj.prototype.Ec=function(a,b){if(rg(this.a,a,b,a,b))return Lj(this,this.a,a,b,this.c);throw Error("Coordinates out of bounds");};function Lj(a,b,c,d,e){var f=b.entries;if(e)if(b.a)f=Mj(a,b,c,d,e);else if(f){f=f[0];var g=pg(b,f[1]>=b[8]|(f[0]>=b[9])<<1);g.entries=b.entries;delete b.entries;f.node=g;mg(a,g);f=Mj(a,b,c,d,e)}else qg(b,f=new Nj(c,d)),mg(a,b),kg(a,f,!0);else f||mg(a,b),qg(b,f=new Nj(c,d)),kg(a,f,!0);return f}function Mj(a,b,c,d,e){return Lj(a,pg(b,c>=b[8]|(d>=b[9])<<1),c,d,e-1)}
function Nj(a,b){this.id=og++;this[0]=b;this[1]=a}Nj.prototype.od=function(a){return this[a%2]};function Oj(){this.a=new Kj(10,180,90,0,0,!0)}n=Oj.prototype;n.Qh=0;n.$c=function(){return this.Qh};n.R=null;n.F=function(){var a=this.R,b;!a&&(b=ig(this.a))&&(this.R=a=new K(-b[0],b[3],-b[2],b[1]));return a};n.Ec=function(a){++this.Qh;this.R=null;return this.a.Ec(a.lng,-a.lat)};n.remove=function(a){if(a=this.a.remove(a))--this.Qh,this.R=null;return a};
n.$f=function(a,b,c){var d=this.a,e=a.Rb(),f=a.Ob(),g=-e.lat;e=e.lng;var h=-f.lat;f=f.lng;var k;a.Fb()?k=d.$a(-180,g,f,h,c,b).concat(d.$a(e,g,180,h,c,b)):k=d.$a(e,g,f,h,c,b);return k};function Pj(a,b,c){this.c=a;this.a=b;this.g=c;this.f=this.c&1?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B;this.b={}};function Qj(a,b,c,d){this.a=a;this.b=b;this.c=c;this.vf=d}function Rj(a,b,c,d){a={type:b,uid:a.b,tiled:c,max_zoom:a.c};d&&Wa(a,d);return a};function Sj(a){this.a=a};function Tj(a,b,c,d,e){this.a=a;this.b=b;this.c=c;this.f=d;this.vf=e}
function Uj(a){if(a.a&32&&!(a.a&16))return{};var b=new Qj(a.a,a.b,a.c,a.vf);var c=new Sj(a.a);a=new Pj(a.a,a.b,a.f);var d={},e=b.b;b=b.a&1?Rj(b,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(b.a&256)}):b.a&2?Rj(b,"RemoteRasterTileSource",!0,{url:""}):Rj(b,"ObjectTileSource",!0,{tile_size:b.vf});d[e]=b;b={};c.a&2&&(b={"translucent-raster":Mh("raster","inlay",1)});if(c.a&28){e=!!(c.a&64);var f={"translucent-polygons":Mh("polygons","inlay",2),"translucent-extruded-polygons":Mh("polygons",
"translucent",3),"translucent-pattern-lines":Mh("pattern-lines","translucent",4),"translucent-overlays":Mh("overlays","inlay",5),markers:Mh("custom_icons","overlay",6,!1)};f["translucent-polygons"].crop_by_tile=!!(c.a&128);f["translucent-pattern-lines"].crop_by_tile=e;f.markers.suppress_fade=!0;f.markers.stick=!0;Wa(b,f)}a.c&2&&(a.b["tile_layer_"+a.a]=Oh(a.a,"_default",{"translucent-raster":{color:[1,1,1,a.g],order:0}}));if(a.c&4){c={"translucent-pattern-lines":{color:Lh("strokeColor"),width:Lh("lineWidth * $meters_per_pixel"),
join:Lh("lineJoin"),cap:Lh("lineCap"),tail_cap:Lh("lineTailCap"),head_cap:Lh("lineHeadCap"),miter_limit:Lh("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:Lh("lineDash"),extrude:!0,dash_phase:Lh("lineDashOffset")}};e=a.b;f="polygon_layer_"+a.a;var g=Oh(a.a,"polygons",void 0,a.f);g.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:Nh(!1)};g.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:Nh(!0)};
e[f]=g;a.b["outline_layer_"+a.a]=Oh(a.a,"outlines",c,a.f);a.b["polyline_layer_"+a.a]=Oh(a.a,"polylines",c,a.f)}a.c&8&&(a.b["overlay_layer_"+a.a]=Oh(a.a,"overlays",{"translucent-overlays":{color:[1,1,1,a.g],order:8190,interactive:!0}}));a.c&16&&(a.b["marker_layer_"+a.a]=Oh(a.a,"markers",{markers:{sprite:Kh("icon.id"),offset:Kh("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:Kh("icon.stick_color"),height:Kh("icon.stick_height")}}},a.f));return{sources:d,styles:b,
layers:a.b}};function bj(a){var b=""+cf(),c;bj.l.constructor.call(this);a=a||{};this.min=a.min||0;this.max=a.max||22;if(c=a.uri){if(/_/.test(c))throw new D(bj,0,"uri "+c);}else c=b;this.uri=c||b;this.uid=b;a.getCopyrights&&wc(a.getCopyrights,"Function",bj)&&(this.getCopyrights=a.getCopyrights);this.f=this.f.bind(this);this.za=!0}u(bj,F);t("H.map.provider.Provider",bj);bj.prototype.g={pe:"configchange",Da:"update"};function Vj(a,b,c){a.dispatchEvent(new sd(a.g.Da,c,b))}bj.prototype.f=function(){this.dispatchEvent(this.g.pe)};
bj.prototype.u=function(){F.prototype.u.call(this);this.b&&(this.b.removeEventListener("change",this.f),this.b=null)};bj.prototype.sa=function(){return null};bj.prototype.getCopyrights=bj.prototype.sa;bj.prototype.j=function(){var a=0;this.si()&&(a|=1);this.providesRasters()&&(a|=2);this.providesSpatials()&&(a|=4);this.providesOverlays()&&(a|=8);this.providesMarkers()&&(a|=16);this.providesDomMarkers()&&(a|=32);return a};bj.prototype.si=ef;bj.prototype.af=ef;bj.prototype.providesRasters=bj.prototype.af;
bj.prototype.Ic=ef;bj.prototype.providesSpatials=bj.prototype.Ic;bj.prototype.ti=ef;bj.prototype.providesOverlays=bj.prototype.ti;bj.prototype.Wb=ef;bj.prototype.providesMarkers=bj.prototype.Wb;bj.prototype.Vb=ef;bj.prototype.providesDomMarkers=bj.prototype.Vb;bj.prototype.oi=id;bj.prototype.i=1;function Wj(a,b){b=Yd(b,0,1);E(b)&&(b=1);a.i!==b&&(a.i=b,a.za&&Xj(a),a.f(),Vj(a))}bj.prototype.Tm=function(){return this.i};bj.prototype.getOpacityInternal=bj.prototype.Tm;
bj.prototype.Dd=function(a,b){this.b&&(this.b.removeEventListener("change",this.f),this.b.removeEventListener(Rh,this.f));this.b=a;this.b.addEventListener("change",this.f);this.b.addEventListener(Rh,this.f);b||this.f();this.za=!1};bj.prototype.setStyleInternal=bj.prototype.Dd;bj.prototype.Db=function(){this.b||Xj(this);return this.b};bj.prototype.getStyleInternal=bj.prototype.Db;function Xj(a){var b=new Tj(a.j(),a.uid,a.max,a.i,a.tileSize);a.b=new Th(Uj(b));a.za=!0}
function Yj(a){a=a.j();var b=Zj;a&1?b=ak:a&2?b=null:a&28&&(b=bk);return b}bj.prototype.ym=function(){return!1};bj.prototype.getFeatureProxy=bj.prototype.ym;function ck(a){var b;uc(this,ck);ck.l.constructor.call(this,a);this.wa=a=[];for(b in Pg)a[Pg[b]]=new Lg}u(ck,bj);t("H.map.provider.ObjectProvider",ck);ck.prototype.si=df;ck.prototype.providesByViewport=ck.prototype.si;ck.prototype.Qb=function(a){return this.wa[a||Pg.ANY]};ck.prototype.getInvalidations=ck.prototype.Qb;ck.prototype.$d=function(a,b){if(b!==Mg.NONE){var c=this.wa[Pg.ANY];var d=c.a+1;c.update(d,b);c=this.wa[a.type];c.update(d,b);a.Qb().update(d,b);Vj(this,a)}};
ck.prototype.invalidateObject=ck.prototype.$d;ck.prototype.requestOverlays=ck.prototype.yd;ck.prototype.requestSpatials=ck.prototype.sg;ck.prototype.requestSpatialsByTile=ck.prototype.tg;ck.prototype.vb=!1;ck.prototype.requestMarkers=ck.prototype.Kc;ck.prototype.requestDomMarkers=ck.prototype.Jc;function N(a){a=a||{};N.l.constructor.call(this,a);this.c=a=new Q({min:a.min,max:a.max});a.a=this;a.ja(this);a.ua(Mg.ADD);this.O=new wg;this.m=new wg;this.s=new Oj;this.v=new wg;this.D=new Oj;this.T=new wg}u(N,ck);t("H.map.provider.LocalObjectProvider",N);N.prototype.j=function(){return 125};N.prototype.Db=function(){if(!this.fa){this.fa=N.l.Db.call(this);var a=new Tj(this.j()|256,this.uid+"_vol",this.max,this.i,this.tileSize);this.fa.Ve(Uj(a))}return this.fa};N.prototype.jc=function(){return this.c};
N.prototype.getRootGroup=N.prototype.jc;N.prototype.$d=function(a,b){b&Mg.SPATIAL&&this.ea(a);N.l.$d.call(this,a,b)};N.prototype.invalidateObject=N.prototype.$d;
N.prototype.ea=function(a){var b;C(a,M,this.ea,0);if(a.a!==this)throw new Yc(this.ea,"foreign object");this.Ha(a);var c=a.type;if(c===Pg.MARKER)if((b=a.ba())instanceof Xf){var d=!0;c=this.s}else c=this.v;else c===Pg.DOM_MARKER?(b=a.ba())instanceof Xf?(d=!0,c=this.D):c=this.T:c=c===Pg.OVERLAY?this.O:this.m;d=d?c.Ec(b):c.Yj(a.F());d.Xi=a;a.la=d};
N.prototype.Ha=function(a){var b;if(a)if(a.a!==this){if(C(a,M))throw new Yc(this.Ha,"foreign object");}else if(b=a.la){var c=a.type;c===Pg.MARKER?this.s.remove(b)||this.v.remove(b):c===Pg.DOM_MARKER?this.D.remove(b)||this.T.remove(b):c===Pg.OVERLAY?this.O.remove(b):this.m.remove(b);delete b.Xi;delete a.la}};N.prototype.removeObject=N.prototype.Ha;
function dk(a,b,c,d,e,f,g){g=g||[];if(b.$c())for(a=b!==a.s&&b!==a.v,e=!e,b=b.$f(c,f,f),c=b.length,f=0;f<c;f++){var h=b[f].Xi;for(var k,l=yd(d),m=h;(k=m.v<=l&&m.s>=l)&&(m=m.Va););k&&(e||h.Cc(!0))&&(a||1===h.zb().getState())&&g.push(h)}return g}N.prototype.ti=function(){return 0<this.O.$c()};N.prototype.providesOverlays=N.prototype.ti;N.prototype.yd=function(a,b,c){return dk(this,this.O,a,b,c,!1).filter(function(d){return d.Zc()})};N.prototype.requestOverlays=N.prototype.yd;
N.prototype.Ic=function(){return 0<this.m.$c()};N.prototype.providesSpatials=N.prototype.Ic;N.prototype.sg=function(a,b,c){return dk(this,this.m,a,b,c,!1)};N.prototype.requestSpatials=N.prototype.sg;N.prototype.tg=function(a,b){return dk(this,this.m,a.Sf(),a.zL,b,!1)};N.prototype.requestSpatialsByTile=N.prototype.tg;N.prototype.Wb=function(){return 0<this.s.$c()+this.v.$c()};N.prototype.providesMarkers=N.prototype.Wb;N.prototype.Kc=function(a,b,c){return ek(this,a,b,c,!1)};
N.prototype.requestMarkers=N.prototype.Kc;function ek(a,b,c,d,e){var f=dk(a,a.s,b,c,d,e);dk(a,a.v,b,c,d,e,f);return f}N.prototype.Vb=function(){return 0<this.D.$c()+this.T.$c()};N.prototype.providesDomMarkers=N.prototype.Vb;N.prototype.Jc=function(a,b,c){return fk(this,a,b,c,!1)};N.prototype.requestDomMarkers=N.prototype.Jc;function fk(a,b,c,d,e){var f=dk(a,a.D,b,c,d,e);dk(a,a.T,b,c,d,e,f);return f}
function gk(a,b,c){var d=c.ba(),e,f=hk.bind(null,a);a=ik.bind(null,a);C(c,nh)?e=C(d,L)?f(d):d.oa.some(f):C(c,xi)?e=C(d,P)?a(d):d.oa.some(a):C(c,jk)&&(e=a(ni(d)));e&&b.push(c)}function hk(a,b){a:{var c=b.X;var d=ti(a,b);if(!d){b=b.X.length;for(var e=0;e<b;e+=3)if(qi(a,c[e],c[e+1])){a=!0;break a}}a=d}return a}function ik(a,b){return ui(a,b)}
function kk(a,b,c){for(var d=a.length;d--;){var e=a[d],f=e.ba();if(C(f,Ji)){f=f.oa;for(var g=f.length,h;g--;)if(h=f[g],qi(b,h.lat,h.lng)){c.push(e);break}}else qi(b,f.lat,f.lng)&&c.push(e)}}
N.prototype.Ta=function(a,b,c,d,e){for(var f=this,g=a.F(),h=[],k=Xb(),l=1;l&Pg.ANY;){if(l&d)switch(l){case Pg.MARKER:k=k.then(function(){return ek(f,g,c,b,!0)}).then(function(m){return kk(m,a,h)});break;case Pg.DOM_MARKER:k=k.then(function(){return fk(f,g,c,b,!0)}).then(function(m){return kk(m,a,h)});break;case Pg.SPATIAL:k=k.then(function(){return dk(f,f.m,g,c,b,!0)}).then(function(m){m.forEach(gk.bind(null,a,h))});break;case Pg.OVERLAY:k=k.then(function(){return dk(f,f.O,g,c,b,!0)}).then(function(m){m.forEach(gk.bind(null,
a,h))})}l<<=1}k.then(function(){return e(h)})};N.prototype.u=function(){N.l.u.call(this);this.c.ra()};var lk={PENDING:0,ACTIVE:1,DONE:2};t("H.map.render.RenderState",lk);function mk(a,b){b=b||{};var c;if(!C(a,Element))throw new D(mk,0,a);var d=a.ownerDocument.createElement("div");this.S=a;mk.l.constructor.call(this);this.padding=new nk(0,0,0,0);this.center=new I(0,0);this.margin=0;this.element=d;d.style.zIndex=0;d.style.height=d.style.width="100%";d.style.position="relative"===a.style.position?"absolute":"relative";this.resize();a.appendChild(d);(c=b.padding)!==B&&this.Fi(c.top,c.right,c.bottom,c.left);this.Ai((c=b.margin)!==B?c:0)}u(mk,F);
t("H.map.ViewPort",mk);mk.prototype.a={Da:"update",se:"sync"};mk.prototype.Ai=function(a){if(this.margin!==+a){if(E(this.margin=+a))throw new D(this.Ai,0,a);ok(this);this.dispatchEvent(this.a.Da)}};mk.prototype.setMargin=mk.prototype.Ai;mk.prototype.Fi=function(a,b,c,d){var e=this.padding;if(e.top!==a||e.right!==b||e.bottom!==c||e.left!==d){if(E(a+b+c+d))throw new D(this.Fi);e.top=a;e.right=b;e.bottom=c;e.left=d;ok(this);this.dispatchEvent(this.a.Da)}};mk.prototype.setPadding=mk.prototype.Fi;
function ok(a){var b=a.padding;a.center.set((a.width+b.left-b.right)/2<<0,(a.height+b.top-b.bottom)/2<<0)}mk.prototype.resize=function(){var a=this.S.offsetWidth,b=this.S.offsetHeight;if(this.width!==a||this.height!==b)this.c=new Ki(this.width,this.height),this.width=a,this.height=b,ok(this),this.dispatchEvent(this.a.Da)};mk.prototype.resize=mk.prototype.resize;mk.prototype.ab=function(a){this.dispatchEvent(new Ri(this.a.se,this.c,a,Si.SIZE))};mk.prototype.synchronize=mk.prototype.ab;
mk.prototype.u=function(){x.clearTimeout(this.b);this.b=null;this.S.removeChild(this.element);this.element=this.S=null;mk.l.u.call(this)};mk.prototype.sc=Nc;mk.prototype.startInteraction=mk.prototype.sc;mk.prototype.kc=Nc;mk.prototype.interaction=mk.prototype.kc;mk.prototype.yb=Nc;mk.prototype.endInteraction=mk.prototype.yb;function pk(a,b,c,d,e,f){var g;for(g=[];d<=e;d++)g=g.concat(qk(a,c,d));a=g.length;ij.call(this,f,a);this.j=c=[];this.f=A(this.f,this);this.c=A(this.c,this);for(this.P(1);a--;)f=g[a],c.push(rk(b,f[0],f[1],f[2],this.f,this.c))}u(pk,ij);pk.prototype.f=function(){kj(this,2)};pk.prototype.c=function(){kj(this,4)};pk.prototype.ve=function(){for(var a=this.j,b=a.length;b--;)a[b].cancel();this.j=y};function sk(){}t("H.util.ICancelable",sk);sk.prototype.cancel=function(){};sk.prototype.cancel=sk.prototype.cancel;function tk(a,b){var c=this;if(!Ca(b))throw new D(uk,1,b);if(!Ca(a.next||Ca(a.cycle)))throw new D(tk,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.b=[];this.c=[];this.g=a;this.i=b;this.j=function(){vk(c)};this.a=null;this.f=function(){c.a||(c.a=x.setTimeout(c.j,1))}}t("H.util.AsyncQueue",tk);tk.prototype.push=function(a,b){if(!Ca(b))throw new D(this.push,1,b);a=wk(new xk,a,this.f,b);this.b.push(a);this.f();return a};tk.prototype.push=tk.prototype.push;
function vk(a){var b=a.c,c=0,d=a.g;d.a();for(a.a=null;c<b.length;){var e=b[c];e.bk?b.splice(c,1):c++}for(;e=d.next(a.b,a.c);)e.cancelled?e.done(null,"cancelled"):(b.push(e),a.i(e,e.data))}function xk(){wk(this,null,null,null)}tk.Task=xk;function wk(a,b,c,d){a.data=b;a.cancelled=!1;a.bk=!1;a.b=c;a.c=d;a.a=null;return a}xk.prototype.done=function(a,b){this.bk=!0;this.b();this.c(this,a,b)};xk.prototype.done=xk.prototype.done;xk.prototype.cancel=function(){this.a&&this.a();this.cancelled=!0};
xk.prototype.cancel=xk.prototype.cancel;xk.prototype.Ao=function(a){this.a=a;return this};xk.prototype.setCancelFn=xk.prototype.Ao;function yk(){}tk.Mode=yk;yk.prototype.next=function(){};yk.prototype.a=function(){};function zk(a,b){zk.l.constructor.call(this,new Ak(a),b)}u(zk,tk);t("H.util.SequentialQueue",zk);function Ak(a){if(isNaN(a)||0>a)throw new D(zk,1,'Argument "maxTime" must be a positive number');this.b=a;this.Qc=Bk()}Ak.prototype.next=function(a){return a.length&&Bk()-this.Qc<this.b?a=a.shift():null};Ak.prototype.a=function(){this.Qc=Bk()};function Ck(a){uc(this,Ck);Ck.l.constructor.call(this,a);if(a&&"tileSize"in a){var b=Bd(+a.tileSize)/Ld;if(isNaN(b)||b%1||0>b||30<b)throw new D(Ck,0,"tileSize: "+a.tileSize);this.tileSize=+a.tileSize}}u(Ck,bj);t("H.map.provider.TileProvider",Ck);function Dk(a,b){return Vd(a)-8-xd(Vd(b))}Ck.getZoomLevelOffset=Dk;Ck.prototype.qd=function(a,b,c){return this.uri.concat("_",a,"_",b,"_",c)};Ck.prototype.getTileKey=Ck.prototype.qd;Ck.prototype.vf=256;Ck.prototype.tileSize=Ck.prototype.vf;function Ek(){}t("H.util.ICache",Ek);Ek.prototype.add=function(){};Ek.prototype.add=Ek.prototype.add;Ek.prototype.get=function(){};Ek.prototype.get=Ek.prototype.get;Ek.prototype.Lf=function(){};Ek.prototype.drop=Ek.prototype.Lf;Ek.prototype.forEach=function(){};Ek.prototype.forEach=Ek.prototype.forEach;Ek.prototype.ra=function(){};Ek.prototype.removeAll=Ek.prototype.ra;Ek.prototype.fe=function(){};Ek.prototype.registerOnDrop=Ek.prototype.fe;Ek.prototype.bh=function(){};
Ek.prototype.deRegisterOnDrop=Ek.prototype.bh;function Fk(a,b,c){this.g=[];b&&this.fe(b);if(c&&!Ca(c))throw new D(Fk,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ci(a)}t("H.util.Cache",Fk);Fk.prototype.add=function(a,b,c){var d,e;c=+c;if(!Cc(c)||0>c)throw new D(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&Gk(this,d),this.b+=c-d.size,d.size=c,d.data=b,Hk(this,d)):this.a[a]=Ik(this,{id:a,data:b,size:c,nc:null,ed:null},this.c),Jk(this);return e};Fk.prototype.add=Fk.prototype.add;
Fk.prototype.fe=function(a){if(!Ca(a))throw new D(this.fe,0,a);this.g.push(a)};Fk.prototype.registerOnDrop=Fk.prototype.fe;Fk.prototype.bh=function(a){this.g=this.g.filter(function(b){return b!==a})};Fk.prototype.deRegisterOnDrop=Fk.prototype.bh;Fk.prototype.get=function(a,b){return(a=b?this.a[a]:Hk(this,this.a[a]))&&a.data};Fk.prototype.get=Fk.prototype.get;Fk.prototype.Lf=function(a){var b;(b=this.a[a])&&Kk(this,b,!0)};Fk.prototype.drop=Fk.prototype.Lf;
Fk.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};Fk.prototype.forEach=Fk.prototype.forEach;Fk.prototype.ra=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&Kk(this,this.a[b],!0)}};Fk.prototype.removeAll=Fk.prototype.ra;Fk.prototype.Ci=function(a){if(!(0<+a))throw new D(Fk.prototype.Ci,0,a);this.i=+a;Jk(this);return this};Fk.prototype.setMaxSize=Fk.prototype.Ci;Fk.prototype.Qm=function(){return this.i};
Fk.prototype.getMaxSize=Fk.prototype.Qm;Fk.prototype.pm=function(){return this.b};Fk.prototype.getCurrentSize=Fk.prototype.pm;function Hk(a,b){b&&(a.c=Ik(a,b,a.c));return b}function Jk(a){for(;a.b>a.i&&a.f;)Kk(a,a.f,!0)}function Ik(a,b,c){if(c!==b){(b.nc||b.ed)&&Kk(a,b,!1);if(b.nc=c)b.ed=c.ed,c.ed=b;b.ed||(a.c=b);b.nc||(a.f=b);a.b+=b.size}return b}function Kk(a,b,c){var d=b.ed,e=b.nc;if(d||e||b==a.c&&b==a.f)d?d.nc=e:a.c=e,e?e.ed=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],Gk(a,b));b.nc=b.ed=null}
function Gk(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};var Lk,Mk=function(){function a(){}for(var b,c,d,e=rc("o ms moz webkit "),f=5;f--&&!b;)b=e[f],b=(c=x[b+(b?"R":"r")+"equestAnimationFrame"])&&!E(c.call(window,a))&&(d=x[b+(b?"C":"c")+"ancelAnimationFrame"]);Lk=b?function(g){return c.call(x,g)}:function(g){return x.setTimeout(g,25)};return b?function(g){return d.call(x,g)}:function(g){return x.clearTimeout(g)}}(),Bk=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Nk(a,b,c,d){this.key="";this.x=a;this.y=b;this.z=c;this.data=d;this.valid=!0}t("H.map.provider.Tile",Nk);function Ok(a,b,c,d){a-=c;b-=d;return a*a+b*b}function Pk(a,b,c){return Qk(a,b*b,c||0,0,a.length-1)}t("H.math.simplifyDP",Pk);
function Qk(a,b,c,d,e){var f=0,g=d,h=a[d].x,k=a[d].y,l=a[e].x,m=a[e].y,q=d+1,p=Ok(h,k,l,m);if(p)for(;q<e;){var r=a[q++];var v=r.x;r=r.y;var w=((v-h)*(l-h)+(r-k)*(m-k))/p;v=0>w?Ok(v,r,h,k):1<w?Ok(v,r,l,m):Ok(v,r,h+w*(l-h),k+w*(m-k));v>f&&(f=v,g=q-1)}else for(;q<e;)r=a[q++],v=r.x,r=r.y,v=Ok(v,r,h,k),v>f&&(f=v,g=q-1);f>=b||0<c&&g-d?(--c,1<g-d?(d=Qk(a,b,c,d,g),d.splice(d.length-1,1)):d=[a[d]],d=1<e-g?d.concat(Qk(a,b,c,g,e)):d.concat(a.slice(g,e+1))):d=[a[d],a[e]];return d};function Rk(a,b,c,d,e,f,g,h){Rk.l.constructor.call(this,b,c,d,null);this.key=a;this.aa=h;this.a=e;this.g=f;this.i={};this.zL=g;this.o=zd(O.MAX_LINE_WIDTH/2*this.g+1)}u(Rk,Nk);t("H.map.provider.SpatialTile",Rk);Rk.prototype.c=Ud;Rk.prototype.s=Ud;Rk.prototype.b=Ud;function Sk(a){return a.aa.getInvalidations(Pg.SPATIAL)}
function Tk(a){var b=Sk(a),c=b.a,d=a.c,e=d===c,f;if(!(e||b.$j(d)||b.Kh(d))){e=a.f;var g=a.i;if(b.bg(d))for(f=e.length;f--;){var h=e[f];if(h.Qb().bg(d)){e.splice(f,1);var k=k||Uk(a,h.fb())}}if(b.Lh(d)){for(f=e.length;f--;)if(h=e[f],h.Qb().Lh(d)){var l=1;if((h=g[h.fb()])&&h.a){k=1;break}}l&&e.sort(Vk)}if(!k&&b.be(d))for(f=e.length;f--;)if(e[f].Qb().be(d)){var m=1;break}a.s!==d||m||(a.s=c,a.b!==d||k||(a.b=c));a.c=c;e=!0}return e}
Rk.prototype.ae=function(){var a=Sk(this),b=a.a,c=this.b,d=c===b;d||(this.aa.vb&&!a.be(c)?d=!0:Tk(this)&&(d=this.b===b));return d};Rk.prototype.isCanvasValid=Rk.prototype.ae;Object.defineProperty(Rk.prototype,"valid",{get:function(){return this.ae()},set:id,configurable:!0});function Wk(a,b){this.b=a;this.a=b}function Uk(a,b){a=a.i;var c=a[b];if(c)return delete a[b],c.a}Rk.prototype.f=ff;
function Xk(a){var b=Sk(a),c=a.c,d=a.f,e;if(!Tk(a)){for(e=d.length;e--;){var f=d[e];var g=f.Qb();(g.bg(c)||g.Kh(c))&&Uk(a,f.fb())}a.f=a.aa.requestSpatialsByTile(a,!1,!1).sort(Vk);a.c=b.a}}function Vk(a,b){return Rg(Qg(a),Qg(b),!1)}Rk.prototype.Ta=function(){return this.f};Rk.prototype.getObjects=Rk.prototype.Ta;var Yk={};Rk.prototype.Pe=function(){var a=this.a+"_"+this.g,b=Yk[a];if(!b){b=-this.o;var c=this.a-b;b=Yk[a]=new nk(b,b,c,c)}return b};Rk.prototype.getPxClipRect=Rk.prototype.Pe;
Rk.prototype.Sf=function(){var a=this.rb;if(!a){var b=this.Uf();a=0;var c=this.a;this.z&&(c-=a+=this.Pe().top);a=this.rb=dg(b.Ye(new I(a,a)),b.Ye(new I(c,c)))}return a};Rk.prototype.getGeoClipRect=Rk.prototype.Sf;Rk.prototype.Uf=function(){var a=this.v;if(!a){var b=this.a;a=this.v=new Yi(B,b);a.Fa(this.z);a.x=this.x*b;a.y=this.y*b}return a};Rk.prototype.getPxProj=Rk.prototype.Uf;Rk.prototype.Za=function(){return this.g};Rk.prototype.getPixelRatio=Rk.prototype.Za;
Rk.prototype.pg=function(){var a=this.data;this.data=null;this.b=Ud;return a};Rk.prototype.releaseCanvas=Rk.prototype.pg;Rk.prototype.qg=function(){this.i={};delete this.f;this.c=Ud};Rk.prototype.releaseData=Rk.prototype.qg;
Rk.prototype.$=function(a){var b=a.getContext("2d"),c,d,e,f,g=0;Xk(this);if(this.b<this.c){var h=this.f;if(c=h.length){a.width=a.height=this.a;b.clearRect(0,0,this.a,this.a);var k=this.i;for(d=0;d<c;d++){var l=h[d];var m=l.fb();if(f=(e=k[m])?e.b:l.getGeometriesForTile(this)){if(e)l.Qb().be(this.b)&&(e.a=ch(l,f)),e=e.a;else{e=ch(l,f);var q;var p=f;for(var r=l.j?2:0,v=p.length;v--;){var w=p[v];if(w!==dh){var z=w.a;for(q=z.length;q--;)w=z[q],4<w.length&&(z[q]=Pk(w,.6,r))}}this.i[m]=new Wk(f,e)}if(e){b.save();
p=l.j?this.O:this.B;for(m=0;m<f.length;m++)p.call(this,l,f[m],l.ta(),b);if(f=l.getLabels(this))for(l=b,m=f.length;m--;)for(r=f[m],p=r.size,l.font=p+"px "+r.font,l.fillStyle=r.color,l.textAlign="center",l.translate(r.x,r.y),l.rotate(r.angle),p=r.lineHeight||1.375*p,v=r.lines,r=v.length;r--;)l.fillText(v[r],0,r*p);b.restore()}g|=e}}}this.data=g?a:null;this.s=this.b=this.c}else this.data&&(g=1);return 0<g};Rk.prototype.render=Rk.prototype.$;
Rk.prototype.B=function(a,b,c,d){var e;c.Re&&(Zk(d,c,this.g),$k(b,d,!1,!0,!1,this.a,this.o));c.Qe&&(e=a.g)&&e.Sb&&(al(d,e),bl(this,d,b,e,c.lineWidth))};
Rk.prototype.O=function(a,b,c,d){var e=c.Sb,f=c.Re,g,h=this.a,k=this.o;if(b===dh)e&&(al(d,c),d.fillRect(0,0,h,h));else{f&&Zk(d,c,this.g);if(c.Qe&&(g=a.g)){var l=c.lineWidth;g.Sb||(g=null)}a=b.c;if(a===Td){if(f||e)al(d,c),$k(b,d,!0,f,e,h,this.o);g&&(al(d,g),bl(this,d,b,g,l,0))}else e&&(al(d,c),$k(b,d,!0,!1,e,h,k,0,a)),f&&$k(b,d,!1,f,!1,h,k,a),g&&(al(d,g),bl(this,d,b,g,l,a))}};
function $k(a,b,c,d,e,f,g,h,k){var l=a.a,m=-g;g=f+g;h=h||0;k===B&&(k=l.length);if(e&&a===dh)b.fillRect(0,0,f,f);else if(k>h){b.beginPath();for(f=h;f<k;f++){var q=l[f];var p=q.length;if(q===wi)b.moveTo(m,m),b.lineTo(m,g),b.lineTo(g,g),b.lineTo(g,m);else{var r=q[0];b.moveTo(r.x,r.y);for(h=1;h<p;h++)r=q[h],b.lineTo(r.x,r.y)}c&&b.closePath()}c&&e&&b.fill(a.b!==Td?"evenodd":"nonzero");d&&b.stroke()}}
function Zk(a,b,c){var d;a.strokeStyle=b.strokeColor;a.lineWidth=b.lineWidth*c;a.lineCap=b.lineCap;a.lineJoin=b.lineJoin;a.miterLimit=b.miterLimit;a.setLineDash&&(d=b.lineDash)!==ff&&(a.setLineDash(d),a.lineDashOffset=b.lineDashOffset)}function al(a,b){a.fillStyle=b.fillColor}
function bl(a,b,c,d,e,f){var g=e*d.width/2;e=e*d.length/2;var h=e/2;d=2*e*d.frequency;var k=Cd(Dd(e,2)+Dd(g,2));a=a.a-k;a=new nk(k,k,a,a);c=c.a;var l,m,q,p,r,v,w,z=Md/2;f=f||0;for(k=c.length;k-- >f;){var J=0;var G=c[k];if(m=l=G.length){var V=G;m=V.length;for(q=0;--m;)q+=V[m].Ya(V[m-1]);m=(V=q)>=d}if(m)for(m=vd(yd(V/d),1E3),m=V/(m+1),q=m/2;--l;){for(p=(r=G[l]).Ya(v=G[l-1]);q<=J+p;){var T=r.x+(v.x-r.x)*(w=(q-J)/p);w=r.y+(v.y-r.y)*w;a.Hf(T,w)&&(b.save(),b.translate(T,w),b.rotate(-Jd((v.y-r.y)/(r.x-v.x))+
(r.x<v.x?z:-z)),b.beginPath(),b.moveTo(-g,-e),b.lineTo(0,e),b.lineTo(g,-e),b.lineTo(0,-h),b.closePath(),b.fill(),b.restore());q+=m}J+=p}}}var cl=[];
Rk.prototype.Ua=function(a,b,c){for(var d=this.f,e=d.length,f,g,h,k,l,m,q=ff,p,r=this.g;e--;)if(g=d[e],g.Cc(!0)&&(h=this.i[g.fb()])&&(k=h.b)){f=g.ta();m="none"!==f.fillColor&&g.j;p="none"===f.strokeColor?0:f.lineWidth*r;for(f=k.length;f--;){l=k[f];var v;if(!(v=m&&l===dh)&&(v=m||p)){var w;v=a;var z=b,J=m,G=p,V=l.b,T=l.c,ua=T!==Td,ea=l.a,ac=ea.length,sb=0,ad=0,si=!1;for(l=0;l<ac;l++){var Ie=ea[l];var Pb=l>=T;var Of=!Pb&&l>=V;if(Ie===wi&&J)Of?sb++:ad++;else{var Sc=Ie.length;cl.length=2*Sc;for(w=0;w<
Sc;w++){var Hp=Ie[w];cl[2*w]=Hp.x;cl[2*w+1]=Hp.y}w=J&&!Pb;Pb=ua&&!Pb?0:G;if(w||Pb)if(Pb=be(v,z,cl,Pb,w),Pb===ae.EDGE||Pb===ae.VERTEX){si=!0;break}else if(Pb===ae.SURFACE)if(Of)sb++;else if(ad++,V===Td)break}}v=si||0<ad&&!(sb%2)}if(v){q===ff&&(q=[]);q.push(g);break}}if(c&&q.length)break}return q};function dl(a,b){var c;dl.l.constructor.call(this,b);this.B=a;this.K=a=b.pixelRatio;this.tileSize=c=1<<xd(Vd((b.tileSize||256)*a));this.T=Dk(c,a);this.Th=A(this.Th,this);this.hi=A(this.hi,this);this.Uh=A(this.Uh,this);this.Sh=A(this.Sh,this);this.v=A(this.v,this);this.B.addEventListener(bj.prototype.g.Da,this.v,!1,this);this.c=[];this.m=new Fk(b.tileCacheSize||256,this.Th);this.s=new Fk(b.dataCacheSize||512,this.hi);this.D=new zk(20,this.Uh);this.a={};this.O=Bk()}u(dl,Ck);
dl.prototype.v=function(a){a.target.type===Pg.SPATIAL&&Vj(this,a.target)};dl.prototype.ib=function(a,b,c,d){var e=this.getTileKey(a,b,c),f;if(f=this.m.get(e,d)){if(d||f.ae())return f;d||this.m.Lf(e)}if((f=this.s.get(e,d))&&(d||Tk(f)))return a=this.c.pop()||document.createElement("canvas"),f.$(a)||this.c.push(a),this.m.add(e,f,1),f;d||((f=this.a[e])?f.count++:(f=this.D.push([e,a,b,c],this.Sh),f.count=1,this.a[e]=f))};dl.prototype.requestTile=dl.prototype.ib;dl.prototype.kd=function(){};
dl.prototype.Vc=function(a,b,c){this.Df(this.getTileKey(a,b,c))};dl.prototype.cancelTile=dl.prototype.Vc;dl.prototype.Df=function(a){var b;if(b=this.a[a])b.count--,b.count||(b.cancel(),delete this.a[a])};dl.prototype.cancelTileByKey=dl.prototype.Df;n=dl.prototype;n.Uh=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3];c=this.m.get(c)||new Rk(c,d,e,f,this.tileSize,this.K,f+this.T,this.B);d=c.data||this.c.pop()||document.createElement("canvas");c.$(d)||this.c.push(d);b.push(c);a.done(c)};
n.Sh=function(a,b){a=a.data[0];b&&this.m.add(a,b,1);delete this.a[a];Vj(this)};n.Th=function(a,b){b.data&&this.c.push(b.pg());this.s.add(a,b,1)};n.hi=function(a,b){b.qg()};n.u=function(){for(var a in this.a)this.a[a].cancel();this.m.ra();this.s.ra();this.c.length=0;dl.l.u.call(this)};function el(a,b){b=b||{};if(!a)throw new D(el,0,a);this.tileSize=a.tileSize;this.c={};aj.call(this,{min:void 0!==b.min?b.min:a.min,max:void 0!==b.max?b.max:a.max,minWorldSize:this.tileSize,projection:b.Jk,dark:b.dark,provider:a})}u(el,aj);t("H.map.layer.BaseTileLayer",el);el.prototype.Ge=function(a,b){var c=this.pixelProjection;if(!C(a,K))throw new D(this.Ge,0,a);if(!E(b)){var d=c.Sj();c.Fa(b)}a=fl(c.kb(a.Rb()),c.kb(a.Ob()));!E(d)&&c.Fa(d);return a};el.prototype.geoRectToRect=el.prototype.Ge;
el.prototype.Zd=function(a,b){var c=Dd(2,yd(b)),d=this.tileSize;if(!C(a,nk))throw new D(this.Zd,0,a);if(E(b=+b))throw new D(this.Zd,1,b);b=yd(a.left/d);b===c&&--b;var e=yd(a.right/d);e===c&&--e;return new nk(b,Yd(yd(a.top/d),0,c-1),e,Yd(yd(a.bottom/d),0,c-1))};el.prototype.getTileBounds=el.prototype.Zd;el.prototype.ib=function(a,b,c,d){return this.a.requestTile(a,b,c,d)};el.prototype.Vc=function(a,b,c){this.a.cancelTile(a,b,c)};el.prototype.cancelTile=el.prototype.Vc;
el.prototype.sa=function(a,b){return this.a.getCopyrights?this.a.getCopyrights(a,b):null};el.prototype.getCopyrights=el.prototype.sa;function gl(a,b,c,d,e){d=yd(d);var f=Dd(2,d),g=b.left,h=b.top,k=b.right;c=k+(c?f+(k===b.left?0:1):1);var l=b.bottom,m=[];if(e){var q=g+(1+k-g)/2+e.x/a.tileSize-.5;var p=h+(1+l-h)/2+e.y/a.tileSize-.5}for(;g<c;){for(h=b.top;h<=l;)a=g%f,m.push([a,h,d,e?Ad(q-g)+Ad(p-h):0]),h++;g++}return m}
function qk(a,b,c){c=yd(c);a.pixelProjection.Fa(c);b=a.Ge(b);var d=a.Zd(b,c);return gl(a,d,b.left>b.right,c)}
el.prototype.Oe=function(a,b,c,d,e,f){var g,h=[],k,l=this.a;f=null!=f?f:"__default__";var m=l.requestTile;if(!C(a,nk))throw new D(this.Oe,0,a);if(E(c=+c))throw new D(this.Oe,1,c);d||(g={});b=gl(this,a,b,c,e);if(a=b.length)for(d||b.sort(hl),c=a;c--;)e=b[c],d||(g[l.qd.apply(l,e)]=!0),e[3]=+d,(k=m.apply(l,e))&&h.push(k);if(!d){d=g;var q;g=this.c[f]||{};for(q in g)g.hasOwnProperty(q)&&g[q]&&!d[q]&&this.a.cancelTileByKey(q);this.c[f]=d}return{total:a,tiles:h}};el.prototype.getProviderTiles=el.prototype.Oe;
function hl(a,b){return b[3]-a[3]};function R(a){uc(this,R);R.l.constructor.call(this,a);this.dc=new il;this.fc=A(this.fc,this);this.T=jl;this.createTileInternal=this.kd.bind(this)}u(R,Ck);t("H.map.provider.RemoteTileProvider",R);R.prototype.Qd=function(){return 1};R.prototype.getEntryWeight=R.prototype.Qd;var jl=new Fk(65536);R.prototype.m={};R.prototype.fa={};R.prototype.Pb=function(){return this.T};R.prototype.getCache=R.prototype.Pb;R.prototype.O=ba(3);R.prototype.fc=function(a){var b=this.uri;return!a.indexOf(b)&&"_"===a.charAt(b.length)};
R.prototype.cacheFilter=R.prototype.fc;R.prototype.Xa=function(a,b){b.valid=!1};R.prototype.reload=function(a){var b=this.getCache();a?b.ra(this.fc):b.forEach(this.Xa,this,this.fc);kl(this);Vj(this,this,{isReload:!0})};R.prototype.reload=R.prototype.reload;R.prototype.Vg=function(){return!1};R.prototype.MAX_STORE_TIME=Infinity;R.prototype.Xd=function(){return this.dc};R.prototype.la=function(a,b){b(a)};
function rk(a,b,c,d,e,f){d=~~d;return a.requestInternal(b,c,d,function(g,h){a.Xd().put(a.qd(b,c,d),{raw:h&&h.raw||g,timestamp:x.Date.now()},e,f)},f,0)}R.prototype.requestInternal=R.prototype.J;
R.prototype.ib=function(a,b,c,d){var e=this;var f=this.getCache();if(E(a=+a))throw new D(this.ib,0,a);if(E(b=+b))throw new D(this.ib,0,b);if(E(c=+c))throw new D(this.ib,0,c);c=~~c;var g=this.getTileKey(a,b,c);f=f.get(g);f&&f.valid||d||this.m[g]||(f=B,this.requestTileAsPromise(a,b,c,d).then(function(h){Vj(e,h)},id));return f};R.prototype.requestTile=R.prototype.ib;
R.prototype.Pk=function(a,b,c,d){var e=this,f=this.getCache(),g=this.getTileKey(a,b,c),h=this.m,k=this.fa,l,m=this.Xd();if(k[g])return k[g];k[g]=k=new Ob(function(q,p){function r(v){var w,z;var J=function(G,V){z=e.createTileInternal(a,b,c,G,V);z.key=g;f.add(g,z,e.Qd(G));q(z);ll(e,g)};v&&(w=x.Date.now()-v.timestamp);v&&w<e.MAX_STORE_TIME?e.la(v.raw,J):(w&&m.remove(g),(z=f.get(g))&&z.valid||d?q(z||null):h[g]=e.requestInternal(a,b,c,J,p))}l=m.get(g,r,r)});h[g]||(h[g]=l);k.then(function(){ll(e,g)},function(){ll(e,
g)});return k};R.prototype.requestTileAsPromise=R.prototype.Pk;R.prototype.Ok=function(a,b){var c=this,d=a.id,e=a.tile.coords;return new Ob(function(f,g){c.Pk(e.x,e.y,e.z,b).then(function(h){var k=y;h=h.Ta?h.Ta():h.data;for(var l=h.length,m;l--;)if(m=h[l],m.fb()===d){k=m;break}f(k)},g)})};R.prototype.requestObjectAsPromise=R.prototype.Ok;function ll(a,b){delete a.m[b];delete a.fa[b]}function kl(a){for(var b in a.m)a.fc(b)&&a.cancelTileByKey(b)}var ml={cancel:function(){}};
R.prototype.kd=function(a,b,c,d){return new Nk(a,b,c,d)};R.prototype.Df=function(a){var b=this.m[a];b&&(b.cancel(),ll(this,a))};R.prototype.cancelTileByKey=R.prototype.Df;R.prototype.Vc=function(a,b,c){this.cancelTileByKey(this.getTileKey(a,b,c))};R.prototype.cancelTile=R.prototype.Vc;R.prototype.u=function(){R.l.u.call(this);this.getCache().ra(this.fc);kl(this)};function il(){}R.NullStorage=il;il.prototype.get=function(a,b){b();return ml};il.prototype.get=il.prototype.get;
il.prototype.put=function(a,b,c){c&&c()};il.prototype.put=il.prototype.put;il.prototype.clear=function(a){a&&a()};il.prototype.clear=il.prototype.clear;il.prototype.remove=function(a,b){b&&b()};il.prototype.remove=il.prototype.remove;function uk(a){uk.l.constructor.call(this,a);a&&(this.B={crossOrigin:a.crossOrigin||"anonymous",headers:a.headers||{}},this.v=a.getURL);if(!Ca(this.v))throw new D(uk,0,"getURL");Wj(this,a.opacity);this.c=x.URL||x.webkitURL;a=this.B.crossOrigin;if(!(a="anonymous"===a||"use-credentials"===a)){a=this.v(0,0,0);var b=window.location,c=document.createElement("a");c.href=a;a=c.hostname===b.hostname&&c.port===b.port&&c.protocol===b.protocol}(this.K=a&&!!rf.prototype.b.arraybuffer&&!!this.c)&&this.Pb().fe(A(this.wa,
this))}u(uk,R);t("H.map.provider.ImageTileProvider",uk);uk.prototype.pc=function(a){Wj(this,a)};uk.prototype.setOpacity=uk.prototype.pc;uk.prototype.ad=function(){return this.i};uk.prototype.getOpacity=uk.prototype.ad;uk.prototype.af=df;uk.prototype.providesRasters=uk.prototype.af;uk.prototype.Qd=function(){return this.tileSize};uk.prototype.getEntryWeight=uk.prototype.Qd;
uk.prototype.J=function(a,b,c,d,e,f){var g=this,h=this.v(a,b,c),k;a=null;if(h){var l=x.setTimeout(function(){g.K?(k=new rf("arraybuffer",h,f,g.B),k.then(function(m){return m.blob()}).then(function(m){var q=new Image;q.onload=A(d,null,q,{raw:m});q.onerror=A(e,null,"bad url");try{q.src=g.c.createObjectURL(m)}catch(p){}},e)):(k=new rf("image",h,f,g.B),k.then(d,e))},150);a={cancel:function(){k?k.cancel():x.clearTimeout(l)}}}else d(null);return a};uk.prototype.requestInternal=uk.prototype.J;
uk.prototype.la=function(a,b){var c=new Image;c.onload=function(){b(this)};c.src=this.c.createObjectURL(a)};uk.prototype.wa=function(a,b){(a=b.data)&&a instanceof HTMLImageElement&&this.c.revokeObjectURL(a.src)};function nk(a,b,c,d){this.left=+a;this.top=+b;this.right=+c;this.bottom=+d}t("H.math.Rect",nk);nk.prototype.set=nk;nk.prototype.set=nk.prototype.set;nk.prototype.Rb=function(){return this.c||(this.c=new I(this.left,this.top))};nk.prototype.getTopLeft=nk.prototype.Rb;nk.prototype.Ob=function(){return this.a||(this.a=new I(this.right,this.bottom))};nk.prototype.getBottomRight=nk.prototype.Ob;nk.prototype.Hf=function(a,b){return this.left<=a&&this.right>=a&&this.top<=b&&this.bottom>=b};
nk.prototype.containsXY=nk.prototype.Hf;function fl(a,b){return new nk(a.x,a.y,b.x,b.y)}nk.fromPoints=fl;nk.prototype.clone=function(){return new nk(this.left,this.top,this.right,this.bottom)};nk.prototype.clone=nk.prototype.clone;function nl(a,b){el.call(this,a,b)}u(nl,el);t("H.map.layer.TileLayer",nl);nl.prototype.zd=function(a,b,c,d,e){if(!C(a,K))throw new D(this.zd,0,a);if(E(b=+b))throw new D(this.zd,1,b);b=yd(b);this.pixelProjection.Fa(b);a=this.Ge(a);var f=this.Zd(a,b);return this.Oe(f,a.left>a.right,b,c,d,e)};nl.prototype.requestTiles=nl.prototype.zd;function ol(a,b){b=b?Ua(b):{};b.tileSize=b.tileSize||256;b.pixelRatio=b.pixelRatio||Se();b.max=24;this.c=new dl(a,b);this.f=new nl(this.c);b.minWorldSize=this.c.tileSize;b.provider=a;ol.l.constructor.call(this,b);this.tileSize=this.f.tileSize;this.j=A(this.j,this);this.c.addEventListener(this.c.g.Da,this.j);a.addEventListener(a.g.Da,this.j)}u(ol,aj);t("H.map.layer.ObjectLayer",ol);ol.prototype.j=function(a){a.currentTarget!==this.c&&a.target.type===Pg.SPATIAL||this.g()};var pl={markers:ff,total:0};
ol.prototype.Kc=function(a,b,c){var d=this.a,e;return d.providesMarkers()&&(e=d.requestMarkers(a,b,!0,c)).length?{markers:e,total:e.length}:pl};ol.prototype.requestMarkers=ol.prototype.Kc;ol.prototype.Jc=function(a,b,c){var d=this.a,e;return d.providesDomMarkers()&&(e=d.requestDomMarkers(a,b,!0,c)).length?{markers:e,total:e.length}:pl};ol.prototype.requestDomMarkers=ol.prototype.Jc;var ql={tiles:ff,total:0};
ol.prototype.zd=function(a,b,c,d){if(this.a.providesSpatials()){var e=this.f.zd(a,b,c,d);c||(c=this.c,e=Bk(),33<e-c.O&&(vk(c.D),c.O=e),e=this.f.zd(a,b,!0,d))}else e=ql;return e};ol.prototype.requestTiles=ol.prototype.zd;ol.prototype.ib=function(a,b,c,d){return this.f.ib(a,b,c,d)};ol.prototype.requestTile=ol.prototype.ib;ol.prototype.Vc=function(a,b,c){this.f.Vc(a,b,c)};ol.prototype.cancelTile=ol.prototype.Vc;var rl={overlays:ff,total:0};
ol.prototype.yd=function(a,b,c){var d=this.a,e=rl;d.providesOverlays&&d.providesOverlays()&&(a=d.requestOverlays(a,b,!0,c),b=a.length)&&(e={overlays:a,total:b});return e};ol.prototype.requestOverlays=ol.prototype.yd;ol.prototype.u=function(){this.c.C();this.f.C();this.a.dispose();ol.l.u.call(this)};function sl(a,b,c,d){var e=new nk(0,0,0,0);sl.l.constructor.call(this);if(!a)throw new D(sl,0,a);if(!b)throw new D(sl,1,b);if(!c)throw new D(sl,2,c);if("object"!==typeof d)throw new D(sl,3,d+" is not an object");if("number"!==typeof d.pixelRatio)throw new D(sl,3,d.pixelRatio+" is not a number");this.qa=d.pixelRatio;this.zoom=0;this.hb=Bd(this.qa)/Ld;this.U=new Yi;this.vb={1:e.clone(),2:e.clone(),4:e.clone()};this.b=new I(.5,.5);this.i=a;tl(this,this.qa);this.sc=A(this.sc,this);this.kc=A(this.kc,this);
this.yb=A(this.yb,this);a.startInteraction=this.sc;a.interaction=this.kc;a.endInteraction=this.yb;a.addEventListener(a.a.Da,this.T,!1,this);this.getCapabilities=this.getCapabilities;this.capture=this.capture;this.zoomAt=this.ne;this.relaunch=this.ha;this.dispose=this.C;this.screenToGeo=this.Wa;this.geoToScreen=this.Ga;this.screenToLookAtData=this.wg;this.O=b;this.rc=A(this.rc,this);this.control=A(this.control,this);this.xb=A(this.xb,this);b.startControl=this.rc;b.control=this.control;b.endControl=
this.xb;b.addEventListener(b.a.Da,this.Tg,!1,this);this.c=c;this.hg=A(this.hg,this);this.Te=A(this.Te,this);this.Ue=A(this.Ue,this);this.gg=A(this.gg,this);c.addEventListener(aj.prototype.b.Da,this.hg,!1,this);c.addEventListener(c.b.oe,this.Te,!1,this);c.addEventListener(c.b.qe,this.Ue,!1,this);c.addEventListener(c.b.re,this.gg,!1,this)}u(sl,F);t("H.map.render.RenderEngine",sl);
function tl(a,b){var c=a.i,d=c.width,e=c.height,f=c.padding,g=f.top,h=f.left,k=f.bottom;f=f.right;c=c.margin;var l=-(d+h-f)/2<<0,m=-(e+g-k)/2<<0;d+=l;e+=m;a=a.vb;a[1].set((l-c)*b,(m-c)*b,(d+c)*b,(e+c)*b);a[2].set(l*b,m*b,d*b,e*b);a[4].set((l+h)*b,(m+g)*b,(d-f)*b,(e-k)*b)}sl.prototype.T=function(){tl(this,this.qa)};
sl.prototype.u=function(){var a=this.i,b=this.O,c=this.c;a.removeEventListener(a.a.Da,this.T,!1,this);a.startInteraction===this.sc&&(a.startInteraction=mk.prototype.sc);a.interaction===this.kc&&(a.interaction=mk.prototype.kc);a.endInteraction===this.yb&&(a.endInteraction=mk.prototype.yb);b.removeEventListener(b.a.Da,this.Tg,!1,this);b.startControl===this.rc&&(b.startControl=ul.prototype.rc);b.control===this.control&&(b.control=ul.prototype.control);b.endControl===this.xb&&(b.endControl=ul.prototype.xb);
c.removeEventListener(aj.prototype.b.Da,this.hg,!1,this);c.removeEventListener(c.b.oe,this.Te,!1,this);c.removeEventListener(c.b.qe,this.Ue,!1,this);c.removeEventListener(c.b.re,this.gg,!1,this)};sl.prototype.control=function(){};sl.prototype.capture=function(){return Yb(Error("not implemented"))};function vl(a,b){a.style.transition="opacity 1.5s";Ce(a,"transitionend",b,!1);a.style.opacity=0}var wl={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};sl.InteractionModifiers=wl;n=sl.prototype;n.gk={hj:"render"};
n.hg=function(a){this.yk(a);this.ha()};n.Te=function(a){this.We(a.idx,a.added)};n.Ue=function(a){this.ii(a.idx,a.removed,a.type===this.c.b.re)};n.gg=function(a){a.removed&&this.Ue(a);this.Te(a)};n.yk=id;n.We=function(a,b){this.Gh(a,b);0===a&&this.Jb();C(b,aj)&&xl(this,b,!0);this.he();this.ha()};
n.Jb=function(){var a=this.c.La();if(0<a.length){var b=a[0].max;this.Fg=a[0].min;this.Jg=b}else a=this.getCapabilities().lookAt.zoom,b=a.max,this.Fg=a.min,this.Jg=b;a=yl(this,this.zoom);a!==this.zoom&&(this.zoom=a,this.U.Fa(a),this.ab())};n.ab=function(a){this.D=this.sb();a&&(this.D.position=a);this.D.zoom=this.zoom-this.hb;this.D.position.alt=0};n.Ko=0;n.heading=180;n.sb=function(){return zl(this,{position:this.U.projection.ng(this.b),zoom:this.zoom,tilt:this.Ko,heading:this.heading})};
function zl(a,b){b.tilt=Al(a,b.tilt);b.heading=Bl(a,b.heading);b.incline=a.getCapabilities().lookAt.incline.min;return b}function yl(a,b){var c=a.getCapabilities().lookAt.zoom;return Yd(b,wd(c.min,a.Fg),vd(c.max,a.Jg))}function Al(a,b){a=a.getCapabilities().lookAt.tilt;return Yd(b,a.min,a.max)}function Bl(a,b){a=a.getCapabilities().lookAt.heading;return Yd((b%360+360)%360,a.min,a.max)}
function xl(a,b,c){c=c?b.addEventListener:b.removeEventListener;c.call(b,b.b.fj,a.ji,!1,a);c.call(b,b.b.ej,a.ji,!1,a)}n.Gh=id;n.ii=id;n.Bo=function(a,b){this.B={before:a,after:b}};sl.prototype.setOnRenderCallbacks=sl.prototype.Bo;var Cl={P2D:0,WEBGL:1,HARP:2};sl.EngineType=Cl;var Dl={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:wl.ZOOM,COORD:wl.COORD},capture:!0};t("H.map.render.webgl.capabilities",Dl);function El(a){var b,c=this,d=x.H.gl;El.l.constructor.call(this);this.a=b=d.Scene.create(x.URL.createObjectURL(nf(JSON.stringify(Fl))),{viewport:a.viewport,container:a.tc,disableRenderLoop:!0,devicePixelRatio:a.devicePixelRatio,logLevel:"error"});a.ko&&b.subscribe({load:a.ko});b.subscribe({view_complete:function(){c.g=!0;a.Ak()}});var e=b.requestRedraw;b.requestRedraw=function(){e.apply(b);a.Ak()};this.i=A(this.i,this);this.f=A(this.f,this);this.j=0;this.c={};this.b={}}u(El,nd);El.prototype.g=!1;
function Gl(a){a=a.a.sources;var b;for(b in a){var c=a[b];if(c.hasPendingCommands&&c.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}El.prototype.$=function(){var a=x.H.gl.Task;this.a.immediateRedraw();a.setState({user_moving_view:this.a.view.user_input_active});a.processAll();return this.g&&!this.a.dirty&&!this.a.building&&!Gl(this)&&!Object.keys(this.b).length};function Hl(a){a.g=!1;a.a.resetViewComplete()}function Il(a){return a.a.view}
function Jl(a,b){function c(){var e=b.La(),f={},g={},h,k,l,m=++a.j,q,p;vh(g,Fl);for(k=0;k<e.length;k++){var r=e[k];if(h=r.pa()){var v=h.Db();if(v.getState()===Qh.READY){var w=v.nd();if(!Ta(w)){delete w.cameras;delete w.camera;f[k]=w=Hh(w,k);!C(r,ol)&&w.sources&&Ih(w,h.uid);for(l in w.sources){var z=w.sources[l];z.max_zoom=vd(h.max,Dl.lookAt.zoom.max);z.max_display_zoom=r.max;z.min_display_zoom=r.min;if(p=h.tileSize)2<=d&&256<p&&h instanceof uk&&(p/=2),z.tile_size=p}(q=v.gc())&&Jh(w,q);vh(g,w)}}}}vh(g.layers.skybox.draw.skybox.color,
g.scene.sky);a.a.config=g;return a.a.updateConfig().then(function(){var J={},G,V;if(m!==a.j)return!1;a.j=0;for(V in f){r=e[+V];var T=f[V].sources;for(G in T)if(T=a.a.sources[G])J[G]=T,T.initialize&&r.getProvider()&&T.initialize(r.getProvider(),a.i,a.a.getWorkers().length,T.tiled?B:a.a.tile_manager.getWorkerForTile(y,T))}for(G in a.c)!J[G]&&a.c[G].dispose&&a.c[G].dispose();a.c=J;return!0})}var d=a.a.pixelRatio();a.a.initialized?c():a.a.load(y,{blocking:!1}).then(c)}
El.prototype.i=function(a,b,c){var d=this,e=this.a.sources[a],f=c&&c.isReload;b?!0!==this.b[a]&&(this.b[a]||(this.b[a]={pl:{},Rg:[]}),C(b,Nk)?this.b[a].pl[b.x+"/"+b.y+"/"+b.z]=!0:(b=b.boundingBox,this.b[a].Rg.push(new K(b[0],b[1],b[2],b[3])))):this.b[a]=!0;e&&e.has_volatile_data?Kl(this,f):(x.clearTimeout(this.m),this.m=x.setTimeout(function(){return Kl(d,f)},Ll))};var Ll=100;
El.prototype.f=function(a){var b=!1,c=this.b[a.source.name],d=x.H.gl;if(c)if(!0===c)b=!0;else{var e=d.Tile.coord(d.Geo.wrapTile(a.coords));b=!!c.pl[e.key];if(!b)for(a=d.Geo.getTileBoundingBox(e,a.source.tile_size,O.MAX_LINE_WIDTH/2),a=dg(a.getTopLeft(),a.getBottomRight()),d=0;d<c.Rg.length;d++)if(c.Rg[d].sd(a,!0)){b=!0;break}}return b};function Kl(a,b){var c=a.a.tile_manager;c.removeTiles(a.f);c.updateTilesForView();b&&c.removeCachedTiles(a.f);Hl(a);a.b={}}El.prototype.nd=function(){return this.a.config};
function Ml(a,b,c,d){a.a.getFeatureAt(b,c,d);a.a.update()}function Nl(a){return a.a.screenshot(void 0).then(function(b){return new Ob(function(c,d){new Dj(URL.createObjectURL(b.blob),function(e,f){1===e?c(f.getData()):d()},!1)})})}El.prototype.Za=function(){return this.a.pixelRatio()};El.prototype.u=function(){var a=this.c;El.l.u.call(this);this.a.destroy();this.b={};a&&Object.keys(a).forEach(function(b){a[b].dispose()});x.clearTimeout(this.m);this.c=this.a=null};
var Fl={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}};function Ol(a,b){if(E(this.x=+a))throw new D(Ol,0,a);if(E(this.y=+b))throw new D(Ol,1,b);}Ol.prototype.add=function(a){return new Ol(this.x+a.x,this.y+a.y)};Ol.prototype.a=function(a){if(!C(a,Ol))throw new D(this.a,0,a);a=this.b(a);return a.x+a.y};Ol.prototype.b=function(a){if(!C(a,Ol))throw new D(this.b,0,a);return new Ol(this.x*a.x,this.y*a.y)};Ol.prototype.Fa=function(a){return new Ol(this.x*a,this.y*a)};function Pl(a){return Cd(a.a(a))};function Ql(a){a=a||gf;this.rb=tc(a.eo)?a.eo:3;this.aa=tc(a.bo)?a.bo:300;this.s=tc(a.Po)?a.Po:3;this.v=tc(a.Lo)?a.Lo:50;this.f=[];this.clear()}t("H.map.render.InteractionUtils",Ql);Ql.prototype.Hn=function(){return this.c};Ql.prototype.isGestureDetected=Ql.prototype.Hn;Ql.prototype.start=function(a,b){var c=wl.HEADING,d=wl.TILT;this.a&&this.clear();this.i=a;this.m=!!b;this.a=!0;this.c=!(a&(c|d))||a===c||a===d};Ql.prototype.start=Ql.prototype.start;
Ql.prototype.store=function(a,b,c,d,e){var f=!1;if(this.a){a=new Rl(a,b,c,d,e);f=a.c;this.o=this.b;this.b=a;if(this.g){if(this.j=!0,f){b=this.i;var g=this.c;if(!g&&this.j){e=wl.HEADING;var h=wl.TILT;c=wl.COORD;d=wl.ZOOM;var k=b&(c|h)?this.Ud(!0):Sl;var l=b&d?this.Of(!0):1;var m=b&e?Ad(this.nh(!0)):0;var q=Ad(k.x);var p=Ad(k.y);k=10<q||10<p;q=10<p&&p>3*q;l=.8>l||1.2<l;m=7<m;b&h&&(m||l||k&&!q?Tl(this,h):q&&(Tl(this,~h>>>0),g=!0));!g&&b&e&&b&(c|d)&&(l||k?(Tl(this,e),g=!0):m&&(Tl(this,h),g=!0));this.c=
g}}}else this.g=a,f||(this.c=!0);this.m&&this.f.push(a)}return f};Ql.prototype.store=Ql.prototype.store;Ql.prototype.clear=function(){this.f.length=0;this.a=this.m=this.j=this.c=!1;this.g=this.o=this.b=void 0};Ql.prototype.clear=Ql.prototype.clear;Ql.prototype.Gc=function(a){return 0<(this.i&a)};Ql.prototype.isModifierEnabled=Ql.prototype.Gc;function Tl(a,b){a.i^=a.i&b}Ql.prototype.Ea=function(){return this.a};Ql.prototype.isRunning=Ql.prototype.Ea;var Sl=oc(new Ol(0,0));
Ql.prototype.xc=function(){var a;if(this.m){var b=this.f;var c=b.length;var d=0;for(a=new Ol(0,0);--c&&d<this.s;)a=a.add(Ul(b[c-1],b[c])),d++}else a=this.Ud();b=a;c=Pl(b);return 0!==c?new Ol(b.x/c,b.y/c):b};Ql.prototype.getDirection=Ql.prototype.xc;
Ql.prototype.Cb=function(a){a=a||Bk();var b,c;if(this.m){var d=this.f;var e=this.f.length;var f=this.f[e-1];for(c=b=0;--e&&b<this.s;)c+=Pl(Ul(d[e],d[e-1])),b++;d=c/b}else f=this.b,d=Pl(this.Ud());return d=d>=this.rb&&a-f.timestamp<=this.v?d>this.aa?this.aa:d:0};Ql.prototype.getSpeed=Ql.prototype.Cb;Ql.prototype.Nf=function(){return this.b?Vl(this.b):B};Ql.prototype.getBifocalCenter=Ql.prototype.Nf;Ql.prototype.Ud=function(a){return(a=a?this.g:this.o)?Ul(a,this.b):new Ol(0,0)};
Ql.prototype.getMoveVector=Ql.prototype.Ud;Ql.prototype.Of=function(a){var b=1;if(this.j){var c=this.b;a=a?this.g:this.o;if(a=Wl(a))if(c=Wl(c))b=c/a}return b};Ql.prototype.getBifocalScaling=Ql.prototype.Of;Ql.prototype.nh=function(a){if(this.j){var b=a?this.g:this.o,c=this.b;a=b.b;var d=c.b,e=0;a&&d&&(b=b.a,c=c.a,e-=Kd(d.y-c.y,d.x-c.x)*Sd-Kd(a.y-b.y,a.x-b.x)*Sd);a=e}else a=0;return a};Ql.prototype.getBifocalRotation=Ql.prototype.nh;
function Rl(a,b,c,d,e){this.a=new I(a,b);c!==B&&(this.b=new I(c,d),this.c=!0);this.timestamp=e!==B?e:Bk()}Rl.prototype.c=!1;function Vl(a){var b=a.a;return(a=a.b)?new I(b.x-(b.x-a.x)/2,b.y-(b.y-a.y)/2):B}function Xl(a,b){var c=a.a;return(a=a.b)&&a.Ya(b)<c.Ya(b)?a:c}function Ul(a,b){var c=a.b,d=b.b;d&&c?(b=Vl(b),a=Vl(a)):c?(b=b.a,a=Xl(a,b)):d?(a=a.a,b=Xl(b,a)):(b=b.a,a=a.a);return new Ol(b.x-a.x,b.y-a.y)}function Wl(a){var b=a.b;return b?a.a.Ya(b):0};var Zj=1,ak=2,bk=3;function Yl(){F.call(this);this.reset()}u(Yl,F);Yl.prototype.start=function(a,b){this.a&&this.reset();E(a-b)||(this.b=+a,this.c=+b);this.a=!0};Yl.prototype.reset=function(){this.a=!1;this.b=this.c=null;this.f=new Zl(0,0,0,0,0,0)};Yl.prototype.Ea=function(){return this.a};Yl.prototype.g={Hg:"animationupdate"};function $l(a){$l.l.constructor.call(this,Yl.prototype.g.Hg);this.c=a}u($l,rd);
Yl.prototype.set=function(a,b,c,d,e,f){var g=this.f;this.a&&(a=new Zl(a/1E3,b/1E3,c/1E3,d/1E3,e/1E3,f/1E3),g.na(a)||(this.f=a,this.dispatchEvent(new $l(am(this)))))};function am(a){return x.Object.create(a.f)}Yl.prototype.Cb=function(){return am(this).Cb()};Yl.prototype.xc=function(){var a=am(this),b=this.Cb()||1;return new Zl(a.mb/b,a.nb/b,a.ob/b,a.ie,a.je,a.jf)};Yl.prototype.u=function(){this.reset();Yl.l.u.call(this)};
function Zl(a,b,c,d,e,f){this.mb=a;this.nb=b;this.ob=c;this.ie=d;this.je=e;this.jf=f}Zl.prototype.Cb=function(){return Cd(this.mb*this.mb+this.nb*this.nb+this.ob*this.ob)};Zl.prototype.xc=function(){var a=this.Cb()||1;return new Zl(this.mb/a,this.nb/a,this.ob/a,this.ie,this.je,this.jf)};Zl.prototype.na=function(a){return!!a&&this.mb===a.mb&&this.nb===a.nb&&this.ob===a.ob&&this.ie===a.ie&&this.je===a.je&&this.jf===a.jf};function bm(a,b,c,d){bm.l.constructor.call(this);this.tc=a;this.qa=d;this.a=a.appendChild(this.createElement(a.ownerDocument));cm(this,b,c)}u(bm,nd);n=bm.prototype;n.G=function(){return this.a};function cm(a,b,c){a.size?(a.size.w=b,a.size.h=c):a.size=new Ki(b,c);a.fl(a.a,a.a.style,b,c,a.qa)}n.Bb=function(){return this.size};n.Za=function(){return this.qa};n.dk=!0;n.ub=function(a){a!==this.dk&&(this.a.style.display=a?"block":"none",this.dk=a)};n.Vh=1;
n.pc=function(a){this.Vh!==a&&(this.hk(a),this.Vh=a)};n.ad=function(){return this.Vh};n.qf=function(a){this.a.style.zIndex=a};n.Rj=function(){return+this.a.style.zIndex};n.Yc=function(){};n.clear=function(){};n.u=function(){this.clear();this.tc.removeChild(this.a);cm(this,0,0);this.a=this.tc=null;bm.l.u.call(this)};n.Lk=0;n.vg=function(){++this.Lk};n.release=function(){--this.Lk||this.C()};function dm(a,b,c,d){dm.l.constructor.apply(this,arguments)}u(dm,bm);n=dm.prototype;n.Pd=function(){return"dom"};n.createElement=function(a){a=a.createElement("DIV");a.style.position="absolute";return a};n.fl=function(a,b,c,d){b.width=c+"px";b.height=d+"px"};n.hk=function(a){this.a.style.opacity=a};n.Yc=function(a,b,c){var d=this.qa,e=a.style;e[xf("transform")]="matrix(1,0,0,1,"+b/d+","+c/d+")";a.parentNode!==this.a&&(e.position="absolute",this.a.appendChild(a))};
n.clear=function(a){a?this.a.removeChild(a):this.a.innerHTML=""};function em(a,b,c,d,e,f){var g=e||"2d";em.l.constructor.apply(this,arguments);this.b=this.a.getContext(g,f);this.c="2d"===g;this.f=g;this.Tn=f}u(em,bm);n=em.prototype;n.createElement=function(a){a=a.createElement("canvas");var b=a.style;b.position="absolute";b.top=b.left="0";return a};n.fl=function(a,b,c,d,e){a.width=wd(c,1);a.height=wd(d,1);b.width=xd(c/e)+"px";b.height=xd(d/e)+"px"};n.hk=function(a){this.b.globalAlpha=a};n.Yc=function(a,b,c,d,e){this.c&&this.b.drawImage(a,b,c,d,e)};n.Pd=function(){return this.f};
n.clear=function(a){var b,c;this.c&&(a?this.b.clearRect(b=a.left,c=a.top,a.right-b,a.bottom-c):this.a.width=this.size.w)};n.u=function(){this.a.width=this.a.height=0;this.b=y;em.l.u.call(this)};function fm(a){this.gb=a}u(fm,nd);fm.prototype.Ab=function(){return this.gb};fm.prototype.pf=function(a){var b=this.Hb;a!==b&&(this.Hb=a,a.vg(),b&&b.release())};fm.prototype.u=function(){this.Hb.release()};fm.prototype.Yd=function(){};function gm(a){var b="dom";gm.l.constructor.call(this,a);C(this.gb,hm)&&(b="2d"===a.Pd()?"2d":"webgl");this.a=b}u(gm,fm);gm.prototype.$=function(a,b,c,d,e,f,g,h){g=this.gb;var k=this.Hb,l=!(C(k,em)&&"2d"===k.Pd());if(d>=g.min&&d<=g.max)return l&&k.ub(!0),g.$(k.G(),{boundingBox:a,zoom:d,screenCenter:b,priorityCenter:f,projection:c,cacheOnly:e,size:k.Bb(),pixelRatio:k.Za(),cameraMatrix:h});l&&k.ub(!1);return lk.DONE};gm.prototype.Yd=function(){return this.a};t("H.util.animation.ease.LINEAR",function(a){return a});t("H.util.animation.ease.EASE_IN_QUAD",function(a){return a*a});function im(a){return-a*(a-2)}t("H.util.animation.ease.EASE_OUT_QUAD",im);t("H.util.animation.ease.EASE_IN_OUT_QUINT",function(a){a*=2;return 1>a?Dd(a,5)/2:(a-=2,Dd(a,5)/2+1)});t("H.util.animation.ease.EASE_OUT_CIRC",function(a){return Cd(2*a-a*a)});function jm(a,b,c,d){if(!Ca(this.i=a))throw new D(jm,0,a);if(E(this.g=+b))throw new D(jm,1,b);if(!Ca(this.f=c)&&null!=c)throw new D(jm,2,c);if(!Ca(this.c=d)&&null!=d)throw new D(jm,3,d);this.id=km.next();this.a=!1}t("H.util.animation.Animation",jm);var km=new af;jm.prototype.start=function(){var a=this,b=Lk;var c=function(){var e=Bk(),f=e-a.Qc,g=f/a.g;if(1<=g){g=1;var h=!0}a.c&&(g=a.c(g));a.i(g,f,e-d,e);d=e;h?a.stop():a.b=b(c)};a.Qc=Bk();var d=a.Qc;a.a=!0;a.b=b(c)};jm.prototype.start=jm.prototype.start;
jm.prototype.stop=function(a){Mk(this.b);this.a=!1;a||this.f&&this.f(this)};jm.prototype.stop=jm.prototype.stop;jm.prototype.Ea=function(){return this.a};jm.prototype.isRunning=jm.prototype.Ea;function lm(a,b){lm.l.constructor.call(this,a);this.vc=!(!b||!b.vc);this.c={}}u(lm,fm);lm.prototype.pf=function(a){lm.l.pf.call(this,a);this.f=a.tc.ownerDocument};var mm=function(a,b){b=b.ba();return C(b,kh)?b.oa:(a[0]=b,a)}.bind(null,[]);
lm.prototype.$=function(a,b,c,d,e,f,g){var h=this.gb,k,l,m,q;this.j=b=this.c;this.c=c={};if(d>=h.min&&d<=h.max){var p=this.Ej(a,d,e,f);var r=p.markers;if(a=r.length){d=[];e=this.Hb;for(f=0;f<a;f++){h=r[f];var v=mm(h);for(k=v.length;k--;)if(l=g(v[k]))(q=b[m=h.fb()+"_"+k])?delete b[m]:q={tk:h},c[m]=q,d.push([q,h,h.zb(),e,l.x,l.y])}d.sort(nm);a=d.length;for(f=0;f<a;f++)this.Nk.apply(this,d[f])}}return!p||p.requested&&p.requested===p.total||!p.requested&&r.length===p.total?lk.DONE:lk.PENDING};
function nm(a,b){var c=Qg(a[1]),d=Qg(b[1]);return Rg(c,d,!0)||a[5]-b[5]||Rg(c,d,!1)}lm.prototype.Ua=function(){};function om(a,b){om.l.constructor.apply(this,arguments);this.b=0;this.a=[];this.ih=A(this.ih,this)}u(om,lm);n=om.prototype;n.Ej=function(){return this.gb.Jc.apply(this.gb,arguments)};n.$=function(a,b,c,d,e,f,g){this.ih();this.i=0;var h=om.l.$.apply(this,arguments);var k=this.Hb,l=this.j,m;for(m in l)pm(this,k,l[m]);return 0===this.a.length&&h?lk.DONE:lk.PENDING};n.pf=function(a){om.l.pf.call(this,a);this.g=a.Za()};
n.ih=function(){for(var a=this.a.length,b,c,d;a--;)d=this.a[a],b=d.wf,c=d.wf.zb(),c.gi(d,c,b);this.a.length=0};n.Nk=function(a,b,c,d,e,f){var g;var h=d.Za();var k=b.Qb();e*=h;f*=h;this.vc||(e=xd(e),f=xd(f));a.detail&&(k.be(a.Dn)?pm(this,d,a):g=a.detail);g||(a.detail=g=c.Hj(this.f),this.b++,Ca(c.gi)&&this.a.push(g));a.Dn=k.a;g.style.zIndex=this.i++;g.wf=b;d.Yc(g,e,f,0,0)};var qm,rm="pointer-events",sm;
if(Ye){var tm;Ye&&Zc!==y&&(Zc=(tm=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+tm[2]:y);sm=Zc;9===sm?rm="display":10===sm&&(rm="visibility")}qm=rm;
om.prototype.Ua=function(a,b,c){var d=this.g,e=ff,f,g,h,k,l;if(this.b){a/=d;b/=d;d=this.f;var m=d.documentElement;var q=this.Hb.G();var p=q.getBoundingClientRect();a+=p.left;for(b+=p.top;(g=h=d.elementFromPoint(a,b))&&g!==q&&g!==m&&h!==r;){for(;(k=g.parentNode)&&(!Ca(k.contains)||!k.contains(q));)g=k;if(k===q&&(g!==h||"svg"!==g.nodeName)&&0>e.indexOf(l=g.wf)&&(e===ff&&(e=[]),e.push(l),c))break;f||(f=[]);var r=g.style;f.push({rj:r.getPropertyValue(qm),Cn:r.getPropertyPriority(qm),style:r});r.setProperty(qm,
"visibility"===qm?"hidden":"none","important");r=h}if(f)for(b=f.length;b--;)a=f[b],a.style.removeProperty(qm),zc(a.rj)&&a.style.setProperty(qm,a.rj,a.Cn)}return e};om.prototype.Yd=function(){return"dom"};function pm(a,b,c){b.clear(b=c.detail);delete b.wf;a.b--;c=(a=c.tk).zb();c.b&&c.b(b,c,a)}om.prototype.u=function(){this.a.length=0;var a=this.Hb,b=this.c,c;for(c in b)pm(this,a,b[c]);this.Hb.C();om.l.u.call(this)};function hm(a,b){var c=b||{},d=c.contextType;c=c.contextAttributes;hm.l.constructor.call(this,b);wc(a,"Function",hm,0,"invalid render callback");if(d){if(-1===um.indexOf(d))throw new D(hm,1,"invalid context type");this.f=d}c&&(this.m=c);this.j=a}u(hm,aj);t("H.map.layer.CanvasLayer",hm);var um=["2d","webgl","webgl2","experimental-webgl"];hm.prototype.f="2d";hm.prototype.Pd=function(){return this.f};
hm.prototype.$=function(a,b){this.c&&this.c.canvas===a||(this.c=a.getContext(this.f,this.m));return this.j(this.c,b)};hm.prototype.u=function(){hm.l.u.call(this);this.c=B};function vm(a,b){vm.l.constructor.call(this,b);wc(a,"Function",vm,0,"invalid render callback");this.c=a}u(vm,aj);t("H.map.layer.DomLayer",vm);vm.prototype.$=function(a,b){return this.c(a,b)};function wm(a,b){if(E(this.b=+a))throw new D(wm,0,a);this.a=0;b&&this.al(b)}t("H.util.kinetics.KineticMove",wm);wm.prototype.al=function(a){this.a=a;return this};wm.prototype.setInitialSpeed=wm.prototype.al;wm.prototype.tm=function(){return Math.abs(this.a/this.b)};wm.prototype.getDuration=wm.prototype.tm;wm.prototype.Je=function(a){return this.a+this.b*a};wm.prototype.getCurrentSpeed=wm.prototype.Je;wm.prototype.om=function(a){return this.a*a+this.b*a*a/2};wm.prototype.getCurrentPath=wm.prototype.om;function xm(a,b){this.a=a;this.b=b}
function ym(a,b,c){var d=[],e={tc:a.a,width:b.w,height:b.h,qa:a.b};for(a=0;a<c.length;a++){b=c[a];var f=b.Yd();var g={};Wa(g,e);var h=b.Hb;switch(f){case "2d":C(b.Ab(),hm)&&(g.Yg=b.Ab().m);if(f=m&&"2d"===m.Pd()){f=g.Yg;var k=m.Tn;f=k===f?!0:k&&!f?!k.alpha&&!k.willReadFrequently:f&&!k?!f.alpha&&!f.willReadFrequently:!f.alpha===!f.alpha&&!k.willReadFrequently===!f.willReadFrequently}if(f)var l=!1;else if(h&&!l){var m=h;l=!1}else m=new em(g.tc,g.width,g.height,g.qa,"2d",g.Yg),l=!0;break;case "dom":m=
h||new dm(g.tc,g.width,g.height,g.qa);l=!h;break;default:m=h||new em(g.tc,g.width,g.height,g.qa,b.Ab().Pd(),g.Yg),l=!h}d[d.length-1]!==m&&(m.qf(d.length),d.push(m));b.pf(m)}return d};t("H.util.events.listenOnce",Ce);t("H.util.events.dispatchEvent",function(a,b){return a.dispatchEvent(b)});t("H.util.events.fireListeners",function(a,b,c,d){return le(a)?a.ld(b,c,d):Me(a,b,c,d)});t("H.util.events.listen",Be);t("H.util.events.unlisten",Ke);var zm=Ne;
Ne=function(a,b){var c,d,e=!0;var f=b[b.currentTarget===b.target?"AT_TARGET":a.capture?"CAPTURING_PHASE":(c=!0,"BUBBLING_PHASE")];if(!c||"pointerenter"!==(d=b.type)&&"pointerleave"!==d)b.eventPhase=f,e=zm(a,b),c&&a.src&&a.src.ic&&null===a.src.ic()&&delete b.eventPhase;return e};function ul(){ul.l.constructor.call(this);this.c={};this.b={position:new Xf(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new P(Gg([90,-180,90,0,90,180,-90,180,-90,-180]))}}u(ul,F);t("H.map.ViewModel",ul);ul.prototype.a={Da:"update",se:"sync"};
ul.prototype.$b=function(a,b){if(!a)throw new D(this.$b,0,a);var c=a[Am];if(tc(c)&&!Yf(c))throw new D(this.$b,0,Am);c=a[Bm];if(tc(c)&&E(+c))throw new D(this.$b,0,Bm);c=a[Cm];if(tc(c)&&!C(c,Wf))throw new D(this.$b,0,Cm);a=x.Object.assign({},a);c=Dm(a,this.c,this.b);Em(this,this.c,a);this.dispatchEvent(new Fm(this.c,c,b));return this};ul.prototype.setLookAtData=ul.prototype.$b;ul.prototype.sb=function(){var a={};a[Am]=Zf(this.b[Am]);Em(this,a,this.b,!0);return a};ul.prototype.getLookAtData=ul.prototype.sb;
var Am="position",Bm="zoom",Cm="bounds",Gm={gj:Am,jj:Bm,aj:"heading",ij:"tilt",bj:"incline",Yi:Cm},Hm=Object.keys(Gm).map(function(a){return Gm[a]});
function Em(a,b,c,d){a.i={};a.g={};a.f=[];for(var e=a.m,f=a.j,g=Hm.length,h,k,l,m;g--;)if(h=Hm[g],m=c[h],k=b[h],null==k||!d)if(null!=m){tc(e)&&e.call(a,h,k,m);l=h;var q;(q="position"!==h)||(q=m,q=!q||E(q.lat)||E(q.lng)?!1:!0);b[l]=q?m:Zf(m);if(tc(f)){switch(h){case "position":l=m&&k&&(m.lat!==k.lat||m.lng!==k.lng);break;case "bounds":l=m&&k&&!m.na(k);break;default:l=m!==k}l&&f.call(a,h,k,m)}}else delete b[h]}ul.prototype.m=function(a,b,c){this.i[a]=b;this.g[a]=c};ul.prototype.j=function(a){this.f.push(Im[a])};
var Im=Hm.reduce(function(a,b){a[b]=Si[b.toUpperCase()];return a},{});function Dm(a,b,c){var d=0;["tilt","incline","heading",Bm].forEach(function(e){if(E(a[e])){var f=E(b[e])?c[e]:b[e];a[e]=f}else d|=Im[e]});[Am,Cm].forEach(function(e){a[e]?d|=Im[e]:a[e]=b[e]||c[e]});return d}ul.prototype.ab=function(a){var b={},c={};Em(this,this.b,a);this.c={};b.lookAt=this.g;c.lookAt=this.i;a=this.f;a=a.length?a.reduce(Jm):0;this.dispatchEvent(new Ri(this.a.se,b,c,a))};ul.prototype.synchronize=ul.prototype.ab;
function Jm(a,b){return a|b}ul.prototype.rf=function(a,b){if(E(a=+a))throw new D(this.rf,0,Bm);this.$b({zoom:a},b)};ul.prototype.tb=function(){return this.b.zoom};ul.prototype.rc=Nc;ul.prototype.startControl=ul.prototype.rc;ul.prototype.control=Nc;ul.prototype.control=ul.prototype.control;ul.prototype.xb=Nc;ul.prototype.endControl=ul.prototype.xb;function Fm(a,b,c){Fm.l.constructor.call(this,ul.prototype.a.Da,a,null,b);this.b=this.animate=!!c}u(Fm,Ri);function S(a,b,c,d){S.l.constructor.call(this,a,b,c,d);this.Fd=new Fk(100);this.fa=new I(0,0);this.Ae=!!d.enableSubpixelRendering;this.jb=Km;this.o=new Ql;this.j=d=new Yl;this.cc=A(this.cc,this);d.addEventListener(d.g.Hg,this.cc);d=a.element;this.K=a=d.ownerDocument.createElement("div");a.style.position="absolute";a.style.width=a.style.height="100%";a.style.zIndex=0;d.insertBefore(a,d.firstChild);this.Hd=new xm(this.K,this.qa);a=x.H.gl;if(!a)throw new Yc(S,'"H-webgl" module is missing');this.a=
new El({viewport:this.i,tc:this.K,devicePixelRatio:this.qa,Ak:A(this.ha,this)});a.WorkerBroker.addTarget("model",dj);a=this.c.La();d=0;var e=a.length;this.m={Xc:[],ia:[]};for(this.f=a;d<e;d++){var f=a[d];this.We(d,f);xl(this,f,!0)}this.Jb();this.dc=A(this.dc,this);this.Xh=A(this.Xh,this);this.Ga=A(this.Ga,this);c.addEventListener(aj.prototype.b.pe,this.dc);this.A=Lm;this.gf();this.zoom=yl(this,this.O.tb());this.Jb();this.U.Fa(this.zoom);this.b=this.U.projection.Nb(b.sb().position);this.U.x=this.U.w*
this.b.x;this.U.y=this.U.h*this.b.y;this.T()}u(S,sl);t("H.map.render.webgl.RenderEngine",S);S.prototype.dc=function(a){a=(a=a.target.pa())&&a.Db();(a&&a.getState())===Qh.INIT?a.load():(Hl(this.a),Jl(this.a,this.c),this.ha())};S.prototype.type=Cl.WEBGL;S.prototype.type=S.prototype.type;var Lm=2;S.prototype.getState=function(){return this.A};S.prototype.getState=S.prototype.getState;function Mm(a,b,c){b=c-b;return Ad(b)<a.U.w/2?b:b-a.U.w*c/Ad(c)}
S.prototype.Tg=function(a){var b=a.newValue,c=a.modifiers,d=Il(this.a);Nm(this);this.fa.set(0,0);var e=Om(this,b);Pm(this);Hm.forEach(function(f){c&a[f.toUpperCase()]||delete e[f]});a.b?Qm(this,e,a):d.setLookAtData(e);Rm(this);Hl(this.a);this.ha()};
function Qm(a,b,c){var d=[],e=c.modifiers;c=Il(a.a);var f=c.getLookAtData(),g,h,k,l=0,m={},q=c.setLookAtData.bind(c);Hm.forEach(function(p){switch(p){case "heading":case "tilt":case "incline":if(e&(Si.HEADING|Si.TILT|Si.INCLINE)){var r=b[p]-f[p];m[p]=-180<r&&180>=r?r:180<r?r-360:r+360;m[p]&&d.push(p)}break;case "zoom":e&Si.ZOOM&&(m[p]=b[p]-f[p],m[p]&&d.push(p));break;case "position":if(e&Si.POSITION){g=Zf(f.position);var v=b.position;r=v.lat*Rd;var w=g.lat*Rd,z=v.lng*Rd-g.lng*Rd;v=Fd(z)*Hd(r);r=Hd(w)*
Fd(r)-Fd(w)*Hd(r)*Hd(z);r=Math.atan2(v,r);k=(0<=r?r:Pd+r)*Sd;(h=g.Ya(b.position))&&d.push(p)}}delete f.bounds});d.length?Sm(a,function(p){var r=p-l,v={};e&(Si.HEADING|Si.TILT|Si.INCLINE|Si.ZOOM)&&d.forEach(function(w){Cc(m[w])&&(f[w]+=m[w]*r,v[w]=f[w])});e&Si.POSITION&&(v.position=g.Dg(k,h*p,!0));q(v);Hl(this.a);Rm(this);this.ha();l=p}.bind(a),a.la,function(){q(b);Hl(this.a);this.ha()}.bind(a),a.V):q(b)}S.prototype.la=300;
S.prototype.kf=function(a){var b=Cc(a);if(!b||b&&0>a)throw new D(this.kf,1,"positive number required");this.la=a};S.prototype.setAnimationDuration=S.prototype.kf;S.prototype.lh=function(){return this.la};S.prototype.getAnimationDuration=S.prototype.lh;S.prototype.V=im;S.prototype.lf=function(a){if(!Ca(a))throw new D(this.lf,1,"function required");this.V=a};S.prototype.setAnimationEase=S.prototype.lf;S.prototype.mh=function(){return this.V};S.prototype.getAnimationEase=S.prototype.mh;
S.prototype.gf=function(){this.V=im;this.la=300};S.prototype.resetAnimationDefaults=S.prototype.gf;n=S.prototype;n.yk=function(){Hl(this.a);this.ha()};n.We=function(a,b){S.l.We.call(this,a,b);Tm(b)&&(Hl(this.a),(a=(a=b.pa())&&a.Db())&&a.getState()===Qh.INIT&&a.load())};
n.ii=function(a,b,c){var d;this.Xa=Bk();if(b.requestDomMarkers||C(b,hm)||C(b,vm)){var e=this.m.ia;for(d=e.length;d--;){var f=e[d];if(f.Ab()===b){e.splice(d,1);f.C();break}}}Tm(b)&&Jl(this.a,this.c);this.f=this.c.La();0===a&&(xl(this,b,!1),this.Jb());ym(this.Hd,Um(this),this.m.ia.filter(tc));this.he();c||this.ha()};function Tm(a){return!(C(a,vm)||C(a,hm))}n.ji=function(){this.Jb()};
n.Jb=function(){S.l.Jb.call(this);var a=this.getCapabilities().lookAt.zoom;Il(this.a).setZoomConstraints(wd(a.min,this.Fg),vd(a.max,this.Jg))};n.Gh=function(a,b){var c;if(b){a={vc:this.Ae,hb:this.hb};b.$?C(b,hm)?c=new gm(b):C(b,vm)&&(c=new gm(b)):b.requestDomMarkers&&(c=new om(b,a));if(c){this.m.ia.push(c);var d=this.c.La();this.m.ia.sort(function(e,f){return d.indexOf(e.gb)-d.indexOf(f.gb)});ym(this.Hd,Um(this),this.m.ia.filter(tc))}Tm(b)&&Jl(this.a,this.c)}this.f=this.c.La()};
function Om(a,b){var c=b.position;return zl(a,{zoom:yl(a,b.zoom),position:new Xf(c.lat,c.lng),tilt:b.tilt,heading:b.heading,bounds:b.bounds})}function Rm(a){var b=a.U,c=Il(a.a).getLookAtData();b.Fa(c.zoom);a.zoom=c.zoom;a.b=b.projection.Nb(c.position);b.x=b.w*a.b.x;b.y=b.h*a.b.y}n.Ga=function(a){return Il(this.a).geoToPixel(a)};S.prototype.geoToScreen=S.prototype.Ga;S.prototype.Wa=function(a,b){return Il(this.a).xyToGeo(a,b)};S.prototype.screenToGeo=S.prototype.Wa;
S.prototype.wg=function(a,b){a=this.Wa(a,b);b=this.O.sb();b.position=a;return b};
function Vm(a,b,c,d,e,f,g,h){var k,l,m=0,q;var p=function(){0===--m&&f(e)};if(h&&h.features)for(m=l=h.features.length,q=0;q<l;q++){var r=h.features[q];var v=r.id;if(k=a.a.a.sources[r.source_name]){var w=k.provider;var z=Yj(w);if(z===ak){var J=r.source_layer;if("overlays"===J)Wm(a,b,c,d,e,k,r.properties.overlays_config);else if(k=k.getMapObjectById(v))if("markers"!==J)e.push(k);else if(Xm(a,b,c,k))e.push(k);else if(d&&!g){var G=!0;Ml(a.a,{x:b,y:c},{radius:Ym,top_most_only:!1},function(V){Vm(a,b,c,
d,e,f,!0,V)})}m--}else z===Zj?(J=r.tile.coords,G=w.getFeatureProxy(r.properties,J,function(V){if(V){for(var T=V,ua;T&&(ua=T.ic())&&ua!==w;)T=ua;ua||T.ja(w);e.push(V)}p()}),G||(k=a.Fd.get(v),k||(k=new Kg(r),k.ja(w),a.Fd.add(v,k,1)),e.push(k),m--)):z===bk&&(G=!0,w.Ok(r,!1).then(function(V){V&&(V instanceof Ni?Xm(this,b,c,V):1)&&e.push(V);p()},function(){p()},a))}}z&&(G||0!==m)||f(e)}
function Wm(a,b,c,d,e,f,g){var h;a=a.Wa(b,c);for(b=g.length;b--&&(!(h=f.getMapObjectById(g[b].id))||0<=e.indexOf(h)||!h.ba().Kd(a)||(e.push(h),!d)););}function Xm(a,b,c,d){var e=d.zb(),f=e.g,g,h=!f;if(f)if(e=e.md(),b+=e.x,c+=e.y,e=d.ba(),C(e,Ji))for(d=e.oa,g=d.length;g--&&!h;)e=a.Ga(d[g]),h=f.Zf(b-e.x,c-e.y,0)!==ae.NONE;else e=a.Ga(e),h=f.Zf(b-e.x,c-e.y,0)!==ae.NONE;return h}
S.prototype.Ua=function(a,b,c,d){var e=this,f=[];f=Zm(f,this.m.ia,a*this.qa,b*this.qa,c);c&&f.length?d(f):this.a.a.initialized?Ml(this.a,{x:a,y:b},{radius:Ym,top_most_only:c},function(g){Vm(e,a,b,c,f,d,!1,g)}):d(f)};S.prototype.getObjectsAt=S.prototype.Ua;function Zm(a,b,c,d,e){for(var f=b.length,g;f--&&!((g=b[f])&&g.Ua&&(a=a.concat(g.Ua(c,d,e)),a.length&&e)););return a}S.prototype.wa=y;function Um(a){a=a.vb[2];return{w:a.right-a.left,h:a.bottom-a.top}}
S.prototype.T=function(){var a=this.m.ia.length;tl(this,this.qa);this.fa.set(0,0);var b=Um(this);var c=b.w;var d=b.h;for(this.a.a.handleViewportUpdate();a--;){b=this.m.ia[a].Hb;var e=b.Bb();e.w===c&&e.h===d||cm(b,c,d)}this.wa=new Ki(c,d);Hl(this.a);this.ha()};S.prototype.getCapabilities=function(){return Dl};S.prototype.getCapabilities=S.prototype.getCapabilities;function $m(a){(Gl(a.a)||Bk()-a.Xa<a.jb)&&!a.v?a.Ig=Lk(a.Xh):(a.v&&(a.he(),an(a)),a.A=Lm)}n=S.prototype;
n.he=function(){this.m.Xc.length=0};
n.Xh=function(){this.B&&this.B.before();var a=Il(this.a);var b=a.getLookAtData(!1);var c=a.getLookAtData(!0);a=this.i.center.clone();c=c.bounds.F();var d=this.zoom;var e=this.fa;var f=this.f;var g=f.length;for(this.jb=Km;g--;){var h=f[g];C(h,aj)&&h.pa()&&h.pa().oi(c,d)}this.v=this.a.$();this.O.ab(b);b=this.v;f=this.m;g=f.ia.length;var k=!0,l;for(l=0;l<g;l++){h=f.ia[l];var m=f.Xc;if(h){var q=h.$(c,a,void 0,d,!1,e,this.Ga,this.a.a.getCameraMatrix());q===lk.ACTIVE&&(this.jb=Infinity);q!==lk.DONE||m[l]||
(an(this,h.Ab()),m[l]=!0);m[l]||(k=!1)}}this.v=b&k;this.wa&&(this.i.ab(this.wa),this.wa=y);this.B&&this.B.after();$m(this)};function an(a,b){setTimeout(A(a.dispatchEvent,a,{type:a.gk.hj,target:b||a}),1)}n.u=function(){var a=this.c.La()[0],b=this.i;Mk(this.Ig);Pm(this,!0);a&&xl(this,a,!1);this.m.ia.filter(tc).forEach(function(c){c.C()});b.element&&b.element.removeChild(this.K);this.K=null;this.A=3;this.a.C();S.l.u.call(this)};n.ha=function(){this.Xa=Bk();this.A===Lm&&(this.v=!1,this.A=1,$m(this))};
function bn(a,b,c){Il(a.a).applyPxOffset([b,c]);Rm(a);a.fa.set(0,0);Hl(a.a);a.ha()}n.ne=function(a,b,c){a=yl(this,yl(this,a));cn(this,a,b,c)};S.prototype.zoomAt=S.prototype.ne;function cn(a,b,c,d){Il(a.a).setLookAtData({zoom:b},Cc(c)&&Cc(c)?[c,d]:B);Rm(a);Hl(a.a);a.ha()}function Nm(a){Pm(a,!0);a.j.Ea()&&a.xb(!0);a.o.Ea()&&a.yb(!0);Pm(a,!0)}function dn(a,b){if(b){var c={};c.$e=b.power;c.Be=b.ease;c.duration=b.duration;a.s=c}}
S.prototype.sc=function(a,b){var c=!!(b||a&(wl.HEADING|wl.TILT));Nm(this);dn(this,b);this.o.start(a,c);Il(this.a).setPanning(!0)};S.prototype.startInteraction=S.prototype.sc;
S.prototype.kc=function(a,b,c,d,e){var f=this.o;var g=!1;if(f.Ea()){var h=Il(this.a);var k=h.getLookAtData();var l=this.i.center;l=[l.x,l.y];b=f.store(a,b,c,d,e);c=f.Nf();a=f.Ud();e=this.o.Of();d=this.o.nh();f.c&&(f.Gc(wl.TILT)&&(h.setLookAtData({tilt:Al(this,k.tilt+a.y/this.i.height*-180)},l),g=!0),b&&1!==e&&f.Gc(wl.ZOOM)&&(g=f.Nf(),e=Bd(Dd(2,this.zoom)*e)/Ld,cn(this,yl(this,e),g.x,g.y),g=!0),f.Gc(wl.COORD)&&0<Pl(a)&&(bn(this,-a.x,-a.y),g=!0),f.Gc(wl.HEADING)&&(b?h.setLookAtData({heading:k.heading+
Bl(this,d)},[c.x,c.y]):a.x&&h.setLookAtData({heading:Bl(this,k.heading+a.x/this.i.width*360)},l),g=!0),g&&(Hl(this.a),this.ha()))}};S.prototype.interaction=S.prototype.kc;
S.prototype.yb=function(a){var b=this;if(this.o.Ea()&&!a){if(this.s){a=this.o.Cb();var c=this.o.xc();var d=this.s.duration;var e=(this.s.$e||1)*a;var f=new wm(-e/(0<d?d:1),e);!E(c.x)&&!E(c.y)&&0<e&&b.o.Gc(wl.COORD)&&Sm(this,function(g){e=f.Je(g*d);E(e)||bn(b,xd(-c.x*e),xd(-c.y*e))},d,void 0,this.s.Be)}this.s=null;this.o.clear()}Il(this.a).setPanning(!1);this.ha()};S.prototype.endInteraction=S.prototype.yb;S.prototype.rc=function(a,b,c){Nm(this);this.j.start(b,c);dn(this,a);Il(this.a).setPanning(!0)};
S.prototype.startControl=S.prototype.rc;S.prototype.control=function(a,b,c,d,e,f){for(var g=0,h;g<arguments.length;g++)if(h=+arguments[g],h!==h)throw new D(this.control,g,h);this.j.Ea()&&this.j.set(a,b,c,d,e,f)};S.prototype.control=S.prototype.control;
S.prototype.xb=function(a,b){var c=this,d;if(this.j.Ea()){Pm(this,!0);var e=Bk();var f=e-this.za;if(1<=f){var g=am(this.j);en(this,g,f)}if(!this.s||a||b)"function"===typeof b&&(a=Il(this.a),a=a.getLookAtData(),b(a),fn(this,a));else{b=this.j.Cb();var h=this.j.xc();var k=this.s.duration;var l=(this.s.$e||1)*b;var m=new wm(-l/(0<k?k:1),l);!E(h.mb)&&!E(h.nb)&&0<l&&Sm(this,function(q,p,r,v){e&&(r=v-e,e=0);l=m.Je(q*k)*r;E(l)||((d=h.ob*l)&&cn(c,yl(c,c.zoom+d),c.j.b,c.j.c),bn(c,xd(h.mb*l),xd(h.nb*l)))},k,
void 0,this.s.Be)}this.j.reset();Il(this.a).setPanning(!1);this.ha()}};S.prototype.endControl=S.prototype.xb;
function fn(a,b){var c=a.b,d=a.U.projection.Nb(b.position),e=a.U.dd(d);d=e.y;e=e.x;var f=b.zoom;c=a.U.dd(c);b=c.y;var g=c.x;c=a.zoom;var h=a.j.Cb(),k=a.j.b,l=a.j.c,m=0;e=Mm(a,g,e);e-=g;d-=b;c=f-c;b=Cd(e*e+d*d+c*c);if(0!==h&&0!==b){var q=e/b;var p=d/b;var r=c/b;var v=h*h/(2*b);Sm(a,function(w,z){var J;if(1!==w){w=h*z-v*z*z/2;z=w-m;if(J=r*z)J=yl(a,a.zoom+J),cn(a,J,k,l);bn(a,xd(q*z),xd(p*z));m=w}else cn(a,yl(a,f),k,l),a.ha()},2*b/h)}}
S.prototype.cc=function(a){var b=this,c=a.c;this.fa.set(0,0);c.mb||c.nb||c.ob||c.ie||c.je||c.jf?(this.za=Bk(),Sm(this,function(d,e,f,g){b.za=g;en(b,c,f)},Td)):Pm(this,!0)};function en(a,b,c){c=c||0;var d=a.j,e=Il(a.a),f=e.getLookAtData();b.ob&&cn(a,yl(a,f.zoom+b.ob*c),d.b,d.c);e.setLookAtData({heading:Bl(a,f.heading+b.je*c),tilt:Al(a,f.tilt+b.ie*c)});Rm(a);bn(a,b.mb*c,b.nb*c)}function Sm(a,b,c,d,e){a.g&&a.g.Ea()&&a.g.stop(!0);a.g=new jm(b,c,d,e);a.g.start()}
function Pm(a,b){a.g&&a.g.Ea()&&a.g.stop(b)}S.prototype.fh=function(){};S.prototype.enter=S.prototype.fh;S.prototype.Mf=function(a){vl(this.K,a)};S.prototype.exit=S.prototype.Mf;S.prototype.capture=function(a,b,c,d){var e=this;return Nl(e.a).then(function(f){var g=e.K.ownerDocument.createElement("canvas"),h=e.qa,k=g.getContext("2d"),l=e.a.Za()/h,m=(c-a)*h;h*=d-b;g.width=m;g.height=h;k.drawImage(f,a*l,b*l,m*l,h*l,0,0,m,h);return g})};S.prototype.am=function(a){return Il(this.a).geoToMeters(a)};
S.prototype.geoToMeters=S.prototype.am;S.prototype.co=function(a){return Il(this.a).metersToGeo(a)};S.prototype.metersToGeo=S.prototype.co;var Km=5E3,Ym=3.5;function U(a,b,c){var d={};U.l.constructor.call(this);this.D=A(U.prototype.D,this);this.i=gn(c,U);this.b=c=new ul;this.K=!1;c.addEventListener(c.a.se,this.za,!1,this);if(!C(a,Element))throw new D(U,0,a);c=this.S=a.ownerDocument.createElement("div");var e=c.style;e.position="relative";e.height=c.style.width="100%";e.overflow="hidden";e.webkitTapHighlightColor="transparent";"transparent"!==e.webkitTapHighlightColor&&(e.webkitTapHighlightColor="rgba(0,0,0,0)");a.appendChild(c);this.ya=new mk(this.S,
this.i);this.ya.addEventListener(this.ya.a.se,this.za,!1,this);a=this.a=new dj(this.i.layers);a.addEventListener(a.b.re,this.T,!1,this);a.addEventListener(a.b.oe,this.T,!1,this);a.addEventListener(a.b.qe,this.T,!1,this);!this.f&&hn(this);this.c=null;this.a.add(b,0);this.g=this.O(null!=this.i.engineType?this.i.engineType:jn.WEBGL,this.i);this.v=A(this.v,this);this.B=A(this.B,this);b=this.i.imprint;if(b!==B&&"object"!==typeof b)throw new D(U,1,"imprint");this.m=null===b?b:new mj(this,b);b=this.i.autoColor;
this.fa=b===B||!!b;kn(this);(b=this.i.zoom)&&(d.zoom=b);(b=this.i.bounds)&&(d.bounds=b);(b=this.i.center)&&(d.position=b);this.b.$b(d)}u(U,F);t("H.Map",U);function gn(a,b){if(a){var c=a.pixelRatio;if(c===B)a.pixelRatio=Se();else if(!(0<c))throw new D(b,0,"pixelRatio: "+c);}else a={},a.pixelRatio=Se();a.renderBaseBackground||(a.renderBaseBackground={lower:3,higher:2});return a}
U.prototype.u=function(){this.fa=!1;this.m&&this.m.C();this.g.dispose();this.b.C();this.ya.C();this.f.C();this.j.C();this.a.C();var a=this.S;a.parentNode.removeChild(a);this.S=null;F.prototype.u.call(this)};U.prototype.G=function(){return this.S};U.prototype.getElement=U.prototype.G;U.prototype.Za=function(){return this.i.pixelRatio};U.prototype.getPixelRatio=U.prototype.Za;function kn(a){a.m&&a.fa&&a.m.Ei({invert:a.c&&a.c.Ql})}
U.prototype.T=function(a){var b=a.added,c=a.removed;b&&b.pa()&&b.pa().ja(this);c&&c.pa()&&c.pa().ja(null);c===this.f&&(this.j=this.f=null);c===this.c&&(this.c=null);0===a.idx&&(this.dispatchEvent(new Ng(this.o.xf,this.c=a.type!==this.a.b.qe?b:0<this.a.a.length?this.a.get(0):y,a.type!==this.a.b.oe?c:1<this.a.a.length?this.a.get(1):y)),kn(this))};U.prototype.za=function(a){a.modifiers&&(this.K||(ln(this,"start"),this.K=!0),ln(this,"",a),this.V&&x.clearTimeout(this.V),this.V=x.setTimeout(this.B,333))};
function ln(a,b,c){a.dispatchEvent(c?new Ri(a.o.cj,c.newValue,c.oldValue,c.modifiers):a.o.cj+b)}U.prototype.B=function(){ln(this,"end");this.K=!1};U.prototype.xg=function(a,b){this.g.getCapabilities().lookAt&&this.b.$b({position:a},!!b);return this};U.prototype.setCenter=U.prototype.xg;U.prototype.lb=function(){var a=this.b.sb();return a?a.position:y};U.prototype.getCenter=U.prototype.lb;U.prototype.rf=function(a,b){this.b.rf(a,!!b);return this};U.prototype.setZoom=U.prototype.rf;U.prototype.tb=function(){return this.b.tb()};
U.prototype.getZoom=U.prototype.tb;U.prototype.ne=function(a,b,c){this.g.zoomAt(a,b,c)};U.prototype.zoomAt=U.prototype.ne;U.prototype.un=function(){return this.ya};U.prototype.getViewPort=U.prototype.un;U.prototype.tn=function(){return this.b};U.prototype.getViewModel=U.prototype.tn;U.prototype.Jm=function(){return this.a};U.prototype.getLayers=U.prototype.Jm;U.prototype.Em=function(){return this.m};U.prototype.getImprint=U.prototype.Em;
U.prototype.capture=function(a,b,c,d,e,f){function g(G,V){p?G.cancel():(w.save(),V.capture(v,m,function(T){w.restore();G.done(T)},function(T){G.done(null,T);h(null)}))}function h(G){p||(p=!0,a(G))}var k=this.hc(),l=k.getCapabilities(),m=this.i.pixelRatio,q=this.ya,p=!1,r=this,v,w;if(!Ca(a))throw new D(this.capture,0,a);c=c||0;d=d||0;e=e||q.width;f=f||q.height;var z=wd(0,vd(c,e));var J=wd(0,vd(d,f));c=vd(q.width,wd(c,e));d=vd(q.height,wd(d,f));l.capture?k.capture(z,J,c,d).then(function(G){var V=r.m,
T=b||[];v=G;w=v.getContext("2d");v.style.width=v.width/m+"px";v.style.height=v.height/m+"px";var ua=new zk(10,g);T=T.concat(V).filter(function(ea){return Ca(ea&&ea.capture)});T.length?(G=T.pop(),T.forEach(function(ea){ua.push(ea,id)}),ua.push(G,A(h,r,v)),vk(ua)):h(v)},function(){h(y)}):a(null)};U.prototype.capture=U.prototype.capture;U.prototype.hc=function(){return this.s||this.g};U.prototype.getEngine=U.prototype.hc;
U.prototype.Zk=function(a){this.g.type===a||this.la||(this.la=!0,this.s=this.O(a),this.s.addEventListener("render",this.v));return this};U.prototype.setEngineType=U.prototype.Zk;U.prototype.v=function(a){a.target===this.s&&(this.s.removeEventListener("render",this.v),this.g.Mf(this.D))};U.prototype.D=function(){var a=this.g.type;this.g.C();this.g=this.s;this.s=B;this.la=!1;this.dispatchEvent(new Ng(this.o.xl,this.g.type,a))};
U.prototype.O=function(a,b){b=b?gn(b,this.O):this.i;kn(this);if(a===jn.P2D)return new x.H.map.render.p2d.RenderEngine(this.ya,this.b,this.a,b);if(a===jn.WEBGL)return new S(this.ya,this.b,this.a,b);if(a===jn.HARP)return new x.H.harp.RenderEngine(this.ya,this.b,this.a,b);throw new D(this.Zk,0,a);};
U.prototype.uf=function(a,b,c,d,e){b=tc(b)?C(b,K,this.uf,1,b)&&b:this.b.sb().bounds.F();e=e||this.c;if(!C(e,el))throw new D(this.uf,4);var f=e.pa(),g=this.Za(),h=e.tileSize;2<=g&&256<h&&f instanceof uk&&(h/=2);g=this.tb();h=Math.log2(h)-8;c=tc(c)?+c:g;d=tc(d)?+d:g;if(!(c<=d))throw new D(this.uf,B,"!(min <= max)");g=f.min;var k=f.max,l=this.hc().type===jn.WEBGL?yd:xd;c=Yd(l(c)-h,g,k);d=Yd(l(d)-h,g,k);if(!(f&&C(f,R)&&md()&&f.Vg()))throw new Yc(this.uf,"Storing is not supported");return new pk(e,f,b,
c,d,a)};U.prototype.storeContent=U.prototype.uf;function mn(a){ij.call(this,a)}u(mn,ij);mn.prototype.f=function(){kj(this,2)};mn.prototype.c=function(){kj(this,4)};U.prototype.Pl=function(a){a=new mn(a);ld().clear(A(a.f,a),A(a.c,a));return a};U.prototype.clearContent=U.prototype.Pl;U.prototype.Ng=function(a,b){var c=this.a,d=c.indexOf(a),e=b!==+b;b=e?c.a.length-1:b;0>d?c.add(a,b):d-b&&(c.oc(d),c.add(a,e?b-1:b));return this};U.prototype.addLayer=U.prototype.Ng;
U.prototype.df=function(a){var b=this.a.indexOf(a);a!==this.c&&a!==this.f&&-1!==b&&this.a.oc(b);return this};U.prototype.removeLayer=U.prototype.df;U.prototype.Bd=function(a){this.c!==a&&(this.a.a.length&&this.a.get(0)!==this.f?this.a.set(0,a):this.a.add(a,0),this.c=a);return this};U.prototype.setBaseLayer=U.prototype.Bd;U.prototype.gm=function(){return this.c};U.prototype.getBaseLayer=U.prototype.gm;
U.prototype.Ga=function(a){if(!Yf(a))throw new D(this.Ga,0,a);return(a=this.g.geoToScreen(a))?wf(a):y};U.prototype.geoToScreen=U.prototype.Ga;U.prototype.Wa=function(a,b){var c;if(c=+E(a)||2*E(b))throw new D(this.Wa,c-1,arguments[c-1]);return(c=this.g.screenToGeo(a,b))?Zf(c):y};U.prototype.screenToGeo=U.prototype.Wa;U.prototype.wg=function(a,b){return this.g.screenToLookAtData(a,b)};U.prototype.screenToLookAtData=U.prototype.wg;
U.prototype.ea=function(a){if(!C(a,M))throw new D(this.ea,0,a);!this.f&&hn(this);this.j.jc().ea(a);return a};U.prototype.addObject=U.prototype.ea;U.prototype.Ha=function(a){if(!C(a,M))throw new D(this.Ha,0,a);!this.f&&hn(this);this.j.jc().Ha(a);return a};U.prototype.removeObject=U.prototype.Ha;U.prototype.Ta=function(a){!this.f&&hn(this);return this.j.jc().Ta(a)};U.prototype.getObjects=U.prototype.Ta;
U.prototype.ec=function(a){var b;yc(a,this.ec,0,a);!this.f&&hn(this);var c=a.length;for(b=0;b<c;b++)this.ea(a[b]);return this};U.prototype.addObjects=U.prototype.ec;U.prototype.xd=function(a){var b;yc(a,this.xd,0,a);!this.f&&hn(this);var c=a.length;for(b=0;b<c;b++)this.Ha(a[b]);return this};U.prototype.removeObjects=U.prototype.xd;U.prototype.Vd=function(a,b,c){var d;if(d=+E(a)||2*E(b))throw new D(this.Vd,d-1,arguments[d-1]);this.g.getObjectsAt(a,b,!0,function(e){c(e[0])})};
U.prototype.getObjectAt=U.prototype.Vd;U.prototype.Ua=function(a,b,c){var d;if(d=+E(a)||2*E(b))throw new D(this.Vd,d-1,arguments[d-1]);this.g.getObjectsAt(a,b,!1,c)};U.prototype.getObjectsAt=U.prototype.Ua;U.prototype.vh=function(a,b,c){var d=c||gf;c=d.visiblesOnly;var e=d.zoom;d=d.types;var f=Pg.ANY;C(a,P,this.vh,0,"area");wc(b,"Function",this.vh,1,"callback");this.j.Ta(a,tc(c)?!!c:!0,tc(e)?+e:this.b.tb(),tc(d)?d&f:f,b)};U.prototype.getObjectsWithin=U.prototype.vh;
function hn(a){a.j=new N({max:24});a.f=new ol(a.j,a.i);a.a.add(a.f)}var jn={P2D:Cl.P2D,WEBGL:Cl.WEBGL};U.EngineType=jn;jn.HARP=Cl.HARP;U.prototype.o={Wo:"mapviewchangestart",cj:"mapviewchange",dj:"mapviewchangeend",xf:"baselayerchange",xl:"enginechange"};function nn(a,b){nn.l.constructor.call(this,a,b)}u(nn,Ni);t("H.map.Marker",nn);n=nn.prototype;n.type=Pg.MARKER;n.Eg=1;n.ua=function(a){if(a!==Mg.VISUAL||1===this.Ik||1===this.icon.getState())var b=nn.l.ua.call(this,a);return b||!1};n.Ik=0;n.ck=function(a){return C(a,Ij)};n.Jh=!1;n.xk=function(){this.ua(Mg.VISUAL)};
n.Oc=function(a){var b=this.icon;this.Jh&&(b.removeEventListener("statechange",this.xk,!1,this),delete this.Jh);b&&(this.Ik=b.getState());nn.l.Oc.call(this,a);0===a.getState()&&(this.Jh=!0,Ce(a,"statechange",this.xk,!1,this));return this};nn.prototype.setIcon=nn.prototype.Oc;nn.prototype.f=function(a){return new Ij(a.svg,a)};nn.prototype.W=function(){var a=this.getIcon(),b=a.Ho||0,c=nn.l.forWorkerMessage.call(this),d=c.properties.icon;d&&0<b&&Wa(d,{stick_color:a.Go,stick_height:b});return c};
nn.prototype.forWorkerMessage=nn.prototype.W;function on(a,b){on.l.constructor.call(this,jh,b);this.ke(a)}u(on,xi);t("H.map.Rect",on);on.prototype.ke=function(a){if(!C(a,K))throw new D(this.ke,0,a);a.na(this.T)||(this.T=this.R=a,this.eb!==y&&on.l.da.call(this,ni(a)))};on.prototype.setBoundingBox=on.prototype.ke;on.prototype.F=function(){return this.R};on.prototype.getBoundingBox=on.prototype.F;on.prototype.da=function(){return this};on.prototype.setGeometry=on.prototype.da;
on.prototype.ba=function(){this.eb||on.l.da.call(this,ni(this.T));return this.eb};on.prototype.getGeometry=on.prototype.ba;function jk(a,b,c){var d="anonymous",e=1;this.f=A(this.f,this);M.call(this,c);this.da(a);c&&(a="crossOrigin",a in c&&(d=c[a]),a="opacity",a in c&&(e=c[a]));this.Yk(b,d);this.pc(e)}u(jk,M);t("H.map.Overlay",jk);jk.prototype.type=Pg.OVERLAY;jk.prototype.F=function(){return this.R};jk.prototype.getBoundingBox=jk.prototype.F;jk.prototype.ke=function(a){C(a,K,this.ke,0,a);return this.da(a)};jk.prototype.setBoundingBox=jk.prototype.ke;jk.prototype.ba=function(){return this.R};
jk.prototype.getGeometry=jk.prototype.ba;jk.prototype.da=function(a){var b=this.R,c=!b;C(a,K,this.da,0,a);if(c||!b.na(a))this.R=a,c||this.ua(Mg.SPATIAL);return this};jk.prototype.setGeometry=jk.prototype.da;jk.prototype.Zc=function(){return this.b.getData()};jk.prototype.getBitmap=jk.prototype.Zc;jk.prototype.Yk=function(a,b){var c=this.b;c&&1!==c.getState()&&c.cancel();this.b=new Dj(a,this.f,!0,B,b);return this};jk.prototype.setBitmap=jk.prototype.Yk;
jk.prototype.f=function(a,b){this.b=b;1===a&&this.ua(Mg.VISUAL)};jk.prototype.ad=function(){return this.g};jk.prototype.getOpacity=jk.prototype.ad;jk.prototype.pc=function(a){var b=this.g,c=2>b;if(0<=a&&1>=a)a!==b&&(this.g=a,c&&this.ua(Mg.VISUAL));else throw new D(this.pc,0);return this};jk.prototype.setOpacity=jk.prototype.pc;jk.prototype.W=function(){var a=jk.l.W.call(this);a.geometry=ni(this.R).W();a.properties.overlay=!0;return a};jk.prototype.forWorkerMessage=jk.prototype.W;function pn(a){if(!a||!Ca(a.requestData))throw new D(pn,0,"options.requestData");pn.l.constructor.call(this,a);this.K=a.requestData;this.D=!!a.providesDomMarkers}u(pn,R);t("H.map.provider.MarkerTileProvider",pn);pn.prototype.Qd=function(a){return a?a.length+1:1};pn.prototype.getEntryWeight=pn.prototype.Qd;
pn.prototype.J=function(a,b,c,d,e){var f=this;return this.K(a,b,c,function(g){for(var h=[],k,l,m=g.length;m--;)l=g[m],l.Jo=f.getTileKey(a,b,c),l.ja(f),k=l.zb(),(C(l,Qi)||1===k.getState())&&h.push(g[m]);d(h)},e)};pn.prototype.requestInternal=pn.prototype.J;pn.prototype.$d=function(a,b){b===Mg.VISUAL&&(a=this.Pb().get(a.Jo))&&(a.valid=!1,Vj(this,a))};pn.prototype.invalidateObject=pn.prototype.$d;pn.prototype.Vb=function(){return this.D};pn.prototype.providesDomMarkers=pn.prototype.Vb;
pn.prototype.Wb=df;pn.prototype.providesMarkers=pn.prototype.Wb;function qn(a,b){qn.l.constructor.call(this,a,b)}u(qn,el);t("H.map.layer.MarkerTileLayer",qn);var rn={markers:[],total:0,requested:0};function sn(a,b,c,d,e){var f=yd(c);a.pixelProjection.Fa(f);b=a.Zd(a.Ge(b),f);c=a.Oe(b,b.left>b.right,~~c,d,e);a=c.tiles;c=c.total;d=a.length;e=[];var g;for(g=0;g<d;g++)for(b=a[g],f=b.data.length;f--;)e.push(b.data[f]);return{markers:e,total:a.length,requested:c}}qn.prototype.Kc=function(a,b,c,d){return this.a.providesDomMarkers()?rn:sn(this,a,b,c,d)};
qn.prototype.requestMarkers=qn.prototype.Kc;qn.prototype.Jc=function(a,b,c,d){return this.a.providesDomMarkers()?sn(this,a,b,c,d):rn};qn.prototype.requestDomMarkers=qn.prototype.Jc;function tn(a,b,c){var d,e=6;if(b){for(d=' expected close to: "'+b;e--;)b=a.a.next(),-1!==b&&(d+=String.fromCharCode(b));d+='"'}throw new D(un,0,"- Malformed WKT: "+(d?c+d:"unexpected end of stream"));}var vn={Cl:" ",zl:"(",Al:")",wl:",",yl:""};Object.keys(vn).reduce(function(a,b){a[vn[b]]=!0;return a},mc());function wn(a,b){var c=a.next();b=b?")":"(";c!==b&&tn(a,c,'"'+b+'"')}function xn(a){return","===yn(a)?(a.next(),!0):!1}
function zn(a,b,c,d,e){var f,g,h=2+b+c;for(g=1;g<=h;g++)(c=a.next())?(f=+c)!==f?tn(a,c,"number"):1===g?d[e+1]=f:2===g?d[e]=f:3===g&&(d[e+2]=f):tn(a,c);b||(d[e+2]=0)}var An=[];function Bn(a,b,c,d){d||wn(a,0);zn(a,b,c,An,0);d||wn(a,1);return new Xf(An[0],An[1],b?An[2]:B)}function Cn(a,b,c){var d=[];wn(a,0);do zn(a,b,c,d,d.length);while(xn(a));wn(a,1);return new L(d)}function Dn(a,b,c){wn(a,0);var d=Cn(a,b,c);if(xn(a)){var e=[];do e.push(Cn(a,b,c));while(xn(a))}wn(a,1);return new P(d,e)}
var En=[],Fn=[Dn],Gn=[Bn],Hn={POINT:Gn,LINESTRING:[Cn],POLYGON:Fn,MULTIPOINT:[Bn,Ji],MULTILINESTRING:[Cn,mh],MULTIPOLYGON:[Dn,vi],GEOMETRY:En,GEOMETRYCOLLECTION:En,CIRCULARSTRING:En,COMPOUNDCURVE:En,CURVEPOLYGON:En,MULTICURVE:En,MULTISURFACE:En,CURVE:En,SURFACE:En,POLYHEDRALSURFACE:En,TIN:En,TRIANGLE:En},In={Z:1,M:2,ZM:3};
function un(a){a=new Jn(a);var b;var c=a.next();(b=Hn[c.toUpperCase()])||tn(a,c,"type name");if(b!==En){c=yn(a);c=In[c.toUpperCase()];var d=c&1;var e=c>>1;d|e&&a.next();c=yn(a);if("EMPTY"===c)if(a.next(),d=b[1])var f=new d([]);else b!==Gn&&(f=new L([]),b===Fn&&(f=new P(f)));else if("("===c){f=b[0];b=b[1];if(b){var g=[];wn(a,0);if(f===Bn){var h="("!==yn(a);do g.push(f(a,d,e,h));while(xn(a))}else{do g.push(f(a,d,e));while(xn(a))}wn(a,1);d=new b(g)}else d=f(a,d,e);f=d}else tn(a,c,'"Z", "M", "ZM", "(" or "EMPTY"');
a.next()&&tn(a,c,"end of stream")}return f||y}function Jn(a){this.a=a}function yn(a){var b=a.b;if(b===B){for(b=a.a;b.Tb()===Kn;)b.next();if(Ln[b.Tb()])b=b.next(),b=b===Mn?"":String.fromCharCode(b);else{b.me();do b.next();while(!Ln[b.Tb()]);b=String.fromCharCode.apply(null,b.Nd())}a.b=b}return b}Jn.prototype.next=function(){var a=yn(this);""!==a&&delete this.b;return a};var Kn=32,Mn=-1,Nn={Cl:Kn,zl:40,Al:41,wl:44,yl:Mn},Ln=Object.keys(Nn).reduce(function(a,b){a[Nn[b]]=!0;return a},mc());function On(){}t("H.util.ICharStream",On);On.prototype.next=function(){};On.prototype.me=function(){};On.prototype.Nd=function(){};On.prototype.Tb=function(){};function Pn(a){this.c=String(a);this.f=0;this.a=[];this.b=!1}t("H.util.CharStream",Pn);Pn.prototype.next=function(){var a=this.c.charCodeAt(this.f++);a=isNaN(a)?-1:a;this.b&&this.a.push(a);return a};Pn.prototype.me=function(){this.b=!0;this.a=[]};Pn.prototype.Nd=function(){var a=this.a.slice();this.b=!1;this.a=[];return a};Pn.prototype.Tb=function(){var a=this.c.charCodeAt(this.f);return isNaN(a)?-1:a};t("H.util.wkt.toGeometry",function(a){return un(new Pn(a))});t("H.buildInfo",function(){return Ef("H-core","1.21.2","baf5b1d5")});var Qn=function(){var a="maps"+eval('"js-"');var b=x.document.querySelector('script[src*="'+a+'"]');if(!b){var c=x.document.getElementsByTagName("script");var d=new RegExp("^.*"+a);var e=0;for(a=c.length;e<a;e++)if(d.test(c[e].src)){b=c[e];break}}return b?b.src.replace(/\/[^\/]*$/,"/"):""}();t("H.getScriptPath",function(){return Qn});

function Rn(a,b){if(!a)throw new D(Rn,0,a);Rn.l.constructor.call(this,a);this.b={};this.c=b&&b.vc;this.f=Sn++}u(Rn,fm);var Sn=0;
Rn.prototype.$=function(a,b,c,d,e,f){var g=xd(d),h=this.gb,k=g+(c.exp-h.pixelProjection.exp),l=h.min,m=h.max;d=h.tileSize;var q=h.pa().i,p=this.Hb,r=p.ad();var v=p.Bb().w;var w=c.w,z=c.x,J=c.y,G={};if(g<l||g>m)return lk.DONE;e=h.requestTiles(a,k,e,f,this.f);a=e.total;e=e.tiles;f=e.length;this.g=c;this.j=b;this.a=k;r!==q&&p.pc(q);c=d=d*w/(Dd(2,k)*d);this.c||(d%1&&(d=yd(d),w=c/d,z/=w,J/=w,w=Dd(2,k)*d),z=yd(z),J=yd(J));this.i=c;k=-d;g=v+d;for(h=0;h<f;h++){v=e[h];if((l=v.data)&&l.tagName){c=b.x-(z-v.x*
d);q=b.y-(J-v.y*d);p.Yc(l,c,q,d,d);for(r=c;(r-=w)>k;)p.Yc(l,r,q,d,d);for(r=c;(r+=w)<g;)p.Yc(l,r,q,d,d)}G[this.a+"_"+v.x+"_"+v.y]=v}this.b=G;return f===a?lk.DONE:lk.PENDING};Rn.prototype.Ua=function(a,b,c){var d=this.i,e=d/this.gb.tileSize,f=this.g,g=this.j,h;if(tc(this.a)&&f){a=f.x+(a-g.x);b=f.y+(b-g.y);var k=yd(f.w/d);var l=f=yd(a/d);g=yd(b/d);Ad(l)>=k&&(l%=k);0>l&&(l=k+l);(k=this.b[this.a+"_"+l+"_"+g])&&k.Ua&&(h=k.Ua((a-d*f)/e,(b-d*g)/e,c))}return h||ff};Rn.prototype.Yd=function(){return"2d"};function Tn(a,b){b=b||{};C(a,ol,Tn,0);Tn.l.constructor.call(this,a);this.vc=!!b.vc;this.c=b.hb||0;this.a=[];this.b={}}u(Tn,fm);
Tn.prototype.$=function(a,b,c,d,e,f){var g,h=this.gb,k;d-=this.c;this.a.length=0;var l=this.b;this.b=g={};if(d>=h.min&&d<=h.max){var m=h.yd(a,d,e,f);var q=m.overlays;if(a=q.length)for(q.sort(Sg),d=this.Hb,e=this.vc,f=0;f<a;f++){h=q[f];var p=h.F();var r=c.kb(p.Rb());var v=c.kb(p.Ob());p=c.w;r.x>=v.x&&(r.x-=p);p=-((r.x+v.x)/p>>1)*p;r.x+=p;r.add(b);v.x+=p;v.add(b);e||(r.round(),v.round());(p=l[k=h.fb()])?delete l[k]:p={oo:h};g[k]=p;var w=r.x;r=r.y;var z=v.x;v=v.y;var J=z-w;var G=v-r;d.pc(h.ad());d.Yc(h.Zc(),
w,r,J,G);p.eh?p.eh.set(w,r,z,v):p.eh=new nk(w,r,z,v);this.a.push(p)}}return!m||m.requested&&m.requested===m.total||!m.requested&&q.length===m.total?lk.DONE:lk.PENDING};Tn.prototype.Ua=function(a,b,c){for(var d=this.a,e=d.length,f,g,h;e--;)if(f=d[e],g=f.eh,g.Hf(a,b))if(f=f.oo,h)h.push(f);else if(h=[f],c)break;return h||ff};Tn.prototype.Yd=function(){return"2d"};Tn.prototype.u=function(){this.a=null;Tn.l.u.call(this)};var Un={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:wl.ZOOM,COORD:wl.COORD},capture:!0};t("H.map.render.p2d.capabilities",Un);function Vn(a,b){this.a=[];Vn.l.constructor.apply(this,arguments)}u(Vn,lm);n=Vn.prototype;n.Ej=function(){return this.gb.Kc.apply(this.gb,arguments)};n.$=function(a,b,c,d,e,f,g){this.a=[];return Vn.l.$.apply(this,arguments)};n.jk=1;n.Nk=function(a,b,c,d,e,f){var g=this.jk=d.Za();e*=g;f*=g;var h=c.Bb();b=h.w*g;h=h.h*g;var k=c.md();this.vc?(e-=k.x*g,f-=k.y*g):(e=xd(e-k.x*g),f=xd(f-k.y*g));d.Yc(c.Zc(),e,f,b,h);a.detail?a.detail.set(e,f,e+b,f+h):a.detail=new nk(e,f,e+b,f+h);this.a.push(a)};
n.Ua=function(a,b,c){for(var d=this.a,e=d.length,f,g,h,k=ff,l=this.jk;e--&&!(f=d[e],g=f.detail,g.Hf(a,b)&&(f=f.tk,(!(h=f.zb().g)||h.Zf((a-g.left)/l,(b-g.top)/l,0))&&0>k.indexOf(f)&&(k===ff&&(k=[]),k.push(f),c))););return k};n.Yd=function(){return"2d"};n.u=function(){this.a=null;Vn.l.u.call(this)};function W(a,b,c,d){W.l.constructor.call(this,a,b,c,d);this.K=new I(0,0);if(c=d.renderBaseBackground)this.Sn=c.lower,this.Mn=c.higher;this.Ln=!!d.enableSubpixelRendering;this.Fd=Wn;this.Fj=0;this.Ae=this.Dj=!1;this.j=new Ql;this.a=d=new Yl;this.Hd=A(this.Hd,this);d.addEventListener(d.g.Hg,this.Hd);this.Ga=A(this.Ga,this);d=a.element;this.wa=a=d.ownerDocument.createElement("div");a.style.position="absolute";a.style.width=a.style.height="100%";a.style.zIndex=0;d.insertBefore(a,d.firstChild);this.Uj=
new xm(this.wa,this.qa);this.o=[];Xn(this);this.Wh=A(W.prototype.Wh,this);this.A=Yn;this.gf();this.zoom=Zn(this,this.O.tb()+this.hb);this.Jb();$n(this,b.sb().position,this.zoom);this.ab();this.T()}u(W,sl);t("H.map.render.p2d.RenderEngine",W);W.prototype.type=Cl.P2D;W.prototype.type=W.prototype.type;var Yn=2;W.prototype.getState=function(){return this.A};W.prototype.getState=W.prototype.getState;function ao(a,b,c){b=c-b;return Ad(b)<a.U.w/2?b:b-a.U.w*c/Ad(c)}
W.prototype.Tg=function(a){var b=this,c=a.b,d=a.newValue,e=a.modifiers;a=d.position;var f=d.bounds,g,h=this.zoom,k=this.b,l=0;e&Si.POSITION&&(g=b.U.kb(a));if(e&Si.BOUNDS)d=bo(this,f.F(),e&Si.ZOOM?d.zoom:B,e&Si.POSITION?a:B),this.O.$b(d,c);else{e&Si.POSITION||(g=b.U.kb(d.position));var m=g.x;var q=g.y;co(this);this.K.set(0,0);d=eo(this,d);var p=d.zoom;var r=d.position;if(c){var v=p-h;var w={x:k.x,y:k.y};c=this.U.dd(w).x;var z=this.U.projection.Nb(a);if(z.x!==this.b.x||z.y!==this.b.y||p!==this.zoom)m=
ao(this,c,m),fo(this,function(J){var G=J-l;if(p!==h){g=b.U.dd(z);var V=b.U.dd(w);m=ao(b,V.x,g.x);q=g.y-V.y}l=J;go(b,m*G,q*G);h+=v*G;ho(b,h);b.ab();b.ha()},this.jb,function(){$n(b,r,p);ho(b,p);b.ab(r);b.ha()},this.cc)}else io(this),$n(this,r,p),ho(this,p),this.ab(r);this.ha()}};W.prototype.jb=300;W.prototype.kf=function(a){var b=Cc(a);if(!b||b&&0>a)throw new D(this.kf,1,"positive number required");this.jb=a};W.prototype.setAnimationDuration=W.prototype.kf;W.prototype.lh=function(){return this.jb};
W.prototype.getAnimationDuration=W.prototype.lh;W.prototype.cc=im;W.prototype.lf=function(a){if(!Ca(a))throw new D(this.lf,1,"function required");this.cc=a};W.prototype.setAnimationEase=W.prototype.lf;W.prototype.mh=function(){return this.cc};W.prototype.getAnimationEase=W.prototype.mh;W.prototype.gf=function(){this.cc=im;this.jb=300};W.prototype.resetAnimationDefaults=W.prototype.gf;
W.prototype.ii=function(a,b,c){var d;this.Xa=Bk();(d=this.fa.ia.splice(a,1)[0])&&d.C&&d.C();(d=this.s.ia.splice(a,1)[0])&&d.C&&d.C();(d=this.V.ia.splice(a,1)[0])&&d.C&&d.C();(d=this.la.ia.splice(a,1)[0])&&d.C&&d.C();this.f=this.c.La();0===a&&(xl(this,b,!1),this.Jb());this.o=ym(this.Uj,jo(this),ko(this));this.he();c||this.ha()};function Xn(a){var b=a.c.La(),c=0,d=b.length;[a.fa={},a.s={},a.V={},a.la={}].forEach(function(e){e.Xc=[];e.ia=[]});for(a.f=a.c.La();c<d;c++)a.We(c,b[c]);a.Jb()}
W.prototype.ji=function(){this.Jb();this.ha()};W.prototype.Gh=function(a,b,c){var d,e,f,g;if(b){var h={vc:this.Ln,hb:this.hb};b.$?C(b,hm)?e=new gm(b):C(b,vm)&&(g=new gm(b)):(b.requestOverlays&&(d=new Tn(b,h)),b.requestTiles&&(e=new Rn(b,h)),b.requestMarkers&&(f=new Vn(b,h)),b.requestDomMarkers&&(g=new om(b,h)))}c=c||0;this.fa.ia.splice(a,c,d);this.s.ia.splice(a,c,e);this.V.ia.splice(a,c,f);this.la.ia.splice(a,c,g);this.f=this.c.La();this.o=ym(this.Uj,jo(this),ko(this))};
function ko(a){var b=[];b=b.concat(a.s.ia);b=b.concat(a.fa.ia);b=b.concat(a.V.ia);b=b.concat(a.la.ia);return b=b.filter(tc)}function eo(a,b){var c=yl(a,yl(a,b.zoom)+a.hb);a=zl(a,b);a.zoom=c;return a}function $n(a,b,c){var d=a.U;d.Fa(c);a.b=d.projection.Nb(b);d.x=d.w*a.b.x;d.y=d.h*a.b.y}W.prototype.Wa=function(a,b){var c=this.i.center,d=this.qa;return this.U.Pa((a-c.x)*d,(b-c.y)*d)};W.prototype.screenToGeo=W.prototype.Wa;W.prototype.wg=function(a,b){a=this.Wa(a,b);b=this.O.sb();b.position=a;return b};
W.prototype.Ga=function(a){var b=this.qa,c=this.i.center,d=c.x*b;c=c.y*b;a=this.U.kb(a);var e=this.U.w;return new I(xd((a.x-xd(a.x/e)*e+d)/b),xd((a.y+c)/b))};W.prototype.geoToScreen=W.prototype.Ga;W.prototype.F=function(a,b){var c=this.vb[a||4];a=this.U;var d=c.left-b,e=a.Pa(d,c.top-b),f=c.right+b;b=a.Pa(f,c.bottom+b);f-d>=a.w&&(e.lng=-(b.lng=180));return dg(e,b)};
W.prototype.Ua=function(a,b,c,d){var e=[],f=this.qa,g;a*=f;b*=f;f=[this.fa,this.s,this.V,this.la];for(g=f.length;g--&&(!c||!e.length);){for(var h=e,k=f[g].ia,l=a,m=b,q=c,p=k.length;p--&&!((e=k[p])&&e.Ua&&(h=h.concat(e.Ua(l,m,q)),h.length&&q)););e=h}d(e)};W.prototype.getObjectsAt=W.prototype.Ua;W.prototype.dc=y;function jo(a){a=a.vb[2];return{w:a.right-a.left,h:a.bottom-a.top}}
W.prototype.T=function(){var a=this.o.length,b;W.l.T.call(this);var c=jo(this);this.K.set(0,0);var d=c.w;for(b=c.h;a--;){c=this.o[a];var e=c.Bb();e.w===d&&e.h===b||cm(c,d,b)}this.dc=new Ki(d,b);this.ha()};W.prototype.getCapabilities=function(){return Un};W.prototype.getCapabilities=W.prototype.getCapabilities;function lo(a){Bk()-a.Xa<a.Fd&&!a.v?a.Ig=Lk(a.Wh):(a.v&&(a.he(),mo(a)),a.A=Yn)}n=W.prototype;n.he=function(){this.fa.Xc.length=0;this.s.Xc.length=0;this.V.Xc.length=0;this.la.Xc.length=0};
n.Wh=function(){var a;this.B&&this.B.before();var b=this.s.ia;var c=this.i.center.clone().scale(this.qa).round();var d=this.F(1,0);var e=this.F(1,no);var f=this.zoom;var g=f-this.hb;var h=this.U;var k=this.Sn;var l=this.Mn;var m=b[0];b=this.K;var q=this.o.length;var p=this.f;for(a=p.length;q--;){var r=this.o[q];C(r,em)&&r.clear()}if(m){if(k)for(;k;)q=f-k,m.$(d,c,h,q,!0,b),--k;if(l&&this.Ae)for(r=1;r<=l&&(q=f+r,h.Fa(q),k=this.F(2,0),h.Fa(f),!m.$(k,c,h,q,!0,b));r++);}for(this.Fd=Wn;a--;)h=p[a],C(h,
aj)&&h.pa()&&h.pa().oi(e,g);d=this.ik(d,c,f,!1,b,oo,this.s,this.fa);c=this.ik(e,c,g,!1,b,po,this.V,this.la);this.v=d&&c;this.D||(this.D=this.O.sb());this.D.bounds=this.F(4,0);this.O.ab(this.D);this.D=null;this.dc&&(this.i.ab(this.dc),this.dc=y);f<this.Fj?this.Ae=!0:this.Dj&&(this.Ae=!1);this.Fj=f;this.Dj=d;this.B&&this.B.after();lo(this)};
n.ik=function(a,b,c,d,e,f,g){var h=Array.prototype.slice.call(arguments,6),k=h.length,l=h[0].ia.length,m=k*l,q=!!m,p;for(p=0;p<m;p++){if(f===oo){var r=p%k;var v=Math.floor(p/k)}else r=Math.floor(p/l),v=p%l;var w=h[r].ia[v];r=h[r].Xc;w&&(w=w.$(a,b,this.U,c,d,e,this.Ga),w===lk.ACTIVE&&(this.Fd=Infinity),w!==lk.DONE||r[v]||(mo(this,this.f[v]),r[v]=!0),r[v]||(q=!1))}return q};function mo(a,b){a.dispatchEvent({type:a.gk.hj,target:b||a})}
n.u=function(){var a=this.c.La()[0],b=this.i;Mk(this.Ig);io(this,!0);a&&xl(this,a,!1);ko(this).forEach(function(c){c.C()});b.element&&b.element.removeChild(this.wa);this.wa=null;this.A=3;W.l.u.call(this)};n.ha=function(){this.Xa=Bk();this.A===Yn&&(this.v=!1,this.A=1,lo(this))};function qo(a,b,c){go(a,b*a.qa,c*a.qa);a.K.set(0,0);a.ab();a.ha()}function go(a,b,c){var d=a.U;a=a.b;d.x=Wd(d.x+b,d.w);d.y=wd(0,vd(d.w,d.y+c));a.x=d.x/d.w;a.y=d.y/d.h}
n.ne=function(a,b,c){a=yl(this,yl(this,a)+this.hb);ho(this,a,b,c)};W.prototype.zoomAt=W.prototype.ne;function ho(a,b,c,d){var e=a.qa,f=a.i.center;c===+c&&d===+d?(c=(c-f.x)*e,d=(d-f.y)*e,a.K.set(c,d),go(a,c,d),a.U.Fa(b),go(a,-c,-d)):(a.K.set(0,0),a.U.Fa(b));a.zoom=b;a.ab();a.ha()}
function bo(a,b,c,d){var e=a.getCapabilities().lookAt.zoom.max,f=b.lb(),g=d||f;if(b.ag()||c&&d)c=c===B?e:c;else{var h=new Yi(a.U.projection);h.Fa(e);var k=h.kb(b.Rb()).round();var l=h.kb(b.Ob()).round();e=h.w;b.Fb()&&(k.x-=e);d?(f=h.kb(g),b=2*wd(f.x-k.x,l.x-f.x),k=2*wd(f.y-k.y,l.y-f.y)):(b=l.x-k.x,k=l.y-k.y,g=f);c===B&&(f=a.vb[4],c=f.right-f.left,f=f.bottom-f.top,c=-8+vd(Bd(c/b*e)/Ld,Bd(f/k*e)/Ld)-a.hb,c=yl(a,c))}return{zoom:yd(c),position:g}}
function co(a){io(a,!0);a.a.Ea()&&a.xb(!0);a.j.Ea()&&a.yb(!0);io(a,!0)}W.prototype.sc=function(a,b){co(this);ro(this,b);this.j.start(a,!!b)};W.prototype.startInteraction=W.prototype.sc;function ro(a,b){if(b){var c={};c.$e=b.power;c.Be=b.ease;c.duration=b.duration;a.m=c}}function Zn(a,b){return yl(a,yl(a,b-a.hb)+a.hb)}
W.prototype.kc=function(a,b,c,d,e){var f=!1;this.j.Ea()&&(b=this.j.store(a,b,c,d,e),this.j.Gc(wl.COORD)&&(a=this.j.Ud(),0<Pl(a)&&(qo(this,-a.x,-a.y),f=!0)),b&&this.j.Gc(wl.ZOOM)&&(a=this.j.Nf(),b=this.j.Of(),b=Bd(Dd(2,this.zoom)*b)/Ld,b!==this.zoom&&(b=Zn(this,b),ho(this,b,a.x,a.y),f=!0)),f&&this.ha())};W.prototype.interaction=W.prototype.kc;
W.prototype.yb=function(a){var b=this;if(this.j.Ea()&&!a){if(this.m){a=this.j.Cb();var c=this.j.xc();var d=this.m.duration;var e=(this.m.$e||1)*a;var f=new wm(-e/(0<d?d:1),e);!E(c.x)&&!E(c.y)&&0<e&&b.j.Gc(wl.COORD)&&fo(this,function(g){e=f.Je(g*d);E(e)||qo(b,xd(-c.x*e),xd(-c.y*e))},d,void 0,this.m.Be)}this.m=null;this.j.clear()}};W.prototype.endInteraction=W.prototype.yb;W.prototype.rc=function(a,b,c){co(this);this.a.start(b,c);ro(this,a)};W.prototype.startControl=W.prototype.rc;
W.prototype.control=function(a,b,c){if(E(+c))throw new D(this.control,2,c);if(E(a))throw new D(this.control,0,a);if(E(b))throw new D(this.control,1,b);this.a.Ea()&&this.a.set(a,b,c,0,0,0)};W.prototype.control=W.prototype.control;
W.prototype.xb=function(a,b){var c=this,d;if(this.a.Ea()){io(this,!0);var e=Bk();var f=e-this.za;if(1<=f){var g=am(this.a);so(this,g,f)}if(!this.m||a||b)"function"===typeof b&&(a=this.sb(),a.zoom=this.zoom-this.hb,b(a),a.zoom+=this.hb,to(this,a));else{b=this.a.Cb();var h=this.a.xc();var k=this.m.duration;var l=(this.m.$e||1)*b;var m=new wm(-l/(0<k?k:1),l);!E(h.mb)&&!E(h.nb)&&0<l&&fo(this,function(q,p,r,v){e&&(r=v-e,e=0);l=m.Je(q*k)*r;E(l)||((d=h.ob*l)&&ho(c,Zn(c,c.zoom+d),c.a.b,c.a.c),qo(c,xd(h.mb*
l),xd(h.nb*l)))},k,void 0,this.m.Be)}this.a.reset()}};W.prototype.endControl=W.prototype.xb;
function to(a,b){var c=a.b,d=a.U.projection.Nb(b.position),e=a.U.dd(d),f=e.y;e=e.x;var g=b.zoom;c=a.U.dd(c);b=c.y;var h=c.x;c=a.zoom;var k=a.a.Cb(),l=a.a.b,m=a.a.c,q=0;e=ao(a,h,e);e-=h;f-=b;c=g-c;b=Cd(e*e+f*f+c*c);if(0!==k&&0!==b){var p=e/b;var r=f/b;var v=c/b;var w=k*k/(2*b);fo(a,function(z,J){var G;if(1!==z){z=k*J-w*J*J/2;J=z-q;if(G=v*J)G=Zn(a,a.zoom+G),ho(a,Zn(a,G),l,m);qo(a,xd(p*J),xd(r*J));q=z}else a.b=d,ho(a,Zn(a,g),l,m),a.ab(),a.ha()},2*b/k)}}
W.prototype.Hd=function(a){var b=this,c=a.c;this.K.set(0,0);c.mb||c.nb||c.ob?(this.za=Bk(),fo(this,function(d,e,f,g){b.za=g;so(b,c,f)},Number.POSITIVE_INFINITY)):io(this,!0)};function so(a,b,c){c=c||0;b.ob&&ho(a,Zn(a,a.zoom+b.ob*c),a.a.atX,a.a.atY);qo(a,b.mb*c,b.nb*c)}function fo(a,b,c,d,e){a.g&&a.g.Ea()&&a.g.stop(!0);a.g=new jm(b,c,d,e);a.g.start()}function io(a,b){a.g&&a.g.Ea()&&a.g.stop(b)}W.prototype.fh=function(){};W.prototype.enter=W.prototype.fh;W.prototype.Mf=function(a){vl(this.wa,a)};
W.prototype.exit=W.prototype.Mf;W.prototype.capture=function(a,b,c,d){var e=this.wa.ownerDocument.createElement("canvas"),f=e.getContext("2d"),g=this.qa;e.width=(c-a)*g;e.height=(d-b)*g;for(c=0;c<this.o.length;c++)d=this.o[c],C(d,em)&&f.drawImage(d.G(),-a*g,-b*g);return Xb(e)};var po=0,oo=1,Wn=1E3,no=256;

function uo(a){var b=a.ownerDocument;b=b.documentElement||b.body.parentNode||b.body;try{var c=a.getBoundingClientRect()}catch(d){c={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:c.left+("number"===typeof window.pageXOffset?window.pageXOffset:b.scrollLeft),y:c.top+("number"===typeof window.pageYOffset?window.pageYOffset:b.scrollTop)}}var vo=Function("return this")();function wo(a,b,c,d,e,f,g){wo.l.constructor.call(this,a);this.pointers=b;this.changedPointers=c;this.targetPointers=d;this.currentPointer=e;this.originalEvent=g;this.target=f}u(wo,rd);t("H.mapevents.Event",wo);function xo(a,b,c,d,e,f){if(isNaN(a))throw Error("x needs to be a number");if(isNaN(b))throw Error("y needs to be a number");if(isNaN(c))throw Error("pointer must have an id");this.viewportX=a;this.viewportY=b;this.target=null;this.id=c;this.type=d;this.dragTarget=null;this.button=tc(e)?e:-1;this.buttons=tc(f)?f:0;this.a=this.button}t("H.mapevents.Pointer",xo);
function yo(a,b,c){if(isNaN(b))throw Error("x needs to be a number");if(isNaN(c))throw Error("y needs to be a number");a.viewportX=b;a.viewportY=c}xo.prototype.Hm=function(){return this.a};xo.prototype.getLastChangedButton=xo.prototype.Hm;function zo(a,b){a.a=b;a.buttons|=xo.prototype.b[+b]||0}function Ao(a,b){a.a=b;a.buttons&=~(xo.prototype.b[+b]||0)}xo.prototype.b=[1,4,2];var Bo={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};xo.Button=Bo;function Co(a){this.a=a instanceof Array?a.slice(0):[]}n=Co.prototype;n.clear=function(){this.a.splice(0,this.a.length)};n.length=function(){return this.a.length};n.indexOf=function(a){for(var b=this.a.length;b--;)if(this.a[b].id===a)return b;return-1};function Do(a,b){b=a.indexOf(b);return-1!==b?a.a[b]:null}n.remove=function(a){a=this.indexOf(a);return-1!==a?this.a.splice(a,1)[0]:null};function Eo(a,b){for(var c=a.a.length,d=[];c--;)a.a[c].type!==b&&d.push(a.a[c]);a.a=d}
function Fo(a,b){for(var c=a.a.length;c--;)if(a.a[c].dragTarget===b)return!0;return!1}n.push=function(a){if(a instanceof xo)return this.a.push(a);throw Error("list needs a pointer");};n.La=function(){return this.a};n.clone=function(){return new Co(this.a)};function Go(a,b,c){c=c||{};if(!(a instanceof U))throw Error("events: map instance required");if(!(b instanceof Array))throw Error("events: map array required");nd.call(this);this.ah=c.ah||300;this.sj=c.sj||50;this.ll=c.ll||50;this.ml=c.ml||500;this.Ph=c.Ph||900;this.Oh=c.Oh||8;this.map=a;this.o=this.map.ya;this.j=this.o.element;this.O=b;this.a=new Co;this.b=new Co;this.i={};this.c=null;this.s=!0;this.aa={};this.f={};this.m=null;this.ye=A(this.ye,this);this.B={pointerdown:this.Tl,pointermove:this.Ul,
pointerup:this.Vl,pointercancel:this.Sl};Ho(this)}u(Go,nd);function Ho(a,b){var c,d=a.O.length;for(c=0;c<d;c++){var e=a.O[c];var f=e.listener;"function"===typeof f&&(b?(e.target||a.j).removeEventListener(e.Ra,f):(e.target||a.j).addEventListener(e.Ra,f))}}function Io(a,b,c){var d;if("function"===typeof a.B[b]){"pointermove"!==b&&(a.s=!0);var e=0;for(d=a.b.length();e<d;e++){var f=a.b.a[e];a.j.contains(c.target)?Jo(a,f,a.yj.bind(a,c,b,f)):a.yj(c,b,f,null)}}a.b.clear()}n=Go.prototype;
n.yj=function(a,b,c,d){Ko(c.id,this.aa);this.B[b].call(this,c,d,a)};function Jo(a,b,c){if(a.c===b)c(b.target);else{var d=a.o;var e=b.viewportX;b=b.viewportY;if(0>e||0>b||e>=d.width||b>=d.height)c(y);else{var f=a.map;f.Vd(e,b,function(g){c(g||f)})}}}
n.Vl=function(a,b,c){var d=a.id;a.target=b;Lo(this,a,c);Mo(this,b,"pointerup",c,a);"mouse"!==a.type&&Mo(this,b,"pointerleave",c,a);b=this.i[a.id];var e={x:a.viewportX,y:a.viewportY},f=c.timeStamp,g=a.target,h=this.m;b&&b.target===g&&b.ue.Ya(e)<this.ll&&f-b.Ri<this.ml?(Mo(this,g,"tap",c,a),h&&h.target===g&&f-h.Ri<this.ah?h.ue.Ya({x:a.viewportX,y:a.viewportY})<this.sj&&(Mo(this,g,"dbltap",c,a),this.m=null):this.m={target:g,ue:new I(a.viewportX,a.viewportY),Ri:c.timeStamp}):this.m=null;this.i={};Ko(d,
this.f)};function Lo(a,b,c){b===a.c&&(Mo(a,b.dragTarget,"dragend",c,b),a.c=null,Ko(b.id,a.aa));b.dragTarget=null}n.ye=function(a,b){var c=this;Mo(this,a.dragTarget,"drag",b,a);Ko(a.id,this.aa);this.aa[a.id]=setTimeout(function(){c.ye(a,b)},150)};function Ko(a,b){b[a]&&(b[a].timeout?clearTimeout(b[a].timeout):clearTimeout(b[a]),delete b[a])}
function No(a,b,c){var d=b.target,e=new I(b.viewportX,b.viewportY),f=b.id;Ko(f,a.f);var g=setTimeout(function(){d&&d===b.target&&e.Ya({x:b.viewportX,y:b.viewportY})<a.Oh&&(Mo(a,d,"longpress",c,b),delete a.i[b.id])},a.Ph);a.f[f]={timeout:g,ue:e}}
n.Ul=function(a,b,c){var d=a.dragTarget,e=a.id;var f=a.target;a.target=b;f!==b&&(Mo(this,f,"pointerleave",c,a),Mo(this,b,"pointerenter",c,a));d?this.c?(this.ye(a,c),this.f[e]&&this.f[e].ue.Ya({x:a.viewportX,y:a.viewportY})>this.Oh&&Ko(e,this.f)):this.s?this.s=!1:(this.c=a,Mo(this,d,"dragstart",c,a),this.ye(a,c),delete this.i[e],this.s=!0):(!this.c||this.c&&this.c.dragTarget!==b&&this.c.dragTarget!==this.map)&&Mo(this,b,"pointermove",c,a)};
n.Tl=function(a,b,c){var d=!(/^(?:mouse|pen)$/.test(a.type)&&0!==c.button);if(b){a.target=b;this.i[a.id]={ue:new I(a.viewportX,a.viewportY),target:a.target,Ri:c.timeStamp};"mouse"!==a.type&&Mo(this,b,"pointerenter",c,a);var e=Mo(this,b,"pointerdown",c,a);!this.c&&d&&(b.draggable&&!Fo(this.a,b)?a.dragTarget=b:!this.map.draggable||e.defaultPrevented||Fo(this.a,this.map)||(a.dragTarget=this.map));No(this,a,c)}};
n.Sl=function(a,b,c){var d=a.id;a.target=null;b?(Mo(this,b,"pointerleave",c,a),Mo(this,b,"pointercancel",c,a)):Mo(this,this.map,"pointercancel",c,a);Lo(this,a,c);this.i={};Ko(d,this.f)};function Mo(a,b,c,d,e){if(b&&"function"===typeof b.dispatchEvent){var f=wo;var g=a.a.La(),h=a.b.La();a=a.a;var k,l=a.a.length,m=[];for(k=0;k<l;k++)a.a[k].target===b&&m.push(a.a[k]);f=new f(c,g,h,m,e,b,d);e.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(c)?e.a:Bo.NONE;b.dispatchEvent(f)}return f}
n.u=function(){Ho(this,!0);this.a.clear();this.b.clear();var a=this.aa,b;for(b in a)Ko(b,a);a=this.f;for(var c in a)Ko(c,a);this.c=this.i=this.m=this.map=this.b=this.a=this.O=this.S=null;nd.prototype.u.call(this)};function Oo(a){this.g=A(this.g,this);Go.call(this,a,[{Ra:"touchstart",listener:this.g},{Ra:"touchmove",listener:this.g},{Ra:"touchend",listener:this.g},{Ra:"touchcancel",listener:this.g}]);this.D={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"};this.v=(a=(a=a.m)?a.G():null)?Array.prototype.slice.call(a.querySelectorAll("a"),0):[]}u(Oo,Go);
Oo.prototype.g=function(a){var b=a.touches,c=this.a.length(),d;if("touchstart"===a.type&&c>=b.length){c=this.a.clone();for(d=b.length;d--;)c.remove(b[d].identifier);for(d=c.length();d--;)this.a.remove(c.a[d].id);this.b=c;Io(this,"pointercancel",a);this.b.clear()}if(this.D[a.type]){b=uo(this.o.element);c=a.type;d=a.changedTouches;var e=d.length,f;this.b.clear();for(f=0;f<e;f++){var g=d[f];var h=Do(this.a,g.identifier);var k=g.pageX-b.x;var l=g.pageY-b.y;if(h)if("touchmove"===c){g=Math.abs(h.viewportX-
k);var m=Math.abs(h.viewportY-l);if(1<g||1<m||1===g&&1===m)yo(h,k,l),this.b.push(h)}else"touchend"===c&&(this.a.remove(h.id),this.b.push(h),Ao(h,Bo.LEFT));else h=new xo(k,l,g.identifier,"touch",Bo.LEFT,1),this.a.push(h),this.b.push(h)}Io(this,this.D[a.type],a);-1===this.v.indexOf(a.target)&&a.preventDefault()}};Oo.prototype.u=function(){this.v=null;Go.prototype.u.call(this)};function Po(a){var b=Qo(this);(window.PointerEvent||window.MSPointerEvent)&&b.push({Ra:"MSHoldVisual",listener:"prevent"});Go.call(this,a,b)}u(Po,Go);function Qo(a){var b=!!window.PointerEvent,c,d,e=[];a.g=A(a.g,a);"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(f){c=f.toLowerCase().replace(/ms/g,"");d=b?c:f;e.push({Ra:d,listener:a.g,target:"MSPointerUp"===f||"MSPointerMove"===f?window:null})});return e}var Ro={2:"touch",3:"pen",4:"mouse"};
Po.prototype.g=function(a){var b=window.PointerEvent?a.type:a.type.toLowerCase().replace(/ms/g,""),c=uo(this.j),d=Do(this.a,a.pointerId),e=a.pageX-c.x;c=a.pageY-c.y;var f=Ro[a.pointerType]||a.pointerType;$c&&"rtl"===x.getComputedStyle(this.o.element).direction&&(e-=(x.devicePixelRatio-1)*this.o.width);if(!(d||b in{pointerup:1,pointerout:1,pointercancel:1}||"touch"===f&&"pointerdown"!==b)){d={x:e,y:c};var g=a.pointerType;"number"===typeof g&&(g=Ro[g]);d=new xo(d.x,d.y,a.pointerId,g,a.button,a.buttons);
this.a.push(d)}d&&(b in{pointerup:1,pointercancel:1}?("touch"===f&&this.a.remove(d.id),Ao(d,a.button)):"pointerdown"===b&&("touch"===a.pointerType&&(Eo(this.a,"mouse"),Eo(this.a,"pen")),zo(d,a.button)),this.b.push(d),"pointermove"!==b?(yo(d,e,c),Io(this,"pointerout"===b||"pointerover"===b?"pointermove":b,a)):d.viewportX===e&&d.viewportY===c||a.target===document.documentElement||(yo(d,e,c),Io(this,b,a)));this.b.clear()};function So(a,b,c,d){So.l.constructor.call(this,"contextmenu");this.items=[];this.viewportX=a;this.viewportY=b;this.target=c;this.originalEvent=d}u(So,rd);t("H.mapevents.ContextMenuEvent",So);function To(a){this.Bh=A(this.Bh,this);this.Dh=A(this.Dh,this);this.Ch=A(this.Ch,this);this.v=!1;this.g=-1;this.D=0;To.l.constructor.call(this,a,[{Ra:"contextmenu",listener:this.Bh},{target:a,Ra:"longpress",listener:this.Dh},{target:a,Ra:"dbltap",listener:this.Ch}])}u(To,Go);n=To.prototype;n.Dh=function(a){var b=a.currentPointer;"touch"===b.type&&1===a.pointers.length&&Uo(this,b.viewportX,b.viewportY,a.originalEvent,a.target)};n.Ch=function(a){"touch"===a.currentPointer.type&&(this.D=Date.now())};
n.Bh=function(a){var b=this;-1===this.g?this.g=setTimeout(function(){var c=uo(b.j),d=a.pageX-c.x;c=a.pageY-c.y;b.g=-1;Uo(b,d,c,a)},this.ah):(clearInterval(this.g),this.g=-1);a.preventDefault()};function Uo(a,b,c,d,e){var f=a.map,g=Date.now()-a.D;e?!a.v&&g>a.Ph&&(a.v=!0,e.dispatchEvent(new So(b,c,e,d)),Ce(f.G(),a.Zi,a.xj,!1,a)):f.Vd(b,c,a.Un.bind(a,b,c,d))}n.Un=function(a,b,c,d){d=d&&Ca(d.dispatchEvent)?d:this.map;Uo(this,a,b,c,d)};n.Zi=["mousedown","touchstart","pointerdown","wheel"];
n.xj=function(){this.v&&(this.v=!1,this.map.dispatchEvent(new rd("contextmenuclose",this.map)))};n.u=function(){var a=this.map.G();clearInterval(this.g);a&&Ke(a,this.Zi,this.xj,!1,this);Go.prototype.u.call(this)};function Vo(a,b,c,d,e){Vo.l.constructor.call(this,"wheel");this.delta=a;this.viewportX=b;this.viewportY=c;this.target=d;this.originalEvent=e}u(Vo,rd);t("H.mapevents.WheelEvent",Vo);function Wo(a){var b="onwheel"in document;this.K=b;this.D=(b?"d":"wheelD")+"elta";this.g=A(this.g,this);Wo.l.constructor.call(this,a,[{Ra:(b?"":"mouse")+"wheel",listener:this.g}]);this.v=this.map.ya}u(Wo,Go);
Wo.prototype.g=function(a){if(!a.vl){var b=uo(this.j);var c=a.pageX-b.x;b=a.pageY-b.y;var d=this.D,e=a[d+(d+"Y"in a?"Y":"")],f;$c&&"rtl"===x.getComputedStyle(this.v.element).direction&&(c-=(x.devicePixelRatio-1)*this.v.width);if(e){var g=Math.abs;var h=g(e);e=(!(f=a[d+"X"])||3<=h/g(f))&&(!(f=a[d+"Z"])||3<=h/g(f))?((0<e)-(0>e))*(this.K?1:-1):0}c=new Vo(e,c,b,null,a);c.delta&&(a.stopImmediatePropagation(),a.preventDefault(),this.map.Vd(c.viewportX,c.viewportY,this.T.bind(this,c)))}};
Wo.prototype.T=function(a,b){var c=a.target=b||this.map,d,e;setTimeout(function(){c.dispatchEvent(a);a.f||(d=a.originalEvent,e=new x.WheelEvent("wheel",d),e.vl=1,d.target.dispatchEvent(e))},0)};function Xo(a){var b=window;this.g=A(this.g,this);Go.call(this,a,[{Ra:"mousedown",listener:this.g},{Ra:"mousemove",listener:this.g,target:b},{Ra:"mouseup",listener:this.g,target:b},{Ra:"mouseover",listener:this.g},{Ra:"mouseout",listener:this.g},{Ra:"dragstart",listener:this.v}])}u(Xo,Go);
Xo.prototype.g=function(a){var b=a.type,c=uo(this.j);c={x:a.pageX-c.x,y:a.pageY-c.y};var d;(d=this.a.a[0])||(d=new xo(c.x,c.y,1,"mouse"),this.a.push(d));this.b.push(d);yo(d,c.x,c.y);/^mouse(?:move|over|out)$/.test(b)?Io(this,"pointermove",a):(/^mouse(down|up)$/.test(b)&&(c=a.which-1,"up"===vo.RegExp.$1?Ao(d,c):zo(d,c)),Io(this,b.replace("mouse","pointer"),a));this.b.clear()};Xo.prototype.v=function(a){a.preventDefault()};function Yo(a){var b=a.ya.element.style;if(-1!==Zo.indexOf(a))throw Error("InvalidArgument: map is already in use");this.a=a;Zo.push(a);b.msTouchAction=b.touchAction="none";bd||!window.PointerEvent&&!window.MSPointerEvent?(this.c=new Oo(this.a),this.b=new Xo(this.a)):this.c=new Po(this.a);this.g=new Wo(this.a);this.f=new To(this.a);this.a.wb(this.C,this);nd.call(this)}u(Yo,nd);t("H.mapevents.MapEvents",Yo);Yo.prototype.c=null;Yo.prototype.b=null;Yo.prototype.g=null;Yo.prototype.f=null;
var Zo=[];Fc(Zo);Yo.prototype.C=function(){this.a=null;this.c.C();this.g.C();this.f.C();this.b&&this.b.C();Zo.splice(Zo.indexOf(this.a),1);nd.prototype.C.call(this)};Yo.prototype.dispose=Yo.prototype.C;Yo.prototype.fm=function(){return this.a};Yo.prototype.getAttachedMap=Yo.prototype.fm;function $o(a,b){b=void 0===b?{}:b;var c;$o.l.constructor.call(this);if(-1!==ap.indexOf(a))throw new D($o,0,"events are already used");this.a=c=a.a;this.j=a;ap.push(a);c.draggable=!0;this.i=b.kinetics||{duration:600,ease:im};this.m=b.modifierKey||"Alt";this.enable(b.enabled);this.c=c.ya;this.f=this.c.element;this.g=0;c.addEventListener("dragstart",this.Zh,!1,this);c.addEventListener("drag",this.lk,!1,this);c.addEventListener("dragend",this.Yh,!0,this);c.addEventListener("wheel",this.Bk,!1,this);c.addEventListener("dbltap",
this.wk,!1,this);c.addEventListener("pointermove",this.mk,!1,this);Be(this.f,"contextmenu",this.kk,!1,this);a.wb(this.C,this)}u($o,nd);t("H.mapevents.Behavior",$o);var ap=[];Fc(ap);$o.prototype.b=0;var bp={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};$o.Feature=bp;var cp=bp.PANNING,dp=bp.PINCH_ZOOM,ep=bp.WHEEL_ZOOM,fp=bp.DBL_TAP_ZOOM,gp=bp.FRACTIONAL_ZOOM,hp=bp.TILT,ip=bp.HEADING,jp=cp|dp|ep|fp|gp|hp|ip;$o.DRAGGING=cp;$o.WHEELZOOM=ep;
$o.DBLTAPZOOM=fp;$o.FRACTIONALZOOM=gp;function kp(a,b){if(a!==+a||a%1||0>a||2147483647<a)throw new D(b,0,"integer in range [0...0x7FFFFFFF] required");}$o.prototype.disable=function(a){var b=this.b;a!==B?(kp(a,this.disable),b^=b&a):b=0;this.c.endInteraction(!0);this.b=b;this.a.draggable=0<(b&(cp|hp|ip|dp))};$o.prototype.disable=$o.prototype.disable;$o.prototype.enable=function(a){var b=this.b;a!==B?(kp(a,this.enable),b|=a&jp):b=jp;this.b=b;this.a.draggable=0<(b&(cp|hp|ip|dp))};
$o.prototype.enable=$o.prototype.enable;$o.prototype.isEnabled=function(a){kp(a,this.isEnabled);return a===(this.b&a)};$o.prototype.isEnabled=$o.prototype.isEnabled;
function lp(a,b,c){var d="touch"===b.currentPointer.type,e=0,f;if(f=!d){f=a.m;var g,h=b.originalEvent;h.getModifierState?g=h.getModifierState(f):g=!!h[f.replace(/^Control$/,"ctrl").toLowerCase()+"Key"];f=g}f?e|=hp|ip:(e|=cp,d&&(b=b.pointers,2===b.length&&(e|=dp|ip,c?55>Ad(b[0].viewportY-b[1].viewportY)&&(e|=hp):a.Hh&wl.TILT&&(e|=hp))));e&=a.b;return(e&hp?wl.TILT:0)|(e&ip?wl.HEADING:0)|(e&dp?wl.ZOOM:0)|(e&cp?wl.COORD:0)}
function mp(a){var b=a.pointers;a=b[0];b=b[1];a=[a.viewportX,a.viewportY];b&&a.push(b.viewportX,b.viewportY);return a}n=$o.prototype;n.Hh=0;n.Zh=function(a){var b=lp(this,a,!0);if(this.Hh=b){var c=this.c;a=mp(a);c.startInteraction(b,this.i);c.interaction.apply(c,a);if(this.b&ep&&!(this.b&gp)&&(b=a[0],c=a[1],this.g)){a=this.a.tb();var d=(0>this.g?zd:yd)(a);a!==d&&(this.g=0,np(this,a,d,b,c))}}};
n.lk=function(a){var b=lp(this,a,!1);if(b!==this.Hh)"pointerout"!==a.originalEvent.type&&"pointerover"!==a.originalEvent.type&&(this.Yh(a),this.Zh(a));else if(b){b=this.c;var c=mp(a);b.interaction.apply(b,c);a.originalEvent.preventDefault()}};n.Yh=function(a){lp(this,a,!1)&&this.c.endInteraction(!this.i)};
function np(a,b,c,d,e){var f=+c-+b;a=a.a.b;if(isNaN(+b))throw Error("start zoom needs to be a number");if(isNaN(+c))throw Error("to zoom needs to be a number");0!==f&&(a.startControl(null,d,e),a.control(0,0,6,0,0,0),a.endControl(!0,function(g){g.zoom=c}))}n.Bk=function(a){if(!a.defaultPrevented&&this.b&ep){var b=a.delta;var c=this.a.tb();var d=this.a;var e=d.hc().type;d=this.b&gp?c-b:(0>-b?zd:yd)(c)-b;if(e===jn.P2D||e===jn.WEBGL||e===jn.HARP)np(this,c,d,a.viewportX,a.viewportY),this.g=b;a.preventDefault()}};
n.mk=function(){};n.wk=function(a){var b=a.currentPointer,c=this.a.tb(),d=a.currentPointer.type,e=this.a.hc().type;(e===jn.P2D||e===jn.WEBGL||e===jn.HARP)&&this.b&fp&&(a="mouse"===d?0===a.originalEvent.button?-1:1:0<a.pointers.length?1:-1,a=this.b&gp?c-a:(0>-a?zd:yd)(c)-a,np(this,c,a,b.viewportX,b.viewportY))};n.kk=function(a){return this.b&fp?(a.preventDefault(),!1):!0};
n.C=function(){var a=this.a;a&&(a.draggable=!1,a.removeEventListener("dragstart",this.Zh,!1,this),a.removeEventListener("drag",this.lk,!1,this),a.removeEventListener("dragend",this.Yh,!0,this),a.removeEventListener("wheel",this.Bk,!1,this),a.removeEventListener("dbltap",this.wk,!1,this),a.removeEventListener("pointermove",this.mk,!1,this),this.a=null);this.f&&(this.f.style.msTouchAction="",Ke(this.f,"contextmenu",this.kk,!1,this),this.f=null);this.i=this.c=null;ap.splice(ap.indexOf(this.j),1);nd.prototype.C.call(this)};
$o.prototype.dispose=$o.prototype.C;t("H.mapevents.buildInfo",function(){return Ef("H-mapevents","1.21.2","7bcdf09")});

R.prototype.O=ca(3,function(a){var b=this.getCache(),c=this;if(a!==y){C(a,Fk,R.prototype.O,0);var d=a}else d=jl;d!==b&&b.ra(function(e,f,g){return c.fc(e)?(d.add(e,f,g),!0):!1});this.T=d});Th.prototype.b=ca(2,function(a){this.i=a;a=this.getState();a!==Qh.INIT&&a!==Qh.LOADING&&ai(this)});function op(a,b){Wa.apply(null,arguments);return a}
function pp(a,b){b=void 0===b?{}:b;if(!a.ak)throw new Yc(a);pp.l.constructor.call(this);var c=qp(this,b);if(!c.baseUrl&&!c.platformBaseUrl)throw new D(a,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.c=(c.baseUrl?c.baseUrl:c.platformBaseUrl).clone();a=c.baseUrl?b:c;a.host&&this.c.yg(a.host);a.subDomain&&this.c.Qa(a.subDomain);a.path&&this.c.nf(a.path);rp(this.c);this.eg=c.headers||{}}u(pp,F);t("H.service.Service",pp);function qp(a,b){a=a.a();return b?op({},a,b):a}
pp.prototype.a=function(){return{}};pp.prototype.I=function(){return this.c};pp.prototype.getUrl=pp.prototype.I;pp.prototype.J=function(a,b,c,d){d=new rf(void 0===d?"application/json":d,a.toString(),fe,{headers:this.eg});d.then(b,sp(this,a,c));return d};function sp(a,b,c){return function(d){return"function"!==typeof d.json?Promise.reject(c(tp(b,d))):d.json().then(function(e){return c(a.b(e))},function(){return c(tp(b,d))})}}pp.prototype.b=function(a){return Error(a.message)};
function tp(a,b){return Error((b.statusText?"["+b.statusText+"] ":"")+a+" request failed")};function X(a,b,c,d,e,f){if(a&&b)this.el(a),this.yg(b),this.nf(c),this.dl(e),this.Uk(f),this.Hi(d);else throw Error('Parameters "scheme" and "host" must be specified');}t("H.service.Url",X);
function up(a,b){var c=x.document,d,e=c&&c.createElement("a"),f="";if(c){if(b){var g=(d=c.getElementsByTagName("base")[0])&&d.href;var h=c.head;var k=d||h.appendChild(c.createElement("base"));k.href=b}e.href=a;f=e.href;b&&(d?d.href=g:h.removeChild(k))}else/[\w]+:\/\//.test(a)&&(f=a);g=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(f);a=g[1];k=g[4];b=g[5];h=g[6];c=g[7];d=g[8];!g[2]&&k&&/@/.test(k)&&(k=k.split("@")[1]);g=k;h=h&&0<h.length?h.substr(1):
"";k={};if(c)for(e=/([?&]?([^=&+]+))(=([^&]+))?/g;f=e.exec(c);)k[decodeURIComponent(f[2])]=f[4]?decodeURIComponent(f[4]):void 0;return new X(a,g,h,k,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}X.parse=up;var vp=0;X.prototype.clone=function(){vp++;var a={},b;for(b in this.a)a[b]=this.a[b];return new X(this.s,this.f,this.c,a,this.g,this.b)};X.prototype.clone=X.prototype.clone;
X.prototype.el=function(a){if(!a||"string"!==typeof a)throw Error('The "scheme" parameter must be a non-empty string.');this.s=a;return this};X.prototype.setScheme=X.prototype.el;X.prototype.jn=function(){return this.s};X.prototype.getScheme=X.prototype.jn;X.prototype.yg=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw Error('The "host" parameter is not a valid host name.');this.f=a;return this};X.prototype.setHost=X.prototype.yg;
X.prototype.Dm=function(){return this.f};X.prototype.getHost=X.prototype.Dm;X.prototype.nf=function(a){this.c=a||void 0;return this};X.prototype.setPath=X.prototype.nf;X.prototype.Wm=function(){return this.c};X.prototype.getPath=X.prototype.Wm;X.prototype.Hi=function(a){if(a)if("object"==typeof a)this.a=a;else throw Error('Parameter "params" must be an object.');else this.a={};return this};X.prototype.setQuery=X.prototype.Hi;X.prototype.Vj=function(){return!wp(this)};X.prototype.hasQuery=X.prototype.Vj;
X.prototype.getQuery=function(){return this.a};X.prototype.getQuery=X.prototype.getQuery;X.prototype.dl=function(a){if(a&&isNaN(parseInt(a,10)))throw Error('Parameter "port" must be a number or undefined');this.g=+a||void 0;return this};X.prototype.setPort=X.prototype.dl;X.prototype.$m=function(){return this.g};X.prototype.getPort=X.prototype.$m;X.prototype.Uk=function(a){this.b=a||void 0;return this};X.prototype.setAnchor=X.prototype.Uk;X.prototype.md=function(){return this.b};
X.prototype.getAnchor=X.prototype.md;X.prototype.N=function(a){if("object"!==typeof a)throw Error('Parameter "other" must be an object.');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};X.prototype.mergeQuery=X.prototype.N;X.prototype.Qa=function(a){if(!a||"string"!==typeof a)throw Error('Parameter "subDomain" must be a non-empty string');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.yg(a+"."+this.f)};
X.prototype.addSubDomain=X.prototype.Qa;X.prototype.L=function(a){if(!a||"string"!==typeof a)throw Error('Parameter "subPath" must be a non-empty string');return this.nf((this.c?this.c+"/":"")+a)};X.prototype.addSubPath=X.prototype.L;X.prototype.toString=function(){return[this.s+"://",this.f,this.g?":"+this.g:"",this.c||!wp(this)||this.b?"/":"",this.c?encodeURI(this.c):"",xp(this),this.b?"#"+encodeURIComponent(this.b):""].join("")};X.prototype.toString=X.prototype.toString;
function xp(a){var b=[],c,d=a.a,e;for(c in d)if(d.hasOwnProperty(c)&&"function"!==typeof d[c]){var f=a.a[c];if(C(f,yp)){var g=0;var h=f.tl;for(e=h.length;g<e;)b.push(encodeURIComponent(c)+(void 0===f?"":"="+encodeURIComponent(h[g]))),g++}else b.push(encodeURIComponent(c)+(void 0===f?"":"="+encodeURIComponent(f)))}return 0<b.length?"?"+b.join("&"):""}function rp(a){var b=Ef("H-service","1.21.2","f330b0b");a.a.xnlp="CL_JSMv3."+b.version;return a}
function wp(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}function yp(a){var b;if(!yc(a))throw new D(yp,0,a);for(b=0;b<a.length;b++){var c=a[b];if(!zc(c)&&!Cc(c))throw new D(yp,0,"The array can only contain strings and numbers");}this.tl=a}X.MultiValueQueryParameter=yp;yp.prototype.sn=function(){return this.tl};yp.prototype.getValues=yp.prototype.sn;function Y(a){a=op({},this.b,a);var b=a.apikey||a.apiKey,c=a.baseUrl;if(c=b?c?0:"baseUrl":"apikey")throw new D(Y,0,'"'+c+'" must be specified');this.Xk(a.baseUrl);this.a=b;this.c.N({apikey:b});this.f=a.headers||{};this.g=Ua(a.servicesConfig||{})}t("H.service.Platform",Y);Y.prototype.b={apikey:null,baseUrl:new X("https","hereapi.com")};Y.prototype.Xk=function(a){this.c=rp(a.clone());this.a=a=this.a;this.c.N({apikey:a})};Y.prototype.setBaseUrl=Y.prototype.Xk;Y.prototype.gc=function(){return this.c};
Y.prototype.getBaseUrl=Y.prototype.gc;Y.prototype.bb=function(a,b){try{return a.ak=!0,new a(op({platformBaseUrl:this.gc(),headers:this.f},this.g[a.CONFIG_KEY]||{},b||{}))}finally{delete a.ak}};Y.prototype.createService=Y.prototype.bb;var zp=Function("return this")();rc("monospace serif");function Ap(){}Ap.prototype.pop=function(a){this[a]||(this[a]=[]);return this[a].pop()||zp.document.createElement("canvas")};Ap.prototype.push=function(a,b){this[b]||(this[b]=[]);this[b].push(a)};var Bp=new Ap;t("H.service.util.eval",function(a){return eval(a)});function Cp(){var a=decodeURIComponent(x.H.getScriptPath())||"https://js.api.here.com/v3/3.1.21.2";return up(a).L("styles")};function Dp(a,b,c){var d=this;c=c||{};var e=+c.min,f=+c.max;c.tileSize=c.tileSize||512;c.min=e?Yd(e,1,17):1;c.min+=Dk(c.tileSize,1);c.max=f?Yd(f,1,17):17;Dp.l.constructor.call(this,c);C(a,Ep,Dp,0);C(b,Ph,Dp,1);this.o=a;b.b&&b.b("OMV");this.Dd(b,!0);this.s=function(){Fp(d);d.reload(!1)};a.addEventListener("versionupdate",this.s);Fp(this);Dp.prototype.D=function(){var g=/^v2\/vectortiles\/(.+)\/mc$/.exec(a.I().c);return g?g[1]:B+""}()}u(Dp,R);t("H.service.omv.Provider",Dp);
function Fp(a){var b=a.qd("_#-;,:","_#-;,:","_#-;,:");a.v=new RegExp("^"+b.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}Dp.prototype.fc=function(a){return this.v.test(a)};Dp.prototype.cacheFilter=Dp.prototype.fc;Dp.prototype.qd=function(a,b,c){return Gp(this.o,a,b,c).toString()};Dp.prototype.getTileKey=Dp.prototype.qd;Dp.prototype.Pb=function(){return this.K};Dp.prototype.getCache=Dp.prototype.Pb;Dp.prototype.MAX_STORE_TIME=2592E6;Dp.prototype.Vg=function(){return md()};
Dp.prototype.Xd=function(){return md()?ld():Dp.l.Xd.call(this)};Dp.prototype.J=function(a,b,c,d,e){return this.o.ib(a,b,c,d,e)};Dp.prototype.requestInternal=Dp.prototype.J;Dp.prototype.fd=function(a){a.b&&a.b("OMV");this.Dd(a)};Dp.prototype.setStyle=Dp.prototype.fd;Dp.prototype.ta=function(){return Dp.l.Db.apply(this)};Dp.prototype.getStyle=Dp.prototype.ta;
Dp.prototype.Db=function(){var a=Dp.l.Db.apply(this),b;this.B&&(a.getState()===Qh.READY?(b=a.nd())&&b.global&&(this.c&&(b.global.ux_language=this.c),this.a&&(b.global.ux_language_fallback=this.a),a=new Th(b,a.gc())):a.load());return a};function Ip(a,b,c){var d=a.Db().getState()===Qh.READY,e=zc(b),f=zc(c);e&&(a.c=b);f&&(a.a=c);if(e||f)a.B=!0,d&&a.f()}Dp.prototype.u=function(){Dp.l.u.call(this);this.o.removeEventListener("versionupdate",this.s)};Dp.prototype.K=new Fk(256);
Dp.prototype.sa=function(a,b){return Jp(this.o.sa(),this.D,b,a)};Dp.prototype.getCopyrights=Dp.prototype.sa;function Ep(a){Ep.l.constructor.call(this,Ep,a);a=qp(this,a).mapVersion;this.Se=tc(a)?a:Kp[this.I().toString()];tc(this.Se)||Lp(this)}u(Ep,pp);t("H.service.omv.Service",Ep);Ep.prototype.a=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}};Ep.CONFIG_KEY="omv";var Kp={};Fc(Kp);Ep.prototype.Nm=function(){return this.Se};Ep.prototype.getMapVersion=Ep.prototype.Nm;
function Lp(a){a.J(a.I().clone().L("../../info"),function(b){b=b.mapVersion;var c=a.I().toString();a.Se=b;b!==Kp[c]&&(Kp[c]=b,a.dispatchEvent("versionupdate"))},function(){})}Ep.prototype.jd=function(a,b){return new nl(new Dp(this,a,b),{max:22})};Ep.prototype.createLayer=Ep.prototype.jd;Ep.prototype.ib=function(a,b,c,d,e){return this.J(Gp(this,a,b,c),function(f){return f.arrayBuffer().then(d,e)},e,"arraybuffer")};
function Gp(a,b,c,d){b=a.I().clone().L(d+"/"+b+"/"+c+"/omv");tc(a.Se)&&b.N({mv:a.Se});return b}Ep.prototype.Wf=function(a){return Cp().L("omv/"+a+".yaml")};Y.prototype.Mj=function(a){return this.bb(Ep,a)};Y.prototype.getOMVService=Y.prototype.Mj;Ep.prototype.Ee=function(){this.Wc=new Mp;this.J(this.I().clone().L("../../copyrights"),A(this.Si,this),id)};Ep.prototype.Si=function(a){Np(this.Wc,a);this.dispatchEvent("copyrightupdate")};Ep.prototype.sa=function(){this.Wc||this.Ee();return this.Wc};
Ep.prototype.getCopyrights=Ep.prototype.sa;function Mp(){this.a={}}function Np(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d,e=b[c],f=a.a[c]||(a.a[c]=[]),g=e.length;for(d=0;d<g;d++)f.push(new Op(e[d]))}}function Jp(a,b,c,d){var e=(a=a.a[b])?a.length:0,f=[];for(b=0;b<e;b++)a[b].sd(c,d)&&f.push(a[b]);return f}
function Op(a){var b,c=a.boxes;this.label=a.label;this.min=a.minLevel;this.max=a.maxLevel;this.b=[];if(c&&(b=c.length)){var d=c[0];var e=new K(d[0],d[1],d[2],d[3]);this.b.push(e);this.a=new K(d[0],d[1],d[2],d[3]);for(a=1;a<b;a++)d=c[a],e=new K(d[0],d[1],d[2],d[3]),this.b.push(e),this.a.mc(e,!1,this.a)}}Op.prototype.sd=function(a,b){if(a>=this.min&&a<=this.max)if((a=this.b.length)&&this.a){if(this.a.sd(b))for(;a--;)if(this.b[a].sd(b))return!0}else return!0;return!1};function Pp(a,b,c,d,e,f,g){var h=this;g=g||{};f=f?f:{};var k=a.I().clone().L(b+"/"+a.Bc()+"/"+c).N(f),l=a.yh();this.D=a;this.V=k;uk.call(this,{tileSize:d,max:512===d?19:20,min:512===d?2:0,getURL:function(m,q,p){var r=h.V.clone();l&&r.Qa(l[(p+q+m)%l.length]);r.L(p+"/"+m+"/"+q+"/"+d+"/"+e);return r.toString()},crossOrigin:g.crossOrigin,headers:g.headers,uri:k.toString().replace(/_/g,"")+d});this.jb=b;this.s=c;this.a=f;this.vb=c.split(".")[0];this.dg=A(this.dg,this);this.getCopyrights=this.sa;a.addEventListener("versionupdate",
this.dg)}u(Pp,uk);Pp.prototype.MAX_STORE_TIME=2592E6;n=Pp.prototype;n.u=function(){uk.prototype.u.call(this);this.D.removeEventListener("versionupdate",this.dg)};n.sa=function(a,b){return Jp(this.D.sa(),this.vb,b,a)};n.dg=function(){var a=this.D;this.V=a.I().clone().L(this.jb+"/"+a.Bc()+"/"+this.s).N(this.a);this.reload(!1)};n.Vg=function(){return md()};n.Xd=function(){return md()?ld():Pp.l.Xd.call(this)};function Qp(a){Qp.l.constructor.call(this,Qp,a);a=qp(this,a);this.ac=a.shards;(this.Oa=a.ignoreTypes?null:a.type)&&this.I().Qa(this.Oa);this.bc=a.version;this.Wc=new Mp;this.ri={};this.Jf=0;"newest"===this.bc&&this.hh()}u(Qp,pp);t("H.service.MapTileService",Qp);Qp.prototype.a=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}};Qp.CONFIG_KEY="maptile";
function Rp(a,b){for(var c={},d=a[b+"s"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+"s"]=c}Qp.prototype.yh=function(){return this.ac};Qp.prototype.Qj=function(){return this.Oa};Qp.prototype.getType=Qp.prototype.Qj;Qp.prototype.Bc=function(){return this.bc};Qp.prototype.getVersion=Qp.prototype.Bc;Qp.prototype.Li=function(a){this.bc=a};Qp.prototype.sa=function(){this.Jf||(this.bc&&"newest"!==this.bc||"traffic"===this.Oa)&&this.Ee();return this.Wc};Qp.prototype.getCopyrights=Qp.prototype.sa;n=Qp.prototype;
n.Ti=function(a){a=a.response;var b;Rp(a,"map");Rp(a,"scheme");Rp(a,"tiletype");Rp(a,"format");Rp(a,"resolution");Rp(a,"language");if("newest"===this.bc&&"traffic"!==this.Oa)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.Li(a.maps[b].hash),this.dispatchEvent("versionupdate"));this.Fh=a;this.dispatchEvent("infoupdate")};n.Si=function(a){Np(this.Wc,a);this.dispatchEvent("copyrightupdate")};
n.hh=function(){var a=this;var b=this.I().clone().L("info").N({output:"json"});this.ac&&b.Qa(this.ac[0]);this.J(b,function(c){a.Ti(c)},function(c){throw c;})};n.Ee=function(){var a=this;var b=this.I().clone().L("copyright").L(a.Bc()).N({output:"json"});this.ac&&b.Qa(this.ac[0]);this.Jf=1;this.J(b,function(c){a.Jf=2;a.Si(c)},function(c){a.Jf=-1;throw c;})};n.rh=function(){return this.Fh};Qp.prototype.getInfo=Qp.prototype.rh;
Qp.prototype.ze=function(a,b,c,d,e,f){var g=this.I().clone().L(a+"/"+this.Bc()+"/"+b+"/"+c+"/"+d).N(e?e:{}).toString();var h=0,k,l=g.length;if(0!==l)for(k=0;k<l;k++){var m=g.charCodeAt(k);h=(h<<5)-h+m;h|=0}g=h;h=this.ri[g];h||(h=new Pp(this,a,b,c,d,e,op({headers:this.eg},f||{})),this.ri[g]=h);return h};Qp.prototype.createTileProvider=Qp.prototype.ze;Qp.prototype.uc=function(a,b,c,d,e,f,g,h){a=this.ze(a,b,c,d,e,h);return new nl(a,{opacity:f,dark:!!g})};Qp.prototype.createTileLayer=Qp.prototype.uc;
Y.prototype.uh=function(a){return this.bb(Qp,a)};Y.prototype.getMapTileService=Y.prototype.uh;Y.prototype.Zg=function(a,b,c,d,e,f){var g=this.uh(),h=this.uh({type:"aerial"}),k=this.Pj(),l=this.Mj(),m={},q={crossOrigin:"anonymous"};Da(a)&&(f=a,"crossOrigin"in f&&(q.crossOrigin=f.crossOrigin),a=f.tileSize,b=f.ppi,c=f.lg,d=f.lg2,e=f.style,f=f.pois);var p=a||512;if(0>[72,250,320,500].indexOf(+b)){if(b!==B)throw new D(this.Zg,1,b);}else m.ppi=+b;c&&(m.lg=c);d&&(m.lg2=d);e&&(m.style=e);f&&(m.pois=f);a=function(r,v,w,z,J){return r.uc(v,w,p,z,m,1,J,q)};b=l.jd(new Th(l.Wf("miami/normal.day").toString()));
Ip(b.pa(),m.lg,m.lg2);c=l.jd(new Th(l.Wf("miami/truck.day").toString()));Ip(c.pa(),m.lg,m.lg2);l=k.qj(m.lg?{lg:m.lg,i18n:!0}:void 0);return{vector:{normal:{map:b,truck:c,traffic:k.pj(),trafficincidents:l}},raster:{normal:{xbase:a(g,"xbasetile","normal.day","png8",!1),xbasenight:a(g,"xbasetile","normal.night","png8",!0),base:a(g,"basetile","normal.day","png8",!1),basenight:a(g,"basetile","normal.night","png8",!0),map:a(g,"maptile","normal.day","png8",!1),mapnight:a(g,"maptile","normal.night","png8",
!0),trafficincidents:l,transit:a(g,"maptile","normal.day.transit","png8",!1),labels:a(g,"labeltile","normal.day","png",!1)},satellite:{xbase:a(h,"xbasetile","hybrid.day","jpg",!0),base:a(h,"basetile","hybrid.day","jpg",!0),map:a(h,"maptile","hybrid.day","jpg",!0),labels:a(h,"labeltile","hybrid.day","png",!0)},terrain:{xbase:a(h,"xbasetile","terrain.day","jpg",!1),base:a(h,"basetile","terrain.day","jpg",!1),map:a(h,"maptile","terrain.day","jpg",!1),labels:a(h,"labeltile","terrain.day","png",!1)}}}};
Y.prototype.createDefaultLayers=Y.prototype.Zg;function Sp(){this.a={}}Sp.prototype.zb=function(a,b){var c=a+b,d;if(d=this.a[c])return d;a=Tp.MARKER.replace("{{icon}}",Up[a]||Up.OTHER);a=a.replace("{{color}}",Vp[b]||Vp.BLOCKING);b={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Li(Mi.POLYGON,Wp.MARKER)};return this.a[c]=d=new Ij(a,b)};
var Tp={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},Up=
{CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',
ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',
ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',
OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},
Vp={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},Wp={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function Xp(a,b,c){c=c?c:{};c.criticality||(c.criticality="major,critical");C(a,Yp,Xp,0);pn.call(this,{max:20,min:8,requestData:A(this.V,this)});this.s=new Sp;this.B=a;this.a=c;this.reload=A(this.reload,this);this.v=setInterval(this.reload,b||18E4)}u(Xp,pn);t("H.service.traffic.incidents.Provider",Xp);Xp.prototype.c={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};
Xp.prototype.V=function(a,b,c,d,e){var f=this,g=this.c,h=this.s;return this.B.requestIncidentsByTile(a,b,c,function(k){var l=[];k=k.TRAFFIC_ITEMS;var m;if(k)for(k=k.TRAFFIC_ITEM,m=k.length;m--;){var q=k[m];var p=q.TRAFFIC_ITEM_TYPE_DESC;switch(p){case "ACCIDENT":case "CONGESTION":var r=p;break;case "CONSTRUCTION":r="ROADWORKS";break;default:r="OTHER"}r=h.zb(r,g[q.CRITICALITY.DESCRIPTION]);p=q.LOCATION.GEOLOC.ORIGIN;p=new nn({lat:p.LATITUDE,lng:p.LONGITUDE},{provider:f,icon:r});p.setData(q);l.push(p)}d(l)},
e,this.a)};Xp.prototype.C=function(){pn.prototype.C.call(this);clearInterval(this.v)};var Zp="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function $p(a,b){var c={};this.a=a;Wa(c,b||c);ck.call(this,c);this.rg={};a=this.Qb(Pg.SPATIAL);a.update(a.a+1,Mg.ADD)}u($p,ck);t("H.service.remote.ObjectProvider",$p);$p.prototype.C=function(){ck.prototype.C.call(this)};$p.prototype.Kc=function(){return ff};$p.prototype.requestMarkers=$p.prototype.Kc;$p.prototype.Jc=function(){return ff};$p.prototype.requestDomMarkers=$p.prototype.Jc;$p.prototype.yd=function(){return ff};$p.prototype.requestOverlays=$p.prototype.yd;$p.prototype.Wb=df;
$p.prototype.providesMarkers=$p.prototype.Wb;$p.prototype.Vb=df;$p.prototype.providesDomMarkers=$p.prototype.Vb;$p.prototype.Ic=df;$p.prototype.providesSpatials=$p.prototype.Ic;$p.prototype.sg=function(){return ff};$p.prototype.requestSpatials=$p.prototype.sg;function aq(a){return a.Cc(!0)}$p.prototype.tg=function(a,b){a=bq(this,a,cq);b&&(a=a.filter(aq));return a};$p.prototype.requestSpatialsByTile=$p.prototype.tg;
function bq(a,b,c){var d=b.j&&b.j[c],e;!d&&(e=b.m)&&(delete b.m,(b.j=a=a.a.parse(a,b,e))&&(d=a[c]));return d||ff}$p.prototype.ea=function(a){var b=a.fb();if(this.rg[b])throw new Yc(this.ea,"Remote object "+b+" already added");return this.rg[b]=a};$p.prototype.Ha=function(a){delete this.rg[a.fb()]};var cq="spatials";function dq(a,b,c){dq.l.constructor.call(this,{min:eq,max:fq});C(a,Yp,dq,0);this.s=a;this.a=c||gq;this.a.responseattributes="sh,fc";this.c=setInterval(A(this.reload,this),b||18E4);this.Dd(new Th(a.Wf().toString()),!0)}u(dq,R);t("H.service.traffic.flow.Provider",dq);dq.prototype.ta=function(){return this.Db()};dq.prototype.getStyle=dq.prototype.ta;dq.prototype.fd=function(a){a.b&&a.b("GeoJSONTileSource");this.Dd(a)};dq.prototype.setStyle=dq.prototype.fd;var gq={locationreferences:"tmc,shp"};
dq.prototype.u=function(){dq.l.u.call(this);clearInterval(this.c)};dq.prototype.J=function(a,b,c,d,e){return this.s.requestFlowByTile(a,b,c,function(f){f.type&&-1!==f.type.indexOf("Error")?e(f.Details):d(f)},e,this.a)};dq.prototype.requestInternal=dq.prototype.J;
dq.prototype.kd=function(a,b,c,d,e){var f,g,h,k,l={type:"FeatureCollection",features:[]},m;var q=d.RWS.length;for(f=0;f<q;f++){var p=d.RWS[f];var r=p.RW;var v=r.length;var w=-1!==Zp.indexOf(p.EXTENDED_COUNTRY_CODE+p.EBU_COUNTRY_CODE);for(p=0;p<v;p++){var z=r[p].FIS;var J=z.length;for(z=0;z<J;z++){var G=r[p].FIS[z].FI;var V=G.length;for(g=0;g<V;g++){var T=G[g];var ua=[];var ea=T.CF[0];var ac=!!ea.SSS;var sb={type:"Feature",properties:ea,geometry:{type:"MultiLineString",coordinates:ua}};sb.properties.LHT=
w;T.SHP.length&&(sb.properties.FC=T.SHP[0].FC);ac&&(m=[]);for(ea=0;ea<T.SHP.length;ea++){var ad=T.SHP[ea].value;var si=ad.length;for(h=0;h<si;h++){var Ie=ac?m:void 0,Pb=new Pn(ad[h].trim()),Of=[],Sc={};for(Pb.me();-1!==(k=Pb.Tb());)k===hq?(Sc.lat=+String.fromCharCode.apply(dq,Pb.Nd()),Pb.next(),Pb.me()):k===iq?(Sc.lng=+String.fromCharCode.apply(dq,Pb.Nd()),Of.push([Sc.lng,Sc.lat]),Ie&&Ie.push(Zf(Sc)),Sc=[],Pb.next(),Pb.me()):Pb.next();Sc.lng=+String.fromCharCode.apply(dq,Pb.Nd());Of.push([Sc.lng,
Sc.lat]);Ie&&Ie.push(Zf(Sc));k=Of;ua.push(k)}}l.features.push(sb)}}}}return dq.l.kd.call(this,a,b,c,l,e)};dq.prototype.createTileInternal=dq.prototype.kd;var fq=21,eq=10,iq=32,hq=44;function jq(a){function b(m){d.contains(e)&&d.removeChild(e);l&&clearTimeout(l);delete jq.a[f];m&&a.Bj&&a.Bj.call(k,m)}if(!a.url||!a.Ug)throw Error('Parameter "options" must specify at least a URL and a callback.');if("function"!==typeof a.Ug)throw Error("Parameters options.callback must be a function");var c=a.ap||document;var d=c.getElementsByTagName("head")[0];var e=c.createElement("script");c=a.url instanceof X?a.url:up(a.url,a.$o);var f=jq.b++;var g=a.Ml||"callback";var h=a.Ug;var k={};var l=
null;k.id=f;k.cancel=function(){b("cancelled")};0!==a.timeout&&(l=x.setTimeout(function(){b("timeout")},a.timeout||3E4));jq.a[f]=function(m){b();h.call(k,m)};e.type="text/javascript";e.src=c.toString()+(c.Vj()?"&":"?")+g+"="+(a.bp?"H.service.jsonp.handleResponse("+f+")":encodeURI("H.service.jsonp.handleResponse("+f+")"));d.appendChild(e);return k}t("H.service.jsonp",jq);jq.yn=function(a){return(a=jq.a[a])?a:function(){}};jq.handleResponse=jq.yn;jq.b=0;jq.a={};function Yp(a){Yp.l.constructor.call(this,Yp,a);this.Nl=qp(this,a).callbackKey}u(Yp,pp);t("H.service.traffic.Service",Yp);Yp.prototype.a=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}};Yp.CONFIG_KEY="traffic";Yp.prototype.pj=function(a){return new nl(new dq(this,void 0,a),{max:22})};Yp.prototype.createFlowLayer=Yp.prototype.pj;Yp.prototype.qj=function(a){return new qn(new Xp(this,void 0,a))};Yp.prototype.createIncidentsLayer=Yp.prototype.qj;
function kq(a,b,c,d){return jq({url:b,Ug:c,Bj:function(e){d(Error("["+e+"] "+b+" request failed"))},Ml:a.Nl})}Yp.prototype.xo=function(a,b,c){a=this.I().clone().L("incidents.json").N(a);return kq(this,a,b,c)};Yp.prototype.requestIncidents=Yp.prototype.xo;Yp.prototype.wo=function(a,b,c,d,e,f){a=this.I().clone().L(["flow/json",c,a,b].join("/")).N(f||{});return kq(this,a,d,e)};Yp.prototype.requestFlowByTile=Yp.prototype.wo;
Yp.prototype.yo=function(a,b,c,d,e,f){a=this.I().clone().L(["incidents/json",c,a,b].join("/")).N(f||{});return kq(this,a,d,e)};Yp.prototype.requestIncidentsByTile=Yp.prototype.yo;Yp.prototype.Wf=function(){return Cp().L("traffic/flow.yaml")};Y.prototype.Pj=function(a){return this.bb(Yp,a)};Y.prototype.getTrafficService=Y.prototype.Pj;function lq(a){lq.l.constructor.call(this,lq,a);this.Sk=qp(this,a).reverseSubDomain}u(lq,pp);t("H.service.GeocodingService",lq);lq.prototype.a=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}};lq.CONFIG_KEY="geocoding";lq.prototype.b=function(a){return Error(a.Details||a.message||a.error)};lq.prototype.kh=function(a,b,c){a=this.I().clone().L("geocode.json").N(a);return this.J(a,b,c)};lq.prototype.geocode=lq.prototype.kh;
lq.prototype.vi=function(a,b,c){a=this.I().clone().L("reversegeocode.json").N(a);this.Sk&&a.Qa(this.Sk);return this.J(a,b,c)};lq.prototype.reverseGeocode=lq.prototype.vi;lq.prototype.search=function(a,b,c){a=this.I().clone().L("search.json").N(a);return this.J(a,b,c)};lq.prototype.search=lq.prototype.search;Y.prototype.zm=function(a){return this.bb(lq,a)};Y.prototype.getGeocodingService=Y.prototype.zm;function mq(a){mq.l.constructor.call(this,mq,a)}u(mq,pp);t("H.service.PlacesService",mq);mq.prototype.a=function(){return{subDomain:"places.ls",path:"places/v1"}};mq.CONFIG_KEY="places";mq.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"};mq.prototype.request=function(a,b,c,d){return this.va(a,b,c,d)};
mq.prototype.va=function(a,b,c,d){a=this.I().clone().L(a).N(b||{});return this.J(a,c,d)};mq.prototype.search=function(a,b,c){return this.va("discover/search",a,b,c)};mq.prototype.search=mq.prototype.search;mq.prototype.Io=function(a,b,c){return this.va("suggest",a,b,c)};mq.prototype.suggest=mq.prototype.Io;mq.prototype.Xl=function(a,b,c){return this.va("discover/explore",a,b,c)};mq.prototype.explore=mq.prototype.Xl;mq.prototype.Hl=function(a,b,c){return this.va("discover/around",a,b,c)};
mq.prototype.around=mq.prototype.Hl;mq.prototype.An=function(a,b,c){return this.va("discover/here",a,b,c)};mq.prototype.here=mq.prototype.An;mq.prototype.Ol=function(a,b,c){return this.va("categories/places",a,b,c)};mq.prototype.categories=mq.prototype.Ol;mq.prototype.Zl=function(a,b,c,d){a=up(a).N(this.I().getQuery()).N(d||{});return this.J(a,b,c)};mq.prototype.follow=mq.prototype.Zl;Y.prototype.Xm=function(a){return this.bb(mq,a)};Y.prototype.getPlacesService=Y.prototype.Xm;function nq(a){nq.l.constructor.call(this,nq,a)}u(nq,pp);t("H.service.publicTransit.Service",nq);nq.prototype.a=function(){return{subDomain:"transit.router",path:"v8"}};nq.CONFIG_KEY="publicTransit";nq.prototype.gn=function(a,b,c){a=this.I().clone().L("routes").N(a);return this.J(a,b,c)};nq.prototype.getRoutes=nq.prototype.gn;nq.prototype.sm=function(a,b,c){a=this.I().clone().L("departures").N(a);return this.J(a,b,c)};nq.prototype.getDepartures=nq.prototype.sm;
nq.prototype.ln=function(a,b,c){a=this.I().clone().L("stations").N(a);return this.J(a,b,c)};nq.prototype.getStations=nq.prototype.ln;nq.prototype.b=function(a){return Error(JSON.stringify(a))};Y.prototype.cn=function(a){return this.bb(nq,a)};Y.prototype.getPublicTransitService=Y.prototype.cn;function oq(a){oq.l.constructor.call(this,oq,a)}u(oq,pp);t("H.service.RoutingService",oq);oq.prototype.a=function(){return{subDomain:"route.ls",path:"routing/7.2"}};oq.prototype.b=function(a){return Error(a.details)};oq.CONFIG_KEY="routing";oq.prototype.Id=function(a,b,c){a=this.I().clone().L("calculateroute.json").N(a);return this.J(a,b,c)};oq.prototype.calculateRoute=oq.prototype.Id;
oq.prototype.Ll=function(a,b,c){a=this.I().clone().Qa("isoline").L("calculateisoline.json").N(a);return this.J(a,b,c)};oq.prototype.calculateIsoline=oq.prototype.Ll;function pq(a){pq.l.constructor.call(this,pq,a)}u(pq,pp);t("H.service.RoutingService8",pq);pq.CONFIG_KEY="routing_v8";pq.prototype.a=function(){return{subDomain:"router",path:"v8/routes"}};pq.prototype.b=function(a){return Error(a.error)};pq.prototype.Id=function(a,b,c){a=this.I().clone().N(a);return this.J(a,b,c)};pq.prototype.calculateRoute=pq.prototype.Id;Y.prototype.Nj=function(a,b){b=+b||7;if(7===b)b=oq;else if(8===b)b=pq;else throw new D(this.Nj,1,"allowed values are 7 and 8");return this.bb(b,a)};Y.prototype.getRoutingService=Y.prototype.Nj;function qq(){}t("H.service.extension.dataView.ITable",qq);qq.prototype.Td=function(){};qq.prototype.getMeta=qq.prototype.Td;qq.prototype.Wd=function(){};qq.prototype.getRowCount=qq.prototype.Wd;qq.prototype.Ac=function(){};qq.prototype.getRow=qq.prototype.Ac;qq.prototype.Sa=function(){};qq.prototype.getColumnNames=qq.prototype.Sa;qq.prototype.He=function(){};qq.prototype.getColumn=qq.prototype.He;qq.prototype.xa=function(){};qq.prototype.getCell=qq.prototype.xa;qq.prototype.concat=function(){};
qq.prototype.concat=qq.prototype.concat;function rq(){}t("H.service.extension.dataView.IRow",rq);rq.prototype.Sa=function(){};rq.prototype.getColumnNames=rq.prototype.Sa;rq.prototype.xa=function(){};rq.prototype.getCell=rq.prototype.xa;rq.prototype.pd=function(){};rq.prototype.getTable=rq.prototype.pd;function sq(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",sq);sq.prototype.Sa=function(){return this.a.Sa()};sq.prototype.getColumnNames=sq.prototype.Sa;sq.prototype.xa=function(a){return this.a.xa(this.b,a)};sq.prototype.getCell=sq.prototype.xa;sq.prototype.pd=function(){return this.a};sq.prototype.getTable=sq.prototype.pd;function tq(){}t("H.service.extension.dataView.IColumn",tq);tq.prototype.xa=function(){};tq.prototype.getCell=tq.prototype.xa;function uq(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",uq);uq.prototype.xa=function(a){return this.b.xa(a,this.a)};uq.prototype.getCell=uq.prototype.xa;function vq(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):B);this.Gb=a;if(b)for(this.Jd=b,this.Wg=a=mc(),d=b.length;d--;)a[b[d]]=!0;c!==B&&(this.di=c)}t("H.service.extension.dataView.ObjTable",vq);n=vq.prototype;n.di=B;n.Gb=B;n.Jd=B;n.Wg=B;n.Td=function(){return this.di};vq.prototype.getMeta=vq.prototype.Td;vq.prototype.Wd=function(){return this.Gb?this.Gb.length:0};vq.prototype.getRowCount=vq.prototype.Wd;vq.prototype.Ac=function(a){var b=this.Gb;return b&&b[a]?new sq(this,a):B};
vq.prototype.getRow=vq.prototype.Ac;vq.prototype.Sa=function(){return this.Jd||ff};vq.prototype.getColumnNames=vq.prototype.Sa;vq.prototype.He=function(a){return this.Wg[a]?new uq(this,a):B};vq.prototype.getColumn=vq.prototype.He;vq.prototype.xa=function(a,b){var c=this.Gb;return(a=c&&this.Wg[b]&&c[a])&&a[b]};vq.prototype.getCell=vq.prototype.xa;
vq.prototype.concat=function(){var a=arguments.length,b,c=this.Jd,d=""+this.Jd,e=(this.Gb||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof vq))throw new D(this.concat,b);if(f.Gb){if(c&&""+f.Jd!==d)throw new D(this.concat,b,"Incompatible columns!");e=e.concat(f.Gb)}}return new vq(e,this.Jd,this.di)};vq.prototype.concat=vq.prototype.concat;function wq(a,b){a.Gb?a.Gb.push(b):a.Gb=[b];return a.Gb.length-1};function xq(a){var b=yq;if(!a||!zc(Ze(a.layerId,a.layer))||!Cc(a.level)||tc(a.rowFilter)&&!Ca(a.rowFilter)||tc(a.rowFilterContext)&&!Da(a.rowFilterContext))throw new D(b,1,tc("invalid layer config")?"invalid layer config":a);};function zq(a,b,c,d){d=d||Aq;this.ff={};d.provider=a;this.invalidate=ef;zq.l.constructor.call(this,b,d);delete this.invalidate;c&&(this.b=c);this.ua(Mg.ADD)}u(zq,bh);t("H.service.remote.Spatial",zq);var Aq={};zq.prototype.fb=function(){return this.b||bh.prototype.fb.call(this)};zq.prototype.getId=zq.prototype.fb;zq.prototype.vg=Function();zq.prototype.retain=zq.prototype.vg;zq.prototype.release=Function();zq.prototype.release=zq.prototype.release;function Bq(a,b){this.a=a;b&&(this.b=b)}
var Cq=new Bq([]);zq.prototype.Rd=function(a){return(this.ff[a.key]||Cq).a};zq.prototype.getGeometriesForTile=zq.prototype.Rd;zq.prototype.th=function(a){return(this.ff[a.key]||Cq).b};zq.prototype.getLabels=zq.prototype.th;function Dq(a,b,c){a.ff[b.key]=new Bq(c,void 0)};function Eq(a,b,c,d,e,f){Fq(Eq,1,b,c);Fq(Eq,2,d,e);(this.f=a.length)?(this.s=a,this.aa=b,this.i=c,this.b=0,this.c=A(this.c,this),this.o=d,this.j=e,this.a=mc(),Wa(this.a,Gq,f||{}),this.g={},x.setTimeout(this.c,0)):b(ff,!0)}var Gq={duration:100,cm:"geometry",bm:"WKT",zo:"searchAttributes",tj:B};
Eq.prototype.c=function(){var a=[];var b=!1;for(var c=Bk(),d;this.b<this.f;){var e=this.s[this.b];b=e.attributes;d=e.layerId||this.a.tj;e.distance&&(b[this.a.zo]={nearest:new Xf(e.nearestLat,e.nearestLon),distance:e.distance});if(e=e[this.a.cm]){try{var f=un(new Pn(e))}catch(g){this.i(new x.Error(g.message));b=!0;break}b[this.a.bm]=f}(e=this.g[d])||(e=this.g[d]=this.o({layerId:d,columnNames:Object.keys(b)}));b=this.j(e,b);a.push(b);this.b++;if((b=this.b===this.f)||Bk()-c>=this.a.duration){this.aa(a,
b);break}}b?this.g=y:this.m=x.setTimeout(this.c,0)};Eq.prototype.cancel=function(){x.clearTimeout(this.m);this.b<this.f&&this.i(new x.Error("parsing canceled"))};Eq.prototype.cancel=Eq.prototype.cancel;function Fq(a,b,c,d){if(!Ca(c))throw new D(a,b,"has invalid type");if(!Ca(d))throw new D(a,b+1,"has invalid type");};function Hq(a,b,c){var d=8===a;this.b=b;this.c=c||id;(this.a=4===a||d)?this.j=d:this.g=1===a;this.f=this.a?"$HProjGeometry":"geometry"}
Hq.prototype.parse=function(a,b,c){var d,e,f={},g=[],h,k;var l=0;for(h=c.length;l<h;l++){var m=c[l];var q=m.Rows;if(m=q.length){var p=Object.keys(q[0]).filter(function(v){return"geometry"!==v&&"$HProjGeometry"!==v});p=new vq(q,p);for(k=0;k<m;k++){var r=q[k];if(e=r[this.f]){if(delete r[this.f],r=p.Ac(k))try{this.a?d=Iq(this,a,b,r,e):d=Jq(this,a,r,e.path),d.ja(a),g.push(d)}catch(v){this.c(v.message)}}else this.c("Layer must contain geometries")}}}f[this.a?"spatials":this.g?"markers":"domMarkers"]=
g;return f};function Iq(a,b,c,d,e){var f=[],g=e.paths,h=g.length,k=0,l=a.b&&a.b(d);for(a=new zq(b,a.j,B,{style:l||a.i,data:d});k!==h;)f.push(Kq(g[k++]));Dq(a,c,[new rh(f,e.interiorsIndex,e.outlinesIndex)]);return a}function Jq(a,b,c,d){d=new Xf(d[0],d[1]);var e=a.b&&a.b(c);a.g?(a={icon:e,data:c,provider:b},a=new nn(d,a)):(a={icon:e,data:c,provider:b},a=new Qi(d,a));return a}function Kq(a){for(var b=0,c=a.length,d=[];b<c;)d.push(new I(a[b++],a[b++]));return d};function Lq(a){a=a||{};var b=a.tileCacheSize||1024,c=a.resultType,d=a.styleCallback;tc(a.min)||(a.min=12);Lq.l.constructor.call(this,a);if(-1===Mq.indexOf(c))throw new D(Lq,2,"invalid resultType");this.a=c;if(d&&!Ca(d))throw new D(Lq,2,"invalid style callback");this.wa=d;this.V=a.pixelRatio||Se();this.Lb=A(this.Lb,this);this.O(new Fk(b,A(this.cc,this)));this.createTileInternal=4===c||8===c?A(this.K,this):A(this.D,this)}u(Lq,R);t("H.service.extension.TileProvider",Lq);Lq.prototype.c=!1;
Lq.prototype.j=function(){return Lq.l.j.call(this)|192};Lq.prototype.ib=function(a,b,c,d){return this.c?Lq.l.ib.call(this,a,b,c,d):B};Lq.prototype.requestTile=Lq.prototype.ib;Lq.prototype.Lb=function(a){this.dispatchEvent(new td("error",zc(a)?a:a+"",this))};Lq.prototype.Wb=function(){return 1===this.a};Lq.prototype.providesMarkers=Lq.prototype.Wb;Lq.prototype.Vb=function(){return 2===this.a};Lq.prototype.providesDomMarkers=Lq.prototype.Vb;Lq.prototype.Ic=function(){return 4===this.a||8===this.a};
Lq.prototype.providesSpatials=Lq.prototype.Ic;function Nq(a){var b=a.vb;b||(a.v||(a.v=a.s(a.a,a.wa,a.Lb)),b=a.vb=new $p(a.v),b.ja(a),b.addEventListener(a.g.Da,A(a.jb,a)),b.vb=!0);return b}Lq.prototype.D=function(a,b,c,d){var e=this.getTileKey(a,b,c);e=this.Pb().get(e);var f=2==this.a,g=[],h=Nq(this);e?e.valid=!0:(a=e=new Nk(a,b,c,y),delete a.j,a.m=d);d=f?bq(h,e,"domMarkers"):bq(h,e,"markers");for(b=d.length;b--;)a=d[b],a.Ui=e,(f||1===a.zb().getState())&&g.push(a);e.data=g;return e};
Lq.prototype.jb=function(a){if(a=a.target.Ui)a.valid=!1};Lq.prototype.Do=function(a){this.B=!!a};Lq.prototype.setTileCanvasRendering=Lq.prototype.Do;Lq.prototype.B=!0;Lq.prototype.K=function(a,b,c,d){var e=Nq(this),f=this.getTileKey(a,b,c),g=this.tileSize,h=this.Pb().get(f);h||(a=h=new Rk(f,a,b,c,g,this.V,c,e),delete a.j,a.m=d);this.B?(d=Bp.pop(g),h.$(d)||Bp.push(d,g)):Xk(h);return h};
Lq.prototype.cc=function(a,b){var c;if(4===this.a||8===this.a){a=b.Ta();for(c=a.length;c--;)delete a[c].ff[b.key];b.data&&(Bp.push(b.pg(),this.tileSize),b.qg())}else for(a=b.data,c=a.length;c--;)delete a[c].Ui};Lq.prototype.u=function(){Lq.l.u.call(this);Nq(this).C()};var Oq={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};Lq.ResultType=Oq;var Mq=[1,2,4,8];function yq(a,b,c){var d=this,e=b&&b.rowFilter,f=c.resultType;yq.l.constructor.call(this,c);C(a,Pq,yq,0);xq(b);e?(c=Ua(b),c.rowFilter=e.toString()):c=Ua(b);delete c.layer;c.layerId=Ze(b.layerId,b.layer);(new Mf).a("pde","H.service.extension.worker.processor");a=a.I().clone().L(Qq+"."+Rq).N({meta:1});(new Qf("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:4===f,serverUrl:a.toString(),layerConfigs:[c],horizontalMargin:1}]})).then(function(){d.c=!0;Vj(d)},this.Lb)}
u(yq,Lq);t("H.service.extension.platformData.TileProvider",yq);yq.prototype.s=function(a,b,c){a=new Hq(a,b,c);a.i=Sq;return a};var Sq=new O({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});
yq.prototype.J=function(a,b,c,d,e){var f=this,g=this.getTileKey(a,b,c),h;g=this.Pb().get(g);var k={cancel:id},l=!0,m=this.a;g&&(4===m||8===m?g.ae()||(d(Bp.pop(this.tileSize),null),l=!1):(d(y),l=!1));if(l){var q=zp.setTimeout(function(){h=new Qf("pde",{message:[f.uid,1,[a,b,c]]});h.then(d,e)},500);k.cancel=function(){h?h.cancel():zp.clearTimeout(q)}}return k};yq.prototype.requestInternal=yq.prototype.J;yq.prototype.u=function(){yq.l.u.call(this);new Qf("pde",{message:[this.uid,3]})};
yq.ResultType=Oq;function Tq(a){this.a=a}Tq.prototype.cancel=function(){for(var a=this.a,b=a.length;b--;)a[b].cancel();a.length=0};function Pq(a){Pq.l.constructor.call(this,Pq,a)}u(Pq,pp);t("H.service.extension.platformData.Service",Pq);Pq.prototype.a=function(){return{subDomain:"s.fleet.ls",path:"1"}};Pq.CONFIG_KEY="platformData";Pq.prototype.request=function(a,b,c,d,e){return this.va(a,b,c,d,e)};
Pq.prototype.va=function(a,b,c,d,e){var f="text/plain";if(!a)throw new D(this.request,0,a);if(!b)throw new D(this.request,1,b);if(!d)throw new D(this.request,3,d);if(!e)throw new D(this.request,4,e);a=this.I().clone().L(a+"."+b).N(c);b===Uq.JSON&&(f="application/json");return this.J(a,d,e,f)};var Qq="tiles";
Pq.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:Qq,FILE:"file",INDEX:"index"};var Rq="json",Uq={TXT:"txt",JSON:Rq,HTML:"html",BIN:"bin"};Pq.EntryPointType=Uq;
Pq.prototype.uc=function(a,b){var c=b&&b.resultType;a=new yq(this,a,b);var d;1==c||2===c?d=new qn(a):d=new nl(a);return d};Pq.prototype.createTileLayer=Pq.prototype.uc;Pq.prototype.Ad=function(a,b,c,d){var e=[],f,g=b.layer_id||b.layer_ids;a=this.request(a,Rq,b,function(h){f=new Eq(h.geometries,c,d,function(k){return new vq([],k.columnNames,k)},function(k,l){return k.Ac(wq(k,l))},{tj:g});e.push(f)},function(h){d(new x.Error(h))});e.push(a);return new Tq(e)};
function Vq(a,b,c){if(!yc(a))throw new D(c,0,"has invalid type");if(!yc(b))throw new D(c,1,"has invalid type");if(a.length!==b.length||!a.length)throw new D(c,1,"specify one key attribute for each given layer id in the same order");}
Pq.prototype.Lc=function(a,b,c,d,e,f){function g(l,m){m&&h--;d(l,!h)}var h,k=[];Vq(a,b,this.Lc);Fq(this.Lc,3,d,e);C(c,K,this.Lc,2);c={bbox:c.ka+","+c.ca+";"+c.ma+","+c.ga};f&&Wa(c,f);a=c.layer_id?[c.layer_id]:a;f=0;for(h=a.length;f<h;f++)c.layer_id=a[f],c.key_attribute=b[f],k.push(this.Ad("search/bbox",c,g,e));return new Tq(k)};Pq.prototype.searchByBoundingBox=Pq.prototype.Lc;
Pq.prototype.Yb=function(a,b,c,d,e,f,g){Vq(a,b,this.Yb);C(c,Xf,this.Yb,2,"has invalid type");if(!Cc(d))throw new D(this.Yb,3,"has invalid type");Fq(this.Yb,4,e,f);a={layer_ids:a.join(","),key_attributes:b.join(","),proximity:c.lat+","+c.lng+","+d};g&&Wa(a,g);return this.Ad("search/proximity",a,e,f)};Pq.prototype.searchByProximity=Pq.prototype.Yb;
Pq.prototype.Xb=function(a,b,c,d,e,f,g){var h="";Vq(a,b,this.Xb);if(!zc(c)&&!C(c,L))throw new D(this.Xb,1,"has invalid type");if(!Cc(d))throw new D(this.Xb,2,"has invalid type");Fq(this.Xb,4,e,f);a={layer_ids:a.join(","),key_attributes:b.join(","),radius:d};if(zc(c))a.route_id=c;else{d=c.X;c=0;for(b=d.length;c<b;c+=3)h+=d[c]+","+d[c+1],c<b-3&&(h+=";");a.corridor=h}g&&Wa(a,g);return this.Ad("search/corridor",a,e,f)};Pq.prototype.searchByCorridor=Pq.prototype.Xb;
Y.prototype.Ym=function(a){return this.bb(Pq,a)};Y.prototype.getPlatformDataService=Y.prototype.Ym;function Wq(a){Wq.l.constructor.call(this,Wq,a)}u(Wq,pp);t("H.service.extension.geofencing.Service",Wq);Wq.prototype.a=function(){return{subDomain:"fleet.ls",path:"2"}};Wq.CONFIG_KEY="geofencing";Wq.prototype.request=function(a,b,c,d){return this.va(a,b,c,d)};Wq.prototype.b=function(a){return Error(a.issues&&a.issues.length?a.issues.map(function(b){return b.message}).join(". "):a.message||a.response_code)};
Wq.prototype.va=function(a,b,c,d){if(!a)throw new D(this.request,0,a);if(!Ca(c))throw new TypeError("onResult must be a function");if(!Ca(d))throw new TypeError("onError must be a function");a=this.I().clone().L(a+".json").N(b);return this.J(a,c,d)};Wq.EntryPoint={SEARCH_PROXIMITY:"search/proximity"};Y.prototype.Am=function(a){return this.bb(Wq,a)};Y.prototype.getGeofencingService=Y.prototype.Am;t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"});t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"});function Xq(a){var b=Yq;if(!a||!zc(a.layerId)||tc(a.rowFilter)&&!Ca(a.rowFilter)||tc(a.rowFilterContext)&&!Da(a.rowFilterContext))throw new D(b,1,tc("invalid layer config")?"invalid layer config":a);}function Zq(a){return zc(a)&&/^[A-Z][A-Z0-9_]*$/.test(a)}function $q(a){for(var b=a&&a.length,c=2<=b&&"WKT"===a[--b]&&"GEOMETRY_ID"===a[--b];c&&b--;)c=Zq(a[b]);return c}
function ar(a,b){var c="",d,e,f=[];if(!b){var g={};f=[];if(a.geometries)for(e=0;e<a.geometries.length;e++)b=a.geometries[e],g[b.layerId]||(g[b.layerId]=[]),g[b.layerId].push(b);for(d in g)f.push({layerId:d,geometries:g[d]});for(d=0;d<f.length;d++)c+=ar(f[d],f[d].layerId)}else if(a.geometries&&a.geometries.length)for(e=Object.keys(a.geometries[0].attributes),c=c+("Meta:\t"+b+"\n")+e.join("\t"),c+="\tWKT\n",d=0;d<a.geometries.length;d++){var h=a.geometries[d].attributes;g=a.geometries[d].geometry;for(b=
0;b<e.length;b++)f.push(h[e[b]]);c+=f.join("\t");c+="\t"+g+"\n";f=[]}return c};function Yq(a,b,c){var d=this,e=b&&b.rowFilter,f;Yq.l.constructor.call(this,c);C(a,br,Yq,0);var g=c.resultType;Xq(b);if(e){var h=Ua(b);h.rowFilter=e.toString()}else h=b;(new Mf).a("cle","H.service.extension.worker.processor");var k=b.layerId;a.request(cr,dr,{detail_level:"all",layer_id:k},function(l){l=l.layers;var m;for(m=0;m<l.length;m++)if(l[m].layerId===k){h.level=l[m].level;break}f=a.I().clone().L(er+"."+dr).N({meta:1});(new Qf("cle",{message:[d.uid,0,{tileSize:d.tileSize,projected:!0,onlyOutline:4===
g,serverUrl:f.toString(),layerConfigs:[h],batchTiles:!1,horizontalMargin:1}]})).then(function(){d.c=!0;Vj(d)},d.Lb)},function(l){d.Lb(l.message)})}u(Yq,Lq);t("H.service.extension.customLocation.TileProvider",Yq);Yq.prototype.s=function(a,b,c){return new Hq(a,b,c)};
Yq.prototype.J=function(a,b,c,d,e){var f=this,g=this.getTileKey(a,b,c),h;g=this.Pb().get(g);var k={cancel:id},l=!0,m=this.a;g&&(4===m||8===m?g.ae()||(d(Bp.pop(this.tileSize),null),l=!1):(d(y),l=!1));if(l){var q=zp.setTimeout(function(){h=new Qf("cle",{message:[f.uid,1,[a,b,c]]});h.then(d,e)},500);k.cancel=function(){h?h.cancel():zp.clearTimeout(q)}}return k};Yq.prototype.requestInternal=Yq.prototype.J;Yq.prototype.u=function(){Yq.l.u.call(this);new Qf("cle",{message:[this.uid,3]})};function fr(){if(gr)throw new Yc(fr);}t("H.service.extension.customLocation.Table",fr);var gr=!0;function hr(a,b){var c;gr=!1;var d=new fr;gr=!0;d.c=pc(x.JSON.parse(x.JSON.stringify(a)));a=a.columnNames;var e=mc();for(c=a.length;c--;)e[a[c]]=c;d.f=e;d.b=a.length;if(b){if(b.length%a.length)throw new D(hr,1,"Invalid number of cells");}else b=[];d.a=b;return d}fr.prototype.Td=function(){return this.c};fr.prototype.getMeta=fr.prototype.Td;fr.prototype.Wd=function(){return this.a.length/this.b};
fr.prototype.getRowCount=fr.prototype.Wd;fr.prototype.Ac=function(a){return a<this.a.length/this.b?new ir(this,a):B};fr.prototype.getRow=fr.prototype.Ac;fr.prototype.hn=function(){var a=this.a.length/this.b,b,c=new x.Array(a);for(b=0;b<a;b++)c[b]=new ir(this,b);return c};fr.prototype.getRows=fr.prototype.hn;fr.prototype.Mg=function(a){var b=this.b,c=this.a,d=c.length/this.b;if(!a||a.length%b)throw new D(this.Mg,0,"Invalid number of cells");this.a=c.concat(a);return d};fr.prototype.addCells=fr.prototype.Mg;
fr.prototype.El=function(){for(var a=this.b,b=this.a,c=this.a.length/this.b;a--;)b.push(y);return this.Ac(c)};fr.prototype.addRow=fr.prototype.El;fr.prototype.Sa=function(){return this.c.columnNames};fr.prototype.getColumnNames=fr.prototype.Sa;fr.prototype.He=function(a){return this.f[a]===B?B:new jr(this,a)};fr.prototype.getColumn=fr.prototype.He;fr.prototype.xa=function(a,b){return this.a[a*this.b+this.f[b]]};fr.prototype.getCell=fr.prototype.xa;
fr.prototype.Mc=function(a,b,c){b=this.f[b];if(a>=this.a.length/this.b)throw new D(this.Mc,0,"Row index out of bounds");if(b===B)throw new D(this.Mc,0,"Column unknown");this.a[a*this.b+b]=c};fr.prototype.setCell=fr.prototype.Mc;
fr.prototype.concat=function(a){var b=arguments.length,c,d=""+this.Sa(),e=this.a?this.a.slice():[];for(c=0;c<b;c++){var f=arguments[c];if(!(f instanceof fr))throw new D(this.concat,c);if(""+f.Sa()!==d)throw new D(this.concat,c,"Incompatible columns!");f.a&&(e=e.concat(f.a))}return hr(this.c,e)};fr.prototype.concat=fr.prototype.concat;var kr=/(\n|\t|\r|")/;
fr.prototype.Qi=function(a,b){var c,d=this.b,e=this.Sa(),f=[],g=[],h=this.a,k=-1;for(c=0;c<d;c++)if(!a||a.test(e[c]))"WKT"===e[c]&&(k=f.length),f.push(c);if(!(a=f.length))throw new D(this.Qi,1,"No columns filtered");lr(this,g,e,0,d,f,a,k);if(b){var l=b.length;for(c=0;c<l;c++)g.push("\n"),e=b[c],lr(this,g,h,e,d,f,a,k)}else for(l=this.Wd(),e=0;e<l;e++)g.push("\n"),lr(this,g,h,e,d,f,a,k);return g.join("")};
function lr(a,b,c,d,e,f,g,h){var k;for(k=0;k<g;k++){k&&b.push("\t");var l=c[d*e+f[k]];if(k!==h){if(l!==y){l=String(l);if(kr.test(l))throw new D(a.Qi,0,'Invalid character (\\n, \\r, \\t, or ") in row '+d+" column "+a.c.columnNames[f[k]]);b.push(l)}}else b.push(l)}}function jr(a,b){this.b=a;this.a=b}fr.Column=jr;jr.prototype.xa=function(a){return this.b.xa(a,this.a)};jr.prototype.getCell=jr.prototype.xa;jr.prototype.Mc=function(a,b){this.b.Mc(a,this.a,b)};jr.prototype.setCell=jr.prototype.Mc;
function ir(a,b){this.a=a;this.ai=b}fr.Row=ir;ir.prototype.Sa=function(){return this.a.Sa()};ir.prototype.getColumnNames=ir.prototype.Sa;ir.prototype.xa=function(a){return this.a.xa(this.ai,a)};ir.prototype.getCell=ir.prototype.xa;ir.prototype.Mc=function(a,b){this.a.Mc(this.ai,a,b)};ir.prototype.setCell=ir.prototype.Mc;ir.prototype.pd=function(){return this.a};ir.prototype.getTable=ir.prototype.pd;function mr(a){if(a===B)a="\t";else if(!/^[^"\r\n]$/.test(a))throw new D(mr,0);this.b=String(a).charCodeAt(0);this.bi=A(this.bi,this);this.A=nr}var nr=0;n=mr.prototype;n.getState=function(){return this.A};function or(a,b,c){var d=a.A;if(d!==b)throw 1===d&&(a.A=nr),new Yc(c,"Requires state: "+["READY","PARSE","PAUSE"][b]+" but found "+["READY","PARSE","PAUSE"][d]);}n.abort=function(){or(this,2,mr.prototype.abort);this.A=nr};
n.bi=function(a){this.A=nr;throw new D(mr.prototype.parse,0,"Malformed DSV at row "+this.a.j+" column "+this.a.b+": "+a);};function pr(a,b){var c=[];a.parse(b,function(d,e,f){1>d&&(c[e]=f);return 0<d});a.A=nr;return c}n.parse=function(a,b,c){or(this,nr,mr.prototype.parse);a=a.trim();this.a=new qr(a,this.b,this.bi);this.c=b;this.vk=c||ef;this.A=2;this.resume()};n.vk=ef;
n.resume=function(){var a=this.a,b=[];or(this,2,mr.prototype.resume);this.A=1;do{if(!a.g){this.A=nr;break}if(e>a.b){if(void 0!==c&&c!==e){this.a.a("The number of columns must be the same for all rows");return}var c=e}var d=a.j;var e=a.b;var f=a.Ff;var g=this.vk(d,e,a);if(a.Ff>f)for(;-1!==a.next(););else{for(;-1!==(f=a.next());)b.push(f);g=String.fromCharCode.apply(y,b);b.length=0}rr(a);this.c(d,e,g)&&(this.A=a.g?2:nr)}while(1===this.A);2!=this.A&&void 0!==c&&0<e&&c!==e&&this.a.a("The number of columns must be the same for all rows")};
function qr(a,b,c){this.c=new Pn(a);this.m=b;this.g=!0;this.Ff=this.j=this.b=0;rr(this);this.a=c;this.f=[];this.i=!1}n=qr.prototype;n.Ff=0;function rr(a){var b=a.c.Tb();a.o=!1;(a.aa=34===b)&&a.c.next()}function sr(a,b){var c=a.c;a.o=!0;switch(b){case a.m:a.b++;break;case 13:c.next(),10!==c.Tb()&&a.a("CR without LF");case 10:a.b=0;a.j++;break;case -1:a.g=!1;break;default:a.a("End of field expected")}c.next();return-1}
n.Tb=function(){if(this.o)var a=-1;else{var b=this.c;a=b.Tb();if(this.aa)switch(a){case 34:b.next();a=b.Tb();34!==a&&(a=sr(this,a));break;case -1:this.a("Closing quotation mark expected")}else switch(a){case 34:this.a("Unexpected quotation mark");case this.m:case 13:case 10:case -1:a=sr(this,a)}}return a};n.me=function(){this.i=!0;this.f=[]};n.Nd=function(){var a=this.f.slice();this.i=!1;this.f=[];return a};n.next=function(){var a=this.Tb();-1!==a&&this.c.next();this.i&&this.f.push(a);this.Ff++;return a};function tr(a,b,c,d){d=d||{};if(!b)throw new D(tr,1,"has to be a function");if(!c)throw new D(tr,2,"has to be a function");this.c=b;this.g=c;this.a=[];this.i=d.duration||ur;this.b=A(this.b,this);this.f={};a=a.split("Meta:\t").slice(1);for(b=0;b<a.length;b++){d=a[b].split("\n");c=d[0].split("\t")[0];d=d.slice(1).join("\n");this.Md[c]=new mr;this.$h[c]=pr(this.Md[c],d);var e={layerId:c,columnNames:this.$h[c]};this.Nh.push(c);this.f[c]=hr(e);this.Qc[c]=Bk();vr(this,d,c);this.b(c)}}var ur=100;n=tr.prototype;
n.$h={};n.Nh=[];n.Md={};n.Qc={};n.Pi={};function vr(a,b,c){var d=[],e=a.$h[c].length-1,f=a.f[c];try{a.Md[c].parse(b,function(g,h,k){var l=!1;0<g&&(d[h]=k,h===e&&(a.a.push(f.Ac(f.Mg(d))),Bk()-a.Qc[c]>a.i&&(l=!0)));return l},function(g,h,k){if(0<g&&h===e)return un(k)})}catch(g){a.g(g)}}n.cancel=function(){for(var a in this.Pi)x.clearTimeout(this.Pi[a])};tr.prototype.cancel=tr.prototype.cancel;
tr.prototype.b=function(a){var b=this,c,d;this.Pi[a]=x.setTimeout(function(){if(2===b.Md[a].getState())b.Qc[a]=Bk(),b.c(b.a,!1),b.a=[],b.Md[a].resume(),b.b(a);else{c=!0;for(d=0;d<b.Nh.length;d++)if(b.Md[b.Nh[d]].getState()!==nr){c=!1;break}c&&(0<b.a.length&&b.c(b.a,!0),b.a=[])}},0)};function br(a){br.l.constructor.call(this,br,a)}u(br,pp);t("H.service.extension.customLocation.Service",br);br.prototype.a=function(){return{subDomain:"fleet.ls",path:"2"}};br.CONFIG_KEY="customLocation";br.prototype.uc=function(a,b){var c=b&&b.resultType;a=new Yq(this,a,b);var d;1===c||2===c?d=new qn(a):d=new nl(a);return d};br.prototype.createTileLayer=br.prototype.uc;
function wr(a,b,c,d){var e;a=a===xr?"changes":"file";var f=b[a],g=zc(f),h=!g&&C(f,Blob);if(!g&&!h)throw new D(d,0,"Invalid "+a+" parameter");if(yr)h?e=f:e=nf(f,"text/plain"),d=new x.FormData,d.append(a,e,e.name||a+".wkt"),c.method="POST",c.data=d,delete b[a];else if(h)throw new D(d,0,"Sending Blob data is not supported by the browser");}var yr=x.FormData&&!!x.FormData.prototype.append;br.prototype.request=function(a,b,c,d,e){return this.va(a,b,c,d,e)};
br.prototype.va=function(a,b,c,d,e){var f="text/plain",g=a===zr.LAYERS_UPLOAD||a===zr.LAYERS_MODIFY||a===zr.LAYERS_IMPORT,h=c,k={data:B,method:"GET",headers:this.eg};if(!a)throw new D(this.request,0,a);if(!b)throw new D(this.request,1,b);Fq(this.request,3,d,e);g&&(C(c,Object,this.request,2,"Invalid request parameters"),h=Ua(c),wr(a,h,k,this.request));var l=this.I().clone().L(a+"."+b).N(h);b===Ar.JSON&&(f="application/json");a=new rf(f,l.toString(),fe,k);a.then(function(m){var q=m.issues;q&&m.error_id&&
m.response_code?e(Error(q[0].message)):d(m)},function(m){"error"===m.type||404===m.status?e(Error(m.statusText||"Unable to load data")):m.json().then(function(q){e(Error("["+q.issues[0].message+"] "+l+" request failed"))},function(){e(Error("["+m.statusText+"] "+l+" request failed"))})});return a};
var cr="layers/list",xr="layers/modify",er="tiled/tile",zr={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:cr,LAYERS_MODIFY:xr,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:er};br.EntryPoint=zr;var dr="json",Ar={TXT:"txt",JSON:dr};br.EntryPointType=Ar;
br.prototype.Ab=function(a,b,c){var d=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:a},function(e){var f=e.replace(/[\r\n]+$/g,"").split("\t");d.request(cr,dr,{layer_id:a,detail_level:"all"},function(g){g=g.layers[0];g.columnNames=f;b(hr(g))},c)},c)};br.prototype.getLayer=br.prototype.Ab;
br.prototype.Tj=function(a,b,c,d){function e(){return++g<f?h.request("layers/access/grant",dr,{layer_id:a,granted_app_id:b[g].grantedAppId,permissions:b[g].permissions.join(",")},e,d):h.Ab(a,c,d)}var f=b&&b.length,g=-1,h=this;return e()};br.prototype.grantAccess=br.prototype.Tj;br.prototype.uj=function(a,b,c){return this.request("layers/delete",dr,{layer_ids:a},b,c)};br.prototype.deleteLayer=br.prototype.uj;
br.prototype.jd=function(a,b,c){function d(){setTimeout(function(){k.Ab(g,function(p){setTimeout(e.bind(null,p),m)},function(){64E3>l?(l+=m,d()):c(x.Error("Timeout"))})},m);m*=2}function e(p){var r=JSON.stringify(p.Sa()),v=a.grants;if(r!==JSON.stringify(h)){var w="Results into different column names on the backend: "+r;setTimeout(function(){k.uj(g,function(){c(x.Error(w))},function(z){c(x.Error(w+". "+z.message))})},m)}else v&&v.length?k.Tj(g,v,b,c):b(p)}var f,g,h,k=this,l=0,m=1E3;var q=!a||!Zq(g=
a.layerId)&&(f="layerId")||!$q(h=a.columnNames)&&(f="columnNames")?0:Ca(b)?Ca(c)?-1:2:1;if(0<=q)throw new D(k.jd,q,f||arguments[q]);return k.Ab(g,function(){c(x.Error("Layer exists already"))},function(){var p={layer_id:g,file:h.join("\t")},r=a.level,v=a.storage;r!==B&&(p.level=r);v!==B&&(p.storage=v);k.request("layers/upload",dr,p,d,c)})};br.prototype.createLayer=br.prototype.jd;
br.prototype.Ad=function(a,b,c,d){var e=[],f;a=this.request(a,dr,b,function(g){g.geometries.length?(g=ar(g,b.layer_id),f=new tr(g,c,d),e.push(f)):c(ff,!0)},d);e.push(a);return new Tq(e)};br.prototype.Yb=function(a,b,c,d,e,f){if(!yc(a))throw new D(this.Yb,0,"has invalid type");C(b,Xf,this.Yb,1,"has invalid type");if(!Cc(c))throw new D(this.Yb,2,"has invalid type");Fq(this.Yb,3,d,e);a={layer_ids:a.join(","),proximity:b.lat+","+b.lng+","+c};f&&Wa(a,f);return this.Ad("search/proximity",a,d,e)};
br.prototype.searchByProximity=br.prototype.Yb;br.prototype.Xb=function(a,b,c,d,e,f){var g="";if(!yc(a))throw new D(this.Xb,0,"has invalid type");if(!zc(b)&&!C(b,L))throw new D(this.Xb,1,"has invalid type");if(!Cc(c))throw new D(this.Xb,2,"has invalid type");Fq(this.Xb,3,d,e);a={layer_ids:a.join(","),radius:c};if(zc(b))a.route_id=b;else{var h=b.X;b=0;for(c=h.length;b<c;b+=3)g+=h[b]+","+h[b+1],b<c-3&&(g+=",");a.corridor=g}f&&Wa(a,f);return this.Ad("search/corridor",a,d,e)};
br.prototype.searchByCorridor=br.prototype.Xb;br.prototype.Lc=function(a,b,c,d,e){function f(k,l){l&&h--;c(k,!h)}var g=[],h;if(!yc(a))throw new D(this.Lc,0,"has invalid type");C(b,K,this.Lc,1,"has invalid type");Fq(this.Lc,2,c,d);b={bbox:b.ka+","+b.ca+";"+b.ma+","+b.ga};e&&Wa(b,e);a=b.layer_id?[b.layer_id]:a;e=0;for(h=a.length;e<h;e++)b.layer_id=a[e],g.push(this.Ad("search/bbox",b,f,d));return new Tq(g)};br.prototype.searchByBoundingBox=br.prototype.Lc;
br.prototype.wi=function(a,b,c,d){var e,f=[];if(!zc(a))throw new D(this.wi,0,"has invalid type");Fq(this.wi,1,b,c);var g={layer_id:a};d&&Wa(g,d);d=this.request("search/all",dr,g,function(h){h.geometries.length?(h=ar(h,a),e=new tr(h,b,c),f.push(e)):b(ff,!0)},c);f.push(d);return new Tq(f)};br.prototype.searchAll=br.prototype.wi;var Br={"delete":/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};
function Cr(a,b,c,d,e,f){function g(){v++;d(this,v===p)}function h(V){v++;e(V,this,v===p)}var k="append"!==b,l,m={},q=mc(),p=0,r=[],v=0;if(!yc(c))throw new D(f,0,c);Fq(f,1,d,e);for(l=c.length;l--;){var w=c[l];if(C(w,ir)){var z=w.pd().Td().layerId;var J=w.xa("GEOMETRY_ID");if(k){if(J===y||""===String(J))var G='GEOMETRY_ID must not be null or ""';m[J=z+"_"+J]&&(G="same GEOMETRY_ID for multiple rows");m[J]=w}else J!==y&&""!==String(J)&&(G='GEOMETRY_ID must be null or ""')}else G="Invalid type";if(G)throw new D(f,
0,"- Invalid row at index "+l+", "+G);J=q[z];J||(J=q[z]=[],p++);J.push(w)}for(z in q){J=q[z];c=[];for(l=J.length;l--;)c.push(J[l].ai);r.push(a.request(xr,dr,{layer_id:z,action:b,changes:J[0].pd().Qi(Br[b]||null,c)},A(g,J),A(h,J)))}return new Tq(r)}br.prototype.mj=function(a,b,c){return Cr(this,"append",a,b,c,this.mj)};br.prototype.appendRows=br.prototype.mj;br.prototype.sl=function(a,b,c){return Cr(this,"update",a,b,c,this.sl)};br.prototype.updateRows=br.prototype.sl;
br.prototype.vj=function(a,b,c){return Cr(this,"delete",a,b,c,this.vj)};br.prototype.deleteRows=br.prototype.vj;Y.prototype.qm=function(a){return this.bb(br,a)};Y.prototype.getCustomLocationService=Y.prototype.qm;function Dr(a){mq.l.constructor.call(this,Dr,a)}u(Dr,pp);t("H.service.extension.customRoute.Service",Dr);Dr.prototype.a=function(){return{subDomain:"s.fleet.ls",path:"2"}};Dr.CONFIG_KEY="customRoute";Dr.prototype.b=function(a){return Error(a.issues&&a.issues.length?a.issues.map(function(b){return b.message}).join(". "):a)};Dr.prototype.Id=function(a,b,c){Fq(this.Id,1,b,c);a=this.I().clone().L("calculateroute.json").N(a);return this.J(a,b,c)};Dr.prototype.calculateRoute=Dr.prototype.Id;
Y.prototype.rm=function(a){return this.bb(Dr,a)};Y.prototype.getCustomRoutingService=Y.prototype.rm;function Er(a){Er.l.constructor.call(this,Er,a)}u(Er,pp);t("H.service.SearchService",Er);Er.CONFIG_KEY="search";Er.prototype.a=function(){return{subDomain:"search",path:"v1"}};Er.prototype.b=function(a){a=[a.title,a.action,a.cause].filter(function(b){return b});return Error(a.join(". "))};Er.prototype.kh=function(a,b,c){a=this.I().clone().Qa("geocode").L("geocode").N(a);return this.J(a,b,c)};Er.prototype.geocode=Er.prototype.kh;
Er.prototype.vi=function(a,b,c){a=this.I().clone().Qa("revgeocode").L("revgeocode").N(a);return this.J(a,b,c)};Er.prototype.reverseGeocode=Er.prototype.vi;Er.prototype.Il=function(a,b,c){a=this.I().clone().Qa("autosuggest").L("autosuggest").N(a);return this.J(a,b,c)};Er.prototype.autosuggest=Er.prototype.Il;Er.prototype.Rl=function(a,b,c){a=this.I().clone().Qa("discover").L("discover").N(a);return this.J(a,b,c)};Er.prototype.discover=Er.prototype.Rl;
Er.prototype.Rn=function(a,b,c){a=this.I().clone().Qa("lookup").L("lookup").N(a);return this.J(a,b,c)};Er.prototype.lookup=Er.prototype.Rn;Er.prototype.Kl=function(a,b,c){a=this.I().clone().Qa("browse").L("browse").N(a);return this.J(a,b,c)};Er.prototype.browse=Er.prototype.Kl;Y.prototype.kn=function(a){return this.bb(Er,a)};Y.prototype.getSearchService=Y.prototype.kn;function Fr(a){this.g=!!a.toBypassToken;if(!this.g&&!a.token)throw new D(Fr,0,'"token" must be specified');Fr.l.constructor.call(this,Fr,a);this.j=a.token;this.i={};this.f={}}u(Fr,pp);t("H.service.xyz.Service",Fr);Fr.prototype.a=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}};Fr.prototype.b=function(a){return Error(a.errorMessage||a.message)};
Fr.prototype.wh=function(a,b,c){wc(a,"String",this.wh,0,'"projectId" must be a string');Gr(this.wh,1,b,c);a=Hr(this.I().clone().nf("project-api/projects/"+a));return this.J(a,b,c)};Fr.prototype.getProject=Fr.prototype.wh;Fr.prototype.Oj=function(a,b,c){Gr(this.Oj,0,a,b);c=Ir(this,this.I().clone().N(c||{}));return this.J(c,a,b)};Fr.prototype.getSpaces=Fr.prototype.Oj;
Fr.prototype.Vf=function(a,b,c){wc(a,"String",this.Vf,0,'"spaceId" must be a string');Gr(this.Vf,1,b,c);a=Ir(this,this.I().clone().L(a));return this.J(a,b,c)};Fr.prototype.getSpace=Fr.prototype.Vf;Fr.prototype.zh=function(a,b,c){wc(a,"String",this.zh,0,'"spaceId" must be a string');Gr(this.zh,1,b,c);a=Ir(this,this.I().clone().L(a+"/statistics"));return this.J(a,b,c)};Fr.prototype.getStatistics=Fr.prototype.zh;
function Jr(a,b,c,d,e,f,g,h){b=Ir(a,a.I().clone().L(e+"/tile/web/"+d+"_"+b+"_"+c+".mvtf").N(Object.assign({clip:!0},h)));return a.J(b,function(k){return k.arrayBuffer().then(f)},g,"arraybuffer")}Fr.prototype.search=function(a,b,c,d){wc(a,"String",this.search,0,'"spaceId" must be a string');Gr(this.search,1,b,c);a=Ir(this,this.I().clone().L(a+"/search").N(d||{}));return this.J(a,b,c)};Fr.prototype.search=Fr.prototype.search;
Fr.prototype.Le=function(a,b,c,d){wc(a,"String",this.Le,0,'"spaceId" must be a string');if(!Da(b))throw new D(this.Le,1,'"params" must be an object');Gr(this.Le,2,c,d);a=Ir(this,this.I().clone().L(a+"/features").N(b));return this.J(a,c,d)};Fr.prototype.getFeaturesById=Fr.prototype.Le;
Fr.prototype.qh=function(a,b,c,d){wc(a,"String",this.qh,0,'"spaceId" must be a string');if(!Da(b))throw new D(this.Le,1,'"params" must be an object');Gr(this.qh,2,c,d);a=Ir(this,this.I().clone().L(a+"/bbox").N(b));return this.J(a,c,d)};Fr.prototype.getFeaturesByBoundingBox=Fr.prototype.qh;Fr.prototype.sa=function(a){var b=this.i[a];if(b)return b;this.f[a]||this.Ee(a);return null};
Fr.prototype.bf=function(a,b,c,d,e){wc(a,"String",this.bf,0,'"spaceId" must be a string');if(!Da(b))throw new D(this.bf,1,'"geojsonObject" must be an object');Gr(this.bf,2,c,d);if(e&&!Da(e))throw new D(this.bf,4,'"opt_params" must be an object');return Kr(this,a,c,d,"PUT",b,e)};Fr.prototype.putFeatures=Fr.prototype.bf;
Fr.prototype.Ze=function(a,b,c,d,e){wc(a,"String",this.Ze,0,'"spaceId" must be a string');if(!Da(b))throw new D(this.Ze,1,'"featureCollection" must be an object');Gr(this.Ze,2,c,d);if(e&&!Da(e))throw new D(this.Ze,4,'"opt_params" must be an object');return Kr(this,a,c,d,"POST",b,e)};Fr.prototype.postFeatures=Fr.prototype.Ze;
Fr.prototype.Kf=function(a,b,c,d){wc(a,"String",this.Kf,0,'"spaceId" must be a string');if(!Da(b))throw new D(this.Kf,1,'"params" must be an object');Gr(this.Kf,2,c,d);return Kr(this,a,c,d,"DELETE",B,b)};Fr.prototype.deleteFeatures=Fr.prototype.Kf;
function Kr(a,b,c,d,e,f,g){var h=Object.assign(a.g?{}:{authorization:"Bearer "+a.j},{"Content-Type":"application/geo+json"},a.eg);e={method:e,headers:h};f&&(e.data=JSON.stringify(f));b=Hr(a.I().clone().L(b+"/features").N(g||{}));f=new rf("application/json",b.toString(),fe,e);f.then(c,sp(a,b,d));return f}Fr.prototype.Ee=function(a){var b=this;this.f[a]=Lr;this.Vf(a,function(c){b.f[a]=Mr;b.i[a]=c.copyright;b.dispatchEvent("copyrightupdate")},function(c){b.f[a]=Nr;throw c;})};
function Ir(a,b){return a.g?b:Hr(b).N({access_token:a.j})}function Hr(a){var b=Object.assign({},a.getQuery());delete b.apikey;return a.Hi(b)}Fr.CONFIG_KEY="xyz";var Lr=1,Mr=2,Nr=-1;function Gr(a,b,c,d){if(!Ca(c))throw new D(a,b,'"onResult" must be a function');if(!Ca(d))throw new D(a,b+1,'"onError" must be a function');}Y.prototype.vn=function(a){return this.bb(Fr,a)};Y.prototype.getXYZService=Y.prototype.vn;function Or(a,b,c){var d;Or.l.constructor.call(this,c?{min:c.min,max:c.max}:void 0);C(a,Fr,Or,0);if(!zc(b))throw new D(Or,1,'"spaceId" must be a string');this.s=a;this.c=b;this.a={};if(c&&(["limit","simplificationLevel","tags"].forEach(function(e){e in c&&(this.a[e]=c[e])},this),a=c.parameters))for(d in a)this.a[d]=a[d];this.Dd(new Th({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.c},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,
"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}))}u(Or,R);t("H.service.xyz.Provider",Or);Or.prototype.J=function(a,b,c,d,e){return Jr(this.s,a,b,c,this.c,d,e,this.a)};Or.prototype.requestInternal=Or.prototype.J;Or.prototype.sa=function(){return this.s.sa(this.c)};
Or.prototype.getCopyrights=Or.prototype.sa;Or.prototype.ta=function(){return this.Db()};Or.prototype.getStyle=Or.prototype.ta;Or.prototype.fd=function(a){a.b("MVT");this.Dd(a)};Or.prototype.setStyle=Or.prototype.fd;t("H.service.buildInfo",function(){return Ef("H-service","1.21.2","f330b0b")});

function Pr(a){var b;if(a)for(this.a={},b=a.length;b--;)this.a[a[b]]=!0;this.kl={}}var Qr;Pr.prototype.a={};Pr.prototype.parse=function(a,b,c){var d,e,f,g,h;Qr=!1;try{c=zp.JSON.parse(c)}catch(m){Qr=!0}if(c&&(d=c.metadata)){var k={spatials:[]};for(e in d){if(c=!this.a[e]&&(f=Rr[e]))(g=d[e])||(Qr=!0,g=void 0),c=g;if(c)for(c=g.length;c--;){var l;(l=g[c])||(Qr=!0,l=void 0);(h=l)&&f(b,a,this,e,h,k)}}}else Qr=!0;return Qr?void 0:k};Pr.prototype.parse=Pr.prototype.parse;
var Rr={"street labels":function(a,b,c,d,e,f){var g;(g=e.vertices)||(Qr=!0,g=void 0);if(g){var h,k=g.length,l;(l=0<k)||(Qr=!0,l=void 0);if(l)for(h=Array(k/2);k;){var m=g[--k];l=g[--k];h[k/2]=new I(l,m)}h=h?{a:[h]}:B;k=+e["font size"]/a.Za();g=c.kl[k];g||(Sr.lineWidth=k,g=c.kl[k]=c.Ld.Ij(Sr));Tr(a,b,h,!1,g,e,d,f)}delete e.vertices},"city center labels":function(a,b,c,d,e,f){Tr(a,b,Ur(e,new rh([])),!0,c.Ld,e,d,f)},labels:function(a,b,c,d,e,f){var g;(g=e["bounding boxes"])||(Qr=!0,g=void 0);if(g){for(var h=
g.length,k=new rh([]),l;h--;){var m;(m=g[h])||(Qr=!0,m=void 0);(l=m)&&Ur(l,k)}Tr(a,b,k,!0,c.Ld,e,d,f)}delete e["bounding boxes"]},buildings:function(a,b,c,d,e,f){var g=e.id,h=b.rg[g],k,l,m,q=[],p=[];(k=e)||(Qr=!0,k=void 0);if(k&&((l=k.vertices)||(Qr=!0,l=void 0),l)){var r;(r=k.polygons)||(Qr=!0,r=void 0);(m=r)&&q.push.apply(q,Vr(l,m));(k=k.outlines)||(Qr=!0,k=void 0);(m=k)&&p.push.apply(p,Vr(l,m))}m=q.length;q.push.apply(q,p);p=new rh(q,Td,m);(q=q.length)||(Qr=!0,q=void 0);q&&(h?(Dq(h,a,[p]),f.spatials.push(h)):
(h=Tr(a,b,p,!0,c.Ld,e,d,f,g),b.ea(h)))}};Rr["transit stops"]=Rr.POIs=Rr.labels;var Wr=["box 2","box 1","annotation box","icon box"];function Ur(a,b){for(var c=Wr.length,d,e;c--;)if(d=Wr[c],e=a[d]){var f=e[0],g=e[1],h=e[2];e=e[3];b.a.push([new I(f,g),new I(f+h,g),new I(f+h,g+e),new I(f,g+e)]);delete a[d]}return b}
function Vr(a,b){var c=b.length,d,e,f;if(0<c)for(e=Array(c);c--;)if((d=b[c])||(Qr=!0,d=void 0),d){var g=d.length;if(0<g)for(e[c]=f=Array(g);g--;){var h=2*d[g];f[g]=new I(a[h],a[h+1])}}return e||[]}var Xr={};function Tr(a,b,c,d,e,f,g,h,k){Xr.style=e;d=new zq(b,d,k,Xr);c&&Dq(d,a,[c]);Yr(f);f.category=g;d.setData(f);h.spatials.push(d);d.ja(b);return d}Pr.prototype.Ld=new O({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var Sr={};
function Yr(a){var b,c=!1;switch(typeof a){case "object":if(a instanceof Array)for(b=a.length;b--;)Yr(a[b])?c=!0:delete a[b];else if(a)for(b in a)Yr(a[b])?c=!0:delete a[b];break;case "number":c=!0;break;default:c=!!a}return c};function Zr(a,b,c){c=c||{};b=b||{};var d=c.tileType||"maptile",e=c.scheme||"normal.day";R.call(this,{min:0,max:20});!0===b.pois&&(b.pois="!F");this.a=b;if(!(a&&a instanceof $r))throw Error("InvalidArgument: service required");this.B=a;this.v=A(this.v,this);this.B.addEventListener("versionupdate",this.v);this.c=a.I().clone().L(d+"/"+a.Bc()+"/"+e).N(this.K).N(b);this.ac=a.yh()||null;this.V=c.pixelRatio||c.pixelratio||Se();this.tileSize=c.tileSize||256;this.tileType=d;this.scheme=e;this.s=new $p(new Pr(c.categoryFilter));
this.s.ja(this);this.D=A(this.D,this);this.s.addEventListener("update",this.D);R.call(this,{min:0,max:20});this.O(new Fk(c.tileCacheSize||256,A(this.wa,this)))}u(Zr,R);t("H.service.metaInfo.TileProvider",Zr);Zr.prototype.wa=function(a,b){a=b.Ta();for(var c=a.length,d;c--;)d=a[c],delete d.ff[b.key],d.release();b.data&&(Bp.push(b.pg(),this.tileSize),b.qg())};Zr.prototype.D=function(){this.dispatchEvent("update")};
Zr.prototype.J=function(a,b,c,d,e){var f=this.c.clone(),g=this.ac,h=this.tileSize,k=this.getTileKey(a,b,c);k=this.Pb().get(k);var l;if(k&&!k.ae()){d(Bp.pop(this.tileSize),null);var m={cancel:function(){}}}else{g&&f.Qa(g[(c+b+a)%g.length]);f.L(c+"/"+a+"/"+b+"/"+h+"/png8");var q=zp.setTimeout(function(){l=new rf("text/plain",f.toString());l.then(function(p){d(null,p)},e)},500)}return m||{cancel:function(){l?l.cancel():zp.clearTimeout(q)}}};Zr.prototype.requestInternal=Zr.prototype.J;
Zr.prototype.kd=function(a,b,c,d,e){var f=this.s;var g=d||Bp.pop(this.tileSize);if(d)a=this.Pb().get(this.getTileKey(a,b,c)),a.$(d);else if(d=a=new Rk(this.qd(a,b,c),a,b,c,this.tileSize,this.V,c,f),delete d.j,d.m=e,a.$(g))for(e=a.Ta(),g=e.length;g--;)e[g].vg();else Bp.push(g,this.tileSize);return a};Zr.prototype.createTileInternal=Zr.prototype.kd;Zr.prototype.C=function(){this.s.C();this.B.removeEventListener("versionupdate",this.v);R.prototype.C.call(this)};
Zr.prototype.v=function(){var a=this.B;this.c=a.I().clone().L(this.tileType+"/"+a.Bc()+"/"+this.scheme).N(this.K).N(this.a);this.reload(!1)};Zr.prototype.K={metadata:"metaonly",mgen:"2"};function $r(a){$r.l.constructor.call(this,$r,a);a=qp(this,a);this.ac=a.shards;(this.Oa=a.ignoreTypes?null:a.type)&&this.I().Qa(this.Oa);this.bc=a.version;this.ri={};this.Wc=new Mp;"newest"===this.bc&&this.hh()}u($r,pp);t("H.service.metaInfo.Service",$r);$r.prototype.a=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}};$r.CONFIG_KEY="metaInfo";function as(a,b){for(var c={},d=a[b+"s"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+"s"]=c}
$r.prototype.yh=function(){return this.ac};$r.prototype.Qj=function(){return this.Oa};$r.prototype.Bc=function(){return this.bc};$r.prototype.getVersion=$r.prototype.Bc;$r.prototype.Li=function(a){this.bc=a};$r.prototype.sa=function(){return this.Wc};$r.prototype.getCopyrights=$r.prototype.sa;
$r.prototype.Ti=function(a){a=a.response;var b;as(a,"map");as(a,"scheme");as(a,"tiletype");as(a,"format");as(a,"resolution");as(a,"language");if("newest"===this.bc&&"traffic"!==this.Oa)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.Li(a.maps[b].hash),this.dispatchEvent("versionupdate"));this.Fh=a;this.dispatchEvent("infoupdate")};
$r.prototype.hh=function(){var a=this;var b=this.I().clone().L("info").N({output:"json"});this.ac&&b.Qa(this.ac[0]);this.J(b,function(c){a.Ti(c)},function(c){throw c;})};$r.prototype.rh=function(){return this.Fh};$r.prototype.getInfo=$r.prototype.rh;$r.prototype.ze=function(a,b,c,d,e,f){return new Zr(this,d,{tileSize:a,pixelRatio:b,categoryFilter:c,tileType:e,scheme:f})};$r.prototype.createTileProvider=$r.prototype.ze;$r.prototype.uc=function(a,b,c,d,e,f){return new nl(this.ze(a,b,c,d,e,f))};
$r.prototype.createTileLayer=$r.prototype.uc;Y.prototype.Jj=function(a){return this.bb($r,a)};Y.prototype.getMetaInfoService=Y.prototype.Jj;(function(){var a=Y.prototype.createDefaultLayers;Y.prototype.createDefaultLayers=function(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g),k={},l=this.Jj();"object"===typeof b&&(g=b,b=g.tileSize,c=g.ppi,d=g.lg,e=g.lg2,f=g.style,g=g.pois);b=b||256;var m=320===c?2:1;if(0>[72,250,320,500].indexOf(+c)){if(c!==B)throw new D(this.Zg,1,c);}else k.ppi=+c;d&&(k.lg=d);e&&(k.lg2=e);f&&(k.style=f);g&&(k.pois=g);h.raster.normal.metaInfo=l.uc(b,m,["buildings"],k);return h}})();

function bs(a,b,c,d,e){e&1&&cs(a,a,b,c,d,0);e&2&&cs(a,a,b,c,d,1);e&4&&cs(a,a,b,c,d,2);e&8&&cs(a,a,b,c,d,3)}
function cs(a,b,c,d,e,f){var g=(c+1)*(c+1),h,k=4*d,l=c+1,m,q=[{r:0,$l:0,Jl:0,Kg:0,next:null}];var p=1;var r=["r","g","b","a"][f];var v=2*c+1;for(var w,z;p<v;p++)q[p]={r:0,$l:0,Jl:0,Kg:0,next:null},q[p-1].next=q[p];q[2*c].next=q[0];var J=4*(d-1);for(h=0;h<e;h++){var G=h*k;var V=a[G+f];var T=V*l*(c+2)/2;v=V*l;for(p=0;p<=c;p++)q[p][r]=V;var ua=0;for(p=1;p<=c;p++){var ea=p<d?G+4*p:G+J;ea=a[ea+f];T+=ea*(l-p);ua+=ea;q[c+p][r]=ea}ea=q[0];w=q[l];p=G;z=4*l;var ac=G+J;for(V=0;V<d;V++){b[p+f]=T/g;T-=v;var sb=
V+l<d?p+z:ac;sb=a[sb+f];ua+=sb;T+=ua;v-=ea[r];v+=w[r];ua-=w[r];ea[r]=sb;ea=ea.next;w=w.next;p+=4;if(!T)for(;(m=4*(V+l))<k&&0===a[G+f+m];)V++,p+=4}}G=(e-1)*k;for(V=0;V<d;V++){a=4*V;h=b[a+f];T=h*l*(c+2)/2;v=h*l;for(p=0;p<=c;p++)q[p][r]=h;ua=0;for(p=1;p<=c;p++)ea=p<e?a+p*k:a+G,ea=b[ea+f],T+=ea*(c-p+1),ua+=ea,q[c+p][r]=ea;ea=q[0];w=q[l];p=a;ac=l*k;J=a+G;for(h=0;h<e;h++)if(b[p+f]=T/g,T-=v,sb=h+l<e?p+ac:J,sb=b[sb+f],ua+=sb,T+=ua,v-=ea[r],v+=w[r],ua-=w[r],ea[r]=sb,ea=ea.next,w=w.next,p+=k,!T)for(;(m=h+l)<
e&&0===b[m*k+f+a];)h++,p+=k}};function ds(a,b,c){this.f=b=a>>b;this.j=Math.log(b)*Math.LOG2E;this.i=a=document.createElement("CANVAS");this.a=a.getContext("2d");this.b=a.width=a.height=3*b;var d=document.createElement("canvas");a=c.a;var e=c.b;b=[];var f;d.width=256;d.height=1;d=d.getContext("2d");for(g in e)e.hasOwnProperty(g)&&b.push({stop:parseFloat(g),value:e[g]});e=b.length;b.sort(this.m);0<b[0].stop&&b.unshift({stop:0,value:b[0].value});1>b[e-1].stop&&b.push({stop:1,value:b[e-1].value});e=b.length;var g=d.createLinearGradient(0,
0,256,0);for(f=0;f<e;f++){if(!a&&k){var h=k.stop+(b[f].stop-k.stop)/2;g.addColorStop(h,k.value);g.addColorStop(h,b[f].value)}g.addColorStop(b[f].stop,b[f].value);var k=b[f]}d.fillStyle=g;d.fillRect(0,0,256,1);this.c=d.getImageData(0,0,256,1).data;this.g=c.a}ds.prototype.m=function(a,b){return a.stop-b.stop};function es(a,b){this.canvas=a;this.size=b};function fs(a,b,c){this.a=a=Yd(a,0,30);this.Oa=b;this.i=c;this.m=[];this.b=[];do this.b[a]=[],this.m[a]=new gs;while(a--);b===hs?(this.o=is,this.j=js):(this.o=ks,this.j=ls);this.c=1/0;this.f=-1/0}var ms=Math.log(.5);function js(a){return this.g?Math.round((a-this.c)/this.g*255):127}function ls(a){return void 0===this.aa?127:Math.round(255*Math.pow(a,this.aa))}
fs.prototype.Ib=function(a){var b,c;var d=a.value;void 0===d&&(d=1);d>this.f&&(this.f=d,this.g=this.f-this.c);d<this.c&&(this.c=d,this.g=this.f-this.c);var e=Xi.Nb(a).scale(1073741823).floor();d=this.a;var f=e.x>>30-d;e=e.y>>30-d;for(c=this.o;-1<d;){this.b[d][e]||(this.b[d][e]=[]);(b=this.b[d][e][f])||(b=this.b[d][e][f]=new c);b.Ib(a,d);var g=this.m[d];g.f>b.b&&(g.f=b.b);g.a<b.b&&(g.a=b.b);g.c>b.a&&(g.c=b.a);g.b<b.a&&(g.b=b.a);d--;f>>=1;e>>=1}};
function ns(a,b,c,d,e){var f=1<<b,g,h;d=Xd(d,f);f=0<=c&&c<f&&(g=a.b[b])&&(h=g[c])&&(f=h[d])||null;!f&&e&&0<=b&&(f=ns(a,b-1,c>>1,d>>1,e));return f}function os(a,b,c,d,e,f){for(var g,h=[];c<=d;c++)for(g=e;g<=f;g++)h.push(ns(a,b,c,g,!1));return h}function ps(a,b){var c=0,d=0,e=ns(a,0,0,0,!1),f;if(!0===b.c)return b.f;b.z===a.a?b.f=b.a:(qs(a,b,function(g){var h=rs(a,g),k=4-h.length;if(g.z!==a.a){for(f=0;f<h.length;f++)c+=h[f].a,d++;c+=k*e.a;d+=k}}),b.f=c/d);b.c=!0;return b.f}
function qs(a,b,c){b=[b];for(var d,e;0<b.length;)e=b.shift(),d=rs(a,e),c(e),b.push.apply(b,d)}function rs(a,b){var c=[],d,e,f;for(e=0;1>=e;e++)for(f=0;1>=f;f++)(d=ns(a,b.z+1,2*b.x+e,2*b.y+f,!1))&&c.push(d);return c}fs.prototype.clear=function(){fs.call(this,this.a,this.Oa,this.i)};function ks(){this.a=this.b=this.g=0}ks.prototype.Ib=function(a,b){this.g++;this.b+=a.value||1;this.a=this.b/Math.pow(2,2*(30-b))};function is(){this.a=this.b=this.g=0;this.c=!1}
is.prototype.Ib=function(a){a=a.value;this.b+=void 0!==a?a:1;this.a=this.b/++this.g;this.c=!1};function gs(){this.f=this.c=1/0;this.a=this.b=-1/0};function ss(a,b){var c,d=0;if(!Da(a)||Ta(a))throw new D(ss,0,a);for(c in a){var e=+c;d++;if(!(Cc(e)&&0<=e&&1>=e&&zc(a[c])))throw new D(ss,0,a);}if(2>d)throw new D(ss,0,"Specify at least 2 stops");this.b=a;this.a=!!b}t("H.data.heatmap.Colors",ss);var ts=new ss({0:"#008","0.2":"#0b0","0.5":"#ff0","0.7":"#f00"},!0);ss.DEFAULT=ts;function us(a){var b=a||{},c=+b.sampleDepth;a=+b.coarseness;var d=b.colors,e={min:b.min,max:b.max},f=b.tileSize,g=+b.dataMax;b.tileSize&&(e.tileSize=f);R.call(this,e);Wj(this,b.opacity);this.Oa="value"===b.type?hs:vs;this.sampleDepth_=Cc(c)?Yd(Math.round(c),1,8):4;this.v=!!b.assumeValues;b=this.max;this.B=Cc(g)?Yd(Math.round(g),this.min,b+this.sampleDepth_):b;a=Cc(a)?Yd(Math.round(a),0,3):1;if(d&&!C(d,ss))throw new D(us,0,"colors");this.a=new fs(b+this.sampleDepth_,this.Oa,this.B);this.K=new ds(this.tileSize,
a,d||ts);this.s=A(this.s,this);this.c=A(this.c,this);this.D=new zk(20,this.s)}u(us,R);t("H.data.heatmap.Provider",us);us.prototype.pc=function(a){Wj(this,a)};us.prototype.setOpacity=us.prototype.pc;us.prototype.ad=function(){return this.i};us.prototype.getOpacity=us.prototype.ad;us.prototype.af=df;us.prototype.providesRasters=us.prototype.af;
us.prototype.J=function(a,b,c,d,e){var f=this.v,g,h;if(ns(this.a,0,0,0,!1)){if(!f){var k=os(this.a,c,b-1,b+1,a-1,a+1);for(g=k.length;g--&&!f;)if(null!==k[g]){f=!0;break}}f&&(h=this.D.push([a,b,c,d,e],this.c))}f||d(null);return h};us.prototype.requestInternal=us.prototype.J;
function ws(a,b,c,d){var e=document.createElement("canvas"),f=a.tileSize,g=e.getContext("2d");e.width=e.height=f;var h=a.K;var k=a.a,l=a.v,m=a.Oa;var q=h.f;var p=h.a,r,v,w=m===vs?2:1,z=w;a=Math.min(a.sampleDepth_+w,h.j);w=h.b;var J=k.a;if(l&&m===hs){for(v=-1;1>=v;v++)for(l=-1;1>=l;l++){var G=(G=ns(k,d,c+v,b+l,!0))?k.j(ps(k,G)):128;p.fillStyle="rgba("+G+",128,0,1)";p.fillRect((l+1)*q,(v+1)*q,q,q)}l=q-Math.floor(q/10);v=3;G=p.getImageData(0,0,w,w);bs(G.data,l,w,w,v);p.putImageData(G,0,0)}else p.fillStyle=
l?"#080":"#000",p.fillRect(0,0,w,w);for(;z<=a&&d+z<=J;z++){l=q>>z;v=q-l;var V=m===vs?127+Math.floor(128/(1<<a-z)):255;G=(1<<z)+2;var T=1<<z;var ua=b<<z;var ea=c<<z;T=os(k,d+z,ea-1,ea+T,ua-1,ua+T);for(ua=T.length;ua--;){ea=ua%G;var ac=ua/G<<0;if(r=T[ua])r=k.j(r.a),p.fillStyle="rgba("+r+","+V+",0,1)",p.fillRect(ea*l+v,ac*l+v,l,l)}G=p;V=l;T=v;ua=q+2*l;l=q+2*l;ea=ea=3;ac=p.getImageData(T,v,ua,l);bs(ac.data,V,ua,l,ea);G.putImageData(ac,T,v)}b=p.getImageData(0,0,w,w);c=h.c;d=h.g;k=b.data;a=0;for(w=k.length;a<
w;a+=4)m=k[a],z=k[a+1],4===c.length&&(m=0),k[a]=c[4*m],k[a+1]=c[4*m+1],k[a+2]=c[4*m+2],k[a+3]=c[4*m+3]*(d?z/255:10>z?0:1);p.putImageData(b,0,0);h=new es(h.i,q);q=h.size;g.drawImage(h.canvas,q,q,q,q,0,0,f,f);return e}us.prototype.s=function(a,b){a.done(ws(this,b[0],b[1],b[2]))};us.prototype.c=function(a,b,c){var d=a.data;a=d[3];d=d[4];c?d():a(b)};
us.prototype.lj=function(a,b){var c;if(!yc(a))throw new D(this.lj,0,a);if(c=a.length){for(;c--;)this.a.Ib(a[c]);a=this.a;var d;c=a.m;var e=a.a,f=0;if(a.Oa===vs){var g=c[a.a].a;for(d=a.a;0<=d;d--)if(c[d].a===g)f=d;else break;g=c[0].a;for(d=0;d<=f;d++)if(g===c[d].a)e=d;else break;f>a.i&&(f=a.i);g=Math.round(e+(f-e)/2);a.aa=ms/Math.log(c[g].b)}this.reload(!!b)}};us.prototype.addData=us.prototype.lj;us.prototype.clear=function(){this.a.clear();this.reload(!0)};us.prototype.clear=us.prototype.clear;var vs=0,hs=1;function xs(){}t("H.data.utils.Dom",xs);xs.prototype.Od=function(a){return!!a&&/^\s*(1|true)\s*$/i.test(this.Ma(a))};xs.prototype.getBoolean=xs.prototype.Od;xs.prototype.Ma=function(a){var b;try{if(a.nodeType===Node.ATTRIBUTE_NODE)return a.value;var c="";var d=0;var e=a.childNodes;for(b=e.length;d<b;d++)e[d].nodeType!==Node.COMMENT_NODE&&(c+=e[d].nodeValue.replace(/^\s+|\s+$/g,""))}catch(f){}return c||""};xs.prototype.getString=xs.prototype.Ma;
xs.prototype.Rf=function(a){return parseFloat(this.Ma(a))||0};xs.prototype.getFloat=xs.prototype.Rf;xs.prototype.Fk=function(a){var b=a.split(/\s+/),c=b.length,d=!(b&&1==c),e=d?1:3,f=[],g;d||(b=a.split(","),c=b.length);for(g=0;g<c;g+=e)if(a=this.li(d?b[g]:g+3>b.length?null:b.slice(g,g+3)))f.push(a);else return[];return f};xs.prototype.parseCoords=xs.prototype.Fk;
xs.prototype.li=function(a){if(!a)return null;var b=a instanceof Array&&0<a.length&&4>a.length?a:a.split(",");a=parseFloat(b[0]);var c=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(c)||isNaN(a)?null:new Xf(c,a,isNaN(b)?void 0:b)};xs.prototype.parseCoord=xs.prototype.li;xs.prototype.Qf=function(a){a=this.Ma(a);return/^[0-9a-fA-F]{8}$/.test(a)?"#"+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2):"#000000ff"};xs.prototype.getColor=xs.prototype.Qf;function ys(){this.a={4:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}};this.b={4:function(a){return[zs(a.charAt(1)),zs(a.charAt(2)),zs(a.charAt(3)),255]},5:function(a){return[zs(a.charAt(1)),zs(a.charAt(2)),zs(a.charAt(3)),zs(a.charAt(4))]},7:function(a){a=
parseInt(a.substring(1),16);return[a>>16&255,a>>8&255,a&255,255]},9:function(a){a=parseInt(a.substring(1),16);return[a>>24&255,a>>16&255,a>>8&255,a&255]}}}t("H.data.utils.ColorHelper",ys);function zs(a){a=parseInt(a,16);return(a<<4)+a}function As(a){return 16>a?"0"+Math.round(a).toString(16):Math.round(a).toString(16)}
function Bs(a,b,c){if(!/^(#|rgb).*/.test(b))return[0,0,0,255];c||(c="","#"===b.charAt(0)?c=a.a[b.length]?b:"":"rgb"===b.substr(0,3)&&(b=b.match(/\d+(\.\d+)?/g),c=b.length,c=2<c&&5>c?["#",As(+b[0]),As(+b[1]),As(+b[2]),3<c?As(255*+b[3]):"ff"].join(""):""),b=c);a=a.b[b.length](b);a[3]=Math.round(a[3]/255*100)/100;return a}
ys.prototype.ql=function(a,b){var c="";if(!/^(#|rgb).*/.test(a)){c="";var d;for(d=0;6>d;d++)c+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return c+"ff"}a=Bs(this,a,b);for(b=0;4>b;b++)3>b?d=Math.floor(Math.random()*(a[b]+1)):d=255*a[b],c+=As(d);return c};ys.prototype.toRandomRGBA=ys.prototype.ql;function Cs(a){a=a.attributes;for(var b,c=a.length;c--;)switch(b=a[c],b.name){case "x":this.x=parseFloat(b.value);break;case "y":this.y=parseFloat(b.value);break;case "xunits":this.bd="fraction"===xs.prototype.Ma(b);break;case "yunits":this.Fc="fraction"===xs.prototype.Ma(b)}}t("H.data.kml.HotSpot",Cs);function Ds(a){var b=a.childNodes,c=new xs;for(a=b.length;a--;){var d=b[a];switch(d.nodeName){case "href":this.href=c.Ma(d)}}}t("H.data.kml.Icon",Ds);function Es(a){var b;if(a){a=a.childNodes;var c=a.length;for(b=new xs;c--;){var d=a[c];switch(d.nodeName){case "scale":this.scale=b.Rf(d);break;case "Icon":this.icon=d=new Ds(d);break;case "hotSpot":this.Wj=d=new Cs(d)}}}}t("H.data.kml.IconStyle",Es);function Fs(a){a=a.childNodes;for(var b,c=a.length,d=new xs,e=new ys;c--;)switch(b=a[c],b.nodeName){case "color":this.color=d.Qf(b);break;case "colorMode":this.a=d.Ma(b)}"random"===this.a&&(this.color="#"+e.ql(this.color,!1))}t("H.data.kml.ColorStyle",Fs);function Gs(a){var b=a.childNodes,c=b.length,d=new xs;this.outline=this.fill=!0;for(this.Ef=new Fs(a);c--;)switch(a=b[c],a.nodeName){case "fill":this.fill=d.Od(a);break;case "outline":this.outline=d.Od(a)}}t("H.data.kml.PolyStyle",Gs);function Hs(a){var b=a.childNodes,c=b.length,d=new xs;for(this.Ef=new Fs(a);c--;)a=b[c],"width"===a.nodeName&&(this.width=d.Rf(a))}t("H.data.kml.LineStyle",Hs);function Is(a){a=a.childNodes;for(var b,c=a.length,d=new xs;c--;)switch(b=a[c],b.nodeName){case "bgColor":this.bgColor=d.Qf(b);break;case "textColor":this.textColor=d.Qf(b);break;case "text":this.text=d.Ma(b);break;case "displayMode":this.displayMode=d.Ma(b)}}t("H.data.kml.BalloonStyle",Is);function Js(a){var b=a.childNodes,c=b.length;for(this.id=a.getAttribute("id");c--;)switch(a=b[c],a.nodeName){case "IconStyle":this.Xj=a=new Es(a);break;case "LineStyle":this.ce=a=new Hs(a);break;case "PolyStyle":this.Hk=a=new Gs(a);break;case "BalloonStyle":this.zf=a=new Is(a)}}t("H.data.kml.Style",Js);function Ks(a,b){a=a.childNodes;var c=a.length,d=new xs;for(this.b=b;c--;)switch(b=a[c],b.nodeName){case "key":this.key=d.Ma(b);break;case "styleUrl":this.a=d.Ma(b)}}t("H.data.kml.Pair",Ks);Ks.prototype.ta=function(){if(this.a){var a="highlight"===this.key?!0:!1;a=this.b.Ah(this.a.substr(1),a)}return a};Ks.prototype.getStyle=Ks.prototype.ta;function Ls(a,b){var c=a.childNodes,d=c.length;this.b=b;this.id=a.getAttribute("id");for(this.a=[];d--;)a=c[d],"Pair"===a.nodeName&&(a=new Ks(a,this.b),this.a.push(a))}t("H.data.kml.StyleMap",Ls);Ls.prototype.ta=function(a){var b=null;a=a?"highlight":"normal";for(var c=this.a.length;c--;)this.a[c].key===a&&(b=this.a[c].ta());return b};Ls.prototype.getStyle=Ls.prototype.ta;function Ms(){this.a={}}t("H.data.kml.StyleContainer",Ms);Ms.prototype.Og=function(a){a&&a.id&&(this.a["style_"+a.id]=a)};Ms.prototype.addStyle=Ms.prototype.Og;Ms.prototype.Ah=function(a,b){a=this.a["style_"+a];a instanceof Ls&&(a=a.ta(b));return a};Ms.prototype.getStyleById=Ms.prototype.Ah;function Ns(a,b){var c=a&&a.childNodes||[],d=new xs;if(!a||!b)throw Error("Node or stylesContainer is not defined");this.visibility=!0;this.qo=a;for(a=c.length;a--;){var e=c[a];switch(e.nodeName){case "name":this.name=d.Ma(e);break;case "description":this.description=d.Ma(e);break;case "visibility":this.visibility=d.Od(e);break;case "open":this.open=d.Od(e);break;case "styleUrl":if(this.a=d.Ma(e))e=this.a.substr(1),this.Yl=b.Ah(e,!1);break;case "Style":this.fk=e=new Js(e)}}}
t("H.data.kml.Feature",Ns);function Os(a){a=a.childNodes;for(var b,c=a.length,d=null,e=new xs;c--;)b=a[c],"coordinates"===b.nodeName&&(d=e.Ma(b));this.a=null;d&&(this.a=e.li(d)||null)}t("H.data.kml.Point",Os);function Ps(a){a=a.childNodes;for(var b,c=a.length,d=new xs;c--;)if(b=a[c],"coordinates"===b.nodeName){b=d.Ma(b);var e=[],f=new xs;try{e=f.Fk(b)}catch(g){e=[]}this.a=2>e.length?[]:e}}t("H.data.kml.Line",Ps);function Qs(a){for(var b=new L,c=a.a?a.a.length:0;c--;)b.wd(a.a[c]);return b};function Rs(){}Rs.prototype.f=0;Rs.prototype.b=0;function Ss(a){var b=a.childNodes,c=b.length;this.a=new L;for(this.c=[];c--;){var d=b[c];var e=d.nodeName;if("outerBoundaryIs"===e||"innerBoundaryIs"===e){var f=d.childNodes;for(d=f.length;d--;){var g=f[d];if("LinearRing"===g.nodeName){var h=new Ps(g);if("outerBoundaryIs"===e){this.a=Qs(h);var k=void 0,l=a,m=h.a;h=new xs;var q=l.querySelector("altitudeMode");if(q&&q.parentNode===l&&!/^\s*clampTo/.test(h.Ma(q))&&m){q=m.length;for(var p=0;p<q&&0!==k;p++){var r=m[p].alt;r?k?r!==k&&(k=0):k=r:k=0}(m=l.querySelector("*|altitudeOffset"))&&
m.parentNode===g&&"http://www.google.com/kml/ext/2.2"===m.namespaceURI&&(g=h.Rf(m))&&(k+=g);k&&(k=vd(yi,k),(g=l.querySelector("extrude"))&&g.parentNode===l&&h.Od(g)?this.b=k:this.f=k)}}else this.c.push(Qs(h))}}}}}u(Ss,Rs);t("H.data.kml.Polygon",Ss);function Ts(a,b){var c=document.createElement("CANVAS");c.width=1;c.height=1;this.i=a;this.b={};this.f={};this.g=new Ij(c);this.c=b||""}Ts.prototype.create=function(a){this.a=new Ns(a,this.i);return Us(this,a,null)};
function Us(a,b,c){b=b.childNodes;for(var d=b.length,e,f={},g;d--;){var h=b[d];switch(h.nodeName){case "Point":e=new Os(h);g=Vs(a,"Marker");e=new nn(e.a,g);g.mi&&Ce(g.mi,"statechange",A(a.j,a,g.mi,e,g),!1);break;case "LineString":e=new Ps(h);g=Vs(a,"Polyline");e=new nh(Qs(e),g);break;case "LinearRing":e=new Ps(h);g=Vs(a,"Polyline");e=new nh(Qs(e),g);break;case "Polygon":e=new Ss(h);g=Vs(a,"Polygon");g.elevation=e.f;g.extrusion=e.b;e=new xi(new P(e.a,e.c),g);break;case "MultiGeometry":e=new Q,e=Us(a,
h,e)}e&&(a.a.name&&(f.name=a.a.name),a.a.description&&(f.description=a.a.description),g&&g.zf&&(f.balloonStyle=g.zf),f.kmlNode=a.a.qo,e.setData(f),c&&c.ea(e))}c&&(e=c);return e}Ts.prototype.j=function(a,b,c){var d=c.anchor,e=c.scale;c=e+"_"+d.x+d.y+d.bd+d.Fc+"_"+c.href;var f={};if(1===a.getState()){var g=this.b[c];if(!g){var h=d.x;var k=d.y;if(g=a.Bb())g={w:g.w*e,h:g.h*e},f.size=g;h=d.bd&&g?g.w*h:h*e;k=d.Fc&&g?g.h*(1-k):!d.Fc&&g?g.h-k*e:k*e;f.anchor={x:h,y:k};g=new Ij(a.Zc(),f);this.b[c]=g}b.Oc(g)}delete this.f[c]};
function Vs(a,b){var c=a.a,d={visibility:c.visibility};var e=new ys;var f=1;var g={x:0,y:0,bd:!1,Fc:!1};var h=Ws(a,c.Yl);c.fk&&(h=Ws(a,c.fk,h));switch(b){case "Marker":if(h&&h.Xj){e=h.Xj;e.scale&&(f=e.scale);if(e.Wj){var k=e.Wj;g={x:k.x,y:k.y,bd:k.bd,Fc:k.Fc}}e.icon&&e.icon.href?(b=e.icon.href,Xs.test(b)||(b=a.c+b),e=f+"_"+g.x+g.y+g.bd+g.Fc+"_"+b,k=a.b[e]||a.f[e],k||(k=new Ij(b),a.f[e]=k),0===k.getState()?(d.icon=a.g,d.mi=k,d.href=b,d.anchor=g,d.scale=f):1===k.getState()&&(d.icon=k)):1!==f&&(k||(g=
{x:14,y:4,bd:!1,Fc:!1}),a={w:28*f,h:36*f},f={size:new Ki(a.w,a.h),anchor:new I(g.bd?a.w*g.x:g.x*f,g.Fc?a.h*(1-g.y):a.h-g.y*f),hitArea:new Li(Mi.POLYGON,[0*f,16*f,0*f,7*f,8*f,0*f,18*f,0*f,26*f,7*f,26*f,16*f,18*f,34*f,8*f,34*f])},d.icon=new Ij('<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',
f))}break;case "Polyline":d.style={};h&&h.ce&&(f=h.ce,d.style.strokeColor="rgba("+Bs(e,f.Ef.color,!0)+")",0<=f.width&&(d.style.lineWidth=f.width));break;case "Polygon":d.style={},h&&(h.ce&&(f=h.ce,d.style.strokeColor="rgba("+Bs(e,f.Ef.color,!0)+")",0<=f.width&&(d.style.lineWidth=f.width)),h.Hk&&(f=h.Hk,d.style.fillColor=f.fill?"rgba("+Bs(e,f.Ef.color,!0)+")":"rgba(0,0,0,0)",f.outline||(d.style.lineWidth=0)))}d.zf=h.zf;return d}
function Ws(a,b,c){c=c||{};for(var d in b)b.hasOwnProperty(d)&&(c[d]="object"===typeof b[d]?Ws(a,b[d],c[d]):b[d]);return c}var Xs=/^[^:\/]+:/;function Ys(a){uc(this,Ys);this.url=a;this.b=[];this.a=y;this.c=A(this.c,this);F.call(this)}u(Ys,F);t("H.data.AbstractReader",Ys);var Zs={ERROR:-1,LOADING:0,VISIT:1,READY:2};Ys.State=Zs;Ys.prototype.f=Zs.READY;Ys.prototype.j={Dl:"statechange"};Ys.prototype.Ab=function(){if(!this.a){this.a=new N;var a=this.a.jc();a.ec(this.b)}return new ol(this.a)};Ys.prototype.getLayer=Ys.prototype.Ab;Ys.prototype.Vm=function(){return this.b.concat([])};Ys.prototype.getParsedObjects=Ys.prototype.Vm;
Ys.prototype.I=function(){return this.url};Ys.prototype.getUrl=Ys.prototype.I;Ys.prototype.Eo=function(a){if(this.f===Zs.LOADING||this.f===Zs.VISIT)throw Error("InvalidState: state "+this.f);this.b=[];this.a=y;this.url=a;return this};Ys.prototype.setUrl=Ys.prototype.Eo;Ys.prototype.getState=function(){return this.f};Ys.prototype.getState=Ys.prototype.getState;Ys.prototype.P=function(a,b,c){this.f=a;this.dispatchEvent(new $s(b||this,this.j.Dl,a,c||""))};
Ys.prototype.parse=function(){var a=this;tc(this.url)?(this.P(Zs.LOADING),(new rf("text/plain",this.url)).then(function(b){try{a.c(b)}catch(c){a.P(Zs.ERROR,y,c.message)}},function(){a.P(Zs.ERROR,y,"Error loading file")})):a.P(Zs.ERROR,y,"File url was not set")};Ys.prototype.parse=Ys.prototype.parse;function $s(a,b,c,d){$s.l.constructor.call(this,b,a);this.state=c;this.message=d}u($s,rd);function at(a){var b=a?a.lastIndexOf("/"):B;this.g=[];Ys.call(this,a);0<=b&&(this.i=a.substr(0,b)+"/")}u(at,Ys);t("H.data.kml.Reader",at);
at.prototype.c=function(a){var b,c=null;if(a&&""!=a.trim()){try{var d=(new DOMParser).parseFromString(a,"text/xml")}catch(h){this.P(Zs.ERROR,void 0,"Error parsing KML document");return}if(d.getElementsByTagName("parsererror").length)this.P(Zs.ERROR,void 0,"Error parsing KML document");else if((a=d.childNodes&&"kml"===d.childNodes[0].nodeName?d.childNodes[0]:void 0)&&(b=bt(a.childNodes,"Document")[0]),b=b||a){d=new Ms;for(var e=bt(b.childNodes,"Style"),f=bt(b.childNodes,"StyleMap"),g=e.length;g--;)a=
new Js(e[g]),d.Og(a);for(g=f.length;g--;)a=new Ls(f[g],d),d.Og(a);this.o=d;this.m=new Ts(this.o,this.i);a=b.childNodes;for(b=a.length;b--;)if(e=a[b],d=c,"Placemark"===e.nodeName?(e=this.m.create(e))&&ct(this,e,d):"Folder"===e.nodeName&&(e={group:new Q,node:e},ct(this,e.group,d),this.g.push(e)),!b&&(d=this.g.shift()))a=d.node.childNodes,c=d.group,b=a.length;this.P(Zs.READY)}else this.P(Zs.ERROR,void 0,"Invalid KML document")}else this.P(Zs.ERROR,void 0,"Unable to create objects from the empty data")};
function ct(a,b,c){c?c.ea(b):(a.a&&a.a.jc().ea(b),a.b.push(b),a.P(Zs.VISIT,b))}function bt(a,b){for(var c=a.length,d,e=[];c--;)d=a[c],d.nodeName===b&&e.push(d);return e};function dt(a,b){this.b=a;this.a=b}
dt.prototype.create=function(a,b){var c=a.coordinates;switch(a.type){case "Point":var d=new nn(et(c));break;case "LineString":d=new nh(ft(c));break;case "Polygon":d=new xi(gt(c));break;case "MultiPoint":var e=0;var f=c.length;d=[];if(this.a){for(;e<f;e++)d.push(et(c[e]));c=new nn(new Ji(d))}else{for(;e<f;e++)d.push(new nn(et(c[e])));c=new Q;c.ec(d)}d=c;f="multiPoint";break;case "MultiLineString":e=0;f=c.length;d=[];if(this.a){for(;e<f;e++)d.push(ft(c[e]));c=new nh(new mh(d))}else{for(;e<f;e++)d.push(new nh(ft(c[e])));
c=new Q;c.ec(d)}d=c;f="multiLineString";break;case "MultiPolygon":d=[];e=0;f=c.length;if(this.a){for(;e<f;e++)d.push(gt(c[e]));c=new xi(new vi(d))}else{for(;e<f;e++)d.push(new xi(gt(c[e])));c=new Q;c.ec(d)}d=c;f="multiPolygon";break;case "GeometryCollection":c=d=new Q;e=a.geometries;f=0;for(var g=e.length;f<g;f++)this.create(e[f],c);f="geometryCollection"}d&&(c=d,e=a.properties,a=a.id,g={},e&&(this.a?g=e:g.properties=e),f&&!this.a&&(g[f]=!0),a&&c.Ji(a),c.setData(g),this.b(d));b&&d&&b.ea(d);return d};
dt.prototype.create=dt.prototype.create;function et(a){return new Xf(a[1],a[0])}function gt(a){for(var b=ft(a[0]),c=[],d,e=1,f=a.length;e<f;e++)d=ft(a[e]),c.push(d);return new P(b,c)}function ft(a){for(var b=0,c=a.length,d=new L;b<c;b++)d.wd(et(a[b]));return d};function ht(a,b){b=b||{};this.i=b.style||this.Ld;(this.g=!!b.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true.");Ys.call(this,a)}u(ht,Ys);t("H.data.geojson.Reader",ht);
ht.prototype.c=function(a){var b,c;try{var d="string"===typeof a?JSON.parse(a):a;if("object"===typeof d){var e=new dt(this.i,this.g);switch(d.type){case "FeatureCollection":if(b=d.features){var f=new Q;it(this,f);for(c=0;c<b.length;c++){var g=jt(b[c]);(g=e.create(g))&&f.ea(g)}}break;case "Feature":g=jt(d);(g=e.create(g))&&it(this,g);break;default:(g=e.create(d))&&it(this,g)}this.P(Zs.READY)}else this.P(Zs.ERROR,void 0,"Invalid syntax")}catch(h){this.P(Zs.ERROR,void 0,"Parse error. "+h.message)}};
ht.prototype.po=function(a){this.P(Zs.LOADING);this.c(a)};ht.prototype.parseData=ht.prototype.po;ht.prototype.Ld=function(){};function jt(a){var b={};if(a.geometry){var c=a.geometry;b.type=c.type;b.properties=a.properties;c.coordinates&&(b.coordinates=c.coordinates);c.geometries&&(b.geometries=c.geometries);a.id&&(b.id=a.id)}return b}function it(a,b){a.a&&a.a.jc().ea(b);a.b.push(b);a.P(Zs.VISIT,b)};t("H.data.buildInfo",function(){return Ef("H-data","1.21.2","abfe236")});

hg.prototype.Tc=ca(1,function(a,b){this.a.Tc(a,Cc(b)?b:this.c)});lg.prototype.Tc=ca(0,function(a,b){var c=0,d;if(!a(this)&&b--)for(;3>=c;c++)(d=this[c])&&d.Tc(a,b)});function kt(a,b,c){this.f=this.c=c;this.ni=[];this.a=0;this.R=dg(a,b,!0)}t("H.clustering.grid.Cluster",kt);kt.prototype.te=function(a){this.b||(this.b=Zf(a));this.a+=a.wt||1;this.ni.push(a)};kt.prototype.Ba=function(){return this.b};kt.prototype.getPosition=kt.prototype.Ba;kt.prototype.Dc=function(){return this.a};kt.prototype.getWeight=kt.prototype.Dc;kt.prototype.td=df;kt.prototype.isCluster=kt.prototype.td;kt.prototype.zc=function(){return this.c};kt.prototype.getMinZoom=kt.prototype.zc;
kt.prototype.Tf=function(){return this.f};kt.prototype.getMaxZoom=kt.prototype.Tf;kt.prototype.F=function(){return this.R};kt.prototype.getBoundingBox=kt.prototype.F;kt.prototype.jh=function(a){this.Fe(a)};kt.prototype.forEachEntry=kt.prototype.jh;kt.prototype.Fe=function(a){var b=this;if(!Ca(a))throw new D(this.Fe,0,a);this.ni.forEach(function(c){a(new lt(c,b.c+1))})};kt.prototype.forEachDataPoint=kt.prototype.Fe;function mt(a){nd.call(this);this.a=[];var b;a?Wa(b={},nt,a):b=nt;this.g=b;nd.call(this)}u(mt,nd);var ot={clusters:[],noisePoints:[]},nt={projection:Xi,min:0,max:22,eps:32,minWeight:2};n=mt.prototype;n.Nc=function(a){this.a=a;this.b=!0};n.Ib=function(a){this.a.push(a);this.b=!0};n.yf=function(a){this.a=this.a.concat(a);this.b=!0};n.cf=function(a){this.a=this.a.filter(function(b){return b!==a});this.b=!0};n.u=function(){mt.l.u.call(this);this.a=null};n.Vk=id;function lt(a,b){this.a=a;this.b=b}t("H.clustering.grid.NoisePoint",lt);lt.prototype.Ba=function(){return Zf(this.a)};lt.prototype.getPosition=lt.prototype.Ba;lt.prototype.Dc=function(){return this.a.wt};lt.prototype.getWeight=lt.prototype.Dc;lt.prototype.td=ef;lt.prototype.isCluster=lt.prototype.td;lt.prototype.zc=function(){return this.b};lt.prototype.getMinZoom=lt.prototype.zc;lt.prototype.getData=function(){return this.a.data};lt.prototype.getData=lt.prototype.getData;function pt(a){mt.call(this,a)}u(pt,mt);
pt.prototype.Ni=function(a){var b=this.g,c=b.min,d=b.max,e=[],f=[],g;if(this.b){for(g=this.a;c<=d;c++){for(var h,k=void 0,l,m,q,p,r,v,w,z=c,J=g,G=e,V=f,T=b.eps,ua=b.projection,ea=b.minWeight,ac=J.length,sb=Math.pow(2,z+8),ad=[];w=J[--ac];)if(!w.Wi){m=ua.Nb(w).scale(sb).floor();v=sb;r=m.x;p=m.y;for(l=ad.length;l--;)h=ad[l],q=h.Ba(),h.Vi||(h.Vi=ua.Nb(q).scale(sb).floor()),q=h.Vi,q=q.Ya(m),q<v&&(v=q,k=h);k&&k.F().Kd(w)||(k=new kt(ua.ng({x:(r-T)/sb,y:(p-T)/sb}),ua.ng({x:(r+T)/sb,y:(p+T)/sb}),z),ad.push(k));
k.te(w);k=null}for(ac=ad.length;ac--;)if(h=ad[ac],l=h.Dc(),l<ea)for(h=h.ni,l=h.length;w=h[--l];)V.push(new lt(w,z)),w.Wi=!0;else G.push(h)}c=0;for(d=g.length;c<d;c++)delete g[c].Wi;this.b=!1;a({clusters:e,noisePoints:f})}};function qt(a){this.a=a;a=document.createElement("canvas");var b=a.getContext("2d"),c=this.a,d=14*c;a.width=d;a.height=d;b.scale(c,c);b.beginPath();b.strokeStyle="#FFFFFF";b.fillStyle="#1080DD";b.arc(7,7,6,0,2*Math.PI,!1);b.fill();b.lineWidth=1;b.stroke();this.f=new Ij(a,{size:{w:14,h:14},anchor:{x:7,y:7}});this.b={};this.c={}}t("H.clustering.theme.Circular",qt);
function rt(a,b,c){var d,e=document.createElement("canvas"),f=e.getContext("2d");var g=a.a;var h=b*g;e.width=h;e.height=h;f.scale(g,g);g=b+":"+c;(d=a.b[g])?f.putImageData(d,0,0):(b/=2,f.beginPath(),f.strokeStyle="rgba("+c+",0.2)",f.fillStyle="rgba("+c+",1)",f.arc(b,b,b/5*3,0,2*Math.PI,!1),f.fill(),f.lineWidth=b/5*4,f.stroke(),a.b[g]=f.getImageData(0,0,h,h));return e}
qt.prototype.km=function(a){var b=a.Dc();var c=this.c[b];if(!c){if(10>b){c=rt(this,28,"118,209,0");var d={x:11,y:18}}else 25>b?(c=rt(this,38,"255,105,0"),d={x:13,y:23}):50>b?(c=rt(this,38,"240,60,0"),d={x:13,y:23}):100>b?(c=rt(this,38,"181,0,21"),d={x:13,y:23}):1E3>b?(c=rt(this,48,"181,0,21"),d={x:15,y:28}):(c=rt(this,66,"181,0,21"),d={x:20,y:38});var e=c.getContext("2d");e.fillStyle="#FFFFFF";e.font="bold 11px Arial";e.fillText(b,d.x,d.y);d=c.width/this.a;c=new Ij(c,{size:{w:d,h:d},anchor:{x:d/2,
y:d/2}});this.c[b]=c}b=new nn(a.Ba(),{icon:c,min:a.zc(),max:a.Tf()});b.setData(a);return b};qt.prototype.getClusterPresentation=qt.prototype.km;qt.prototype.Sm=function(a){var b=new nn(a.Ba(),{icon:this.f,min:a.zc()});b.setData(a);return b};qt.prototype.getNoisePresentation=qt.prototype.Sm;function st(a){mt.call(this,a);a=this.g;if(a.projection!==Xi)throw new D(st,0,"Other projection than mercator not supported yet");this.m=a.projection;this.f=a.eps;this.v=a.minWeight;this.o=new Yi(this.m);(new Mf).a("cluster","H.clustering.dynamicgrid.worker");this.i=A(this.i,this);this.j=A(this.j,this)}u(st,mt);st.prototype.Vk=function(a,b){this.aa=a;this.s=yd(b)};
st.prototype.Ni=function(a,b){var c=this.c;var d=this.aa,e=this.s||0;var f=!c||!(c.zoom===e&&c.b.na(d));if(d&&(this.b||f)){c&&3>c.ee&&c.cancel();this.b=!1;c=this.f;if(c>=128*Dd(2,e))var g=tt;else{f=this.o;f.Fa(e);var h=f.kb(d.Rb());g=f.kb(d.Ob());h.y-=c;g.y+=c;h=f.Ye(h);var k=f.Ye(g);g=new K(h.lat,h.lng,k.lat,k.lng);c=f.Pa(c,0).lng+180;g=g.Hc(h.lat,h.lng-c,k.lat,h.lng).Hc(h.lat,k.lng,k.lat,k.lng+c)}c=g;h=this.a;g=[];for(f=h.length;f--;)c.Kd(h[f])&&g.push(h[f]);0<g.length?(this.c=new ut(d,e,g,this.f,
this.v,this.m!==Xi,a,b),this.c.then(this.i,this.j)):a(ot)}};st.prototype.i=function(a){Ba(a)||(a=new x.Uint32Array(a));this.c.g(vt(this,a))};st.prototype.j=function(a){zc(a)&&this.c.f(a)};var tt=new K(90,-180,-90,180);
function vt(a,b){for(var c=0,d=b[c++],e=Array(d),f=0,g=[],h=b.length,k=a.c.a,l=a.c.zoom;d--;)e[f++]=new lt(k[b[c++]],l);for(;c<h;){d=b[c++];f=k[b[c]];var m=a.o;var q=a.f;m.Fa(a.c.zoom);var p=m.kb(f);f=m.Pa(p.x-q,p.y-q);m=m.Pa(p.x+q,p.y+q);f=new K(f.lat,f.lng,m.lat,m.lng);for(f=new kt(f.Rb(),f.Ob(),l);d--;)f.te(k[b[c++]]);g.push(f)}return{clusters:g,noisePoints:e}}st.prototype.u=function(){st.l.u.call(this)};
function ut(a,b,c,d,e,f,g,h){this.b=a;this.zoom=b;this.a=c;this.g=g;this.f=h;a=c.length;g=3*a;h=new (x.Float64Array||Array)(g);for(var k;a--;)k=c[a],h[--g]=k.lat,h[--g]=k.lng,h[--g]=k.wt;ee.call(this,"cluster",{message:[h,d,e,b,f]},void 0)}u(ut,Qf);function wt(a,b,c){this.c=a;this.a=b;this.f=c}t("H.clustering.fastgrid.NoisePoint",wt);wt.prototype.Ba=function(){this.b||(this.b=this.c.Pa(this.a[1],this.a[0],1));return this.b};wt.prototype.getPosition=wt.prototype.Ba;wt.prototype.Dc=function(){return this.a.a};wt.prototype.getWeight=wt.prototype.Dc;wt.prototype.td=ef;wt.prototype.isCluster=wt.prototype.td;wt.prototype.zc=function(){return this.f-this.c.c};wt.prototype.getMinZoom=wt.prototype.zc;wt.prototype.getData=function(){return this.a.data};
wt.prototype.getData=wt.prototype.getData;function xt(a,b,c,d){this.c=a;this.a=b;this.j=c;this.o=d;this.g=Ia(this.g,this);this.f=Ia(this.f,this)}t("H.clustering.fastgrid.Cluster",xt);xt.prototype.Ba=function(){this.b||(this.b=this.c.Pa(this.a.we,this.a.xe,this.a.Kb));return this.b};xt.prototype.getPosition=xt.prototype.Ba;xt.prototype.Dc=function(){return this.a.Kb};xt.prototype.getWeight=xt.prototype.Dc;xt.prototype.td=df;xt.prototype.isCluster=xt.prototype.td;xt.prototype.zc=function(){return this.j?this.j-this.c.c:-1/0};
xt.prototype.getMinZoom=xt.prototype.zc;xt.prototype.Tf=function(){return this.o-this.c.c};xt.prototype.getMaxZoom=xt.prototype.Tf;xt.prototype.F=function(){this.R||(this.R=dg(this.c.Pa(this.a.a,this.a.f,1),this.c.Pa(this.a.b,this.a.c,1),!0));return this.R};xt.prototype.getBoundingBox=xt.prototype.F;xt.prototype.jh=function(a){this.i=a;this.a.Tc(this.g,Td)};xt.prototype.forEachEntry=xt.prototype.jh;
xt.prototype.g=function(a,b){var c=!1,d,e;a.Kb>=this.c.m&&a!==this.a&&a.Kb!==this.a.Kb&&(this.i(new xt(this.c,a,0,b)),c=!0);if(!c&&(d=a.entries))for(a=d.length,e=0;e<a;e++)this.i(new wt(this.c,d[e],b));return c};xt.prototype.Fe=function(a){this.m=a;this.a.Tc(this.f,Td)};xt.prototype.forEachDataPoint=xt.prototype.Fe;xt.prototype.f=function(a,b){var c;if(a=a.entries){var d=a.length;for(c=0;c<d;c++)this.m(new wt(this.c,a[c],b))}return!1};function yt(a,b,c,d,e,f){this.g=b;a&&(this.parent=a,b&1?(c=a[8],e=a[5]):(c=a[7],e=a[8]),b&2?(d=a[9],f=a[6]):(d=a[4],f=a[9]));this[7]=c;this[5]=e;this[8]=(c+e)/2;this[4]=d;this[6]=f;this[9]=(d+f)/2}n=yt.prototype;n.de=0;function zt(a,b){return a[b]||(++a.de,a[b]=new yt(a,b))}n.removeChild=function(a){var b=a.g;this[b]===a&&(delete this[b],delete a.parent,--this.de)};n.Tc=function(a,b){for(var c=0,d=this;d=d.parent;)++c;At(this,a,b,c)};
function At(a,b,c,d){var e,f;if(!b(a,d)&&c--)for(++d,e=0;4>e;e++)(f=a[e])&&At(f,b,c,d)}n.we=0;n.xe=0;n.Kb=0;function Bt(a){this.b=a||10;this.a=null;Ct(this)}function Ct(a){a.head=a.a=new yt(null,NaN,0,0,4294967296,4294967296)}function Dt(a,b){var c,d;for(c=0;4>c;c++)if(d=b[c])Dt(a,d),delete b[c];delete b.parent;delete b.entries}function Et(a,b){var c=a.head,d;if(b){var e=b;if(e!==c)for(c=e;e=e.parent;)if(e.entries||1<e.de)c=e}else for(;!c.entries&&2>(d=c.de);)if(d)c=e;else break;a.head=c}
Bt.prototype.Ec=function(a,b,c,d){var e=this.a;if(!(a>=e[7]&&b>=e[4]&&a<=e[5]&&b<=e[6]))throw Error("Coordinates out of bounds");return Ft(this,this.a,a,b,c,this.b,d)};
function Ft(a,b,c,d,e,f,g){var h=b.entries;if(f)if(b.de)h=Ft(a,zt(b,c>=b[8]|(d>=b[9])<<1),c,d,e,f-1,g);else if(h){h=h[0];var k=zt(b,h[1]>=b[8]|(h[0]>=b[9])<<1);k.entries=b.entries;k.we=b.we;k.xe=b.xe;k.Kb=b.Kb;k.a=b.a;k.f=b.f;k.b=b.b;k.c=b.c;delete b.entries;h.node=k;Et(a,k);h=Ft(a,zt(b,c>=b[8]|(d>=b[9])<<1),c,d,e,f-1,g)}else f=h=new Gt(c,d,e,g),(b.entries||(b.entries=[])).push(f),Et(a,b);else h||Et(a,b),a=h=new Gt(c,d,e,g),(b.entries||(b.entries=[])).push(a);b.we+=c*e;b.xe+=d*e;b.Kb+=e;b.a===B?(b.a=
b.b=c,b.f=b.c=d):(c<b.a?b.a=c:c>b.b&&(b.b=c),d<b.f?b.f=d:d>b.c&&(b.c=d));return h}Bt.prototype.Tc=function(a,b){At(this.a,a,b===+b?b:this.b,0)};function Gt(a,b,c,d){this[0]=b;this[1]=a;this.a=c;this.data=d};function Ht(a){mt.call(this,a);a=this.g;this.j=a.projection;this.o=a.min;this.f=a.max;this.m=a.minWeight;this.c=7-xd(Bd(wd(1,a.eps))/Ld);this.i=new Bt(wd(this.o,this.f+this.c))}u(Ht,mt);n=Ht.prototype;n.Nc=function(a){var b=0,c=a.length,d,e=new I(0,0),f=this.j,g=this.i;Ht.l.Nc.call(this,a);Dt(g,g.a);for(Ct(g);b<c;b++)f.Nb(d=a[b],e).scale(4294967296).floor(),g.Ec(e.x,e.y,d.wt,d.data);this.b=!0};n.Ib=function(a){Ht.l.Ib.call(this,a);this.Nc(this.a)};
n.yf=function(a){for(var b=a.length,c=Ht.l.Ib;b--;)c.call(this,a[b]);this.Nc(this.a)};n.cf=function(a){Ht.l.cf.call(this,a);this.Nc(this.a)};n.Pa=function(a,b,c,d){return this.j.Pa(a/c/4294967296,b/c/4294967296,d)};n.Ni=function(a){if(this.b){var b={clusters:[],noisePoints:[]};It(this,this.i.a,0,this.f+this.c,-1/0,b,null);this.b=!1;a(b)}};
function It(a,b,c,d,e,f,g){var h=b.Kb,k;g&&(g.node.Kb!==h?(f.clusters.push(new xt(a,g.node,g.depth,c-1)),g=null):e++);g||(h>=a.m?(g={node:b,depth:c},e=c):Jt(a,b,e+1,f));if(b.de&&d--)for(c++,h=0;4>h;h++)if(k=b[h])It(a,k,c,d,e,f,g),g=null;g&&f.clusters.push(new xt(a,g.node,g.depth,a.f+a.c))}function Jt(a,b,c,d){b=b.entries;var e;if(b){var f=b.length;d=d.noisePoints;for(e=0;e<f;e++)d.push(new wt(a,b[e],c))}else for(e=0;4>e;e++)(f=a[e])&&Jt(a,f,c,d)}n.u=function(){Ht.l.u.call(this);this.i=null};function Kt(a,b,c,d){this.lat=a;this.lng=b;this.wt=c===+c?c:1;this.data=d}t("H.clustering.DataPoint",Kt);Kt.prototype.a=NaN;Kt.prototype.b=NaN;function Lt(a,b){b=b||{};var c={},d=b.min||0,e=wd(d,b.max||22);d={min:d,max:e};Lt.l.constructor.call(this,d);this.jb=b.pixelRatio||Se();Wa(c,nt,d,b.clusteringOptions||{});c.minWeight=wd(nt.minWeight,c.minWeight);switch(c.strategy){case Mt.DYNAMICGRID:if(c.projection!==Xi)throw new D(Lt,1,"Unsupported projection");this.a=new st(c);break;case Mt.GRID:this.a=new pt(c);break;default:this.a=new Ht(c)}this.a.Nc(a);this.B=b.theme||new qt(this.jb);this.la=A(this.la,this);this.Xa=A(this.Xa,this);Nt(this)}
u(Lt,N);t("H.clustering.Provider",Lt);Lt.prototype.u=function(){Lt.l.u.call(this);this.c.ra();this.a.C();this.B=this.K=this.a=null;x.clearTimeout(this.V)};var Mt={FASTGRID:0,GRID:1,DYNAMICGRID:2};Lt.Strategy=Mt;Lt.prototype.la=function(){this.dispatchEvent("start");this.a.Ni(this.Xa,id)};function Nt(a,b,c){a.V&&x.clearTimeout(a.V);b&&a.a.Vk(b,c);a.V=x.setTimeout(a.la,150)}Lt.prototype.Xa=function(a){this.dispatchEvent("end");this.K=a;Ot(this)};Lt.prototype.Nc=function(a){this.a.Nc(a);Nt(this)};
Lt.prototype.setDataPoints=Lt.prototype.Nc;Lt.prototype.Ib=function(a){this.a.Ib(a);Nt(this)};Lt.prototype.addDataPoint=Lt.prototype.Ib;Lt.prototype.yf=function(a){this.a.yf(a);Nt(this)};Lt.prototype.addDataPoints=Lt.prototype.yf;Lt.prototype.cf=function(a){this.a.cf(a);Nt(this)};Lt.prototype.removeDataPoint=Lt.prototype.cf;Lt.prototype.mn=function(){return this.B};Lt.prototype.getTheme=Lt.prototype.mn;Lt.prototype.Co=function(a){this.B=a;this.K&&(this.c.ra(),Ot(this))};Lt.prototype.setTheme=Lt.prototype.Co;
function Ot(a){var b=a.K.clusters,c=a.K.noisePoints,d=b.length,e=c.length,f=0<d+e;for(a.c.ra();d--;){var g=b[d];a.c.ea(a.B.getClusterPresentation(g))}for(;e--;)b=c[e],a.c.ea(a.B.getNoisePresentation(b));f&&Vj(a)}Lt.prototype.Vb=function(){return!0};Lt.prototype.providesDomMarkers=Lt.prototype.Vb;Lt.prototype.Wb=function(){return!0};Lt.prototype.providesMarkers=Lt.prototype.Wb;Lt.prototype.Ic=function(){return!0};Lt.prototype.providesSpatials=Lt.prototype.Ic;
Lt.prototype.oi=function(a,b){Nt(this,a,b)};t("H.clustering.buildInfo",function(){return Ef("H-clustering","1.21.2","32f6469")});

function Pt(a,b){a:{for(var c=a.length,d="string"===typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"===typeof a?a.charAt(b):a[b]}var Qt={};function Rt(a){var b=a.ownerDocument,c=b.documentElement;b=b.defaultView;var d=a.getBoundingClientRect();a=d.left;d=d.top;isNaN(b.pageXOffset)?(a+=c.scrollLeft,d+=c.scrollTop):(a+=b.pageXOffset,d+=b.pageYOffset);return new I(a,d)}
function St(a,b,c){b=Cc(b)?b+"px":b;c=Cc(c)?c+"px":c;a.style[xf("transform")]="translate("+b+","+c+")"}var Tt={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};t("H.ui.LayoutAlignment",Tt);function Ut(a,b){var c={},d={};c["top-left"]=Vt(b,"div",[Wt,Xt].join(" "));c["top-center"]=Vt(b,"div",[Wt,Yt,Zt,Xt].join(" "));c["top-right"]=Vt(b,"div",[Wt,Xt].join(" "));c["left-top"]=Vt(b,"div",[Wt,$t].join(" "));c["left-middle"]=Vt(b,"div",[Wt,au,bu,$t].join(" "));c["left-bottom"]=Vt(b,"div",[Wt,$t].join(" "));c["right-top"]=Vt(b,"div",[Wt,$t].join(" "));c["right-middle"]=Vt(b,"div",[Wt,cu,bu,$t].join(" "));c["right-bottom"]=Vt(b,"div",[Wt,$t].join(" "));c["bottom-left"]=Vt(b,"div",[Wt,Xt].join(" "));
c["bottom-center"]=Vt(b,"div",[Wt,du,Zt,Xt].join(" "));c["bottom-right"]=Vt(b,"div",[Wt,Xt].join(" "));d["top-left"]=Vt(b,"div",[Yt,au].join(" "));d["top-right"]=Vt(b,"div",[Yt,cu].join(" "));d["bottom-left"]=Vt(b,"div",[du,au].join(" "));d["bottom-right"]=Vt(b,"div",[du,cu].join(" "));eu(d["top-left"],c["top-left"],c["left-top"]);eu(d["top-right"],c["top-right"],c["right-top"]);eu(d["bottom-left"],c["left-bottom"],c["bottom-left"]);eu(d["bottom-right"],c["right-bottom"],c["bottom-right"]);eu(a,d["top-left"],
d["top-right"],d["bottom-left"],d["bottom-right"],c["top-center"],c["left-middle"],c["right-middle"],c["bottom-center"]);this.a=c}var Yt="H_l_top",du="H_l_bottom",au="H_l_left",cu="H_l_right",Zt="H_l_center",bu="H_l_middle",Xt="H_l_horizontal",$t="H_l_vertical",Wt="H_l_anchor";Ut.prototype.update=function(){var a=this.a;fu(a["top-center"],!0);fu(a["bottom-center"],!0);fu(a["left-middle"],!1);fu(a["right-middle"],!1)};
function fu(a,b){b?(b=a.offsetWidth,a.style.marginLeft=-Math.round(.5*b)+"px"):(b=a.offsetHeight,a.style.marginTop=-Math.round(.5*b)+"px")}Ut.prototype.put=function(a,b){a=a?a.G():null;var c=b?this.a[b]:null;a&&c&&(a.parentElement&&a.parentElement.removeChild(a),c.insertBefore(a,/(bottom|right)$/.test(b)||/(center|middle)/.test(b)&&c.childNodes.length%2?c.firstChild:null));this.update()};var gu={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",gu);function hu(){this.a=this.wj()}hu.prototype.wj=function(){var a=Function("return this;")(),b=a.navigator,c=[];b&&(b.msPointerEnabled?c.push(iu):b.pointerEnabled&&c.push(ju));1>c.length&&("TouchEvent"in a&&c.push(ku),c.push(lu));return c};hu.prototype.detectEventSets=hu.prototype.wj;hu.prototype.addEventListener=function(a,b,c,d){for(var e=this.a,f,g=e.length,h=!1;g--;)if(f=e[g][b])h=!0,a.addEventListener(f,c,d||!1);h||a.addEventListener(b,c,d||!1)};
hu.prototype.removeEventListener=function(a,b,c,d){for(var e=this.a,f,g=e.length,h=!1;g--;)if(f=e[g][b])h=!0,a.removeEventListener(f,c,d||!1);h||a.removeEventListener(b,c,d||!1)};
var ju={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},iu={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},ku={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},lu={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"};function Vt(a,b,c,d){a=a.createElement(b);c&&(a.className=c);d&&(a.innerHTML=d);return a}function eu(a,b){for(var c=1,d=arguments.length;c<d;c++)a.appendChild(arguments[c])}var mu=new hu;function nu(a,b,c){mu.addEventListener(a,b,c,void 0)}function ou(a,b,c){mu.removeEventListener(a,b,c,void 0)};var pu=[];t("H.ui.i18n.defaultLocales",pu);var qu={},ru=[];function su(a,b){qu[a]=b;-1===pu.indexOf(a)&&pu.push(a);ru.length?tu(a,b):ru=Object.keys(b)}function tu(a,b){for(var c=ru,d=c.length,e;d--;)if(e=c[d],!b[e])throw Error("'"+e+"' key missing in translation map for "+a);};su("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer",
"traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"});su("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Sat\u00e9lite","layers.terrain":"Terreno","layer.transit":"Transportes p\u00fablicos","layer.traffic":"Condi\u00e7\u00f5es de tr\u00e2nsito","layer.incidents":"Mostrar incidentes de tr\u00e2nsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar",
"zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes p\u00fablicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras not\u00edcias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Constru\u00e7\u00e3o","traffic.DISABLED_VEHICLE":"Ve\u00edculo avariado","traffic.from":"Hora de in\u00edcio:","traffic.until":"Hora de fim prevista:",
"distance.measurement":"Measure distance"});su("ru-RU",{"layers.normal":"\u0420\u0435\u0436\u0438\u043c \u043a\u0430\u0440\u0442\u044b","layers.satellite":"\u0421\u043f\u0443\u0442\u043d\u0438\u043a\u043e\u0432\u0430\u044f","layers.terrain":"\u041c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u044c","layer.transit":"\u041e\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442","layer.traffic":"\u0414\u043e\u0440\u043e\u0436\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f",
"layer.incidents":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u043e\u0440\u043e\u0436\u043d\u044b\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f","layers.choose":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0438\u0434",minimap:"Minimap","scale.switchToImperial":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0438\u043b\u0438","scale.switchToMetric":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0438\u043b\u043e\u043c\u0435\u0442\u0440\u044b",
"scale.km":"\u043a\u043c","scale.m":"\u043c","scale.mi":"\u043c\u0438\u043b\u044c","scale.ft":"\u0444\u0443\u0442","zoom.out":"\u041e\u0442\u0434\u0430\u043b\u0438\u0442\u044c","zoom.in":"\u041f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u044c","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"\u041e\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442","traffic.MISCELLANEOUS":"\u041f\u0440\u043e\u0447\u0435\u0435 \u0414\u0422\u041f",
"traffic.ACCIDENT":"\u0414\u0422\u041f","traffic.OTHER_NEWS":"\u0414\u0440\u0443\u0433\u0438\u0435 \u043d\u043e\u0432\u043e\u0441\u0442\u0438","traffic.PLANNED_EVENT":"\u041f\u043b\u0430\u043d\u043e\u0432\u043e\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435","traffic.ROAD_HAZARD":"\u0414\u043e\u0440\u043e\u0436\u043d\u0430\u044f \u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","traffic.WEATHER":"\u041f\u043e\u0433\u043e\u0434\u0430","traffic.CONGESTION":"\u041f\u0440\u043e\u0431\u043a\u0430",
"traffic.CONSTRUCTION":"\u0420\u0435\u043c\u043e\u043d\u0442","traffic.DISABLED_VEHICLE":"\u041d\u0435\u0438\u0441\u043f\u0440\u0430\u0432\u043d\u044b\u0439 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c","traffic.from":"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430:","traffic.until":"\u041e\u0436\u0438\u0434\u0430\u0435\u043c\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f:","distance.measurement":"\u0418\u0437\u043c\u0435\u0440\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435"});su("fi-FI",{"layers.normal":"Karttan\u00e4kym\u00e4","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"N\u00e4yt\u00e4 liikennetapahtumat","layers.choose":"Valitse n\u00e4kym\u00e4",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"L\u00e4henn\u00e4",
"zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelem\u00e4t\u00f6n syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiell\u00e4","traffic.WEATHER":"S\u00e4\u00e4","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennusty\u00f6","traffic.DISABLED_VEHICLE":"Pys\u00e4htynyt ajoneuvo","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu p\u00e4\u00e4ttymisaika:",
"distance.measurement":"Measure distance"});su("pt-BR",{"layers.normal":"Exibi\u00e7\u00e3o do mapa","layers.satellite":"Sat\u00e9lite","layers.terrain":"Terreno","layer.transit":"Transporte p\u00fablico","layer.traffic":"Condi\u00e7\u00f5es do tr\u00e2nsito","layer.incidents":"Mostrar incidentes no tr\u00e2nsito","layers.choose":"Escolher exibi\u00e7\u00e3o",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"p\u00e9s","zoom.out":"Menos zoom",
"zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte p\u00fablico","traffic.MISCELLANEOUS":"Miscel\u00e2nea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras not\u00edcias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Constru\u00e7\u00e3o","traffic.DISABLED_VEHICLE":"Ve\u00edculo incapacitado","traffic.from":"Hora de in\u00edcio:",
"traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"});su("zh-CN",{"layers.normal":"\u5730\u56fe\u89c6\u56fe","layers.satellite":"\u536b\u661f","layers.terrain":"\u5730\u5f62","layer.transit":"\u516c\u5171\u4ea4\u901a","layer.traffic":"\u4ea4\u901a\u60c5\u51b5","layer.incidents":"\u663e\u793a\u4ea4\u901a\u4e8b\u4ef6","layers.choose":"\u9009\u62e9\u89c6\u56fe",minimap:"Minimap","scale.switchToImperial":"\u5207\u6362\u4e3a\u300c\u82f1\u91cc\u300d","scale.switchToMetric":"\u5207\u6362\u4e3a\u300c\u516c\u91cc\u300d","scale.km":"\u516c\u91cc","scale.m":"\u7c73",
"scale.mi":"\u82f1\u91cc","scale.ft":"\u82f1\u5c3a","zoom.out":"\u7f29\u5c0f","zoom.in":"\u653e\u5927","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"\u516c\u5171\u4ea4\u901a","traffic.MISCELLANEOUS":"\u7efc\u5408\u4e8b\u4ef6","traffic.ACCIDENT":"\u4ea4\u901a\u610f\u5916","traffic.OTHER_NEWS":"\u5176\u4ed6\u65b0\u95fb","traffic.PLANNED_EVENT":"\u9884\u5b9a\u4e8b\u4ef6","traffic.ROAD_HAZARD":"\u9053\u8def\u5371\u9669","traffic.WEATHER":"\u5929\u6c14","traffic.CONGESTION":"\u5835\u585e",
"traffic.CONSTRUCTION":"\u65bd\u5de5","traffic.DISABLED_VEHICLE":"\u8f66\u8f86\u629b\u951a","traffic.from":"\u5f00\u59cb\u65f6\u95f4\uff1a","traffic.until":"\u9884\u8ba1\u7ed3\u675f\u65f6\u95f4\uff1a","distance.measurement":"Measure distance"});su("es-ES",{"layers.normal":"Mapa","layers.satellite":"Sat\u00e9lite","layers.terrain":"Terreno","layer.transit":"Transporte p\u00fablico","layer.traffic":"Estado del tr\u00e1fico","layer.incidents":"Mostrar incidentes de tr\u00e1fico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle",
"traffic.MASS_TRANSIT":"Transporte p\u00fablico","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"M\u00e1s noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construcci\u00f3n","traffic.DISABLED_VEHICLE":"Veh\u00edculo averiado","traffic.from":"Inicio:","traffic.until":"Finalizaci\u00f3n estimada:","distance.measurement":"Measure distance"});su("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arri\u00e8re","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle",
"traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.PLANNED_EVENT":"\u00c9v\u00e9nement pr\u00e9vu","traffic.ROAD_HAZARD":"Danger routier","traffic.WEATHER":"M\u00e9t\u00e9o","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"V\u00e9hicule en panne","traffic.from":"Date ou heure de d\u00e9but:","traffic.until":"Date et heure de fin estim\u00e9es:","distance.measurement":"Measure distance"});su("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Poka\u017c zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmie\u0144 na mile","scale.switchToMetric":"Zmie\u0144 na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybli\u017c","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny",
"traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomo\u015bci","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpiecze\u0144stwo na drodze","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.from":"Data rozpocz\u0119cia:","traffic.until":"Przybli\u017cona data zako\u0144czenia:","distance.measurement":"Measure distance"});su("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gel\u00e4nde","layer.transit":"\u00d6ffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsst\u00f6rungen anzeigen","layers.choose":"Ansicht ausw\u00e4hlen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergr\u00f6\u00dfern",
"zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"\u00d6ffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:",
"distance.measurement":"Measure distance"});su("tr-TR",{"layers.normal":"Harita g\u00f6r\u00fcn\u00fcm\u00fc","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ula\u015f\u0131m","layer.traffic":"Trafik durumlar\u0131","layer.incidents":"Trafik olaylar\u0131n\u0131 g\u00f6ster","layers.choose":"G\u00f6r\u00fcn\u00fcm se\u00e7",minimap:"Minimap","scale.switchToImperial":"Mile d\u00f6n\u00fc\u015ft\u00fcr","scale.switchToMetric":"Kilometreye d\u00f6n\u00fc\u015ft\u00fcr","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft",
"zoom.out":"Uzakla\u015ft\u0131r","zoom.in":"Yak\u0131nla\u015ft\u0131r","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ula\u015f\u0131m","traffic.MISCELLANEOUS":"\u00c7e\u015fitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Di\u011fer haberler","traffic.PLANNED_EVENT":"Planl\u0131 etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Yo\u011funluk","traffic.CONSTRUCTION":"Yol \u00e7al\u0131\u015fmas\u0131","traffic.DISABLED_VEHICLE":"Ara\u00e7 ar\u0131zas\u0131",
"traffic.from":"Ba\u015flang\u0131\u00e7 zaman\u0131:","traffic.until":"Tahmini biti\u015f zaman\u0131:","distance.measurement":"Measure distance"});su("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici",
"traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"});su("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport",
"traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"});function uu(a,b){if(!zc(a))throw new TypeError("string locale code required");if(Da(b))tu(a,b);else{if(-1===pu.indexOf(a))throw Error("Default locale '"+a+"' does nto exist.");b=qu[a]}this.a=b||{};this.b=a}t("H.ui.i18n.Localization",uu);uu.prototype.Mm=function(){return this.b};uu.prototype.getLocale=uu.prototype.Mm;uu.prototype.Gm=function(){return Object.keys(this.a)};uu.prototype.getKeys=uu.prototype.Gm;uu.prototype.Eh=function(a){return!(!this.a||!this.a[a])};uu.prototype.hasKey=uu.prototype.Eh;
uu.prototype.translate=function(a){var b=this.a[a];if(!zc(b))throw Error("Translation missing for key '"+a+"'.");return b};uu.prototype.translate=uu.prototype.translate;function Z(a,b){F.call(this);this.Oa=a||"div";this.g=b?b.split(" "):[];this.D=!1;this.g.push("H_el")}u(Z,F);t("H.ui.base.Element",Z);Z.prototype.$=function(a){if(!a)throw Error("Wrong document object");this.S=Vt(a,this.Oa,this.g.join(" "));this.renderInternal(this.S,a);this.Ca(this.lc(),!0);this.qc(this.la);this.ub(this.c);return this.S};Z.prototype.fa=function(){};Z.prototype.K=function(){};Z.prototype.Y=function(){};Z.prototype.renderInternal=Z.prototype.Y;Z.prototype.lc=function(){return this.D};
Z.prototype.isDisabled=Z.prototype.lc;Z.prototype.Ca=function(a,b){a=!!a;if(a!==this.D||b)(this.D=a)?this.Ka("H_disabled"):this.pb("H_disabled");return this};Z.prototype.setDisabled=Z.prototype.Ca;Z.prototype.O=null;Z.prototype.getData=function(){return this.O};Z.prototype.getData=Z.prototype.getData;Z.prototype.setData=function(a){this.O=a};Z.prototype.setData=Z.prototype.setData;Z.prototype.qc=function(a){var b=this.G();this.la=a;b&&(a?b.setAttribute("title",a):b.removeAttribute("title"))};
Z.prototype.setTooltip=Z.prototype.qc;Z.prototype.S=null;Z.prototype.G=function(){return this.S};Z.prototype.getElement=Z.prototype.G;Z.prototype.c=!0;Z.prototype.ub=function(a){var b=this.G();this.c=a;b&&(b.style.display=a?"":"none")};Z.prototype.setVisibility=Z.prototype.ub;Z.prototype.Cc=function(){return this.c};Z.prototype.getVisibility=Z.prototype.Cc;Z.prototype.Ka=function(a){var b=this.G();0>this.g.indexOf(a)&&this.g.push(a);b&&(b.className=this.g.join(" "));return this};
Z.prototype.addClass=Z.prototype.Ka;Z.prototype.pb=function(a){a=this.g.indexOf(a);var b=this.G();-1<a&&this.g.splice(a,1);b&&(b.className=this.g.join(" "));return this};Z.prototype.removeClass=Z.prototype.pb;function vu(a){(a=a.G())&&a.parentNode&&a.parentNode.removeChild(a)}Z.prototype.u=function(){Z.l.u.call(this);vu(this);this.la=this.O=this.S=null};function wu(a,b,c){Z.call(this,a,b);this.b=c?c.concat():[]}u(wu,Z);t("H.ui.base.Container",wu);wu.prototype.Ca=function(a,b){var c=this.b?this.b.length:0;for(Z.prototype.Ca.call(this,a,b);c--;)this.b[c].Ca(a,b);return this};wu.prototype.setDisabled=wu.prototype.Ca;wu.prototype.Ja=function(a){var b=this.G();this.b.push(a);b&&(a.$(b.ownerDocument),b.appendChild(a.G()));return this};wu.prototype.addChild=wu.prototype.Ja;wu.prototype.oh=function(){return this.b.concat()};
wu.prototype.getChildren=wu.prototype.oh;wu.prototype.removeChild=function(a){var b=this.b.indexOf(a),c=this.G();0<=b&&(this.b.splice(b,1),c&&c.removeChild(a.G()))};wu.prototype.removeChild=wu.prototype.removeChild;wu.prototype.ra=function(){var a=this.G();a&&this.b.forEach(function(b){a.removeChild(b.G())});this.b=[]};wu.prototype.Y=function(a,b){for(var c=0,d=this.b.length;c<d;c++)a.appendChild(this.b[c].$(b))};wu.prototype.renderInternal=wu.prototype.Y;
wu.prototype.u=function(){this.ra();this.b.forEach(this.V,this);Z.prototype.u.call(this)};wu.prototype.V=function(a){a.C()};function xu(a){C(a,Pe,xu,1);Z.call(this,"div","H_context_menu_item");this.b=a;this.f=A(this.f,this);this.a=A(this.a,this);this.b.addEventListener("update",this.a)}u(xu,Z);t("H.ui.context.Item",xu);xu.prototype.f=function(a){var b=this.b,c=b.callback;c&&!b.isDisabled()&&(this.dispatchEvent("click"),c(a))};xu.prototype.Y=function(){var a=this,b=this.G();Be(b,"click",this.f);b.addEventListener("keyup",function(c){13==c.keyCode&&a.f(c)});this.a()};xu.prototype.renderInternal=xu.prototype.Y;
xu.prototype.a=function(){var a=this.G(),b=this.b;b.callback?(this.Ka("clickable"),a.setAttribute("tabindex","0")):(this.pb("clickable"),a.removeAttribute("tabindex"));b.isDisabled()?this.Ka("disabled"):this.pb("disabled");b=b.getLabel();yu.textContent=b;a.innerHTML=yu.innerHTML.split("\n").join("<br/>")};xu.prototype.u=function(){Z.prototype.u.call(this);this.b.removeEventListener("update",this.a)};function zu(a){C(a,Array,zu,1);wu.call(this,"div","H_context_menu");this.f=a;this.a=null}u(zu,wu);t("H.ui.context.Menu",zu);zu.prototype.Y=function(){wu.prototype.Y.apply(this,arguments);this.f.forEach(function(a){a===Qe?a=new Z("div","H_context_menu_item_separator"):(a=new xu(a),a.addEventListener("click",this.i.bind(this)));this.Ja(a)},this);Be(this.G(),["mousedown","touchstart","pointerdown","wheel"],function(a){a.stopPropagation()})};zu.prototype.renderInternal=zu.prototype.Y;
zu.prototype.setPosition=function(a,b){if(this.a){var c=this.G();var d=c.offsetWidth;var e=c.offsetHeight;var f=this.a;var g=f.ya.width;f=f.ya.height;a+d>g&&a>g/2&&(a-=d);b+e>f&&b>f/2&&(b-=e);St(c,a,b)}};zu.prototype.setPosition=zu.prototype.setPosition;zu.prototype.i=function(){this.a&&this.a.dispatchEvent(new rd("contextmenuclose",this.a))};zu.prototype.Ia=function(a){this.a=a};zu.prototype.setMap=zu.prototype.Ia;function Au(a,b){b=b||{};var c=this;Z.call(this,"div","H_ib H_ib_top");this.v=A(function(d){c.lc()||(c.close(),d.preventDefault())},this);this.update=A(this.update,this);this.i=A(this.i,this);this.setPosition(a);this.mf(b.content);b.onStateChange&&this.addEventListener("statechange",b.onStateChange);this.P(Bu.OPEN)}u(Au,Z);t("H.ui.InfoBubble",Au);Au.prototype.a=null;Au.prototype.Ba=function(){return this.b};Au.prototype.setPosition=function(a){this.b=Zf(a);this.update()};
Au.prototype.setPosition=Au.prototype.setPosition;Au.prototype.Ia=function(a){this.a=a};
Au.prototype.Y=function(a,b){this.o=Vt(b,"div","H_ib_body");this.tailEl_=Vt(b,"div","H_ib_tail");this.j=Vt(b,"div","H_ib_close H_btn",Cu);this.f=Vt(b,"div","H_ib_content","&nbsp;");this.o.appendChild(this.j);this.o.appendChild(this.f);nu(this.j,"start",this.v);this.a.b.addEventListener("sync",this.update);this.a.ya.addEventListener("sync",this.update);this.a.addEventListener("enginechange",this.i);a.appendChild(this.o);a.appendChild(this.tailEl_);this.mf(this.m)};
Au.prototype.renderInternal=Au.prototype.Y;Au.prototype.i=function(){this.s||(this.s=setTimeout(this.update,0))};Au.prototype.update=function(){var a=this.G(),b=this.a,c,d="none";this.s=0;if(b&&a&&this.getState()===Bu.OPEN){if(c=b.Ga(this.b)){var e=c.x;c=c.y;b=b.ya.width;if(e>=-b||e<=2*b||c>=-b||c<=2*b)d="",Du?(a.style.left=e-b+"px",a.style.top=c+"px"):St(a,e,c)}a.style.display=d;""===d&&(a.style.visibility="visible")}};var Bu={OPEN:"open",CLOSED:"closed"};Au.State=Bu;Au.prototype.A=Bu.OPEN;
Au.prototype.getState=function(){return this.A};Au.prototype.getState=Au.prototype.getState;Au.prototype.P=function(a){a!==this.A&&(this.A=a,this.dispatchEvent("statechange"));if(a=this.G())this.A===Bu.OPEN?(a.style.display="block",a.style.visibility="hidden",this.i()):a.style.display="none"};Au.prototype.setState=Au.prototype.P;Au.prototype.close=function(){this.P(Bu.CLOSED)};Au.prototype.close=Au.prototype.close;Au.prototype.open=function(){this.P(Bu.OPEN)};Au.prototype.open=Au.prototype.open;
Au.prototype.mm=function(){return this.f||null};Au.prototype.getContentElement=Au.prototype.mm;
Au.prototype.mf=function(a){if(a)if("string"===typeof a||"number"===typeof a.nodeType&&"string"===typeof a.nodeName)this.m=a;else throw Error("InfoBubble content must be a string or HTML node.");else this.m=void 0;this.G()&&(this.m?(this.f.innerHTML="","string"===typeof this.m?this.f.innerHTML=a:"number"===typeof a.nodeType&&"string"===typeof a.nodeName&&this.f.appendChild(a)):this.f.innerHTML="&nbsp;",this.i())};Au.prototype.setContent=Au.prototype.mf;
Au.prototype.u=function(){this.close();this.mf(null);this.j&&ou(this.j,"end",this.v);this.a&&(this.a.b.removeEventListener("sync",this.update),this.a.ya.removeEventListener("sync",this.update));Z.prototype.u.call(this)};var Cu='<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>';function Eu(a){this.c=a;this.a=this.b=null;this.i=0;this.g=22;this.f=A(this.f,this);a=this.c.yc();a.addEventListener("mapviewchange",this.o,!1,this);a=a.a;a.addEventListener("add",this.j,!1,this);a.addEventListener("remove",this.m,!1,this)}function Fu(a,b){a.b&&b&&a.b===b.pa()||(a.b&&a.b.removeEventListener("tap",a.f),b?(a.b=b.pa(),a.b.addEventListener("tap",a.f),a.i=a.b.min,a.g=a.b.max):(a.b=null,a.i=0,a.g=22))}
Eu.prototype.o=function(a){var b=a.newValue.zoom;this.a&&a.modifiers&a.ZOOM&&(b<this.i||b>this.g)&&this.a.close()};Eu.prototype.j=function(a){a=a.added;Gu(a)&&Fu(this,a)};Eu.prototype.m=function(a){Gu(a.removed)&&(this.a&&this.a.close(),Fu(this,null))};function Gu(a){return window.H.service&&a.pa()instanceof window.H.service.traffic.incidents.Provider}
Eu.prototype.f=function(a){var b;if(a.target&&(b=a.target.getData())&&0===a.currentPointer.button){this.a||(this.a=new Au(a.target.ba()),this.a.Ka("H_tib"),this.c.kj(this.a));this.a.setPosition(a.target.ba());var c=b.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_");this.c.Aa().Eh("traffic."+c)&&(c=this.c.Aa().translate("traffic."+c));this.a.mf('<div class="H_tib_content"><div class="H_rdo_title">{{title}}</div><div class="H_tib_desc"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",
c).replace("{{desc}}",b.TRAFFIC_ITEM_DESCRIPTION[0].value).replace("{{traffic.from}}",this.c.Aa().translate("traffic.from")).replace("{{traffic.until}}",this.c.Aa().translate("traffic.until")).replace("{{from}}",b.START_TIME).replace("{{until}}",b.END_TIME));this.a.open()}a.stopPropagation()};function Hu(a,b){var c=a.G(),d=this;F.call(this);this.a=a;this.i=c.ownerDocument;this.f={};this.c=[];new Eu(this);this.S=Vt(this.i,"div","H_ui");this.B=A(function(e){this.o.put(e.target,e.target.Uc)},this);this.addEventListener("alignmentchange",this.B);this.D=A(function(){this.rl()},this);this.addEventListener("toggleunitsystem",this.D);this.S.addEventListener("contextmenu",this.v,!1);this.S.addEventListener("MSHoldVisual",this.v,!1);this.a.addEventListener("contextmenu",this.O,!1,this);this.a.addEventListener("contextmenuclose",
this.s,!1,this);this.a.wb(this.C.bind(this));this.b=null;this.m=-1;this.o=new Ut(this.S,this.i);this.g=gu.METRIC;Iu(this,"en-US");b&&Ju(this,b);c.appendChild(this.S);x.setTimeout(function(){d.o.update()},1)}u(Hu,F);t("H.ui.UI",Hu);Hu.prototype.v=function(a){for(var b=a.target;b&&!/\bH_ib_content\b/.test(b.className);)b=b.parentNode;b||a.preventDefault()};Hu.prototype.G=function(){return this.S};Hu.prototype.getElement=Hu.prototype.G;Hu.prototype.yc=function(){return this.a};
Hu.prototype.getMap=Hu.prototype.yc;Hu.prototype.qn=function(){return this.g};Hu.prototype.getUnitSystem=Hu.prototype.qn;Hu.prototype.zg=function(a){var b=this.f,c;if(a!==this.g)for(c in this.g=a,b)if(b[c]instanceof Ku)b[c].onUnitSystemChange(this.g)};Hu.prototype.setUnitSystem=Hu.prototype.zg;
function Iu(a,b){if(zc(b))var c=b;else if(b instanceof uu){c=b.b;var d=b}else throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");if(c)if(d)a.j=d;else if(0<=pu.indexOf(c))a.j=new uu(c);else throw Error("Locale ["+c+"] is not supported.");else throw Error("No locale was defined.");}Hu.prototype.Aa=function(){return this.j};Hu.prototype.rl=function(){this.g===gu.METRIC?this.zg(gu.IMPERIAL):this.zg(gu.METRIC)};Hu.prototype.toggleUnitSystem=Hu.prototype.rl;
Hu.prototype.kj=function(a){var b=this.c.length,c=this.S;if(0>this.c.indexOf(a)){a.ja(this);a.Ia(this.a);var d=a.$(this.i);b=0<b?this.c[b-1].G().nextSibling:this.S.firstChild;c.insertBefore(d,b);this.c.push(a)}};Hu.prototype.addBubble=Hu.prototype.kj;
Hu.prototype.O=function(a){var b=a.items;this.b&&this.s();clearTimeout(this.m);this.m=x.setTimeout(function(){b.length&&(this.b=new zu(b),this.S.insertBefore(this.b.$(this.i),this.S.firstChild),this.b.ja(this),this.b.Ia(this.a),this.b.setPosition(a.viewportX,a.viewportY))}.bind(this),0)};Hu.prototype.s=function(){this.b&&(this.b.C(),this.b=null)};Hu.prototype.ro=function(a){var b=this.c.indexOf(a);-1<b&&(a.ja(null),a.Ia(null),this.c.splice(b,1),this.S.removeChild(a.G()))};
Hu.prototype.removeBubble=Hu.prototype.ro;Hu.prototype.im=function(){return this.c};Hu.prototype.getBubbles=Hu.prototype.im;Hu.prototype.Gd=function(a,b){if(this.Ie(a))throw Error("A control with name ["+a+"] is already registered.");b.ja(this);b.Ia(this.a);b.Xa=this.j;b.$(this.i);b.onUnitSystemChange(this.g);this.f[a]=b};Hu.prototype.addControl=Hu.prototype.Gd;
Hu.prototype.to=function(a){var b=this.Ie(a);if(b)b.K(),b.ja(null),b.Ia(null),vu(b),delete this.f[a];else throw Error("Control ["+a+"] not found in this UI's controls.");return b};Hu.prototype.removeControl=Hu.prototype.to;Hu.prototype.Ie=function(a){return this.f[a]};Hu.prototype.getControl=Hu.prototype.Ie;
Hu.prototype.u=function(){for(var a in this.f)Qt.hasOwnProperty.call(this.f,a)&&this.f[a].C();this.c.forEach(function(b){b.C()});(a=this.S.parentNode)&&a.removeChild(this.S);F.prototype.u.call(this);this.S=null};
function Ju(a,b){var c,d;b.unitSystem&&a.zg(b.unitSystem);(d=b.locale)&&Iu(a,d);(c=b.zoom)&&a.Gd("zoom",new Lu(Da(c)?c:null));(c=b.zoomrectangle)&&a.Gd("zoomrectangle",new Mu(Da(c)?c:null));(c=b.mapsettings)&&a.Gd("mapsettings",new Nu(Da(c)?c:null));(c=b.scalebar)&&a.Gd("scalebar",new Ou(Da(c)?c:null));(c=b.distancemeasurement)&&a.Gd("distancemeasurement",new Pu(Da(c)?c:null))}
Hu.prototype.capture=function(a,b,c,d){var e=this.Ie("scalebar"),f=a.getContext("2d"),g=a.width,h=a.height,k=this.a.m,l=5+(k?k.G().childNodes[1].offsetHeight:0);e&&e.Cc()?e.capture(b,function(m){f.drawImage(m,g-m.width-5*b,h-m.height-l*b);c(a)},d):c(a)};Hu.prototype.capture=Hu.prototype.capture;
Hu.createDefault=function(a,b,c){var d=a.hc().type;c=new Hu(a,{unitSystem:gu.METRIC,zoom:{alignment:"right-bottom"},mapsettings:Qu(d,b,a.c),scalebar:{alignment:"bottom-right"},locale:c||"en-US"});if(d===Cl.P2D){var e=c.Ie("mapsettings");var f=function(){if(e.yc()){var g=Qu(d,b,a.c);Ru(e,g.baseLayers,g.layers)}};a.addEventListener(a.o.xf,f);c.wb(function(){a.removeEventListener(a.o.xf,f)});e.wb(function(){a.removeEventListener(a.o.xf,f)})}return c};
function Qu(a,b,c){var d=b.raster;b=b.vector.normal;var e;if(a===Cl.P2D){a=[{label:"layers.normal",layer:d.normal.map},{label:"layers.satellite",layer:d.satellite.map},{label:"layers.terrain",layer:d.terrain.map}];if(c)for(e in d)if(d[e].map===c){var f=e;break}c=[{label:"layer.incidents",layer:d.normal.trafficincidents},{label:"layer.transit",layer:f&&d[f].transit}]}else a=[{label:"layers.normal",layer:b.map},{label:"layers.satellite",layer:d.satellite.map}],c=[{label:"layer.traffic",layer:b.traffic},
{label:"layer.incidents",layer:b.trafficincidents}];return{alignment:"bottom-right",baseLayers:a,layers:c}};function Su(a){a=a||{};Z.call(this,"div","H_btn");this.Pc(a.label||" ");this.qc(a.tooltip||"");this.setData(a.data);this.Ca(!!a.disabled);this.P(Tu.UP,!0);a.onStateChange&&this.addEventListener("statechange",a.onStateChange);this.f=A(this.f,this);this.b=A(this.b,this)}u(Su,Z);t("H.ui.base.Button",Su);Su.prototype.Ca=function(a,b){a&&this.pb("H_active");return Su.l.Ca.call(this,a,b)};
Su.prototype.Y=function(a){nu(a,"start",this.f);nu(a,"end",this.b);nu(a,"out",this.b);this.Pc(this.Me(),!0)};Su.prototype.renderInternal=Su.prototype.Y;Su.prototype.getState=function(){return this.A};Su.prototype.getState=Su.prototype.getState;Su.prototype.P=function(a,b){a!==this.A&&(this.A=a,a===Tu.DOWN?this.Ka("H_active"):this.pb("H_active"),b||this.dispatchEvent("statechange"));return this};Su.prototype.setState=Su.prototype.P;Su.prototype.Me=function(){return this.a};
Su.prototype.getLabel=Su.prototype.Me;Su.prototype.Pc=function(a,b){if(b||a!==this.a)if(this.a=a,b=this.G())b.innerHTML=a;return this};Su.prototype.setLabel=Su.prototype.Pc;Su.prototype.f=function(a){this.lc()||this.P(Tu.DOWN);a.preventDefault()};Su.prototype.b=function(a){this.lc()||this.P(Tu.UP);a.preventDefault()};Su.prototype.u=function(){var a=this.G();a&&(ou(a,"start",this.f),ou(a,"end",this.b),ou(a,"out",this.b));Z.prototype.u.call(this)};var Tu={UP:"up",DOWN:"down"};Su.State=Tu;function Uu(a){a=a||{};var b;this.f=!!a.vertical;this.V=a.length||"16em";this.a=Cc(b=a.min)?b:0;this.m=wd(this.a,Cc(b=a.max)?b:100);this.za=E(b=a.step)?1:b;this.o=Vu(this,Cc(b=a.value)?b:(this.a+this.m)/2);this.jg=A(this.jg,this);this.fg=A(this.fg,this);this.mg=A(this.mg,this);this.kg=A(this.kg,this);this.b=a.pointerArea;Z.call(this,"div","H_slider"+(this.f?"":" H_l_horizontal"))}u(Uu,Z);t("H.ui.base.Slider",Uu);
Uu.prototype.Ag=function(a,b){var c=this.f,d=c?"top":"left";if(!this.i||b)a=Yd(a,this.a,this.m),this.j&&(b=100*(a-this.a)/(this.m-this.a),c=(c?-1:1)*b,this.j.style[d]=c+"%",this.Xa.style[d]=100+c+"%"),this.o=Vu(this,a);return this.o};Uu.prototype.setValue=Uu.prototype.Ag;Uu.prototype.rn=function(){return this.o};Uu.prototype.getValue=Uu.prototype.rn;function Wu(a){a.s||(nu(a.G(),"start",a.jg),nu(a.b,"move",a.fg),nu(a.b,"end",a.mg),nu(a.b,"out",a.kg),a.s=!0)}
function Xu(a){a.s&&(ou(a.G(),"start",a.jg),ou(a.b,"move",a.fg),ou(a.b,"end",a.mg),ou(a.b,"out",a.kg),a.s=!1)}function Vu(a,b){var c=a.za;b=Yd(b,a.a,a.m);return c?a.a+xd((b-a.a)/c)*c:b}function Yu(a,b){var c=a.B,d=a.f;a.v||(a.v=c["offset"+(d?"Height":"Width")]);b-=Rt(c)[d?"y":"x"];0>b&&(b=0);b=(a.m-a.a)*b/a.v;b=Vu(a,d?a.m-b:a.a+b);a.o!==b&&(a.Ag(b,!0),a.dispatchEvent(new Ng(a.sk.hd,b,a.o)))}function Zu(a,b){return(b.touches?b.targetTouches[0]:b)["page"+(a.f?"Y":"X")]}
function $u(a){var b=!1,c=a.type;-1!==c.indexOf("pointer")||-1!==c.indexOf("touch")?b=!0:C(a,MouseEvent)&&(b=1===a.which||1===a.buttons);return b}function av(a){var b=a.touches;return b&&1===b.length||C(a,MouseEvent)}n=Uu.prototype;
n.jg=function(a){var b=this.f;if($u(a)&&av(a)){var c=Zu(this,a);var d=a.target;d===this.j||d.parentElement===this.j?(this.T=c-Rt(this.j)[b?"y":"x"]-this.j.offsetWidth/2,this.G().className="H_slider H_slider_active"+(this.f?"":" H_l_horizontal"),this.i=!0):Yu(this,c);a.preventDefault()}};n.mg=function(){this.i&&(this.G().className="H_slider "+(this.f?"":" H_l_horizontal"),this.i=!1)};n.kg=function(a){this.i&&a.target===this.b&&(this.i=!1)};
n.fg=function(a){this.i&&av(a)&&($u(a)?(Yu(this,Zu(this,a)-this.T),a.preventDefault()):this.i=!1)};n.sk={hd:"change"};
n.Y=function(a,b){var c=Vt(b,"div","H_slider_cont"),d=Vt(b,"div","H_slider_knob_cont"),e=Vt(b,"div","H_slider_knob"),f=Vt(b,"div","H_slider_knob_halo"),g=Vt(b,"div","H_slider_track");b=Vt(b,"div","H_slider_track H_slider_track_active");a.appendChild(c);c.appendChild(g);g.appendChild(b);c.appendChild(d);d.appendChild(e);d.appendChild(f);this.B=g;this.Xa=b;this.j=d;this.b||(this.b=a.ownerDocument.body);c.style[this.f?"height":"width"]=this.V;this.Ag(this.o);Wu(this)};
Uu.prototype.renderInternal=Uu.prototype.Y;Uu.prototype.u=function(){Xu(this)};Uu.prototype.Ca=function(a,b){a?Xu(this):this.B&&Wu(this);return Z.prototype.Ca.call(this,a,b)};Uu.prototype.setDisabled=Uu.prototype.Ca;var bv={"in":'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function Ku(){wu.call(this,"div","H_ctl");this.map=null;this.Uc="top-left"}u(Ku,wu);t("H.ui.Control",Ku);Ku.prototype.Ia=function(a){this.map=a};Ku.prototype.$=function(a){return wu.prototype.$.call(this,a)};Ku.prototype.Y=function(a,b){wu.prototype.renderInternal.call(this,a,b);this.Zb(this.Uc)};Ku.prototype.renderInternal=Ku.prototype.Y;Ku.prototype.Xe=function(){};Ku.prototype.onUnitSystemChange=Ku.prototype.Xe;Ku.prototype.yc=function(){return this.map};Ku.prototype.getMap=Ku.prototype.yc;
Ku.prototype.Aa=function(){return this.Xa};Ku.prototype.getLocalization=Ku.prototype.Aa;Ku.prototype.dm=function(){return this.Uc};Ku.prototype.getAlignment=Ku.prototype.dm;Ku.prototype.Zb=function(a){"string"===typeof a&&Tt[a.replace("-","_").toUpperCase()]===a&&(this.Uc=a,this.dispatchEvent("alignmentchange"));return this};Ku.prototype.setAlignment=Ku.prototype.Zb;function Lu(a){a=a||{};var b=a.slider;Ku.call(this);this.o=A(this.o,this);this.i=A(this.i,this);this.a=A(this.a,this);b&&(this.v=A(this.v,this),this.B=b,this.wa=a.sliderSnaps,this.Ka("H_zoom_slider"));this.j=new Su({label:bv["in"],onStateChange:this.o});this.s=new Su({label:bv.out,onStateChange:this.o});this.Ka("H_zoom");this.Ka("H_grp");this.za=!1!==a.fractionalZoom;this.setZoomSpeed(a.zoomSpeed||4);this.Zb(a.alignment||"right-middle")}u(Lu,Ku);t("H.ui.ZoomControl",Lu);
Lu.prototype.wn=function(){return this.T};Lu.prototype.getZoomSpeed=Lu.prototype.wn;Lu.prototype.Fo=function(a){this.T=a};Lu.prototype.setZoomSpeed=Lu.prototype.Fo;Lu.prototype.Ia=function(a){this.map!==a&&(this.map&&this.map.removeEventListener("mapviewchange",this.i),cv(this));Ku.prototype.Ia.apply(this,arguments);this.map&&(this.a(),a.addEventListener("mapviewchange",this.i),a.addEventListener("baselayerchange",this.a))};Lu.prototype.setMap=Lu.prototype.Ia;
Lu.prototype.u=function(){Ku.prototype.u.apply(this,arguments);this.map.removeEventListener("baselayerchange",this.a);cv(this)};Lu.prototype.Y=function(a,b){Ku.prototype.renderInternal.call(this,a,b);this.j.qc(this.Aa().translate("zoom.in"));this.s.qc(this.Aa().translate("zoom.out"))};Lu.prototype.renderInternal=Lu.prototype.Y;Lu.prototype.Zb=function(a){var b=this.Uc;Ku.prototype.Zb.call(this,a);b!==a&&this.a();return this};Lu.prototype.setAlignment=Lu.prototype.Zb;
Lu.prototype.i=function(){var a=this.map,b=a.tb(),c=a.Za()-1;a=a.c||a.hc().getCapabilities().lookAt.zoom;this.B&&this.f.Ag(b);this.lc()||(this.j.Ca(b+c>=a.max),this.s.Ca(b<=a.min))};Lu.prototype.Ca=function(a,b){Lu.l.Ca.call(this,a,b);this.i();return this};Lu.prototype.setDisabled=Lu.prototype.Ca;function cv(a){a.removeChild(a.f);a.f=null;a.m&&(a.m.removeEventListener("minchange",a.a),a.m.removeEventListener("maxchange",a.a),a.m=null)}
Lu.prototype.o=function(a){a=a.target;var b=a===this.j?1:-1,c=0<b?Math.ceil:Math.floor,d=this.map,e,f=this;d&&("down"===a.getState()?(d.b.startControl(),d.b.control(0,0,b*this.T,0,0,0)):d.b.endControl(!0,function(g){e=f.za?g.zoom:c(g.zoom);g.zoom=e}))};Lu.prototype.v=function(a){this.map&&this.map.rf(a.newValue)};
Lu.prototype.a=function(){var a=this.Uc,b=this.yc();if(/^top/g.test(a)||/^bottom/g.test(a)){var c=this.s;a=this.j;var d=!1}else c=this.j,a=this.s,d=!0;this.removeChild(c);this.removeChild(a);this.Ja(c);if(this.B&&b){cv(this);b=d;var e=(d=(c=this.map)&&c.c)||c.hc().getCapabilities().lookAt.zoom;if(this.m=d)d.addEventListener("minchange",this.a),d.addEventListener("maxchange",this.a);this.f=new Uu({step:this.wa?1:0,vertical:b,min:e.min,max:e.max,value:c.tb(),pointerArea:c.G()});this.f.addEventListener(this.f.sk.hd,
this.v);this.Ja(this.f)}this.Ja(a)};var dv={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',
point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function ev(a){Su.call(this,a);this.j=function(b){b.preventDefault()};this.i=A(function(b){this.lc()||this.toggleState();b.preventDefault()},this)}u(ev,Su);t("H.ui.base.PushButton",ev);ev.prototype.Y=function(a){nu(a,"start",this.i);nu(a,"end",this.j);this.Pc(this.Me(),!0)};ev.prototype.renderInternal=ev.prototype.Y;ev.prototype.No=function(){var a=Tu.DOWN;this.P(this.getState()===a?Tu.UP:a);return this};ev.prototype.toggleState=ev.prototype.No;
ev.prototype.u=function(){var a=this.G();a&&ou(a,"start",this.i);Su.prototype.u.call(this)};var Du,fv=navigator.userAgent,gv=-1<fv.indexOf("Android")&&-1<fv.indexOf("Mozilla/5.0")&&-1<fv.indexOf("AppleWebKit"),hv=/AppleWebKit\/([\d.]+)/,iv=null===hv.exec(fv)?null:parseFloat(hv.exec(fv)[1]);Du=gv&&null!==iv&&537>iv;var jv=Function("return this")(),yu=document.createElement("T");function kv(a,b,c){Qi.call(this,a,{icon:lv,visibility:c});mv(this,b)}u(kv,Qi);function mv(a,b){a.Nn=b;a.S&&(a.S.textContent=b)}var lv=new Hi(Vt(jv.document,"span","H_dm_label"),{onAttach:function(a,b,c){c.S=a;mv(c,c.Nn)},onDetach:function(a,b,c){delete c.S}});function nv(a,b){F.call(this);this.f=a;this.a=new kv(this.K,"");b.push(this.a);this.b=new Q({objects:b,data:this});this.j=this.j.bind(this)}u(nv,F);nv.prototype.g=!1;nv.prototype.K={lat:0,lng:0};nv.prototype.Pc=function(a,b){mv(this.a,a);this.a.da(b)};nv.prototype.j=function(){this.a.ub(this.c)};function ov(a,b){b&&(a.nextSibling=b,b.previousSibling=a)};function pv(a,b,c,d){var e=new L,f=[];ov(a,this);ov(this,b);e.wd(a.Ba());e.wd(b.Ba());this.i=new nh(e,{style:c.ce});this.s=new nh(e,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.i.ta().lineWidth+2*(d||5))}});c.c&&(this.o=new nh(e,{style:c.c}),f.push(this.o));f.push(this.i,this.s);nv.call(this,c,f);this.O=this.v=-1;a=this.b;a.addEventListener("pointermove",this.D,!0,this);a.addEventListener("pointerleave",this.B,!0,this)}u(pv,nv);pv.prototype.Ke=function(){var a=this.i.ba();return a.De(0).Ya(a.De(1))};
function qv(a,b,c){var d=a.i.ba();d.tf(3*c,3,[b.lat,b.lng,0]);a.o&&a.o.da(d);a.s.da(d);a.i.da(d)}pv.prototype.D=function(a){var b=a.currentPointer;a=this.previousSibling.Ba();var c=this.nextSibling.Ba(),d=this.f.f,e=b.viewportX;b=b.viewportY;if(this.v!==e||this.O!==b)this.v=e,this.O=b,d.da(this.f.g(a,c,{x:e,y:b})),d.ub(!0)};pv.prototype.B=function(){this.f.f.ub()};pv.prototype.xi=function(){this.Pc(this.f.a(this.Ke()),this.i.F().lb())};function rv(a,b,c){c=b.b(c||0);this.i=new nn(a,{icon:c,zIndex:0});this.i.draggable=!0;nv.call(this,b,[this.i]);a=this.b;a.addEventListener("dragstart",this.$n,!0,this);a.addEventListener("drag",this.ao,!0,this);a.addEventListener("dragend",this.Zn,!0,this)}u(rv,nv);n=rv.prototype;n.Aj=0;n.ci={hd:"change"};n.Ke=function(){return this.Aj};n.Ba=function(){return this.i.ba()};
function sv(a){var b=0;a.nextSibling&&a.previousSibling&&(a.nextSibling.g||a.previousSibling.g?a.nextSibling.g&&!a.previousSibling.g&&(b=2):b=1);b=a.f.b(b);a.i.Oc(b)}n.ao=function(a){var b=a.currentPointer;a=b.viewportX;b=b.viewportY;if(this.s!==a||this.v!==b)this.s=a,this.v=b,this.i.da(this.f.map.Wa(a-this.o.x,b-this.o.y)),this.dispatchEvent(new rd(this.ci.hd,this))};
n.$n=function(a){var b=a.currentPointer,c=b.viewportX;b=b.viewportY;var d=this.f.map.Ga(this.Ba());this.i.qf(1);this.o={x:c-d.x,y:b-d.y};a.stopPropagation()};n.Zn=function(){this.i.qf(0)};n.xi=function(a){this.Aj=a;this.Pc(this.f.a(a),this.Ba())};function tv(a,b){this.c=b;this.b=a;this.a={previousSibling:null,nextSibling:null,g:!0};uv(this,this.a);this.ig=A(this.ig,this)}t("H.ui.distanceMeasurement.Model",tv);n=tv.prototype;n.ag=function(){return this.a.nextSibling===this.a};function vv(a,b){a=a.a;for(var c=a.nextSibling;c!==a;){var d=c,e=c.previousSibling===a?!1:b;(d.c=e)?d.j():(d.m&&x.clearTimeout(d.m),d.m=x.setTimeout(d.j,100));c=c.nextSibling}}
function wv(a,b){var c=b||a.a.nextSibling,d=0,e=0;if(b&&!xv(a,b))throw new D(a.ef,0,b);c instanceof rv?d=c.Ke():c instanceof pv&&(d=c.previousSibling.Ke());for(b=c;b&&b!==a.a;b=b.nextSibling,e++)b.xi(d),1===e%2&&(d+=b.Ke())}n.te=function(a){var b=this.a.previousSibling,c=this.ag();a=new rv(a,this.c,c?0:2);this.b.ea(a.b);ov(a,this.a);a.addEventListener(a.ci.hd,this.ig);c?uv(this,a):(yv(this,b,a),sv(b),wv(this,b));return a};
n.insertBefore=function(a,b){var c;var d=1;if(b){if(!xv(this,b))throw new D(this.insertBefore,1,b);if(c=b.previousSibling.g)d=0;a=new rv(a,this.c,d);a.addEventListener(a.ci.hd,this.ig);this.b.ea(a.b);c?(c=this.a.nextSibling,yv(this,a,c),uv(this,a),b=a,sv(c)):(c=b.previousSibling,b=c.previousSibling,d=c.nextSibling,this.b.Ha(c.b),yv(this,b,a),yv(this,a,d));wv(this,b)}else a=this.te(a);return a};n.ra=function(){uv(this,this.a);this.b.ra()};
n.ef=function(a){var b=this.a,c=a.previousSibling,d=a.nextSibling;if(!xv(this,a))throw new D(this.ef,0,a);this.b.Ha(a.b);if(c===b){var e=d;e!==b?(a=e.nextSibling,uv(this,a),a.xi(0),sv(a),wv(this,a)):uv(this,this.a)}else d===b?(e=c,a=e.previousSibling,ov(a,b),sv(a)):c&&d&&(yv(this,c.previousSibling,d.nextSibling),this.b.xd([d.b,c.b]),wv(this,c.previousSibling));e&&e!==b&&this.b.Ha(e.b)};function xv(a,b){for(var c=a.a.nextSibling,d=!1;c!==a.a;){if(c===b){d=!0;break}c=c.nextSibling}return d}
function yv(a,b,c){b=new pv(b,c,a.c);a.b.ea(b.b)}function uv(a,b){a.a.nextSibling=b;b.previousSibling=a.a}n.ig=function(a){a=a.target;var b=a.previousSibling,c=a.nextSibling,d=a.Ba();if(!c.g){qv(c,d,!1);var e=a}b.g||(qv(b,d,!0),e=b.previousSibling);wv(this,e)};function Pu(a){a=a||{};var b,c=a.lineStyle;Ku.call(this);this.s=new ev({label:dv.btn,onStateChange:A(this.Xn,this)});this.Ja(this.s);if(b=a.distanceFormatter)this.zj=b;c&&(this.ek=c,this.Ck=B);this.Zb(a.alignment||"right-bottom");this.m={};this.m[0]=a.startIcon;this.m[2]=a.endIcon;this.m[1]=a.stopoverIcon;this.m[3]=a.splitIcon}u(Pu,Ku);t("H.ui.DistanceMeasurement",Pu);n=Pu.prototype;n.ek={strokeColor:"rgb(39,44,54)",lineWidth:5};n.Ck={strokeColor:"white",lineWidth:7};
function zv(a){var b=a.map,c,d={};a.i||(a.j=new N,a.f=new ol(a.j,{pixelRatio:a.map.Za()}),a.v=c=a.j.jc(),a.v.hl(!0),c.addEventListener("dragstart",a.Vn,!0,a),c.addEventListener("dragend",a.sf,!0,a),c.addEventListener("pointerenter",a.sf,!0,a),c.addEventListener("pointerleave",a.Wn,!0,a),c.addEventListener("tap",a.lo,!0,a),a.o=Av(a),d.a=A(a.zj,a),d.b=A(a.nk,a),d.g=A(a.Lj,a),d.map=a.map,d.f=a.o,d.ce=a.ek,d.c=a.Ck,a.a=new tv(a.v,d),a.i=!0);a.o&&a.v.ea(a.o);b.addEventListener("tap",a.zk,!0,a);b.a.add(a.f)}
function Bv(a){var b=a.map;a.i&&(b.removeEventListener("tap",a.zk,!0,a),b.df(a.f),a.a.ra())}function Av(a){function b(){var h=c.Bb();h={anchor:c.md().clone().scale(f).floor(),size:new Ki(yd(h.w*f),yd(h.h*f)),hitArea:d};return new Ij(c.Zc(),h)}var c=a.nk(3),d=new Li(Mi.NONE,[]),e,f=c===a.B?.5:1;if(1===c.getState())var g=b();else g=new Ij("<svg/>",{hitArea:d}),c.addEventListener("statechange",function(){1===c.getState()&&e.Oc(b())});return e=new nn(a.map.lb(),{visibility:!1,icon:g})}
n.zj=function(a){var b="m",c=0;"metric"===this.T?1E3<=a&&(a/=1E3,b="km",c=1):(a/=.3048,b="ft",5280<=a&&(a/=5280,b="mi",c=1));return a.toFixed(c)+" "+this.Aa().translate("scale."+b)};n.Lj=function(a,b,c){a=this.map.Ga(a);b=this.map.Ga(b);c=(new I(c.x,c.y)).Kj(a,b);return this.map.Wa(c.x,c.y)};
n.Y=function(a,b){var c=22*(this.map.hc().type===jn.P2D?this.map.Za():1),d=c/2;Ku.prototype.renderInternal.call(this,a,b);this.T=gu.METRIC;this.B=new Ij(dv.point,{anchor:{x:d,y:d},size:{w:c,h:c},hitArea:new Li(Mi.CIRCLE,[d,d,d])});this.s.qc(this.Aa().translate("distance.measurement"))};Pu.prototype.renderInternal=Pu.prototype.Y;n=Pu.prototype;n.nk=function(a){return this.m[a]||this.B};n.sf=function(){vv(this.a,!0)};n.Vn=function(){vv(this.a)};n.Wn=function(a){"touch"!==a.currentPointer.type&&vv(this.a)};
n.lo=function(a){var b=a.currentPointer;var c=a.target.Va;var d;c&&(c=c.getData())instanceof nv&&(d=c);c=d;a=a.originalEvent;a=a.metaKey||a.altKey;c&&(a&&c instanceof rv?this.a.ef(c):c instanceof pv&&(a=c.previousSibling.Ba(),d=c.nextSibling.Ba(),b={x:b.viewportX,y:b.viewportY},this.a.insertBefore(this.Lj(a,d,b),c.nextSibling),this.o.ub()),this.sf())};
n.zk=function(a){var b=a.currentPointer;a=a.target;a!==this.map&&a.getProvider&&a.getProvider()===this.j||(this.a.te(this.map.Wa(b.viewportX,b.viewportY)),this.o.ub(),this.sf())};n.Xn=function(a){"down"===a.target.getState()?zv(this):Bv(this)};n.Xe=function(a){this.T=a;this.i&&(wv(this.a),this.sf())};Pu.prototype.onUnitSystemChange=Pu.prototype.Xe;Pu.prototype.u=function(){Bv(this);this.i&&(this.j.C(),this.f.C());Pu.l.u.call(this)};
Pu.prototype.Ia=function(a){a?this.s.getState()===Tu.DOWN&&(this.map=a,zv(this)):(Bv(this),this.i=!1);Ku.prototype.Ia.apply(this,arguments)};Pu.prototype.setMap=Pu.prototype.Ia;function Cv(){this.A=Dv.CLOSED;wu.call(this,"div","H_overlay")}u(Cv,wu);t("H.ui.base.OverlayPanel",Cv);Cv.prototype.P=function(a,b){if(a!==this.A||b)this.A=a,a===Dv.OPEN?this.Ka("H_open"):this.pb("H_open");return this};Cv.prototype.setState=Cv.prototype.P;Cv.prototype.getState=function(){return this.A};Cv.prototype.getState=Cv.prototype.getState;
Cv.prototype.Gk=function(a){var b=a.Uc;a=a.G();var c=this.G(),d=c.style;this.pb("H_top");this.pb("H_middle");this.pb("H_bottom");this.pb("H_left");this.pb("H_center");this.pb("H_right");d.bottom=d.top=d.left=d.right=d.margin="";if(/top/g.test(b)){this.Ka("H_top");d.top="0";d.margin="0 12px";var e=-1}else/bottom/g.test(b)?(this.Ka("H_bottom"),d.bottom="0",d.margin="0 12px",e=1):(this.Ka("H_middle"),d.top="50%",d.margin="0 12px",d.marginTop=-Math.round(.5*
c.offsetHeight)+"px",e=0);/left/g.test(b)?(this.Ka("H_left"),d.left=a.offsetWidth+"px",d.marginLeft="12px"):/right/g.test(b)?(this.Ka("H_right"),d.right=a.offsetWidth+"px",d.marginRight="12px"):(this.Ka("H_center"),d.left="50%",0>e?(d.top=a.offsetHeight+"px",d.marginTop="12px"):0<e&&(d.bottom=a.offsetHeight+"px",d.marginBottom="12px"),d.marginLeft=-Math.round(.5*c.offsetWidth)+"px",a.appendChild(c))};Cv.prototype.pointToControl=Cv.prototype.Gk;var Dv={OPEN:"open",CLOSED:"closed"};
Cv.State=Dv;function Ev(a){a=a||{};wu.call(this,"div","H_rdo");this.i=new Z("div","H_rdo_title");this.a=new wu("div","H_rdo_buttons");this.Ja(this.i);this.Ja(this.a);this.j=A(function(b){b.target.getState()===Tu.DOWN?(this.Tk(b.target,!0),this.dispatchEvent(Fv)):b.target.P(Tu.DOWN,!0)},this);this.addEventListener("statechange",this.j);this.Ki(a.title||"");a.onActiveButtonChange&&this.addEventListener(Fv,a.onActiveButtonChange);a.buttonsOptions&&a.buttonsOptions.forEach(function(b){this.Lg(new ev(b))},
this)}u(Ev,wu);t("H.ui.base.RadioGroup",Ev);var Fv="activebuttonchange";Ev.prototype.Y=function(a,b){wu.prototype.renderInternal.call(this,a,b);this.Ki(this.f,!0)};Ev.prototype.renderInternal=Ev.prototype.Y;Ev.prototype.ra=function(){this.a.ra()};Ev.prototype.Ki=function(a,b){if(a!==this.f||b)this.f=a,this.i.G()&&(this.i.G().innerHTML=this.f);return this};Ev.prototype.setTitle=Ev.prototype.Ki;Ev.prototype.nn=function(){return this.f};Ev.prototype.getTitle=Ev.prototype.nn;
Ev.prototype.Lg=function(a){if(!(a instanceof ev))throw Error("PushButton expected");a.ja(this);this.a.Ja(a);return this};Ev.prototype.addButton=Ev.prototype.Lg;Ev.prototype.so=function(a){this.a.removeChild(a);a.ja(null);return this};Ev.prototype.removeButton=Ev.prototype.so;Ev.prototype.Pf=function(){return this.a.oh()};Ev.prototype.getButtons=Ev.prototype.Pf;Ev.prototype.Tk=function(a,b){for(var c=this.Pf(),d=c.length;d--;)c[d].P(c[d]===a?Tu.DOWN:Tu.UP,b)};Ev.prototype.setActiveButton=Ev.prototype.Tk;
Ev.prototype.u=function(){this.removeEventListener("statechange",this.j);this.ra();wu.prototype.u.call(this)};function Nu(a){a=a||{};Ku.call(this);this.i=new Cv;new Ev;this.a=this.a.bind(this);this.o=this.o.bind(this);this.s=this.s.bind(this);this.Zb(a.alignment||"bottom-right");Ru(this,a.baseLayers,a.layers)}u(Nu,Ku);t("H.ui.MapSettingsControl",Nu);function Ru(a,b,c){var d=a.yc();a.f&&a.f.forEach(function(e){var f=e.layer;e=f&&Pt(c,function(g){return g.layer===f});f&&!e&&d.df(f)});a.m=yc(b)?b:[];a.f=yc(c)?c:[];a.j&&(a.j.ra(),a.v.ra(),Gv(a))}
Nu.prototype.fa=function(){var a=this.yc();a&&(a.addEventListener("tap",this.o),a=a.a,a.addEventListener("add",this.a),a.addEventListener("remove",this.a),a.addEventListener("set",this.a))};Nu.prototype.K=function(){var a=this.yc();a&&(a.removeEventListener("tap",this.o),a=a.a,a.removeEventListener("add",this.a),a.removeEventListener("remove",this.a),a.removeEventListener("set",this.a))};
Nu.prototype.Y=function(a,b){var c=this.Aa().translate("layers.choose");Ku.prototype.renderInternal.call(this,a,b);this.fa();this.B=new ev({tooltip:c,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:A(function(d){d.target.getState()===Tu.DOWN?(this.i.P(Dv.OPEN),this.i.Gk(this)):
this.i.P(Dv.CLOSED)},this)});this.j=new Ev({title:c,onActiveButtonChange:function(){a:{var d=this.j.Pf();for(var e=d.length;e--;)if(d[e].getState()===Tu.DOWN){d=d[e];break a}d=null}d=d.getData();this.map.Bd(this.m[d].layer);this.s()}.bind(this)});this.v=new wu("div","H_grp");this.T=new Z("div","H_separator");this.Ja(this.B);this.Ja(this.i);this.i.Ja(this.j);this.i.Ja(this.T);this.i.Ja(this.v);Gv(this)};Nu.prototype.renderInternal=Nu.prototype.Y;
function Gv(a){var b=a.Aa();a.m.forEach(function(c,d){this.j.Lg(new ev({label:Hv(b,c.label),data:d,disabled:!c.layer}))},a);a.f.forEach(function(c,d){this.v.Ja(new ev({label:Hv(b,c.label),onStateChange:this.za.bind(this,c.layer),data:d,disabled:!c.layer}))},a);a.T.ub(!(!a.f.length||!a.m.length));x.setTimeout(function(){this.map&&(this.a(),this.B.Ca(!(this.m&&this.m.length||this.f&&this.f.length)))}.bind(a))}
Nu.prototype.a=function(){var a=this.map.c,b=this.map.a;this.m.forEach(function(c,d){this.j.Pf()[d].P(Tu[c.layer===a?"DOWN":"UP"],!0)},this);this.f.forEach(function(c,d){d=this.v.oh()[d];c.layer?d.P(Tu[-1!==b.indexOf(c.layer)?"DOWN":"UP"],!0):d.Ca(!0)},this)};Nu.prototype.za=function(a,b){b.target.getState()===Tu.DOWN?this.map.Ng(a):this.map.df(a);this.s()};
Nu.prototype.s=function(){var a;if(a=Iv(this)){var b=a.Gg;b.pa().ta().Ve(a.pa().ta().nd());this.map.df(a);a.C();delete a.Gg}Jv(this)&&Kv(this,this.map.c)};
function Kv(a,b){var c,d,e={},f=b.pa(),g=window.H.service&&window.H.service.omv.Provider;if(g&&b.pa()instanceof g&&f.ta().Ce){var h=f.ta();var k=function(){var l=Lv.ground.filter(function(q){return!!h.xh("layers."+q)}),m=Lv.water.filter(function(q){return!!h.xh("layers."+q)});l.concat(m).length&&(vh(e,h.Ce(l)),vh(e,h.Ce(m,!1,!0)),delete e.global,c=new Th(e,h.gc()),d=f.o.jd(c),d.Gg=b,this.map.Ng(d));h.removeEventListener(Sh.CHANGE,k)}.bind(a);h.getState()!==Qh.READY?h.addEventListener(Sh.CHANGE,
k):k()}}function Iv(a){return Pt(a.map.a.La(),function(b){return!!b.Gg})}function Jv(a){a=a.map.a.La();var b=window.H.service&&window.H.service.traffic.flow.Provider;return!!b&&a.some(function(c){return c.pa()instanceof b})}var Lv={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function Hv(a,b){return/^layers?/.test(b)&&a.Eh(b)?a.translate(b):b}Nu.prototype.o=function(){this.B.P(Tu.UP)};
Nu.prototype.u=function(){Nu.l.u.call(this);this.K()};function Mu(a){a=a||{};Ku.call(this);this.f=new ev({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',
onStateChange:A(this.Yn,this)});this.Ja(this.f);this.Zb(a.alignment||"right-bottom")}u(Mu,Ku);t("H.ui.ZoomRectangle",Mu);n=Mu.prototype;
n.Yn=function(a){var b=this.map,c=b.ya.element;a.target.getState()===Tu.DOWN?(b.addEventListener("dragstart",this.qk,!0,this),b.addEventListener("drag",this.rk,!0,this),b.addEventListener("dragend",this.pk,!0,this),a=c.ownerDocument.createElement("div"),a.className="H_zoom_lasso",c.appendChild(a),this.a=a):(b.removeEventListener("dragstart",this.qk,!0,this),b.removeEventListener("drag",this.rk,!0,this),b.removeEventListener("dragend",this.pk,!0,this),c.removeChild(this.a))};
n.qk=function(a){var b=this.a.style,c=a.currentPointer,d=c.viewportX;c=c.viewportY;a.target===this.map&&(a.stopPropagation(),b.width="0px",b.height="0px",b.top=c+"px",b.left=d+"px",b.display="block",this.j=c,this.i=d)};n.rk=function(a){var b=a.currentPointer,c=b.viewportX,d=b.viewportY;b=this.i;var e=this.j,f=this.a.style;a.target===this.map&&(a.stopPropagation(),a=c-b,c=d-e,f.left=b+(0>a?a:0)+"px",f.top=e+(0>c?c:0)+"px",f.width=Math.abs(a)+"px",f.height=Math.abs(c)+"px")};
n.pk=function(a){var b=this.map,c=a.currentPointer;a.target===this.map&&(a.stopPropagation(),this.a.style.display="none",b.b.$b({bounds:eg([b.Wa(this.i,this.j),b.Wa(c.viewportX,c.viewportY)])},!0))};n.Y=function(a,b){Ku.prototype.renderInternal.call(this,a,b);this.f.qc(this.Aa().translate("zoom.rectangle"))};Mu.prototype.renderInternal=Mu.prototype.Y;function Mv(a,b){b=b||{};if(!(a&&a instanceof nl))throw Error("Base layer is mandatory for overview UI element");Ku.call(this);this.f=new ev({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:A(this.i,this)});this.Ja(this.f);this.a=
new Nv(a,b.zoomDelta,b.scaleX,b.scaleY);this.Zb(b.alignment||"right-bottom");this.Ja(this.a)}u(Mv,Ku);t("H.ui.Overview",Mv);Mv.prototype.Bd=function(a){this.a.Bd(a);return this};Mv.prototype.setBaseLayer=Mv.prototype.Bd;Mv.prototype.i=function(a){a.target.getState()===Tu.DOWN?(a=this.a,Ov(a,!0),a.Oi(),a.Ka("H_overview_active"),a.a.addEventListener("mapviewchange",a.Oi,!1,a)):Pv(this.a)};
Mv.prototype.Y=function(a,b){Ku.prototype.renderInternal.call(this,a,b);this.f.G().style["float"]=this.Uc.match("right")?"right":"left";this.a.Ia(this.map);this.f.qc(this.Aa().translate("minimap"))};Mv.prototype.renderInternal=Mv.prototype.Y;Mv.prototype.u=function(){this.a.C();Z.prototype.u.call(this)};function Nv(a,b,c,d){this.m=a;"number"===typeof b&&(this.ul=b);"number"===typeof c&&(this.Dk=c);"number"===typeof d&&(this.Ek=d);wu.call(this,"div","H_overview")}u(Nv,Ku);Nv.prototype.Bd=function(a){this.f.Bd(a)};
Nv.prototype.Y=function(a,b){b=Vt(b,"div","H_overview_map");eu(a,b);this.i=b};Nv.prototype.renderInternal=Nv.prototype.Y;n=Nv.prototype;n.ul=3;n.Dk=5;n.Ek=5;n.Ia=function(a){this.a=a;this.f=new U(this.i,this.m,{pixelRatio:this.a.Za(),engineType:this.a.hc().type});this.f.m.G().style.display="none";this.o=this.f.b;this.j=this.a.b};function Pv(a){!a.Ed&&Ov(a);a.pb("H_overview_active");a.a.removeEventListener("mapviewchange",a.Oi,!1,a)}
n.Oi=function(a){a&&a.modifiers&a.SIZE&&Ov(this,!0);a=this.j.sb();a.zoom=a.zoom-this.ul;this.o.$b(a)};function Ov(a,b){var c=a.a.ya.element,d=a.G().style,e=c.offsetWidth/a.Dk/10;c=c.offsetHeight/a.Ek/10;var f=a.i.style;b?(d.width=e+"em",d.height=c+"em",f.width=e+"em",f.height=c+"em"):d.width=d.height="0em";a.f.ya.resize()}n.u=function(){Nv.l.u.call(this);Pv(this);this.f.C();this.f=this.o=this.j=this.a=this.m=this.i=null};function Ou(a){a=a||{};Ku.call(this);this.Ka("H_scalebar");this.Zb(a.alignment||"right-bottom");this.v=150;this.update=A(this.update,this);this.m=this.f=this.a=this.j=null}u(Ou,Ku);t("H.ui.ScaleBar",Ou);
Ou.prototype.Y=function(a,b){Ku.prototype.renderInternal.call(this,a,b);a.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>';a.style.direction="ltr";this.j=a.firstChild;b=this.j.childNodes;this.a=b[0];this.f=b[1];this.m=a.lastChild;this.o=gu.METRIC;this.s=
A(function(c){this.lc()||(this.dispatchEvent("toggleunitsystem"),c.preventDefault())},this);this.i=A(function(c){c.preventDefault()},this);nu(a,"start",this.i);nu(a,"end",this.s);this.qc(this.Aa().translate("scale.switchToImperial"));this.update()};Ou.prototype.renderInternal=Ou.prototype.Y;Ou.prototype.Ia=function(a){this.map&&this.map.removeEventListener("mapviewchange",this.update);a&&a.addEventListener("mapviewchange",this.update);Ku.prototype.Ia.apply(this,arguments)};Ou.prototype.setMap=Ou.prototype.Ia;
Ou.prototype.capture=function(a,b,c){var d=this.G();var e=d.ownerDocument,f=e.createElement("canvas"),g=f.getContext("2d"),h=e.createElementNS("http://www.w3.org/2000/svg","svg"),k=e.createElementNS("http://www.w3.org/2000/svg","foreignObject"),l=jf(d,e,!1);e=parseFloat(d.offsetWidth)+1;var m=parseFloat(d.offsetHeight),q=e*a;a*=m;f.width=q;f.height=a;h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("width",q);h.setAttribute("height",a);h.setAttribute("viewBox","0 0 "+e+" "+m);k.setAttribute("width",
"100%");k.setAttribute("height","100%");h.appendChild(k);l.setAttribute("width","100%");l.setAttribute("height","100%");l.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var p=window.getComputedStyle(d);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach(function(r){l.style.setProperty(r,p.getPropertyValue(r))});k.appendChild(l);d=$e(h.outerHTML);(new rf("image",d)).then(function(r){g.drawImage(r,0,0);b(f)},c)};Ou.prototype.capture=Ou.prototype.capture;
Ou.prototype.Xe=function(a){this.o=a;this.qc("imperial"===a?this.Aa().translate("scale.switchToMetric"):this.Aa().translate("scale.switchToImperial"));this.update()};Ou.prototype.onUnitSystemChange=Ou.prototype.Xe;
Ou.prototype.update=function(){if(this.G()){var a=this.v;var b=0;var c=this.map;var d;if(c){var e=Math.round(.5*c.ya.width);var f=Math.round(.5*c.ya.height);if(d=c.Wa(e,f))b=Zf(d),c=Zf(c.Wa(e+1,f)),b=100*b.Ya(c)}if(c=b)this.o===gu.IMPERIAL?c<Qv?(f=c/Rv,e=this.Aa().translate("scale.ft")):(f=c/Qv,e=this.Aa().translate("scale.mi")):1E3>c?(f=c,e=this.Aa().translate("scale.m")):(f=c/1E3,e=this.Aa().translate("scale.km")),c=Math.pow(10,Math.floor(Math.log(f)/Math.LN10)),f=c/f*100,f<a/5?(c*=5,f*=5):f<a/
2?(c*=2,f*=2):f>a&&(c/=2,f/=2),f=Math.round(f),this.j.setAttribute("width",f),this.m.textContent=c+" "+e,this.a.points.getItem(2).x=this.f.points.getItem(2).x=this.a.points.getItem(3).x=this.f.points.getItem(3).x=f-2}};var Qv=1609.344,Rv=.3048006;t("H.ui.buildInfo",function(){return Ef("H-ui","1.21.2","e91ec96")});

H.__bootstrap__="var l,ba=\"function\"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ca=\"undefined\"!=typeof window&&window===this?this:\"undefined\"!=typeof global&&null!=global?global:this;function da(a,b){if(b){var c=ca;a=a.split(\".\");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}var fa;\nif(\"function\"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={gb:!0},ka={};try{ka.__proto__=ia;ha=ka.gb;break a}catch(a){}ha=!1}fa=ha?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+\" is not extensible\");return a}:null}var la=fa;da(\"Object.setPrototypeOf\",function(a){return a||la});var p=this||self;\nfunction ma(a,b,c){a=a.split(\".\");c=c||p;a[0]in c||\"undefined\"==typeof c.execScript||c.execScript(\"var \"+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function na(){}\nfunction oa(a){var b=typeof a;if(\"object\"==b)if(a){if(a instanceof Array)return\"array\";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(\"[object Window]\"==c)return\"object\";if(\"[object Array]\"==c||\"number\"==typeof a.length&&\"undefined\"!=typeof a.splice&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==c||\"undefined\"!=typeof a.call&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"call\"))return\"function\"}else return\"null\";\nelse if(\"function\"==b&&\"undefined\"==typeof a.call)return\"object\";return b}function r(a){return\"function\"==oa(a)}function qa(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==b}var ra=\"closure_uid_\"+(1E9*Math.random()>>>0),sa=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}\nfunction ua(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function va(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?va=ta:va=ua;return va.apply(null,arguments)}\nfunction wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){ma(a,b,void 0)}function xa(a,b){function c(){}c.prototype=b.prototype;a.V=b.prototype;a.prototype=new c;a.prototype.constructor=a};function x(){}t(\"H.util.ICache\",x);x.prototype.add=function(){};x.prototype.add=x.prototype.add;x.prototype.get=function(){};x.prototype.get=x.prototype.get;x.prototype.sa=function(){};x.prototype.drop=x.prototype.sa;x.prototype.forEach=function(){};x.prototype.forEach=x.prototype.forEach;x.prototype.T=function(){};x.prototype.removeAll=x.prototype.T;x.prototype.ba=function(){};x.prototype.registerOnDrop=x.prototype.ba;x.prototype.qa=function(){};x.prototype.deRegisterOnDrop=x.prototype.qa;function ya(){var a=za,b;for(b in a)return!1;return!0}function Aa(a){var b={},c;for(c in a)b[c]=a[c];return b}var Ba=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function Ca(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Ba.length;f++)c=Ba[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var y=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}xa(Da,Error);Da.prototype.name=\"CustomError\";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(\"string\"===typeof a)return\"string\"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=va,Ga=String,Ha=y.Object.freeze||function(a){return a},z=self.eval(\"undefined\"),Ia=self.eval(\"null\");function La(a){return Ga(a).split(\",\"!==z?\",\":\" \")}var Ma=\"prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new A(c,d,void 0!==z?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e=\"Array\"===Pa(a))&&b)throw new A(b,c,d!==z?d:a);return e}\nt(\"H.lang.isArray\",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return\"string\"===typeof a}t(\"H.lang.isString\",Qa);var Ra=isNaN;function Sa(a){return a===+a}t(\"H.lang.isNumber\",Sa);t(\"H.lang.isInteger\",Number.isInteger?Number.isInteger:function(a){return\"number\"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);\nfunction Ua(a,b,c,d){var e=\"\",f=2>arguments.length,g;f&&(b={H:y.H},c=\"\",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(qa(g)&&g.window===g&&g.self===g||qa(g)&&0<g.nodeType&&r(g.cloneNode))&&qa(g)){if(g===a)return e=c+\".\"+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+\".\"+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace(\".\"+Ma[0]+\".\",\"#\"):\"~\"+(r(a)?Xa(a)+\"()\":Pa(a)));return e}\nfunction Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:\"anonymous\"}function $a(a,b,c){c[b]=\"#\"+b};function B(a,b,c){this.g=[];b&&this.ba(b);if(c&&!r(c))throw new A(B,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ia(a)}t(\"H.util.Cache\",B);B.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new A(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&db(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,A:null,D:null},this.c),gb(this);return e};B.prototype.add=B.prototype.add;\nB.prototype.ba=function(a){if(!r(a))throw new A(this.ba,0,a);this.g.push(a)};B.prototype.registerOnDrop=B.prototype.ba;B.prototype.qa=function(a){this.g=this.g.filter(function(b){return b!==a})};B.prototype.deRegisterOnDrop=B.prototype.qa;B.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};B.prototype.get=B.prototype.get;B.prototype.sa=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};B.prototype.drop=B.prototype.sa;\nB.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};B.prototype.forEach=B.prototype.forEach;B.prototype.T=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};B.prototype.removeAll=B.prototype.T;B.prototype.Ia=function(a){if(!(0<+a))throw new A(B.prototype.Ia,0,a);this.o=+a;gb(this);return this};B.prototype.setMaxSize=B.prototype.Ia;B.prototype.zb=function(){return this.o};\nB.prototype.getMaxSize=B.prototype.zb;B.prototype.vb=function(){return this.b};B.prototype.getCurrentSize=B.prototype.vb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.o&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.A||b.D)&&hb(a,b,!1);if(b.A=c)b.D=c.D,c.D=b;b.D||(a.c=b);b.A||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.D,e=b.A;if(d||e||b==a.c&&b==a.f)d?d.A=e:a.c=e,e?e.D=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],db(a,b));b.A=b.D=null}\nfunction db(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function C(){}t(\"H.service.extension.dataView.ITable\",C);C.prototype.ya=function(){};C.prototype.getMeta=C.prototype.ya;C.prototype.za=function(){};C.prototype.getRowCount=C.prototype.za;C.prototype.ia=function(){};C.prototype.getRow=C.prototype.ia;C.prototype.C=function(){};C.prototype.getColumnNames=C.prototype.C;C.prototype.xa=function(){};C.prototype.getColumn=C.prototype.xa;C.prototype.s=function(){};C.prototype.getCell=C.prototype.s;C.prototype.concat=function(){};C.prototype.concat=C.prototype.concat;function ib(){}t(\"H.service.extension.dataView.IRow\",ib);ib.prototype.C=function(){};ib.prototype.getColumnNames=ib.prototype.C;ib.prototype.s=function(){};ib.prototype.getCell=ib.prototype.s;ib.prototype.Aa=function(){};ib.prototype.getTable=ib.prototype.Aa;function jb(a,b){this.a=a;this.b=b}t(\"H.service.extension.dataView.ObjRow\",jb);jb.prototype.C=function(){return this.a.C()};jb.prototype.getColumnNames=jb.prototype.C;jb.prototype.s=function(a){return this.a.s(this.b,a)};jb.prototype.getCell=jb.prototype.s;jb.prototype.Aa=function(){return this.a};jb.prototype.getTable=jb.prototype.Aa;function kb(){}t(\"H.service.extension.dataView.IColumn\",kb);kb.prototype.s=function(){};kb.prototype.getCell=kb.prototype.s;function lb(a,b){this.b=a;this.a=b}t(\"H.service.extension.dataView.ObjColumn\",lb);lb.prototype.s=function(a){return this.b.s(a,this.a)};lb.prototype.getCell=lb.prototype.s;function A(a,b,c){var d=arguments.length;b=b!==z?+b:b;if(b!==z){var e=(e=/^.*?\\(([^\\)]+)/.exec((\"\"+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,\"\")))?La(e[1].replace(/\\s+/g,\"\")):[];e.forEach($a);e=e[b]||\"#\"+b}var f=a?Ua(a):\"\";d=2<d?Ga(c):\"\";if(e||d)f+=\" (Argument \"+(e||\"\")+(d?\" \"+d:\"\")+\")\";d=Error(f);Object.setPrototypeOf(d,A.prototype);return d}xa(A,Error);t(\"H.lang.InvalidArgumentError\",A);A.prototype.name=\"InvalidArgumentError\";function D(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):z);this.F=a;if(b)for(this.N=b,this.pa=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==z&&(this.Ca=c)}t(\"H.service.extension.dataView.ObjTable\",D);l=D.prototype;l.Ca=z;l.F=z;l.N=z;l.pa=z;l.ya=function(){return this.Ca};D.prototype.getMeta=D.prototype.ya;D.prototype.za=function(){return this.F?this.F.length:0};D.prototype.getRowCount=D.prototype.za;D.prototype.ia=function(a){var b=this.F;return b&&b[a]?new jb(this,a):z};\nD.prototype.getRow=D.prototype.ia;D.prototype.C=function(){return this.N||mb};D.prototype.getColumnNames=D.prototype.C;D.prototype.xa=function(a){return this.pa[a]?new lb(this,a):z};D.prototype.getColumn=D.prototype.xa;D.prototype.s=function(a,b){var c=this.F;return(a=c&&this.pa[b]&&c[a])&&a[b]};D.prototype.getCell=D.prototype.s;\nD.prototype.concat=function(){var a=arguments.length,b,c=this.N,d=\"\"+this.N,e=(this.F||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof D))throw new A(this.concat,b);if(f.F){if(c&&\"\"+f.N!==d)throw new A(this.concat,b,\"Incompatible columns!\");e=e.concat(f.F)}}return new D(e,this.N,this.Ca)};D.prototype.concat=D.prototype.concat;function E(a,b){this.x=+a;this.y=+b}t(\"H.math.Point\",E);E.prototype.set=E;E.prototype.set=E.prototype.set;E.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new E(this.x,this.y);return a};E.prototype.clone=E.prototype.clone;E.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};E.prototype.add=E.prototype.add;E.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};E.prototype.sub=E.prototype.sub;E.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};\nE.prototype.scale=E.prototype.scale;E.prototype.round=function(){this.x=nb(this.x);this.y=nb(this.y);return this};E.prototype.round=E.prototype.round;E.prototype.floor=function(){this.x=ob(this.x);this.y=ob(this.y);return this};E.prototype.floor=E.prototype.floor;E.prototype.ceil=function(){this.x=pb(this.x);this.y=pb(this.y);return this};E.prototype.ceil=E.prototype.ceil;E.prototype.G=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};E.prototype.equals=E.prototype.G;\nE.prototype.Ab=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new E(a.x+f*c,a.y+f*d)}return e};E.prototype.getNearest=E.prototype.Ab;E.prototype.ra=function(a){return qb(rb(this.x-a.x,2)+rb(this.y-a.y,2))};E.prototype.distance=E.prototype.ra;E.fromIPoint=function(a){if(!a)throw Error(\"invalid argument\");return a instanceof E?a:new E(a.x,a.y)};var F=Math,sb=F.min,tb=F.max,nb=F.round,ob=F.floor,pb=F.ceil,ub=F.abs,vb=F.log,qb=F.sqrt,rb=F.pow,wb=F.exp,xb=F.sin,yb=F.asin,zb=F.cos,Ab=F.tan,Bb=F.atan,Cb=F.atan2,Db=F.LN2,I=F.PI,Eb=I/2,Gb=I/4,Hb=2*I,Ib=3*I,Jb=I/180,Kb=180/I,Lb=1/0;rb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t(\"H.math.normalize\",function(a,b,c){b-=c=c||0;a-=c;return a-ob(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t(\"H.math.clamp\",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}\nfunction Pb(a,b,c,d,e,f){return qb(rb((a-e)*(d-f)-(b-f)*(c-e),2)/(rb(c-e,2)+rb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t(\"H.math.CoverType\",Qb);\nfunction Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}\nfunction Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t(\"H.math.isPointInsidePolygon\",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==z;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t(\"H.math.flatten\",Tb);function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var J=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var M=n[0];var v=n[1];J&&J.G(M)?h.push(v):g.push(h=n);J=v;f&&(m=u,k=0)}}else g=a;return g}t(\"H.math.clipping.clipStrips\",Ub);\nfunction Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new E(h,-b),new E(g,-a)]:[new E(g,-a),new E(h,-b)]}\nfunction Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.ga=Yb(b.x,b.y,null,Zb(b));a.ga=Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.B)for(d=a;d.next;d=d.next)if(!d.B){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.jb;var n=f.kb;var q=f.ic;var u=f.jc;e=Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Da=k;k.Da=e}}f=Sb(b,cc(a));\nc&&(f=!f);for(g=b;g;g=g.next)g.B&&(g.ta=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.B&&(d.ta=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.na;a=a.Da){for(f=a.ta;;){c=Yb(a.x,a.y,c);c.artificial=a.B||a.Mb;a.na=1;a=f?a.next:a.u;if(!a)break;if(a.B){a.na=1;break}}if(!a)break}c.Wa=J;var J=c}return J}}t(\"H.math.clipping.clipPolygon\",Wb);\nfunction Yb(a,b,c,d,e,f,g,h,k,m){a={x:a,y:b,next:c||null,u:d||null,Wa:e||null,Da:f||null,B:!!g,ta:h||0,na:k||0,alpha:m||0};d&&(a.u.next=a);c&&(a.next.u=a);return a}function $b(a){for(;a&&a.B;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.B||b.B&&b.na))}return b}function dc(a){var b=Zb(a);b.u.next=a;a.u=b.u}\nfunction ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.ga&&(f.ga.x=f.x,f.ga.y=f.y),ac(a,b,c,d,e);e.ic=a.x+k*g;e.jc=a.y+k*h;e.jb=k;e.kb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}\nfunction bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.u=b.u;a.next.u=a;a.u.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=Yb(a[e].x,a[e].y,d);c.Mb=b;if(c.next=d)d.u=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(\"\"+b);c=Error(c.join(\" \"));Object.setPrototypeOf(c,fc.prototype);return c}xa(fc,Error);t(\"H.lang.IllegalOperationError\",fc);fc.prototype.name=\"IllegalOperationError\";function gc(){if(!Qa(\"STATIC_DB\"))throw new A(this.constructor,0);this.o=y.indexedDB||y.hc||y.Pb||y.Qb;if(!this.o)throw new fc(this.constructor,\"This browser does not support IndexedDB\");this.a=[];this.c=[];this.g=Fa(this.g,this)}var hc,ic;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new A(this.get,0);if(!r(b))throw new A(this.get,1);jc(this,function(e){d=e.get(a);kc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=lc)}}};\ngc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains(\"data\")||a.createObjectStore(\"data\")};\nfunction mc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.o.open(nc+\"STATIC_DB\",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.v);a.f=this.error;a.c.forEach(function(e){e(a.f)});a.a=a.c=null};a.v=setTimeout(function(){d.call({error:Error(\"DbOpenTimeoutError\")})},500);a.b.onsuccess=function(){clearTimeout(a.v);a.a?(a.a.forEach(function(e){e(this.result)},this),a.a=a.c=null):(a.b=a.f=null,a.a=[],a.c=[])};a.a.push(b);c&&a.c.push(c)}}\nfunction jc(a,b,c){mc(a,function(d){d=d.transaction([\"data\"],\"readwrite\");b(d.objectStore(\"data\"))},c)}function kc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t(\"H.util.IndexedDBStorage.getInstance\",function(){hc||(hc=new gc);return hc});var nc=\"H_\";\nt(\"H.util.IndexedDBStorage.isSupported\",function(){if(ic===z)if(\"file:\"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf(\"firefox\")&&128<=window.location.href.length)ic=!1;else{var a=y.indexedDB||y.hc||y.Pb||y.Qb;var b=nc+\"TEST_DB\";try{var c=a&&a.open(b,1)}catch(d){}ic=!!c&&null===c.onupgradeneeded;c&&a.deleteDatabase&&a.deleteDatabase(b)}return ic});function oc(){0!=pc&&(qc[this[ra]||(this[ra]=++sa)]=this);this.c=this.c;this.a=this.a}var pc=0,qc={};oc.prototype.c=!1;oc.prototype.O=function(){if(!this.c&&(this.c=!0,this.ha(),0!=pc)){var a=this[ra]||(this[ra]=++sa);if(0!=pc&&this.a&&0<this.a.length)throw Error(this+\" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.\");delete qc[a]}};\noc.prototype.M=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?va(a,b):a))};oc.prototype.ha=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function K(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.Ya=!0}K.prototype.stopPropagation=function(){this.a=!0};K.prototype.c=function(){this.Ya=!1};t(\"H.util.Event\",K);K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.CAPTURING_PHASE=1;K.prototype.CAPTURING_PHASE=K.prototype.CAPTURING_PHASE;K.prototype.AT_TARGET=2;K.prototype.AT_TARGET=K.prototype.AT_TARGET;K.prototype.BUBBLING_PHASE=3;K.prototype.BUBBLING_PHASE=K.prototype.BUBBLING_PHASE;K.prototype.eventPhase=0;K.prototype.eventPhase=K.prototype.eventPhase;function rc(a,b,c){rc.V.constructor.call(this,a,c);this.data=b}xa(rc,K);t(\"H.util.DataEvent\",rc);function sc(a,b,c){sc.V.constructor.call(this,a,c);this.message=b}xa(sc,K);t(\"H.util.ErrorEvent\",sc);function tc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}tc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function uc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function vc(){this.b=this.a=null}var xc=new tc(function(){return new wc},function(a){a.reset()});vc.prototype.add=function(a,b){var c=xc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function yc(){var a=Bc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function wc(){this.next=this.b=this.a=null}wc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};wc.prototype.reset=function(){this.next=this.b=this.a=null};var Cc=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Dc(a,b){return a<b?-1:a>b?1:0};var Ec;a:{var Fc=p.navigator;if(Fc){var Gc=Fc.userAgent;if(Gc){Ec=Gc;break a}}Ec=\"\"}function L(a){return-1!=Ec.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||\"\";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,\"\");function Lc(a,b){this.b=a===Mc&&b||\"\";this.a=Nc}var Nc={},Mc={};function Oc(){this.a=\"\";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;oa(a);return\"type_error:SafeHtml\"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc(\"<!DOCTYPE html>\");var Rc=Sc(\"\");Sc(\"<br>\");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:\"type_error:Const\");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(oa(b),b=\"type_error:TrustedResourceUrl\");a.src=b.toString()};function Uc(a){Uc[\" \"](a);return a}Uc[\" \"]=na;var Vc=L(\"Opera\"),Wc=L(\"Trident\")||L(\"MSIE\"),Xc=L(\"Edge\"),Yc=L(\"Gecko\")&&!(-1!=Ec.toLowerCase().indexOf(\"webkit\")&&!L(\"Edge\"))&&!(L(\"Trident\")||L(\"MSIE\"))&&!L(\"Edge\"),Zc=-1!=Ec.toLowerCase().indexOf(\"webkit\")&&!L(\"Edge\");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;\na:{var bd=\"\",cd=function(){var a=Ec;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:\"\");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);\"application/xhtml+xml\"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;\nfunction jd(){var a=p.MessageChannel;\"undefined\"===typeof a&&\"undefined\"!==typeof window&&window.postMessage&&window.addEventListener&&!L(\"Presto\")&&(a=function(){var e=gd(\"IFRAME\");e.style.display=\"none\";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g=\"callImmediate\"+Math.random(),h=\"file:\"==f.location.protocol?\"*\":f.location.protocol+\"//\"+f.location.host;e=va(function(k){if((\"*\"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},\nthis);f.addEventListener(\"message\",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if(\"undefined\"!==typeof a&&!L(\"Trident\")&&!L(\"MSIE\")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Na;c.Na=null;e()}};return function(e){d.next={Na:e};d=d.next;b.port2.postMessage(0)}}return\"undefined\"!==typeof document&&\"onreadystatechange\"in gd(\"SCRIPT\")?function(e){var f=gd(\"SCRIPT\");f.onreadystatechange=function(){f.onreadystatechange=null;\nf.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);Bc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!L(\"Edge\")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,Bc=new vc;function od(){for(var a;a=yc();){try{a.a.call(a.b)}catch(b){hd(b)}uc(xc,a)}nd=!1};function pd(a){this.a=qd;this.v=void 0;this.f=this.b=this.c=null;this.g=this.o=!1;if(a!=na)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new tc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}\nfunction xd(a,b,c){yd(a,b,c,null)||kd(wa(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,wa(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;\npd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}\nfunction Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ea=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ga=function(a){this.a=qd;rd(this,td,a)};\nfunction rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError(\"Promise cannot resolve to itself\")),a.a=1,yd(c,a.Ea,a.Ga,a)||(a.v=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||na,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(qa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}\nfunction Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.o||(a.o=!0,kd(a.S,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.S=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.v);this.o=!1};\nfunction Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}uc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}xa(Dd,Da);Dd.prototype.name=\"cancel\";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Ua=Fa(this.Ua,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==z&&(this.priority=c);this.b().add(this)}var Od=1,Pd={lc:0,mc:Od,kc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Ua=function(a){this.Z=3;this.a.b(a)};l.reject=function(a){this.Z=5;this.a.reject(a)};l.Z=0;\nl.cancel=function(){this.a.a.cancel();if(3>this.Z){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c&&a.a[b].splice(c,1);this.Z=4}};function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ma=a;this.ma.addEventListener(\"allocatable\",Fa(this.b,this))}t(\"H.util.JobManager\",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};\nQd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ma.nc(b))!==Ia){var d=Fa(this.ma.oc,this.ma,c,b);b.then(d,d);b.Z=b.pc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?\" out of [\"+c[0]+\"...\"+c[1]+\"]\":\"\",d.push(\"(\"+b+e+\")\"));d=Error(d.join(\" \"));Object.setPrototypeOf(d,Sd.prototype);return d}xa(Sd,Error);t(\"H.lang.OutOfRangeError\",Sd);Sd.prototype.name=\"OutOfRangeError\";var Td=\"closure_listenable_\"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ja=e;this.key=++Ud;this.U=this.da=!1}function Wd(a){a.U=!0;a.listener=null;a.proxy=null;a.src=null;a.ja=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.da=!1)):(b=new Vd(b,this.src,f,!!d,e),b.da=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}\nXd.prototype.T=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.U&&f.listener==b&&f.capture==!!c&&f.ja==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;\nif(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,\"9\"))ce=ed[\"9\"];else{for(var de=0,ee=Cc(String(ad)).split(\".\"),fe=Cc(\"9\").split(\".\"),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||\"\",je=fe[he]||\"\";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||[\"\",\"\",\"\",\"\"],le=/(\\d*)(\\D*)(.*)/.exec(je)||[\"\",\"\",\"\",\"\"];if(0==ke[0].length&&0==le[0].length)break;de=Dc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Dc(0==ke[2].length,0==le[2].length)||Dc(ke[2],le[2]);\nie=ke[3];je=le[3]}while(0==de)}ce=ed[\"9\"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},\"passive\",{get:function(){a=!0}});try{p.addEventListener(\"test\",na,b),p.removeEventListener(\"test\",na,b)}catch(c){}return a}();function oe(a,b){K.call(this,a?a.type:\"\");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key=\"\";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType=\"\";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=\n!1}e||(b=null)}}else\"mouseover\"==c?b=a.fromElement:\"mouseout\"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||\"\";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=\na.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=\"string\"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||\"\";this.b=a;a.defaultPrevented&&this.c()}}xa(oe,K);var pe={2:\"touch\",3:\"pen\",4:\"mouse\"};oe.prototype.stopPropagation=function(){oe.V.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};\noe.prototype.c=function(){oe.V.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe=\"closure_lm_\"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if(\"array\"==oa(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,qa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}\nfunction we(a,b,c,d,e,f){if(!b)throw Error(\"Invalid event type\");var g=qa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error(\"addEventListener and attachEvent are unavailable.\");se++}}\nfunction ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if(\"array\"==oa(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,qa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}\nfunction Ce(a,b,c,d,e){if(\"array\"==oa(b))for(var f=0;f<b.length;f++)Ce(a,b[f],c,d,e);else(d=qa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&De(c))}\nfunction De(a){if(\"number\"!==typeof a&&a&&!a.U){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]=\"on\"+a}\nfunction Ee(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.U&&(f=Fe(f,d),e=e&&!1!==f)}return e}function Fe(a,b){var c=a.listener,d=a.ja||a.src;a.da&&De(a);return c.call(d,b)}\nfunction Ae(a,b){if(a.U)return!0;if(!ae){if(!b)a:{b=[\"window\",\"event\"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=Ee(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=\nd[e],f=Ee(d[e],a,!1,b),c=c&&f}return c}return Fe(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Ge=\"__closure_events_fn_\"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Ge]||(a[Ge]=function(b){return a.handleEvent(b)});return a[Ge]};function N(){oc.call(this);this.b=new Xd(this);this.v=this;this.o=null}xa(N,oc);N.prototype[Td]=!0;l=N.prototype;l.J=function(){return this.o};l.Ja=function(a){this.o=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Ce(this,a,b,c,d)};\nl.dispatchEvent=function(a){var b,c=this.J();if(c)for(b=[];c;c=c.J())b.push(c);c=this.v;var d=a.type||a;if(\"string\"===typeof a)a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);Ca(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.P(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.P(d,!0,a)&&e,a.a||(e=g.P(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.P(d,!1,a)&&e;return e};\nl.ha=function(){N.V.ha.call(this);this.b&&this.b.T(void 0);this.o=null};l.P=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.U&&f.capture==b){var g=f.listener,h=f.ja||f.src;f.da&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.Ya};t(\"H.util.EventTarget\",N);N.prototype.Ja=N.prototype.Ja;N.prototype.setParentEventTarget=N.prototype.Ja;N.prototype.J=N.prototype.J;N.prototype.getParentEventTarget=N.prototype.J;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;\nN.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.O=N.prototype.O;N.prototype.dispose=N.prototype.O;N.prototype.M=N.prototype.M;N.prototype.addOnDisposeCallback=N.prototype.M;N.prototype.S=N.prototype.P;\nN.prototype.P=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?\"AT_TARGET\":b?\"CAPTURING_PHASE\":(d=!0,\"BUBBLING_PHASE\")];if(!d||\"pointerenter\"!==(e=c.type)&&\"pointerleave\"!==e)c.eventPhase=g,f=N.prototype.S.apply(this,arguments),d&&this.J&&null===this.J()&&delete c.eventPhase;return f};function O(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;O.V.constructor.call(this)}xa(O,N);t(\"H.util.ContextItem\",O);O.prototype.xb=function(){return this.g};O.prototype.getLabel=O.prototype.xb;O.prototype.ac=function(a){this.g!==a&&(this.g=a,this.dispatchEvent(\"update\"));return this};O.prototype.setLabel=O.prototype.ac;O.prototype.Nb=function(){return this.f};O.prototype.isDisabled=O.prototype.Nb;\nO.prototype.$b=function(a){a^this.f&&(this.f=a,this.dispatchEvent(\"update\"));return this};O.prototype.setDisabled=O.prototype.$b;var He=new O;O.SEPARATOR=He;function Ie(){if(y.document){var a=document.createElement(\"canvas\");a.width=a.height=1;a.getContext(\"2d\")}}t(\"H.util.getPixelRatio\",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t(\"H.util.eval\",function(a){return eval(a)});t(\"H.util.provide\",function(a){var b=p.$jscomp;if(b&&(\"function\"!=typeof b.ub?0:b.ub()))throw Error(\"goog.provide cannot be used within a module.\");ma(a,void 0)});function Je(){this.A=0}\nJe.prototype.next=function(a){if(9007199254740992===this.A)throw new Sd(a,this.A,[0,9007199254740991]);return this.A++};var Ke=new Je;Fa(Ke.next,Ke);function lc(){}var mb=Ha([]);Ha({});Ie();Ie();function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new A(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new A(b,c,a);return d}function Ne(a,b,c){var d;if(a!==z&&Ra(d=+a)&&b)throw new A(b,c,a);return d}t(\"H.geo.isDBC\",function(a,b){return 0!==(0>a^0>b)&&180<ub(b-a)});function Q(){var a=Q;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError(\"Illegal constructor \"+Ua(a));}t(\"H.geo.AbstractGeometry\",Q);Q.prototype.getBoundingBox=Q.prototype.X;Q.prototype.equals=Q.prototype.G;Q.prototype.oa=\"\";Q.prototype.wa=\"\";Q.prototype.toString=function(){return this.cb([this.oa.toUpperCase(),\" \"]).join(\"\")};Q.prototype.toString=Q.prototype.toString;Q.prototype.cc=function(){return{type:this.wa,coordinates:this.bb()}};Q.prototype.toGeoJSON=Q.prototype.cc;\nQ.prototype.ua=function(){return{type:this.oa,coordinates:this.va(),boundingBox:this.X().ua()}};Q.prototype.forWorkerMessage=Q.prototype.ua;function S(a,b,c){this.lat=Le(a,S,0);this.lng=Me(b,S,1);c!==z&&(this.alt=Ne(c,S,2))}xa(S,Q);t(\"H.geo.Point\",S);S.prototype.G=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};S.prototype.equals=S.prototype.G;S.prototype.ra=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Jb;var c=a.lat*Jb;a=1.274200158E7*yb(sb(1,qb(rb(xb((b-c)/2),2)+zb(b)*zb(c)*rb(xb((this.lng*Jb-a.lng*Jb)/2),2))))}return a};\nS.prototype.distance=S.prototype.ra;\nS.prototype.gc=function(a,b,c){if(c){if(b/=6371000.79){a*=Jb;var d=Jb*this.lat;var e=xb(d);var f=xb(b);var g=zb(b);var h=Jb*this.lng;var k=zb(d);d=yb(k*zb(a)*f+e*g);a=Cb(xb(a)*k*f,g-e*xb(d));a=(h+a+I)%(2*I)-I;k=a*Kb}return b?new S(d*Kb,(k+540)%360-180):this}a=(a%360+360)%360;if(0===(a+90)%180)return d=this.lng+b/(6371000.79*Hb*zb(this.lat*Jb))*(270===a?-360:360),new S(this.lat,(d+540)%360-180);if(b/=6371000.79){a*=Jb;h=this.lat*Jb;e=this.lng*Jb;f=h+b*zb(a);g=f-h;d=vb(Ab(f/2+Gb)/Ab(h/2+Gb));d=Ra(g/\nd)?zb(h):g/d;var m=b*xb(a)/d;ub(f)>Eb&&(f=0<f?I-f:-(I+f))}return b?new S(f*Kb,((e+m+Ib+(ub(h+g)>Eb?I:0))%Hb-I)*Kb):this};S.prototype.walk=S.prototype.gc;S.prototype.X=function(){return new V(this.lat,this.lng,this.lat,this.lng)};S.prototype.getBoundingBox=S.prototype.X;function Oe(a,b,c){var d=qa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==z&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new A(b,c,a);return d}S.validate=Oe;\nfunction Pe(a){if(!a)throw new A(Pe,0,a);return new S(a.lat,a.lng,a.alt)}S.fromIPoint=Pe;l=S.prototype;l.oa=\"Point\";l.cb=function(a){a.push(\"(\",this.lng,\" \",this.lat,\")\");return a};l.wa=\"Point\";l.bb=function(){return[this.lng,this.lat,this.alt||0]};l.va=function(){return[this.lat,this.lng,this.alt||0]};var W={};t(\"H.geo.mercator\",W);W.a=function(a){return sb(1,tb(0,.5-vb(Ab(Gb+Eb*a/180))/I/2))};W.b=function(a){return a/360+.5};W.ka=function(a,b,c){c?(c.x=W.b(b),c.y=W.a(a)):c=new E(W.b(b),W.a(a));return c};W.latLngToPoint=W.ka;W.rb=function(a,b){return W.ka(a.lat,a.lng,b)};W.geoToPoint=W.rb;W.f=function(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(I*(1-2*a)))-Eb)};W.c=function(a){return 360*(1===a?1:Mb(a,1))-180};W.W=function(a,b,c){c?(c.lat=W.f(b),c.lng=W.c(a)):c=new S(W.f(b),W.c(a));return c};\nW.xyToGeo=W.W;W.Ub=function(a,b){return W.W(a.x,a.y,b)};W.pointToGeo=W.Ub;t(\"H.util.constants.DEFAULT_MIN_ZOOM_LEVEL\",0);t(\"H.util.constants.DEFAULT_MAX_ZOOM_LEVEL\",22);function Y(a,b){this.projection=a||W;this.b=0;this.a=this.exp=vb(b||256)/Db;Qe(this);this.y=this.x=0}t(\"H.geo.PixelProjection\",Y);var Re=ub(24)+ub(-8);Y.prototype.Xb=W;Y.prototype.projection=Y.prototype.Xb;Y.prototype.x=0;Y.prototype.x=Y.prototype.x;Y.prototype.y=0;Y.prototype.y=Y.prototype.y;Y.prototype.fc=rb(2,Re);Y.prototype.w=Y.prototype.fc;Y.prototype.Hb=rb(2,Re);Y.prototype.h=Y.prototype.Hb;\nY.prototype.ca=function(a){if(Ra(a))throw new A(this.ca,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Qe(this);this.x=b*this.w;this.y=c*this.h};Y.prototype.rescale=Y.prototype.ca;function Qe(a){a.a>Re&&(a.a=Re);a.w=rb(2,a.a);a.h=rb(2,a.a)}Y.prototype.Ra=function(){return this.b||0};Y.prototype.getZoomScale=Y.prototype.Ra;Y.prototype.qb=function(a,b){a=this.projection.ka(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};Y.prototype.geoToPixel=Y.prototype.qb;\nY.prototype.Fa=function(a,b){return this.projection.W((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};Y.prototype.pixelToGeo=Y.prototype.Fa;Y.prototype.W=function(a,b,c){return this.projection.W((a+this.x)/this.w,(b+this.y)/this.h,c)};Y.prototype.xyToGeo=Y.prototype.W;Y.prototype.Ba=function(a,b,c){a=this.projection.ka(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};Y.prototype.latLngToPixel=Y.prototype.Ba;Y.prototype.Vb=function(a){return new E(a.x*this.w-this.x,a.y*this.h-this.y)};\nY.prototype.pointToPixel=Y.prototype.Vb;t(\"H.util.Disposable\",oc);oc.prototype.M=oc.prototype.M;oc.prototype.addOnDisposeCallback=oc.prototype.M;t(\"H.util.dispose\",function(a){a&&\"function\"==typeof a.O&&a.O()});function Se(){}t(\"H.util.ICancelable\",Se);Se.prototype.cancel=function(){};Se.prototype.cancel=Se.prototype.cancel;function Te(a,b,c,d){this.key=\"\";this.x=a;this.y=b;this.b=c;this.Y=d;this.a=Ad()}Te.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};Te.prototype.reject=function(a){this.a.reject(a)};Te.prototype.cancel=function(){this.a.a.cancel()};function Ue(a,b,c,d){if(!a||!b||!c)throw new A(Ue,null,\"Must specify name, version and revision parameter\");this.name=a;this.version=b;this.revision=c;d&&Ca(this,d)}t(\"H.util.BuildInfo\",Ue);Ue.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(\";\")};var Ve={};function We(a,b,c,d){if(!a)throw new A(We,1,\"Must specify a name parameter\");return Ve[a]||(Ve[a]=new Ue(a,b,c,d))}Ue.get=We;function Z(a,b,c,d,e,f){if(a&&b)this.ab(a),this.Ha(b),this.Ka(c),this.$a(e),this.Za(f),this.La(d);else throw Error('Parameters \"scheme\" and \"host\" must be specified');}t(\"H.service.Url\",Z);\nfunction Xe(a,b){var c=y.document,d,e=c&&c.createElement(\"a\"),f=\"\";if(c){if(b){var g=(d=c.getElementsByTagName(\"base\")[0])&&d.href;var h=c.head;var k=d||h.appendChild(c.createElement(\"base\"));k.href=b}e.href=a;f=e.href;b&&(d?d.href=g:h.removeChild(k))}else/[\\w]+:\\/\\//.test(a)&&(f=a);g=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(f);a=g[1];k=g[4];b=g[5];h=g[6];c=g[7];d=g[8];!g[2]&&k&&/@/.test(k)&&(k=k.split(\"@\")[1]);g=k;h=h&&0<h.length?h.substr(1):\n\"\";k={};if(c)for(e=/([?&]?([^=&+]+))(=([^&]+))?/g;f=e.exec(c);)k[decodeURIComponent(f[2])]=f[4]?decodeURIComponent(f[4]):void 0;return new Z(a,g,h,k,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):\"\")}Z.parse=Xe;var Ye=0;Z.prototype.clone=function(){Ye++;var a={},b;for(b in this.a)a[b]=this.a[b];return new Z(this.o,this.f,this.b,a,this.g,this.c)};Z.prototype.clone=Z.prototype.clone;\nZ.prototype.ab=function(a){if(!a||\"string\"!==typeof a)throw Error('The \"scheme\" parameter must be a non-empty string.');this.o=a;return this};Z.prototype.setScheme=Z.prototype.ab;Z.prototype.Eb=function(){return this.o};Z.prototype.getScheme=Z.prototype.Eb;Z.prototype.Ha=function(a){if(!a||\"string\"!==typeof a||\"-\"===a.charAt(0)||\".\"===a.charAt(0)||\".\"===a.charAt(a.length-1))throw Error('The \"host\" parameter is not a valid host name.');this.f=a;return this};Z.prototype.setHost=Z.prototype.Ha;\nZ.prototype.wb=function(){return this.f};Z.prototype.getHost=Z.prototype.wb;Z.prototype.Ka=function(a){this.b=a||void 0;return this};Z.prototype.setPath=Z.prototype.Ka;Z.prototype.Bb=function(){return this.b};Z.prototype.getPath=Z.prototype.Bb;Z.prototype.La=function(a){if(a)if(\"object\"==typeof a)this.a=a;else throw Error('Parameter \"params\" must be an object.');else this.a={};return this};Z.prototype.setQuery=Z.prototype.La;Z.prototype.Ib=function(){return!Ze(this)};Z.prototype.hasQuery=Z.prototype.Ib;\nZ.prototype.getQuery=function(){return this.a};Z.prototype.getQuery=Z.prototype.getQuery;Z.prototype.$a=function(a){if(a&&isNaN(parseInt(a,10)))throw Error('Parameter \"port\" must be a number or undefined');this.g=+a||void 0;return this};Z.prototype.setPort=Z.prototype.$a;Z.prototype.Cb=function(){return this.g};Z.prototype.getPort=Z.prototype.Cb;Z.prototype.Za=function(a){this.c=a||void 0;return this};Z.prototype.setAnchor=Z.prototype.Za;Z.prototype.sb=function(){return this.c};\nZ.prototype.getAnchor=Z.prototype.sb;Z.prototype.$=function(a){if(\"object\"!==typeof a)throw Error('Parameter \"other\" must be an object.');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&\"function\"!==typeof a[c]&&(b[c]=a[c]);return this};Z.prototype.mergeQuery=Z.prototype.$;Z.prototype.hb=function(a){if(!a||\"string\"!==typeof a)throw Error('Parameter \"subDomain\" must be a non-empty string');\".\"===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.Ha(a+\".\"+this.f)};\nZ.prototype.addSubDomain=Z.prototype.hb;Z.prototype.ib=function(a){if(!a||\"string\"!==typeof a)throw Error('Parameter \"subPath\" must be a non-empty string');return this.Ka((this.b?this.b+\"/\":\"\")+a)};Z.prototype.addSubPath=Z.prototype.ib;Z.prototype.toString=function(){return[this.o+\"://\",this.f,this.g?\":\"+this.g:\"\",this.b||!Ze(this)||this.c?\"/\":\"\",this.b?encodeURI(this.b):\"\",$e(this),this.c?\"#\"+encodeURIComponent(this.c):\"\"].join(\"\")};Z.prototype.toString=Z.prototype.toString;\nfunction $e(a){var b=[],c,d=a.a,e;for(c in d)if(d.hasOwnProperty(c)&&\"function\"!==typeof d[c]){var f=a.a[c];if(Na(f,af)){var g=0;var h=f.eb;for(e=h.length;g<e;)b.push(encodeURIComponent(c)+(void 0===f?\"\":\"=\"+encodeURIComponent(h[g]))),g++}else b.push(encodeURIComponent(c)+(void 0===f?\"\":\"=\"+encodeURIComponent(f)))}return 0<b.length?\"?\"+b.join(\"&\"):\"\"}function Ze(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&\"function\"!==typeof a.a[b]&&(c++,0<c))break;return!c}\nfunction af(a){var b;if(!Oa(a,void 0,void 0,void 0))throw new A(af,0,a);for(b=0;b<a.length;b++){var c=a[b];if(!Qa(c)&&!Sa(c))throw new A(af,0,\"The array can only contain strings and numbers\");}this.eb=a}Z.MultiValueQueryParameter=af;af.prototype.Gb=function(){return this.eb};af.prototype.getValues=af.prototype.Gb;var bf={};function cf(a){try{importScripts.apply(self,arguments)}catch(b){this.postError(\"invalid_script\")}}function df(a){bf[a]=null;this.postMessage(a)}function ef(a,b,c){if(r(b))var d=b;else try{d=self.eval(\"(\"+b+\")\"),r(d)||(d=null)}catch(e){}d?(bf[a]=d,c||this.postMessage(a)):this.postError(\"invalid_processor\")}function ff(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}ff.prototype.postError=function(a){this.postMessage(a,z,0)};\nff.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===z?1:c,data:a},b||z)};function gf(a,b,c){if(!Qa(a))throw new A(gf,0,\"InvalidArgument\");if(!r(b))throw new A(gf,1,\"InvalidArgument\");var d=hf++;jf[d]={mimeType:c||kf,lb:b};(new ff([\"3\",d,[]])).postMessage(a,[],2)}var jf={},hf=0;\nfunction lf(a,b){var c=a;if(jf[this.a]){var d=jf[this.a];var e=d.lb;delete jf[this.a];if(b)e(null,b);else{if(d.mimeType===mf){a=new Uint8Array(a);b=a.byteLength;d=\"\";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var kf=0,mf=1;function V(a,b,c,d){nf(this,Le(a,V,0),Me(b,V,1),Le(c,V,2),Me(d,V,3))}xa(V,Q);t(\"H.geo.Rect\",V);V.prototype.oa=\"Polygon\";V.prototype.cb=function(a){var b=this.m,c=this.i,d=this.l,e=this.j;a.push(\"(\",\"(\",c,\" \",b,\",\",e,\" \",b,\",\",e,\" \",d,\",\",c,\" \",d,\",\",c,\" \",b,\")\",\")\");return a};V.prototype.G=function(a){return this===a||!!a&&this.m===a.m&&this.i===a.i&&this.l===a.l&&this.j===a.j};V.prototype.equals=V.prototype.G;V.prototype.clone=function(){return new V(this.m,this.i,this.l,this.j)};\nV.prototype.clone=V.prototype.clone;function nf(a,b,c,d,e){a.i=c;a.j=e;b<d&&(c=b,b=d,d=c);a.m=b;a.l=d;a.c=a.a=a.b=null;return a}V.prototype.Qa=function(){this.c||(this.c=new S(this.m,this.i));return this.c};V.prototype.getTopLeft=V.prototype.Qa;V.prototype.Pa=function(){this.a||(this.a=new S(this.l,this.j));return this.a};V.prototype.getBottomRight=V.prototype.Pa;V.prototype.Fb=function(){return this.m};V.prototype.getTop=V.prototype.Fb;V.prototype.tb=function(){return this.l};\nV.prototype.getBottom=V.prototype.tb;V.prototype.yb=function(){return this.i};V.prototype.getLeft=V.prototype.yb;V.prototype.Db=function(){return this.j};V.prototype.getRight=V.prototype.Db;V.prototype.I=function(){this.b||(this.b=new S(this.l+(this.m-this.l)/2,of(this.i,this.K())));return this.b};V.prototype.getCenter=V.prototype.I;V.prototype.K=function(){return pf(this.i,this.j)};V.prototype.getWidth=V.prototype.K;V.prototype.R=function(){return this.m-this.l};V.prototype.getHeight=V.prototype.R;\nV.prototype.Lb=function(){return this.i>this.j};V.prototype.isCDB=V.prototype.Lb;V.prototype.Ob=function(){return!this.K()&&!this.R()};V.prototype.isEmpty=V.prototype.Ob;V.prototype.X=function(){return new V(this.m,this.i,this.l,this.j)};V.prototype.getBoundingBox=V.prototype.X;V.prototype.ea=function(a,b,c){var d=this.I();c||(a=Le(a,this.ea,0),b=Me(b,this.ea,1));b=this.L(a,b,c);a=b.I();return a.lat===d.lat&&a.lng===d.lng&&this.R()===b.R()&&this.K()===b.K()};V.prototype.containsLatLng=V.prototype.ea;\nV.prototype.fa=function(a,b){b||Oe(a,this.fa,0);return this.ea(a.lat,a.lng,b)};V.prototype.containsPoint=V.prototype.fa;V.prototype.Oa=function(a,b){var c=this.I();if(!b&&!Na(a,V))throw new A(this.Oa,0,a);b=this.la(a,b);a=b.I();return a.lat===c.lat&&a.lng===c.lng&&this.R()===b.R()&&this.K()===b.K()};V.prototype.containsRect=V.prototype.Oa;\nV.prototype.L=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new A(this.L,0,a);if(Ra(b=Me(b)))throw new A(this.L,1,b);}return qf(this.m,this.i,this.l,this.j,a,b,a,b,d)};V.prototype.mergeLatLng=V.prototype.L;V.prototype.Va=function(a,b,c){b||Oe(a,this.Va,0);return this.L(a.lat,a.lng,b,c)};V.prototype.mergePoint=V.prototype.Va;V.prototype.la=function(a,b,c){if(!b&&!Na(a,V))throw new A(this.la,0,a);return qf(this.m,this.i,this.l,this.j,a.m,a.i,a.l,a.j,c)};V.prototype.mergeRect=V.prototype.la;\nV.prototype.aa=function(a,b,c,d,e,f){e||(a=Le(a,this.aa,0),b=Me(b,this.aa,1),c=Le(c,this.aa,2),d=Me(d,this.aa,3));return qf(this.m,this.i,this.l,this.j,a,b,c,d,f)};V.prototype.mergeTopLeftBottomRight=V.prototype.aa;V.prototype.Ta=function(a,b){var c=this.i<=this.j,d=a.i<=a.j,e=this.i<a.j,f=a.i<this.j;if(!b&&!Na(a,V))throw new A(this.Ta,0,a);return this.l<=a.m&&a.l<=this.m&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};V.prototype.intersects=V.prototype.Ta;function pf(a,b){a=b-a;return a+(0>a?360:0)}\nfunction of(a,b){a+=b/2;return a-(180<a?360:0)}function qf(a,b,c,d,e,f,g,h,k){c=sb(c,g);a=tb(a,e);e=pf(b,d);var m=of(b,e);g=pf(f,h);var n=of(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?nf(k,a,m,c,q):new V(a,m,c,q)}V.merge=qf;function rf(a,b,c){c||(Oe(a,rf,0),Oe(b,rf,1));return new V(a.lat,a.lng,b.lat,b.lng)}V.fromPoints=rf;\nfunction sf(a,b){var c=1,d=a.length,e=null;var f=oa(a);if(\"array\"!=f&&(\"object\"!=f||\"number\"!=typeof a.length))throw new A(sf,0,a);if(0<d)for(f=a[0],e=rf(f,f,b);c<d;c++)f=a[c],e.L(f.lat,f.lng,b,e);return e}V.coverPoints=sf;function tf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new A(tf,0,a);if(0<d)for(e=new V(a[0],a[1],a[0],a[1]);c<d;c+=3)e.L(a[c],a[c+1],b,e);return e}V.coverLatLngAlts=tf;\nfunction uf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new A(uf,0,a);if(0<d)for(e=new V(a[0].m,a[0].i,a[0].l,a[0].j);c<d;c++)e.la(a[c],b,e);return e}V.coverRects=uf;\nV.prototype.Xa=function(a,b){var c=this.i,d=this.m,e=this.j,f=this.l,g=this.I().lng;Oe(a,this.Xa,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?nf(b,d,a,f,e):new V(d,a,f,e)};V.prototype.resizeToCenter=V.prototype.Xa;V.prototype.wa=\"Polygon\";\nV.prototype.bb=function(){return[[this.i,this.m,0],[this.j,this.m,0],[this.j,this.l,0],[this.i,this.l,0],[this.i,this.m,0]]};V.prototype.ua=function(){return this.va()};V.prototype.va=function(){return[this.m,this.i,this.l,this.j]};function vf(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var J=y.Float32Array;var M,v=[];if(b){b=La(b);a=La(a);e&&(f=La(c));c=b.length;d=d?1E-7:1E-5;for(M=new J(3*c);g<c;){J=b[g];var G=+J;var X=+a[g];e&&(q=+f[g]);wf.test(J)?0<=u&&(0<g-u&&v.push(u,g+1),u=-1):0>u&&(u=g);g++;m=M[h++]=m+X*d;k=M[h++]=k+G*d;e&&(n=M[h]=n+q);h++}0<=u&&1<c-u&&v.push(u,c)}else M=new J(0);return{path:M,outlineIndices:v}}var wf=/^-?0\\d/;\nfunction xf(a,b){for(var c=0,d=a.length/3,e=new y.Array(d),f=0;c<d;)e[c++]=b.Ba(a[f],a[++f]),f+=2;return e};function yf(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var zf=1/Math.pow(10,10);function Af(a,b){var c=[],d=a.Qa();a=a.Pa();var e;180==a.lng&&(a.lng-=zf);d=yf(d,b);a=yf(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Bf(a,b){var c=a.tileSize||256;this.b={};this.v=Xe(a.serverUrl);this.g=b;this.dc=a.layerConfigs||[];this.o=a.projected;this.S=c;this.Ea=!1!==a.batchTiles;this.Ga=a.horizontalMargin||0;this.ec=a.onlyOutline;this.fb=new Y(Ia,c);this.f=new Y(Ia,c);this.f.ca(22-Math.log(c)/Math.LN2+8)}xa(Bf,oc);l=Bf.prototype;\nl.Zb=function(a,b,c){var d=this.S,e=this.Ga,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.fb;e.ca(c);f=e.Fa(f);d=e.Fa(d);return Cf(this,new V(f.lat,f.lng,d.lat,d.lng),this.dc,{x:a,y:b,z:c})};l.Yb=function(a,b,c,d,e){return Cf(this,new V(a,b,c,d),e)};\nfunction Cf(a,b,c,d){var e=Df(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var J=q.level;g[u]=q.columns;q=Af(b,J);var M=q.length-1;for(h=0;h<M;h+=2){var v=[u,q[h+1],q[h],J].join(\"_\");var G=k[v]||a.g.get(v);G||(G=new Te(q[h+1],q[h],J,u),G.key=v,k[v]=G,n.push(G));m.push(G)}}n.length&&(a.Ea?Ef(a,n):Ff(a,n));return zd(m.map(function(X){return X.then(Fa(this.ob,this,X.Y,Gf(e))).then(Fa(this.Wb,this,X,d||{})).then(Fa(this.pb,this,g[X.Y]))},a))}\nl.ob=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new D(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ia(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Ff(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Hf(a,k,m)}var d,e=b.length,f=a.v;for(d=0;d<e;d++){var g=b[d];var h=f.clone().$({tilex:g.x}).$({tiley:g.y}).$({level:g.b}).$({layer:g.Y});new gf(h.toString(),Fa(c,null,g),mf)}}\nfunction Ef(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);If(a,e)}}function If(a,b){var c=a.v.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.Y)}),g.tilexy=d.join(\",\"),g.layers=f.join(\",\"),g.levels=e.join(\",\"),c.La(g),new gf(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject(\"error\")}):Hf(a,b,h)},mf))}\nfunction Hf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf(\"[\")+1;for(e=0;e<d;e++){var g=c.indexOf(\"]},{\",f+3)+2;g<f&&(g=c.lastIndexOf(\"]}\"));var h=c.substr(f,g-f);f=g+1;Jf(a,b[e],h)}}else Jf(a,b,c)}function Jf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}\nfunction Gf(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==z?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Kf(a,b,c,d,e){return e?[new E(a,b),new E(c,b),new E(c,d),new E(a,d),new E(a,b)]:[a,b,c,b,c,d,a,d]}\nl.Wb=function(a,b,c){var d=this.f.Ra()-b.z,e=this.S<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,J=c.Rows,M=J.length,v,G=/^ADAS/.test(a.Y),X=this.f,pa=this.ec,R,ab=[],Ja=[],Ka=[],bb=[];for(a=0;a<M;a++){var w=v=J[a];var P=(R=G)?\"HPY\":\"LAT\";var T=R?\"HPX\":\"LON\";var ea=R?\"HPZ\":\"ZLEVEL\";if(w[P]){var U=vf(w[P],w[T],w[ea],R);w.geometry=U;delete w[P];delete w[T];delete w[ea];if(w.INNER_LAT)for(P=w.INNER_LAT.split(\";\"),U=w.INNER_LON.split(\";\"),delete w.INNER_LAT,delete w.INNER_LON,\nw.interiors=ea=[],T=P.length,w=0;w<T;w++)ea.push(vf(P[w],U[w],\"\",R))}if(this.o){R=void 0;T=v;U=X;P=T.$$projected$$;if(!P){var aa=T.geometry;w=xf(aa.path,U);v=[w];T.$$projected$$=P={Tb:v};T=(ea=T.interiors)?ea.length:0;v.length+=T;R|=Lf(v,w,aa.outlineIndices);if(T)for(P.Jb=1,q=0;q<T;q++)aa=ea[q],w=xf(aa.path,U),v[1+q]=w,R|=Lf(v,w,aa.outlineIndices);R&&(P.Rb=1+T)}w=P;R=w.Tb;v=w.Jb;var zc=w.Rb;U=[];P=T=Lb;var cb=ea=z;w=R[0];if(1===w.length){var Ac=Ac||(Ac=Kf(g,b,h,e,!1));v=w[0];Rb(v.x,v.y,Ac)&&U.push(Mf(w,\ng,b,d))}else{var Be=R.length;for(aa=pa?zc:0;aa<Be&&(pa||!aa||U.length);aa++)if(w=R[aa],aa>=zc){aa===zc&&(P=U.length);var ja=Ub([w],k,m,n,f,!1);Nf(ja,g,b,d,U)}else{var Fb=Fb||(Fb=Kf(k,m,n,f,!0));if(aa>=v)if(aa===v&&(T=U.length),cb)for(q=cb.length;q--;){if(ja=Of(cb[q],w),u=ja.length){for(ea=ea||[];u--;)ea.push(q);Nf(ja,g,b,d,U)}}else ja=Of(Fb,w),Nf(ja,g,b,d,U);else if(ja=Of(Fb,w),Nf(ja,g,b,d,U),1<ja.length&&v<Be)for(cb=[],q=ja.length;q--;)cb[q]=ja[q]}}U.length&&(ab[a]=U,Ja[a]=T,Ka[a]=ea,bb[a]=P)}}return{bc:c,\nmb:ab,Kb:Ja,nb:Ka,Sb:bb}};function Lf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Of(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Wa)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Nf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Mf(a[f],b,c,d))}\nfunction Mf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}\nl.pb=function(a,b){var c=b.bc,d=b.mb,e=b.Kb,f=b.Sb;b=b.nb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,J=c.Rows,M=J.length,v;q<M;q+=1)if(d[q]||!this.o){h={};u=J[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(v in u)\"$$projected$$\"!==v&&(h[v]=u[v]);u.geometry&&(h.geometry=u.geometry);m=void 0;var G,X=h,pa=d[q],R=e[q],ab=b[q],Ja=f[q],Ka=g;if(pa){var bb=pa.length;if(ab)for(G=R;G--;){if(G){var w={};for(m in X)w[m]=X[m]}else w=X;u=[pa[G]];var P=sb(bb,Ja)-R;for(h=0;h<P;h++)ab[h]===\nG&&u.push(pa[R+h]);P=u.length;if(!G)for(h=Ja;h<bb;h++)u.push(pa[h]);w.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:P};Ka.push(w)}else X.$HProjGeometry={paths:pa,interiorsIndex:R,outlinesIndex:Ja},Ka.push(X)}else Ka.push(X)}c.Meta&&(k.Meta=c.Meta);return k};l.ha=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject(\"disposed\"),delete b[a])};\nfunction Df(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=Aa(a[e]);if(c.rowFilter&&(c.rowFilter=eval(\"(\"+c.rowFilter+\")\"),!r(c.rowFilter)))throw Error(\"Invalid row filter for layer \"+c.layerId);b.push(c)}return b};t(\"H.service.extension.worker.processor\",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=za[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(za[a]=new Bf(c,Pf)),this.postMessage();else if(f)switch(b){case 1:try{f.Zb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.Yb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.O();delete za[a];ya()&&Pf.T();break;default:e.postError(\"Unsupported command\")}else e.postError(\"TileProvider is not initialized\")});\nvar Pf=new B(26214400),za=Object.create(Ia,void 0);function Qf(a,b,c){var d=a[b];a=a[b+1];this.Sa=[];this.Ma=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Qf.prototype.fa=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Qf.prototype.I=function(){return this.b};var Rf=new E(0,0);function Sf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Tf=new Y;function Uf(a,b,c,d,e){Tf.Ba(a,b,Rf);d[e]=Rf.x;d[e+1]=Rf.y}\nt(\"H.clustering.dynamicgrid.worker\",function(a,b,c,d,e){var f=e?Sf:Uf,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Tf.ca(d);g<h.length;){var J=h[g++];var M=h[g++];var v=h[g++];f(v,M,d,q,u);for(v=a.length;v--;)if(M=a[v],M.fa(q,u)){var G=M;break}G||(G=new Qf(q,u,b),a.push(G));v=u/2;G.Ma+=J||1;G.Sa.push(v);G=null;u+=2}for(v=a.length;v--;)M=a[v],b=M.Ma>=c,f=M.Sa,d=f.length,b?(m.push(d),m=m.concat(f)):\n(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener(\"message\",function(a){a=new ff(a.data);var b=bf[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError(\"processor_not_found\")});(function(){var a=new ff;var b=function(c,d){ef.apply(a,[c,d,!0])};b(\"0\",cf);b(\"1\",ef);b(\"2\",df);b(\"3\",lf)})();\n";
!function(){var e=function(){var W_,Z_,K_;"undefined"!=typeof self&&("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)||!("undefined"!=typeof module&&module.exports||"undefined"!=typeof window)||(W_=e.toString(),Z_="",K_="undefined"!=typeof document&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:""),function(){"use strict";function n(e){return t.call(e).slice(8,-1)}var t={}.toString,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e,t){return e(t={exports:{}},t.exports),t.exports}function r(e){return e&&e.Math==Math&&e}function o(e){try{return!!e()}catch(e){return!0}}function a(e){return"object"==typeof e?null!==e:"function"==typeof e}function s(e){return m?v.createElement(e):{}}function d(e){if(!a(e))throw TypeError(String(e)+" is not an object");return e}function l(e,t){if(!a(e))return e;var i,r;if(t&&"function"==typeof(i=e.toString)&&!a(r=i.call(e)))return r;if("function"==typeof(i=e.valueOf)&&!a(r=i.call(e)))return r;if(!t&&"function"==typeof(i=e.toString)&&!a(r=i.call(e)))return r;throw TypeError("Can't convert object to primitive value")}function x(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function c(t,i){try{A(p,t,i)}catch(e){p[t]=i}return i}function u(e){return"Symbol(".concat(void 0===e?"":e,")_",(++k+E).toString(36))}function h(e){return R[e]||(R[e]=M&&S[e]||(M?S:u)("Symbol."+e))}function _(e){var t,i,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),P))?i:z?n(t):"Object"==(r=n(t))&&"function"==typeof t.callee?"Arguments":r}var f="object",p=r(typeof globalThis==f&&globalThis)||r(typeof window==f&&window)||r(typeof self==f&&self)||r(typeof e==f&&e)||Function("return this")(),g=!o(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),v=p.document,m=a(v)&&a(v.createElement),y=!g&&!o(function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}),b=Object.defineProperty,w={f:g?b:function(e,t,i){if(d(e),t=l(t,!0),d(i),y)try{return b(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},A=g?function(e,t,i){return w.f(e,t,x(1,i))}:function(e,t,i){return e[t]=i,e},T=i(function(e){var t="__core-js_shared__",i=p[t]||c(t,{});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})}),k=0,E=Math.random(),M=!o(function(){return!String(Symbol())}),R=T("wks"),S=p.Symbol,P=h("toStringTag"),z="Arguments"==n(function(){return arguments}()),N={};N[h("toStringTag")]="z";function O(e,t){return q.call(e,t)}function I(e){return Z[e]||(Z[e]=u(e))}var L,C,F,D,j,U,G,B,V="[object z]"!==String(N)?function(){return"[object "+_(this)+"]"}:N.toString,q={}.hasOwnProperty,Y=T("native-function-to-string",Function.toString),X=p.WeakMap,W="function"==typeof X&&/native code/.test(Y.call(X)),Z=T("keys"),K={},$=p.WeakMap;G=W?(L=new $,C=L.get,F=L.has,D=L.set,j=function(e,t){return D.call(L,e,t),t},U=function(e){return C.call(L,e)||{}},function(e){return F.call(L,e)}):(B=I("state"),K[B]=!0,j=function(e,t){return A(e,B,t),t},U=function(e){return O(e,B)?e[B]:{}},function(e){return O(e,B)});var J={set:j,get:U,has:G,enforce:function(e){return G(e)?U(e):j(e,{})},getterFor:function(i){return function(e){var t;if(!a(e)||(t=U(e)).type!==i)throw TypeError("Incompatible receiver, "+i+" required");return t}}},Q=i(function(e){var t=J.get,s=J.enforce,l=String(Y).split("toString");T("inspectSource",function(e){return Y.call(e)}),(e.exports=function(e,t,i,r){var n=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet;"function"==typeof i&&("string"!=typeof t||O(i,"name")||A(i,"name",t),s(i).source=l.join("string"==typeof t?t:"")),e!==p?(n?!a&&e[t]&&(o=!0):delete e[t],o?e[t]=i:A(e,t,i)):o?e[t]=i:c(t,i)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||Y.call(this)})}),ee=Object.prototype;V!==ee.toString&&Q(ee,"toString",V,{unsafe:!0});function te(e){return isNaN(e=+e)?0:(0<e?de:fe)(e)}function ie(e){if(null==e)throw TypeError("Can't call method on "+e);return e}function re(e){return me(ie(e))}function ne(e){return 0<e?be(te(e),9007199254740991):0}function oe(e,t){var i,r=re(e),n=0,o=[];for(i in r)!O(K,i)&&O(r,i)&&o.push(i);for(;t.length>n;)O(r,i=t[n++])&&(~Te(o,i)||o.push(i));return o}function ae(e,t){var i=Oe[Ne(e)];return i==Le||i!=Ie&&("function"==typeof t?o(t):!!t)}function se(e,t){var i,r,n,o,a=e.target,s=e.global,l=e.stat,u=s?p:l?p[a]||c(a,{}):(p[a]||{}).prototype;if(u)for(i in t){if(n=t[i],r=e.noTargetGet?(o=Fe(u,i))&&o.value:u[i],!Ce(s?i:a+(l?".":"#")+i,e.forced)&&void 0!==r){if(typeof n==typeof r)continue;!function(e,t){for(var i=Pe(t),r=w.f,n=xe.f,o=0;o<i.length;o++){var a=i[o];O(e,a)||r(e,a,n(t,a))}}(n,r)}(e.sham||r&&r.sham)&&A(n,"sham",!0),Q(u,i,n,e)}}var le,ue,ce,he,fe=Math.ceil,de=Math.floor,_e={}.propertyIsEnumerable,pe=Object.getOwnPropertyDescriptor,ge={f:pe&&!_e.call({1:2},1)?function(e){var t=pe(this,e);return!!t&&t.enumerable}:_e},ve="".split,me=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==n(e)?ve.call(e,""):Object(e)}:Object,ye=Object.getOwnPropertyDescriptor,xe={f:g?ye:function(e,t){if(e=re(e),t=l(t,!0),y)try{return ye(e,t)}catch(e){}if(O(e,t))return x(!ge.f.call(e,t),e[t])}},be=Math.min,we=Math.max,Ae=Math.min,Te=(le=!1,function(e,t,i){var r,n,o,a=re(e),s=ne(a.length),l=(r=s,(n=te(i))<0?we(n+r,0):Ae(n,r));if(le&&t!=t){for(;l<s;)if((o=a[l++])!=o)return!0}else for(;l<s;l++)if((le||l in a)&&a[l]===t)return le||l||0;return!le&&-1}),ke=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ee=ke.concat("length","prototype"),Me={f:Object.getOwnPropertyNames||function(e){return oe(e,Ee)}},Re={f:Object.getOwnPropertySymbols},Se=p.Reflect,Pe=Se&&Se.ownKeys||function(e){var t=Me.f(d(e)),i=Re.f;return i?t.concat(i(e)):t},ze=/#|\.prototype\./,Ne=ae.normalize=function(e){return String(e).replace(ze,".").toLowerCase()},Oe=ae.data={},Ie=ae.NATIVE="N",Le=ae.POLYFILL="P",Ce=ae,Fe=xe.f,De=!o(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),je=I("IE_PROTO"),Ue=Object.prototype,Ge=De?Object.getPrototypeOf:function(e){return e=Object(ie(e)),O(e,je)?e[je]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Ue:null},Be=h("iterator"),Ve=!1;[].keys&&("next"in(he=[].keys())?(ce=Ge(Ge(he)))!==Object.prototype&&(ue=ce):Ve=!0),null==ue&&(ue={}),O(ue,Be)||A(ue,Be,function(){return this});function qe(){}var He={IteratorPrototype:ue,BUGGY_SAFARI_ITERATORS:Ve},Ye=Object.keys||function(e){return oe(e,ke)},Xe=g?Object.defineProperties:function(e,t){d(e);for(var i,r=Ye(t),n=r.length,o=0;o<n;)w.f(e,i=r[o++],t[i]);return e},We=p.document,Ze=We&&We.documentElement,Ke=I("IE_PROTO"),$e="prototype",Je=function(){var e,t=s("iframe"),i=ke.length,r="script";for(t.style.display="none",Ze.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object</"+r+">"),e.close(),Je=e.F;i--;)delete Je[$e][ke[i]];return Je()},Qe=Object.create||function(e,t){var i;return null!==e?(qe[$e]=d(e),i=new qe,qe[$e]=null,i[Ke]=e):i=Je(),void 0===t?i:Xe(i,t)};K[Ke]=!0;function et(e,t,i){e&&!O(e=i?e:e.prototype,ot)&&nt(e,ot,{configurable:!0,value:t})}function tt(){return this}function it(){return this}function rt(e,t,i,r,n,o,a){var s,l,u;function c(e){if(e===n&&m)return m;if(!ht&&e in g)return g[e];switch(e){case"keys":case ft:case dt:return function(){return new i(this,e)}}return function(){return new i(this)}}l=r,u=t+" Iterator",(s=i).prototype=Qe(st,{next:x(1,l)}),et(s,u,!1),at[u]=tt;var h,f,d,_=t+" Iterator",p=!1,g=e.prototype,v=g[ut]||g["@@iterator"]||n&&g[n],m=!ht&&v||c(n),y="Array"==t&&g.entries||v;if(y&&(h=Ge(y.call(new e)),ct!==Object.prototype&&h.next&&(Ge(h)!==ct&&(lt?lt(h,ct):"function"!=typeof h[ut]&&A(h,ut,it)),et(h,_,!0))),n==ft&&v&&v.name!==ft&&(p=!0,m=function(){return v.call(this)}),g[ut]!==m&&A(g,ut,m),at[t]=m,n)if(f={values:c(ft),keys:o?m:c("keys"),entries:c(dt)},a)for(d in f)!ht&&!p&&d in g||Q(g,d,f[d]);else se({target:t,proto:!0,forced:ht||p},f);return f}var nt=w.f,ot=h("toStringTag"),at={},st=He.IteratorPrototype,lt=Object.setPrototypeOf||("__proto__"in{}?function(){var i,r=!1,e={};try{(i=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return function(e,t){if(d(e),!a(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(e,t),r?i.call(e,t):e.__proto__=t,e}}():void 0),ut=h("iterator"),ct=He.IteratorPrototype,ht=He.BUGGY_SAFARI_ITERATORS,ft="values",dt="entries",_t="String Iterator",pt=J.set,gt=J.getterFor(_t);rt(String,"String",function(e){pt(this,{type:_t,string:String(e),index:0})},function(){var e,t,i,r,n,o,a,s,l=gt(this),u=l.string,c=l.index;return c>=u.length?{value:void 0,done:!0}:(t=c,i=!0,o=String(ie(u)),a=te(t),s=o.length,e=a<0||s<=a?i?"":void 0:(r=o.charCodeAt(a))<55296||56319<r||a+1===s||(n=o.charCodeAt(a+1))<56320||57343<n?i?o.charAt(a):r:i?o.slice(a,a+2):n-56320+(r-55296<<10)+65536,l.index+=e.length,{value:e,done:!1})});var vt={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},mt=h("unscopables"),yt=Array.prototype;null==yt[mt]&&A(yt,mt,Qe(null));function xt(e){yt[mt][e]=!0}var bt="Array Iterator",wt=J.set,At=J.getterFor(bt),Tt=rt(Array,"Array",function(e,t){wt(this,{type:bt,target:re(e),index:0,kind:t})},function(){var e=At(this),t=e.target,i=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==i?{value:r,done:!1}:"values"==i?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");at.Arguments=at.Array,xt("keys"),xt("values"),xt("entries");var kt=h("iterator"),Et=h("toStringTag"),Mt=Tt.values;for(var Rt in vt){var St=p[Rt],Pt=St&&St.prototype;if(Pt){if(Pt[kt]!==Mt)try{A(Pt,kt,Mt)}catch(e){Pt[kt]=Mt}if(Pt[Et]||A(Pt,Et,Rt),vt[Rt])for(var zt in Tt)if(Pt[zt]!==Tt[zt])try{A(Pt,zt,Tt[zt])}catch(e){Pt[zt]=Tt[zt]}}}function Nt(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}function Ot(r,n,e){if(Nt(r),void 0===n)return r;switch(e){case 0:return function(){return r.call(n)};case 1:return function(e){return r.call(n,e)};case 2:return function(e,t){return r.call(n,e,t)};case 3:return function(e,t,i){return r.call(n,e,t,i)}}return function(){return r.apply(n,arguments)}}var It=h("iterator"),Lt=Array.prototype,Ct=h("iterator"),Ft=i(function(e){var f={};(e.exports=function(e,t,i,r,n){var o,a,s,l,u,c,h=Ot(t,i,r?2:1);if(n)o=e;else{if("function"!=typeof(a=function(e){if(null!=e)return e[Ct]||e["@@iterator"]||at[_(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(c=a)&&(at.Array===c||Lt[It]===c)){for(s=0,l=ne(e.length);s<l;s++)if((r?h(d(u=e[s])[0],u[1]):h(e[s]))===f)return f;return}o=a.call(e)}for(;!(u=o.next()).done;)if(function(t,e,i,r){try{return r?e(d(i)[0],i[1]):e(i)}catch(e){var n=t.return;throw void 0!==n&&d(n.call(t)),e}}(o,h,u.value,r)===f)return f}).BREAK=f}),Dt=h("iterator"),jt=!1;try{var Ut=0;({next:function(){return{done:!!Ut++}},return:function(){jt=!0}})[Dt]=function(){return this}}catch(e){}function Gt(e,t){var i,r=d(e).constructor;return void 0===r||null==(i=d(r)[Zt])?t:Nt(i)}function Bt(e){var t;ri.hasOwnProperty(e)&&(t=ri[e],delete ri[e],t())}function Vt(e){return function(){Bt(e)}}function qt(e){Bt(e.data)}function Ht(e){p.postMessage(e+"",Kt.protocol+"//"+Kt.host)}var Yt,Xt,Wt,Zt=h("species"),Kt=p.location,$t=p.setImmediate,Jt=p.clearImmediate,Qt=p.process,ei=p.MessageChannel,ti=p.Dispatch,ii=0,ri={},ni="onreadystatechange";$t&&Jt||($t=function(e){for(var t=[],i=1;i<arguments.length;)t.push(arguments[i++]);return ri[++ii]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Yt(ii),ii},Jt=function(e){delete ri[e]},"process"==n(Qt)?Yt=function(e){Qt.nextTick(Vt(e))}:ti&&ti.now?Yt=function(e){ti.now(Vt(e))}:ei?(Wt=(Xt=new ei).port2,Xt.port1.onmessage=qt,Yt=Ot(Wt.postMessage,Wt,1)):!p.addEventListener||"function"!=typeof postMessage||p.importScripts||o(Ht)?Yt=ni in s("script")?function(e){Ze.appendChild(s("script"))[ni]=function(){Ze.removeChild(this),Bt(e)}}:function(e){setTimeout(Vt(e),0)}:(Yt=Ht,p.addEventListener("message",qt,!1)));var oi,ai,si,li,ui,ci,hi,fi={set:$t,clear:Jt},di=p.navigator,_i=di&&di.userAgent||"",pi=xe.f,gi=fi.set,vi=p.MutationObserver||p.WebKitMutationObserver,mi=p.process,yi=p.Promise,xi="process"==n(mi),bi=pi(p,"queueMicrotask"),wi=bi&&bi.value;wi||(oi=function(){var e,t;for(xi&&(e=mi.domain)&&e.exit();ai;){t=ai.fn,ai=ai.next;try{t()}catch(e){throw ai?li():si=void 0,e}}si=void 0,e&&e.enter()},li=xi?function(){mi.nextTick(oi)}:vi&&!/(iphone|ipod|ipad).*applewebkit/i.test(_i)?(ui=!0,ci=document.createTextNode(""),new vi(oi).observe(ci,{characterData:!0}),function(){ci.data=ui=!ui}):yi&&yi.resolve?(hi=yi.resolve(void 0),function(){hi.then(oi)}):function(){gi.call(p,oi)});function Ai(e){var i,r;this.promise=new e(function(e,t){if(void 0!==i||void 0!==r)throw TypeError("Bad Promise constructor");i=e,r=t}),this.resolve=Nt(i),this.reject=Nt(r)}function Ti(e,t){if(d(e),a(t)&&t.constructor===e)return t;var i=ji.f(e);return(0,i.resolve)(t),i.promise}function ki(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}function Ei(e){return"function"==typeof e?e:void 0}function Mi(e,t){return arguments.length<2?Ei(Ui[e])||Ei(p[e]):Ui[e]&&Ui[e][t]||p[e]&&p[e][t]}function Ri(e){var t;return!(!a(e)||"function"!=typeof(t=e.then))&&t}function Si(c,h,t){var i;h.notified||(h.notified=!0,i=h.reactions,Di(function(){for(var l=h.value,u=1==h.state,e=0;i.length>e;)!function(e){var t,i,r,n=u?e.ok:e.fail,o=e.resolve,a=e.reject,s=e.domain;try{n?(u||(2===h.rejection&&cr(c,h),h.rejection=1),!0===n?t=l:(s&&s.enter(),t=n(l),s&&(s.exit(),r=!0)),t===e.promise?a(Zi("Promise-chain cycle")):(i=Ri(t))?i.call(t,o,a):o(t)):a(l)}catch(e){s&&!r&&s.exit(),a(e)}}(i[e++]);h.reactions=[],h.notified=!1,t&&!h.rejection&&lr(c,h)}))}function Pi(e,t,i){var r,n;nr?((r=Ki.createEvent("Event")).promise=t,r.reason=i,r.initEvent(e,!1,!0),p.dispatchEvent(r)):r={promise:t,reason:i},(n=p["on"+e])?n(r):e===or&&function(e,t){var i=p.console;i&&i.error&&(1===arguments.length?i.error(e):i.error(e,t))}("Unhandled promise rejection",i)}function zi(t,i,r,n){return function(e){t(i,r,e,n)}}function Ni(e,t,i,r){t.done||(t.done=!0,r&&(t=r),t.value=i,t.state=2,Si(e,t,!0))}var Oi,Ii,Li,Ci,Fi,Di=wi||function(e){var t={fn:e,next:void 0};si&&(si.next=t),ai||(ai=t,li()),si=t},ji={f:function(e){return new Ai(e)}},Ui=p,Gi=h("species"),Bi="Promise",Vi=fi.set,qi=h("species"),Hi=J.get,Yi=J.set,Xi=J.getterFor(Bi),Wi=p[Bi],Zi=p.TypeError,Ki=p.document,$i=p.process,Ji=p.fetch,Qi=$i&&$i.versions,er=Qi&&Qi.v8||"",tr=ji.f,ir=tr,rr="process"==n($i),nr=!!(Ki&&Ki.createEvent&&p.dispatchEvent),or="unhandledrejection",ar=Ce(Bi,function(){function t(){}var e=Wi.resolve(1),i=(e.constructor={})[qi]=function(e){e(t,t)};return!((rr||"function"==typeof PromiseRejectionEvent)&&e.then(t)instanceof i&&0!==er.indexOf("6.6")&&-1===_i.indexOf("Chrome/66"))}),sr=ar||!function(e,t){if(!t&&!jt)return!1;var i=!1;try{var r={};r[Dt]=function(){return{next:function(){return{done:i=!0}}}},e(r)}catch(e){}return i}(function(e){Wi.all(e).catch(function(){})}),lr=function(i,r){Vi.call(p,function(){var e,t=r.value;if(ur(r)&&(e=ki(function(){rr?$i.emit("unhandledRejection",t,i):Pi(or,i,t)}),r.rejection=rr||ur(r)?2:1,e.error))throw e.value})},ur=function(e){return 1!==e.rejection&&!e.parent},cr=function(e,t){Vi.call(p,function(){rr?$i.emit("rejectionHandled",e):Pi("rejectionhandled",e,t.value)})},hr=function(i,r,e,t){if(!r.done){r.done=!0,t&&(r=t);try{if(i===e)throw Zi("Promise can't be resolved itself");var n=Ri(e);n?Di(function(){var t={done:!1};try{n.call(e,zi(hr,i,t,r),zi(Ni,i,t,r))}catch(e){Ni(i,t,e,r)}}):(r.value=e,r.state=1,Si(i,r,!1))}catch(e){Ni(i,{done:!1},e,r)}}};ar&&(Wi=function(e){!function(e,t,i){if(!(e instanceof t))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation")}(this,Wi,Bi),Nt(e),Oi.call(this);var t=Hi(this);try{e(zi(hr,this,t),zi(Ni,this,t))}catch(e){Ni(this,t,e)}},(Oi=function(){Yi(this,{type:Bi,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(e,t,i){for(var r in t)Q(e,r,t[r],i);return e}(Wi.prototype,{then:function(e,t){var i=Xi(this),r=tr(Gt(this,Wi));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=rr?$i.domain:void 0,i.parent=!0,i.reactions.push(r),0!=i.state&&Si(this,i,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Ii=function(){var e=new Oi,t=Hi(e);this.promise=e,this.resolve=zi(hr,e,t),this.reject=zi(Ni,e,t)},ji.f=tr=function(e){return e===Wi||e===Li?new Ii:ir(e)},"function"==typeof Ji&&se({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Ti(Wi,Ji.apply(p,arguments))}})),se({global:!0,wrap:!0,forced:ar},{Promise:Wi}),et(Wi,Bi,!1),Ci=Mi(Bi),Fi=w.f,g&&Ci&&!Ci[Gi]&&Fi(Ci,Gi,{configurable:!0,get:function(){return this}}),Li=Ui[Bi],se({target:Bi,stat:!0,forced:ar},{reject:function(e){var t=tr(this);return t.reject.call(void 0,e),t.promise}}),se({target:Bi,stat:!0,forced:ar},{resolve:function(e){return Ti(this,e)}}),se({target:Bi,stat:!0,forced:sr},{all:function(e){var s=this,t=tr(s),l=t.resolve,u=t.reject,i=ki(function(){var r=Nt(s.resolve),n=[],o=0,a=1;Ft(e,function(e){var t=o++,i=!1;n.push(void 0),a++,r.call(s,e).then(function(e){i||(i=!0,n[t]=e,--a||l(n))},u)}),--a||l(n)});return i.error&&u(i.value),t.promise},race:function(e){var i=this,r=tr(i),n=r.reject,t=ki(function(){var t=Nt(i.resolve);Ft(e,function(e){t.call(i,e).then(r.resolve,n)})});return t.error&&n(t.value),r.promise}}),se({target:"Promise",proto:!0,real:!0},{finally:function(t){var i=Gt(this,Mi("Promise")),e="function"==typeof t;return this.then(e?function(e){return Ti(i,t()).then(function(){return e})}:t,e?function(e){return Ti(i,t()).then(function(){throw e})}:t)}});var fr,dr;Ui.Promise;function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gr(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vr(e,t,i){return t&&gr(e.prototype,t),i&&gr(e,i),e}function mr(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yr(t,e){var i,r=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)),r}function xr(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?yr(Object(i),!0).forEach(function(e){mr(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):yr(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function br(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ar(e,t)}function wr(e){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ar(e,t){return(Ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function kr(e,t,i){return(kr=Tr()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&Ar(n,i.prototype),n}).apply(null,arguments)}function Er(e){var r="function"==typeof Map?new Map:void 0;return(Er=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,i)}function i(){return kr(e,arguments,wr(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ar(i,e)})(e)}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rr(o){var a=Tr();return function(){var e,t,i,r,n=wr(o);return t=a?(e=wr(this).constructor,Reflect.construct(n,arguments,e)):n.apply(this,arguments),i=this,!(r=t)||"object"!=typeof r&&"function"!=typeof r?Mr(i):r}}function Sr(e,t,i){return(Sr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wr(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function Pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var i=[],r=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return i}(e,t)||Nr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zr(e){return function(e){if(Array.isArray(e))return Or(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Nr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nr(e,t){if(e){if("string"==typeof e)return Or(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Or(e,t):void 0}}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function Ir(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=Nr(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])}return t}),"function"!=typeof Object.values&&(Object.values=function(t){return Object.keys(t).map(function(e){return t[e]})}),Math.hypot=Math.hypot||function(){for(var e=0,t=arguments.length,i=0;i<t;i++){if(arguments[i]===1/0||arguments[i]===-1/0)return 1/0;e+=arguments[i]*arguments[i]}return Math.sqrt(e)},Math.log2=Math.log2||function(e){return Math.log(e)*Math.LOG2E},"undefined"!=typeof window?("performance"in window==!1&&(window.performance={}),fr=window.performance):"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&("performance"in self==!1&&(self.performance={}),fr=self.performance),fr&&"function"!=typeof fr.now&&(dr=+new Date,fr.now=function(){return new Date-dr});var Lr=Cr;function Cr(e,t){this.x=e,this.y=t}Cr.prototype={clone:function(){return new Cr(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,i=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=i,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),r=t*this.x-i*this.y,n=i*this.x+t*this.y;return this.x=r,this.y=n,this},_rotateAround:function(e,t){var i=Math.cos(e),r=Math.sin(e),n=t.x+i*(this.x-t.x)-r*(this.y-t.y),o=t.y+r*(this.x-t.x)+i*(this.y-t.y);return this.x=n,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Cr.convert=function(e){return!(e instanceof Cr)&&Array.isArray(e)?new Cr(e[0],e[1]):e};var Fr=Dr;function Dr(e,t,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=n,e.readFields(jr,this,t)}function jr(e,t,i){1==e?t.id=i.readVarint():2==e?function(e,t){var i=e.readVarint()+e.pos;for(;e.pos<i;){var r=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[r]=n}}(i,t):3==e?t.type=i.readVarint():4==e&&(t._geometry=i.pos)}Dr.types=["Unknown","Point","LineString","Polygon"],Dr.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i,r=e.readVarint()+e.pos,n=1,o=0,a=0,s=0,l=[];e.pos<r;){if(o||(n=7&(i=e.readVarint()),o=i>>3),o--,1===n||2===n)a+=e.readSVarint(),s+=e.readSVarint(),1===n&&(t&&l.push(t),t=[]),t.push(new Lr(a,s));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&l.push(t),l},Dr.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,r=1,n=0,o=0,a=0,s=1/0,l=-1/0,u=1/0,c=-1/0;e.pos<i;){if(n||(r=7&(t=e.readVarint()),n=t>>3),n--,1===r||2===r)(o+=e.readSVarint())<s&&(s=o),l<o&&(l=o),(a+=e.readSVarint())<u&&(u=a),c<a&&(c=a);else if(7!==r)throw new Error("unknown command "+r)}return[s,u,l,c]},Dr.prototype.toGeoJSON=function(e,t,i){var r,n=this.extent*Math.pow(2,i),o=this.extent*e,a=this.extent*t,s=this.loadGeometry(),l=Dr.types[this.type];function u(e){for(var t=0;t<e.length;t++){var i=e[t],r=180-360*(i.y+a)/n;e[t]=[360*(i.x+o)/n-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:for(var c=[],h=0;h<s.length;h++)c[h]=s[h][0];u(s=c);break;case 2:for(h=0;h<s.length;h++)u(s[h]);break;case 3:for(s=function(e){var t=e.length;if(t<=1)return[e];for(var i,r,n=[],o=0;o<t;o++){var a=function(e){for(var t,i,r=0,n=0,o=e.length,a=o-1;n<o;a=n++)t=e[n],i=e[a],r+=(i.x-t.x)*(t.y+i.y);return r}(e[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(i&&n.push(i),i=[e[o]]):i.push(e[o]))}i&&n.push(i);return n}(s),h=0;h<s.length;h++)for(r=0;r<s[h].length;r++)u(s[h][r])}1===s.length?s=s[0]:l="Multi"+l;var f={type:"Feature",geometry:{type:l,coordinates:s},properties:this.properties};return"id"in this&&(f.id=this.id),f};var Ur=Gr;function Gr(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Br,this,t),this.length=this._features.length}function Br(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():5===e?t.extent=i.readVarint():2===e?t._features.push(i.pos):3===e?t._keys.push(i.readString()):4===e&&t._values.push(function(e){var t=null,i=e.readVarint()+e.pos;for(;e.pos<i;){var r=e.readVarint()>>3;t=1==r?e.readString():2==r?e.readFloat():3==r?e.readDouble():4==r?e.readVarint64():5==r?e.readVarint():6==r?e.readSVarint():7==r?e.readBoolean():null}return t}(i))}function Vr(e,t,i){var r;3!==e||(r=new Ur(i,i.readVarint()+i.pos)).length&&(t[r.name]=r)}Gr.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Fr(this._pbf,t,this.extent,this._keys,this._values)};var qr,Hr=function(e,t){this.layers=e.readFields(Vr,{},t)},Yr=Fr,Xr="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Wr={};(function(){var e,t,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){e!=Array.prototype&&e!=Object.prototype&&(e[t]=i.value)},a=("undefined"==typeof window||window!==this)&&void 0!==Xr&&null!=Xr?Xr:this;if("function"==typeof Object.setPrototypeOf)e=Object.setPrototypeOf;else{e:{var i={};try{i.__proto__={ea:!0},t=i.ea;break e}catch(e){}t=!1}e=t?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var r=e;!function(e,t){if(t){var i=a;e=e.split(".");for(var r=0;r<e.length-1;r++){var n=e[r];n in i||(i[n]={}),i=i[n]}(t=t(r=i[e=e[e.length-1]]))!=r&&null!=t&&o(i,e,{configurable:!0,writable:!0,value:t})}}("Object.setPrototypeOf",function(e){return e||r});var n=this||self;function s(e){var t=_r(e);if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var i=Object.prototype.toString.call(e);if("[object Window]"==i)return"object";if("[object Array]"==i||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==i||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function u(e){return"function"==s(e)}function c(e){var t=_r(e);return"object"==t&&null!=e||"function"==t}function l(e,t){e=e.split(".");var i,r=n;e[0]in r||void 0===r.execScript||r.execScript("var "+e[0]);for(;e.length&&(i=e.shift());)e.length||void 0===t?r=r[i]&&r[i]!==Object.prototype[i]?r[i]:r[i]={}:r[i]=t}function h(e,t){function i(){}i.prototype=t.prototype,e.ua=t.prototype,e.prototype=new i,e.prototype.constructor=e}var f=Math,d=f.min,_=f.max,p=f.round,g=f.floor,v=f.ceil,m=f.abs,y=f.log,x=f.sqrt,b=f.pow,w=f.sin,A=f.asin,T=f.cos,k=f.tan,E=f.atan2,M=f.PI,R=M/2,S=M/4,P=2*M,z=3*M,N=M/180,O=180/M;function I(e,t,i){return i<e?i:e<t?t:e}function L(e,t,i){return t<i?t<=e&&e<=i:i<=e&&e<=t}function C(e,t,i,r,n,o){return x(b((e-n)*(r-o)-(t-o)*(i-n),2)/(b(i-n,2)+b(r-o,2)))}l("H.math.normalize",function(e,t,i){return t-=i=i||0,(e-=i)-g(e/t)*t+i}),l("H.math.clamp",I);var F={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function D(e,t){var i=e.x;e=e.y;for(var r,n,o,a,s=t.length,l=s,u=t[0],c=0,h=0,f=0;1!=c&&1<l;)n=t[--l],r=t[--l],a=t[l?l-1:(s+(l-1))%s],o=t[l?l-2:(s+(l-2))%s],i<=r&&r<=i&&e<=n&&n<=e||i<=o&&o<=i&&e<=a&&a<=e?c=1:c||r!==i?!c&&L(i,r,o)&&((r<i&&i<o||i<r&&o<i)&&(h+=e<(u=n+(i-r)/(o-r)*(a-n)),f+=u<e),c=L(e,n,a)&&C(i,e,r,n,o,a)<=0?2:0):(o===i&&(n<e&&e<a||e<n&&a<e)||(u<=i&&i<o||i<=u&&o<i)&&(e<=n?++h:++f),c=L(e,n,a)&&C(i,e,r,n,o,a)<=0?2:0),u=r;return c||0===f||0==h%2||(c=3),c!==F.NONE}function j(e,t){this.x=+e,this.y=+t}function H(e,t,i,r,n,o,a,s,l,u){return e={x:e,y:t,next:i||null,s:r||null,ta:n||null,X:o||null,o:!!a,T:s||0,O:l||0,alpha:u||0},r&&(e.s.next=e),i&&(e.next.s=e),e}function U(e){for(;e&&e.o;)e=e.next;return e}function G(e){if(e)for(;e.next;)e=e.next;return e}function B(e){var t=G(e);(t.s.next=e).s=t.s}function V(e){for(var t=[];e;)t.push(e.x,e.y),e=e.next;return t}function q(e,t,i){for(t=t.next;t!==i&&t.alpha<=e.alpha;)t=t.next;e.next=t,e.s=t.s,(e.next.s=e).s.next=e}function Y(e,t){for(var i,r=null,n=0,o=e.length;n<o;n++)(i=H(e[n].x,e[n].y,r)).qa=t,(i.next=r)&&(r.s=i),r=i;return r}function X(e,t,i,r){return(e-=i)*e+(t-=r)*t}l("H.math.CoverType",F),l("H.math.isPointInsidePolygon",D),l("H.math.flatten",function(e){for(var t=e.length,i=new Float64Array(2*t),r=t&&e[0].x!==K;t--;){var n=e[t],o=t<<1;i[o]=r?n.x:n[0],i[1+o]=r?n.y:n[1]}return i}),l("H.math.Point",j),(j.prototype.set=j).prototype.clone=function(e){return e?(e.x=this.x,e.y=this.y):e=new j(this.x,this.y),e},j.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},j.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},j.prototype.scale=function(e,t){return this.x*=e,this.y*=void 0===t?e:t,this},j.prototype.round=function(){return this.x=p(this.x),this.y=p(this.y),this},j.prototype.floor=function(){return this.x=g(this.x),this.y=g(this.y),this},j.prototype.ceil=function(){return this.x=v(this.x),this.y=v(this.y),this},j.prototype.equals=j.prototype.w=function(e){return!(!e||this.x!==e.x||this.y!==e.y)},j.prototype.getNearest=j.prototype.la=function(e,t){var i,r=t.x-e.x,n=t.y-e.y,o=e;return(r||n)&&(o=(i=((this.x-e.x)*r+(this.y-e.y)*n)/(r*r+n*n))<=0?e:1<=i?t:new j(e.x+i*r,e.y+i*n)),o},j.prototype.distance=j.prototype.R=function(e){return x(b(this.x-e.x,2)+b(this.y-e.y,2))},j.fromIPoint=function(e){if(!e)throw Error("invalid argument");return e instanceof j?e:new j(e.x,e.y)},l("H.math.clipping.clipStrips",function(e,t,i,r,n,o){var a,s,l,u=e.length;if(u)for(a=[];u--;)for(var c,h,f=e[u],d=f.length,_=0,p=1;p<d;p++){(l=function(e,t,i,r,n,o){var a=e.x;e=-e.y;var s=t.x;if(t=-t.y,i=-i,o=-o,s<a){if(n<s||a<r)return;var l=a,u=e;a=s,e=t,s=l,t=u,l=1}else if(n<a||s<r)return;if(t<e){if(i<t||e<o)return;var c=1;e=-e,t=-t,u=o,o=-i,i=-u}else if(i<e||t<o)return;if(a<r){if((e+=(r-a)*(t-e)/(s-a))>i)return;a=r}if(e<o){if((a+=(o-e)*(s-a)/(t-e))>n)return;e=o}return n<s&&(t=e+(n-a)*(t-e)/(s-a),s=n),i<t&&(s=a+(i-e)*(s-a)/(t-e),t=i),c&&(e=-e,t=-t),l?[new j(s,-t),new j(a,-e)]:[new j(a,-e),new j(s,-t)]}(f[p-1],f[p],i,t,r,n))&&(c=l[0],h=l[1],_&&_.w(c)?s.push(h):a.push(s=l),_=h,o&&(p=d,u=0))}else a=e;return a}),l("H.math.clipping.clipPolygon",function(e,t,i){var r;e=Y(e,!0),t=Y(t,!1);var n={},o=r=1;switch(~~(i||0)){case 1:o=r=0;break;case 2:r=0,o=1;break;case 3:r=1,o=0}i=r;var a,s,l,u,c,h,f=o;if(t&&e){for(t.M=H(t.x,t.y,null,G(t)),e.M=H(e.x,e.y,null,G(e)),o=t;o.next;o=o.next)if(!o.o)for(r=e;r.next;r=r.next){r.o||(h=function e(t,i,r,n,o){var a,s=i.x-t.x,l=i.y-t.y;var u=n.x-r.x;var c=n.y-r.y;var h=s*c-l*u;if(!h)return 0;u=((r.x-t.x)*c-(r.y-t.y)*u)/h;h=(l*(r.x-t.x)-s*(r.y-t.y))/h;if(u<0||1<u||h<0||1<h)return 0;0===u?a=t:1===u?a=i:0===h?a=r:1===h&&(a=n);if(a)return a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.M&&(a.M.x=a.x,a.M.y=a.y),e(t,i,r,n,o);o.xa=t.x+u*s;o.ya=t.y+u*l;o.fa=u;o.ga=h;return 1}(o,a=U(o.next),r,s=U(r.next),n))&&(h=n.fa,l=n.ga,q(h=H(u=n.xa,c=n.ya,null,null,null,null,!0,0,0,h),o,a),q(a=H(u,c,null,null,null,null,!0,0,0,l),r,s),(h.X=a).X=h)}for(n=D(t,V(e)),i&&(n=!n),o=t;o;o=o.next)o.o&&(n=!(o.T=n));for(n=D(e,V(t)),f&&(n=!n),r=e;r.next;r=r.next)r.o&&(n=!(r.T=n));for(B(t),B(e);(e=function(e){var t=e;if(t)for(;(t=t.next)!=e&&(!t.o||t.o&&t.O););return t}(t))!=t;){for(i=null;!e.O;e=e.X){for(n=e.T;(i=H(e.x,e.y,i)).artificial=e.o||e.qa,e.O=1,e=n?e.next:e.s;)if(e.o){e.O=1;break}if(!e)break}i.ta=d;var d=i}return d}}),l("H.math.simplifyDP",function(e,t,i){return function e(t,i,r,n,o){var a=0,s=n,l=t[n].x,u=t[n].y,c=t[o].x,h=t[o].y,f=n+1,d=X(l,u,c,h);if(d)for(;f<o;){var _=t[f++],p=_.x;_=_.y;var g=((p-l)*(c-l)+(_-u)*(h-u))/d;p=g<0?X(p,_,l,u):1<g?X(p,_,c,h):X(p,_,l+g*(c-l),u+g*(h-u)),a<p&&(a=p,s=f-1)}else for(;f<o;)_=t[f++],p=_.x,_=_.y,p=X(p,_,l,u),a<p&&(a=p,s=f-1);n=i<=a||0<r&&s-n?(--r,1<s-n?(n=e(t,i,r,n,s),n.splice(n.length-1,1)):n=[t[n]],1<o-s?n.concat(e(t,i,r,s,o)):n.concat(t.slice(s,o+1))):[t[n],t[o]];return n}(e,t*t,i||0,0,e.length-1)});var W=this,Z=String,K=self.eval("undefined"),$=self.eval("null"),J="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(e,t){if(!0==(e instanceof t&&e.constructor===t))throw new TypeError("Illegal constructor "+ne(t))}l("H.lang.isArray",function(e,t,i,r){var n;if(!(n="Array"===ie(e))&&t)throw new ue(t,i,r!==K?r:e);return n}),l("H.lang.isString",function(e){return"string"==typeof e});var ee=isNaN;function te(e){return e===+e}function ie(e){var t=Object[J[0]][J[6]].call(e).match(/^\[object (\w+)\]$/);return t?t[1]:_r(e)}l("H.lang.isNumber",te),l("H.lang.isInteger",Number.isInteger?Number.isInteger:function(e){return"number"==typeof e&&0==e%1});var re=[];function ne(n,e,o,a){var s,t,l="",i=arguments.length<2;return i&&(e={H:W.H},o="",a=re.slice()),se(e,!0,function(e,t){try{if(s=e[t],i=s,se(e,!(r=[]),function(e,t){e[t]===i&&r.push(t)}),t=r.sort(oe)[0],!(c(s)&&s.window===s&&s.self===s||c(s)&&0<s.nodeType&&u(s.cloneNode))&&c(s)){if(s===n)return l=o+"."+t,1;if(a.indexOf(s)<0&&(a.push(s),l=ne(n,s,o+"."+t,a)))return 1}}catch(e){}var i,r}),i&&(l=l?l.substr(1).replace("."+J[0]+".","#"):"~"+(u(n)?((t=/^\s*function ([^\( ]+)/.exec(t=n))?t[1]:"anonymous")+"()":ie(n))),l}function oe(e,t){return t.length-e.length}re.indexOf(re)<0&&re.push(re);var ae=Object[J[0]][J[2]];function se(e,t,i){var r;if(e){for(n in e)if((!t||ae.call(e,n))&&i(e,n,!0))return;for(r=J.length;r--;){var n=J[r];if((!t||ae.call(e,n))&&i(e,n,!1))break}}}function le(e,t,i){i[t]="#"+t}function ue(e,t,i){var r,n,o=arguments.length;return(t=t!==K?+t:t)!==K&&((n=r=(n=/^.*?\(([^\)]+)/.exec((""+e).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?Z(n[1].replace(/\s+/g,"")).split(","!==K?",":" "):[]).forEach(le),n=n[t]||"#"+t),r=e?ne(e):"",o=2<o?Z(i):"",(n||o)&&(r+=" (Argument "+(n||"")+(o?" "+o:"")+")"),o=Error(r),Object.setPrototypeOf(o,ue.prototype),o}function ce(e,t,i){var r=I(+e,-90,90);if(t&&ee(r))throw new ue(t,i,e);return r}function he(e,t,i){var r,n=+e;if((n<-180||180<n)&&(n=(!1==(r=(n+180)%360)<0?r:360+r)-180),t&&ee(n))throw new ue(t,i,e);return n}function fe(e,t,i){var r;if(e!==K&&ee(r=+e)&&t)throw new ue(t,i,e);return r}function de(){Q(this,de)}function _e(e,t,i){this.lat=ce(e,_e,0),this.lng=he(t,_e,1),i!==K&&(this.alt=fe(i,_e,2))}function pe(e,t,i){var r=c(e)&&!(ee(e.lat=ce(e.lat))||ee(e.lng=he(e.lng))||e.alt!==K&&ee(e.alt=fe(e.alt)));if(!r&&t)throw new ue(t,i,e);return r}function ge(e,t,i,r){ve(this,ce(e,ge,0),he(t,ge,1),ce(i,ge,2),he(r,ge,3))}function ve(e,t,i,r,n){return e.f=i,e.g=n,t<r&&(i=t,t=r,r=i),e.i=t,e.h=r,e.m=e.b=e.c=null,e}function me(e,t){return(e=t-e)+(e<0?360:0)}function ye(e,t){return(e+=t/2)-(180<e?360:0)}function xe(e,t,i,r,n,o,a,s,l){i=d(i,a),e=_(e,n);var u=ye(t,n=me(t,r)),c=ye(o,a=me(o,s))-u,h=(c+=c-1e-6<0?360:0)-1e-6<180?(u=t,s):(c=360-c,u=o,r);return 360<=(c=c+n/2+a/2)+5e-7?(u=-180,h=180):c-5e-7<n?(u=t,h=r):c-5e-7<a&&(u=o,h=s),l?ve(l,e,u,i,h):new ge(e,u,i,h)}function be(e,t,i){return i||(pe(e,be,0),pe(t,be,1)),new ge(e.lat,e.lng,t.lat,t.lng)}function we(e,t,i,r,n,o){Q(this,we),this.sa=e||10,this.c=this.b=null,this.j=r||0,this.l=n||0,this.m=t||1,this.u=i||1,this.I=!!o,this.flush()}function Ae(e,t,i){var r,n;if(e.I&&(r=e.c))for(n=3;0<=n;n--){var o=t[n];if(n%3?o>=r[n]:o<=r[n]){if(!i){e.c=null;break}r[n]=o}}}function Te(e,t){var i,r=e.a;if(t){var n=t;if(n!==r)for(r=n;n=n.c;)(n.entries||1<n.a)&&(r=n)}else for(;!r.entries&&(i=r.a)<2&&i;)r=n;e.a=r}h(ue,Error),l("H.lang.InvalidArgumentError",ue),ue.prototype.name="InvalidArgumentError",l("H.geo.isDBC",function(e,t){return 0!=(e<0^t<0)&&180<m(t-e)}),l("H.geo.AbstractGeometry",de),de.prototype.getBoundingBox=de.prototype.D,de.prototype.equals=de.prototype.w,de.prototype.a="",de.prototype.l="",de.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},de.prototype.toGeoJSON=de.prototype.va=function(){return{type:this.l,coordinates:this.u()}},de.prototype.forWorkerMessage=de.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},h(_e,de),l("H.geo.Point",_e),_e.prototype.equals=_e.prototype.w=function(e){return this===e||!!e&&this.lat===e.lat&&this.lng===e.lng&&(this.alt||0)===(e.alt||0)},_e.prototype.distance=_e.prototype.R=function(e){var t,i;return e=this===e||this.lat===e.lat&&this.lng===e.lng?0:(t=this.lat*N,i=e.lat*N,12742001.58*A(d(1,x(b(w((t-i)/2),2)+T(t)*T(i)*b(w((this.lng*N-e.lng*N)/2),2)))))},_e.prototype.walk=_e.prototype.wa=function(e,t,i){var r,n,o,a,s,l,u;return i?((t/=6371000.79)&&(e*=N,s=N*this.lat,r=w(s),n=w(t),o=T(t),a=N*this.lng,l=T(s),s=A(l*T(e)*n+r*o),l=(e=(a+(e=E(w(e)*l*n,o-r*w(s)))+M)%(2*M)-M)*O),t?new _e(s*O,(l+540)%360-180):this):0==((e=(e%360+360)%360)+90)%180?(s=this.lng+t/(6371000.79*P*T(this.lat*N))*(270===e?-360:360),new _e(this.lat,(s+540)%360-180)):((t/=6371000.79)&&(e*=N,a=this.lat*N,r=this.lng*N,o=(n=a+t*T(e))-a,s=y(k(n/2+S)/k(a/2+S)),s=ee(o/s)?T(a):o/s,u=t*w(e)/s,m(n)>R&&(n=0<n?M-n:-(M+n))),t?new _e(n*O,((r+u+z+(m(a+o)>R?M:0))%P-M)*O):this)},_e.prototype.getBoundingBox=_e.prototype.D=function(){return new ge(this.lat,this.lng,this.lat,this.lng)},_e.validate=pe,_e.fromIPoint=function e(t){if(!t)throw new ue(e,0,t);return new _e(t.lat,t.lng,t.alt)},_e.prototype.a="Point",_e.prototype.I=function(e){return e.push("(",this.lng," ",this.lat,")"),e},_e.prototype.l="Point",_e.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},_e.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},h(ge,de),l("H.geo.Rect",ge),ge.prototype.a="Polygon",ge.prototype.I=function(e){var t=this.i,i=this.f,r=this.h,n=this.g;return e.push("(","(",i," ",t,",",n," ",t,",",n," ",r,",",i," ",r,",",i," ",t,")",")"),e},ge.prototype.equals=ge.prototype.w=function(e){return this===e||!!e&&this.i===e.i&&this.f===e.f&&this.h===e.h&&this.g===e.g},ge.prototype.clone=function(){return new ge(this.i,this.f,this.h,this.g)},ge.prototype.getTopLeft=ge.prototype.W=function(){return this.m||(this.m=new _e(this.i,this.f)),this.m},ge.prototype.getBottomRight=ge.prototype.V=function(){return this.b||(this.b=new _e(this.h,this.g)),this.b},ge.prototype.getTop=ge.prototype.na=function(){return this.i},ge.prototype.getBottom=ge.prototype.ha=function(){return this.h},ge.prototype.getLeft=ge.prototype.ja=function(){return this.f},ge.prototype.getRight=ge.prototype.ma=function(){return this.g},ge.prototype.getCenter=ge.prototype.F=function(){return this.c||(this.c=new _e(this.h+(this.i-this.h)/2,ye(this.f,this.A()))),this.c},ge.prototype.getWidth=ge.prototype.A=function(){return me(this.f,this.g)},ge.prototype.getHeight=ge.prototype.G=function(){return this.i-this.h},ge.prototype.isCDB=ge.prototype.N=function(){return this.f>this.g},ge.prototype.isEmpty=ge.prototype.ra=function(){return!this.A()&&!this.G()},ge.prototype.getBoundingBox=ge.prototype.D=function(){return new ge(this.i,this.f,this.h,this.g)},ge.prototype.containsLatLng=ge.prototype.L=function(e,t,i){var r=this.F();return i||(e=ce(e,this.L,0),t=he(t,this.L,1)),(e=(t=this.B(e,t,i)).F()).lat===r.lat&&e.lng===r.lng&&this.G()===t.G()&&this.A()===t.A()},ge.prototype.containsPoint=ge.prototype.$=function(e,t){return t||pe(e,this.$,0),this.L(e.lat,e.lng,t)},ge.prototype.containsRect=ge.prototype.aa=function(e,t){var i=this.F();if(!(t||e instanceof ge))throw new ue(this.aa,0,e);return(e=(t=this.J(e,t)).F()).lat===i.lat&&e.lng===i.lng&&this.G()===t.G()&&this.A()===t.A()},ge.prototype.mergeLatLng=ge.prototype.B=function(e,t,i,r){if(!i){if(ee(e=ce(e)))throw new ue(this.B,0,e);if(ee(t=he(t)))throw new ue(this.B,1,t)}return xe(this.i,this.f,this.h,this.g,e,t,e,t,r)},ge.prototype.mergePoint=ge.prototype.ca=function(e,t,i){return t||pe(e,this.ca,0),this.B(e.lat,e.lng,t,i)},ge.prototype.mergeRect=ge.prototype.J=function(e,t,i){if(!(t||e instanceof ge))throw new ue(this.J,0,e);return xe(this.i,this.f,this.h,this.g,e.i,e.f,e.h,e.g,i)},ge.prototype.mergeTopLeftBottomRight=ge.prototype.C=function(e,t,i,r,n,o){return n||(e=ce(e,this.C,0),t=he(t,this.C,1),i=ce(i,this.C,2),r=he(r,this.C,3)),xe(this.i,this.f,this.h,this.g,e,t,i,r,o)},ge.prototype.intersects=ge.prototype.ba=function(e,t){var i=this.f<=this.g,r=e.f<=e.g,n=this.f<e.g,o=e.f<this.g;if(!(t||e instanceof ge))throw new ue(this.ba,0,e);return this.h<=e.i&&e.h<=this.i&&(!i&&(!r||n||o)||!r&&(n||o)||n&&o)},ge.merge=xe,ge.fromPoints=be,ge.coverPoints=function e(t,i){var r=1,n=t.length,o=null,a=s(t);if("array"!=a&&("object"!=a||"number"!=typeof t.length))throw new ue(e,0,t);if(0<n)for(o=be(a=t[0],a,i);r<n;r++)a=t[r],o.B(a.lat,a.lng,i,o);return o},ge.coverLatLngAlts=function e(t,i){var r,n=3,o=t.length;if(!(i||t&&null!=t.length))throw new ue(e,0,t);if(0<o)for(r=new ge(t[0],t[1],t[0],t[1]);n<o;n+=3)r.B(t[n],t[n+1],i,r);return r},ge.coverRects=function e(t,i){var r,n=1,o=t.length;if(i&&(!t||null==t.length))throw new ue(e,0,t);if(0<o)for(r=new ge(t[0].i,t[0].f,t[0].h,t[0].g);n<o;n++)r.J(t[n],i,r);return r},ge.prototype.resizeToCenter=ge.prototype.da=function(e,t){var i=this.f,r=this.i,n=this.g,o=this.h,a=this.F().lng;pe(e,this.da,0);var s=e.lat-o-(r-o)/2,l=e.lng-a;return e=(e=i+((l=180<l||l<-180?-(a+e.lng):l)<0?2*l:0))<-180?360+e:e,n=180<(n+=0<l?2*l:0)?n-360:n,90<=(r=0<s?r+2*s:r)&&(r=90),(o=s<0?o+2*s:o)<=-90&&(o=-90),t?ve(t,r,e,o,n):new ge(r,e,o,n)},ge.prototype.l="Polygon",ge.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},ge.prototype.U=function(){return this.j()},ge.prototype.j=function(){return[this.i,this.f,this.h,this.g]},we.prototype.remove=function(e){var t,i,r,n,o,a,s=!1;if(e&&(t=e.a)&&t.b===this&&(i=t.entries)&&0<=(r=i.indexOf(e))){for(i.splice(r,1),i=this.a;t;){(n=t.entries)&&n.length||(n&&delete t.entries,t.a||!(o=t.c))?t=$:((r=o)[a=(s=t).j]===s&&(delete r[a],delete s.c,--r.a),i===t&&(i=o),t=o)}this.a!==i&&(this.a=i,Te(this)),Ae(this,e,!1),s=!0}return s},we.prototype.flush=function(){var e=new Ee(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);(e.b=this).a=this.b=e,this.c=null},we.prototype.o=function(e,t,i,r,n,o){var a=[],s=this.a,l=this.b;return e<=s[5]&&t<=s[6]&&(n?i>=s[7]:i>s[7])&&(o?r>=s[4]:r>s[4])&&function e(t,i,r,n,o,a,s,l,u){var c,h=i.entries,f=i[7],d=i[4],_=i[5],p=i[6],g=i[8],v=i[9];if(h){var m=h.length;if(d<o||f<n||s<p||a<_)for(;m--;){f=h[m],d=f[3],_=f[0],p=f[1];var y=f[2];o<=y&&n<=p&&(_<s||l&&_==s)&&(d<a||u&&d==a)&&r.push(f)}else for(;m--;)r.push(h[m])}(g<a||u&&a==g)&&(o<v&&(c=i[1])&&e(t,c,r,n,o,a,s,l,u),(v<s||l&&s==v)&&(c=i[3])&&e(t,c,r,n,o,a,s,l,u));n<g&&(o<v&&(c=i[0])&&e(t,c,r,n,o,a,s,l,u),(v<s||l&&s==v)&&(c=i[2])&&e(t,c,r,n,o,a,s,l,u))}(this,s,a,e,t,i,r,o||r>=l[6],n||i>=l[5]),a};var ke=0;function Ee(e,t,i,r,n,o){this.j=t,e&&(this.c=e,this.b=e.b,n=1&t?(i=e[8],e[5]):(i=e[7],e[8]),o=2&t?(r=e[9],e[6]):(r=e[4],e[9])),this[7]=i,this[5]=n,this[8]=(i+n)/2,this[4]=r,this[6]=o,this[9]=(r+o)/2}function Me(e,t,i,r,n,o){Me.ua.constructor.apply(this,arguments)}function Re(e,t,i,r,n,o,a){var s,l,u=t[8],c=t[9];return a&&(n<u||(s=u<=i))&&(o<c||(l=c<=r))?i=(u=Re)(e,t=t[s|=l<<1]||(++t.a,t[s]=new Ee(t,s)),i,r,n,o,a-1):(r=i=new Se(i,r,n,o),(t.entries||(t.entries=[])).push(r),r.a=t,Ae(e,i,!0),Te(e,t)),i}function Se(e,t,i,r){this.id=ke++,this[0]=t,this[1]=i,this[2]=r,this[3]=e}function Pe(e){this.l=new Me(+e||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function ze(e,t,i,r,n,o){if(o)o=new Se(n,-t,i+360,-r),e.j.push(o),e.m=!0,e.a&&e.a.C(t,i,r,n,!0,e.a);else{var a=-t,s=-r,l=(o=e.l).b,u=l[5],c=l[6];if(!(l[7]<=i&&l[4]<=a&&(n<u||u===n&&u===l.b.b[5])&&(s<c||c===s&&c===l.b.b[6])))throw Error("Coordinates out of bounds");o=Re(o,o.b,i,a,n,s,o.sa),e.b&&e.b.C(t,i,r,n,!0,e.b)}return e.c=null,o}function Ne(e,t,i,r,n,o,a){var s=(e=e.j).length,l=[];if(s)for(var u=i+360,c=n+360;s--;){var h=e[s];(Oe(h,t,i,r,n,o,a)||Oe(h,t,u,r,c,o,a))&&l.push(h)}return l}function Oe(e,t,i,r,n,o,a){var s=e[3],l=e[0],u=e[1];return e=e[2],(o?l<=r:l<r)&&(a?s<=n:s<n)&&t<=e&&i<=u}function Ie(e,t){var i,r;if(i=t.length){for(var n=e.length,o={};n--;)o[e[n].id]=1;for(;i--;)(r=t[i]).id in o||e.push(r)}}function Le(){}function Ce(e,t,i){if(this.l=[],t&&this.K(t),i&&!u(i))throw new ue(Ce,2,i);this.b=0,this.m=i,this.a={},this.j=this.c=null,this.Z(e)}function Fe(e,t){return t&&(e.c=je(e,t,e.c)),t}function De(e){for(;e.b>e.u&&e.j;)Ue(e,e.j,!0)}function je(e,t,i){return i!==t&&((t.H||t.v)&&Ue(e,t),(t.H=i)&&(t.v=i.v,i.v=t),t.v||(e.c=t),t.H||(e.j=t),e.b+=t.size),t}function Ue(e,t,i){var r=t.v,n=t.H;if((r||n||t==e.c&&t==e.j)&&(r?r.H=n:e.c=n,n?n.v=r:e.j=r,e.b-=t.size,i)){for(i=e.l.length;i--;)e.l[i].call(e,t.id,t.data,t.size);delete e.a[t.id]}t.H=t.v=null}Ee.prototype.a=0,h(Me,we),l("H.geo.QuadTree",Pe),Pe.prototype.N=function(){return this.m},Pe.prototype.D=function(){var e;if(!this.c){var t,i,r=[];if((a=!this.b)&&(s=(o=this.l).c,o.I&&!s&&((a=o.a).entries||a[0]||a[1]||a[2]||a[3])&&(s=function e(t,i){for(var r,n,o=0,a=3;0<=a;a--){for(var s=a+4,l=0<a%3,u=[],c=i[a],h=t[a],f=h.length;f--;){var d=h[f];if(r=d.entries)for(n=r.length;n--;){var _=r[n][a];(l?c<_:_<c)&&(c=_)}for(n=4;n--;)(r=d[n])&&(l?r[s]>c:r[s]<c)&&u.push(r)}o+=u.length,i[a]=c,t[a]=u}return o&&(i=e(t,i)),i}([s=[a],s,s,s],[a[6],a[7],a[4],a[5]]),o.c=s),a=o=s),a&&(this.b=new ge(-o[0],o[3],-o[2],o[1])),(e=this.b)&&r.push(e),!this.a&&(i=(t=this.j).length)){for(a=360,s=-(o=90),l=0;i--;)var n=t[i],o=d(o,n[0]),a=d(a,n[3]),s=_(s,n[2]),l=_(l,n[1]);this.a=new ge(-o,a,-s,l-360)}(e=this.a)&&r.push(e),(e=r[0])&&(r[1]&&(e=e.J(r[1],!0)),this.c=e)}return this.c},Pe.prototype.insertBoundingBox=Pe.prototype.oa=function(e){var t=e.W(),i=e.V();return(e=e.N())?ze(this,t.lat,i.lng,i.lat,t.lng,e):ze(this,t.lat,t.lng,i.lat,i.lng,e)},Pe.prototype.remove=function(e){var t,i;return e.a?(i=this.l.remove(e),this.b=null):(i=0<=(e=(t=this.j).indexOf(e)))&&(t.splice(e,1),this.m=0<t.length,this.a=null),i&&(this.c=null),i},Pe.prototype.intersectBoundingBox=Pe.prototype.pa=function(e,t,i){var r=this.l,n=e.W(),o=e.V(),a=-n.lat,n=n.lng,s=-o.lat,o=o.lng;return!t&&a==s||!i&&n===o?e=[]:e.N()?(Ie(e=r.o(-180,a,o,s,i,t),r.o(n,a,180,s,!1,t)),Ie(e,Ne(this,a,o,s,n+360,t,i))):Ie(e=r.o(n,a,o,s,i,t),Ne(this,a,n,s,o,t,i)),e},l("H.util.ICache",Le),Le.prototype.add=function(){},Le.prototype.get=function(){},Le.prototype.drop=Le.prototype.S=function(){},Le.prototype.forEach=function(){},Le.prototype.removeAll=Le.prototype.Y=function(){},Le.prototype.registerOnDrop=Le.prototype.K=function(){},Le.prototype.deRegisterOnDrop=Le.prototype.P=function(){},l("H.util.Cache",Ce),Ce.prototype.add=function(e,t,i){if(!te(i=+i)||i<0)throw new ue(this.add,2,i);e=String(e);var r=this.a[e],n=!0;return this.m&&(n=this.m(e,t,i)),r?n?(this.b+=i-r.size,r.size=i,r.data=t,Fe(this,r)):Ue(this,r,!0):n&&(this.a[e]=je(this,{id:e,data:t,size:i,H:null,v:null},this.c)),De(this),n},Ce.prototype.registerOnDrop=Ce.prototype.K=function(e){if(!u(e))throw new ue(this.K,0,e);this.l.push(e)},Ce.prototype.deRegisterOnDrop=Ce.prototype.P=function(t){this.l=this.l.filter(function(e){return e!==t})},Ce.prototype.get=function(e,t){return(e=t?this.a[e]:Fe(this,this.a[e]))&&e.data},Ce.prototype.drop=Ce.prototype.S=function(e){var t;(t=this.a[e])&&Ue(this,t,!0)},Ce.prototype.forEach=function(e,t,i){var r;for(r in this.a){var n=this.a[r];i&&!i(r,n.data,n.size)||e.call(t,r,n.data,n.size)}},Ce.prototype.removeAll=Ce.prototype.Y=function(e){var t;for(t in this.a){var i=this.a[t];e&&!e(t,i.data,i.size)||Ue(this,this.a[t],!0)}},Ce.prototype.setMaxSize=Ce.prototype.Z=function(e){if(!(0<+e))throw new ue(Ce.prototype.Z,0,e);return this.u=+e,De(this),this},Ce.prototype.getMaxSize=Ce.prototype.ka=function(){return this.u},Ce.prototype.getCurrentSize=Ce.prototype.ia=function(){return this.b}}).call(Wr);var Zr,Kr=qr={};function $r(e){return kr(Wr.H.math.Point,zr(e))}qr.clipPolygon=function(e,t){var i,r,n,o=[],a=Wr.H.math.clipping.clipPolygon(e.map($r),t.map($r));if(a)do{for(i=[],r=a;i.push([(n=r).x,n.y]),r=r.next;);o.push(i)}while(a=a.nextPoly);else qr.isPointInsidePolygon(t[0],e)?o.push(t):qr.isPointInsidePolygon(e[0],t)&&o.push(e);return o},qr.isPointInsidePolygon=function(e,t){return Wr.H.math.isPointInsidePolygon({x:e[0],y:e[1]},Wr.H.math.flatten(t))},qr.clamp=function(e,t,i){return(e-=0)>i?i:e<t?t:e},qr.splitLegs=function(e,t){var i=[];e.push(e[0]);for(var r=0;r<e.length-1;r++){var n,o=e[r],a=e[r+1];i.push(o),Math.abs(a[0]-o[0])>=t&&(n=[(o[0]+a[0])/2,(o[1]+a[1])/2],i.push(n))}return i.length!==e.length-1?qr.splitLegs(i,t):i},qr.getBBox=function(e){var t=1/0,i=1/0,r=-1/0,n=-1/0;return e.forEach(function(e){e[0]<t&&(t=e[0]),e[1]<i&&(i=e[1]),e[0]>r&&(r=e[0]),e[1]>n&&(n=e[1])}),[t,i,r,n]},qr.getBBoxCenter=function(e){var t=Pr(e,4),i=t[0],r=t[1];return[i+(t[2]-i)/2,r+(t[3]-r)/2]},qr.getLineLength=function(e,t,i,r){return Math.sqrt(Math.pow(e-i,2)+Math.pow(t-r,2))};var Jr=Zr={};Zr.default_source_max_zoom=18,Zr.default_view_max_zoom=20,Zr.tile_size=256,Zr.half_circumference_meters=20037508.342789244,Zr.circumference_meters=2*Zr.half_circumference_meters,Zr.min_zoom_meters_per_pixel=Zr.circumference_meters/Zr.tile_size;var Qr=[];Zr.metersPerPixel=function(e){return Qr[e]=Qr[e]||Zr.min_zoom_meters_per_pixel/Math.pow(2,e),Qr[e]};var en=[];Zr.metersPerTile=function(e){return en[e]=en[e]||Zr.circumference_meters/Math.pow(2,e),en[e]},Zr.tile_scale=4096,Zr.units_per_pixel=Zr.tile_scale/Zr.tile_size,Zr.height_scale=16;var tn=[];Zr.unitsPerMeter=function(e){return tn[e]=tn[e]||Zr.tile_scale/(Zr.tile_size*Zr.metersPerPixel(e)),tn[e]},Zr.metersForTile=function(e){return{x:e.x*Zr.circumference_meters/Math.pow(2,e.z)-Zr.half_circumference_meters,y:-(e.y*Zr.circumference_meters/Math.pow(2,e.z)-Zr.half_circumference_meters)}},Zr.tileForMeters=function(e,t){var i=Pr(e,2),r=i[0],n=i[1];return{x:Math.floor((r+Zr.half_circumference_meters)/(Zr.circumference_meters/Math.pow(2,t))),y:Math.floor((-n+Zr.half_circumference_meters)/(Zr.circumference_meters/Math.pow(2,t))),z:t}},Zr.metersToExactTileCoords=function(e,t){var i=Pr(e,2),r=i[0],n=i[1];return{x:Math.pow(2,t-1)*(1+r/Zr.half_circumference_meters),y:Math.pow(2,t-1)*(1-n/Zr.half_circumference_meters),z:t}},Zr.wrapTile=function(e){var t=e.x,i=e.y,r=e.z,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{x:!0,y:!1},o=(1<<r)-1;return n.x&&(t&=o),n.y&&(i&=o),{x:t,y:i,z:r}},Zr.metersToLatLng=function(e){var t=Pr(e,2),i=t[0],r=t[1];return i/=Zr.half_circumference_meters,r/=Zr.half_circumference_meters,r=(2*Math.atan(Math.exp(r*Math.PI))-Math.PI/2)/Math.PI,[i*=180,r*=180]},Zr.latLngToMeters=function(e){var t=Pr(e,2),i=t[0],r=t[1],r=Math.log(Math.tan(r*Math.PI/360+Math.PI/4))/Math.PI;return r*=Zr.half_circumference_meters,r=Math.min(Math.max(r,-Zr.half_circumference_meters),Zr.half_circumference_meters),[i*=Zr.half_circumference_meters/180,r]},Zr.tileSpaceToMeters=function(e,t,i){var r=Pr(e,2),n=r[0],o=r[1],a=Zr.unitsPerMeter(t);return[n/a+i.x,o/a+i.y]},Zr.tileSpaceToLatlng=function(e,t,n){var o=Zr.unitsPerMeter(t);return Zr.transformGeometry(e,function(e){e[0]=e[0]/o+n.x,e[1]=e[1]/o+n.y;var t=Pr(Zr.metersToLatLng(e),2),i=t[0],r=t[1];e[0]=i,e[1]=r}),e},Zr.copyGeometry=function(e){if(null!=e){var t={type:e.type};return"Point"===e.type?t.coordinates=[e.coordinates[0],e.coordinates[1]]:"LineString"===e.type||"MultiPoint"===e.type?t.coordinates=e.coordinates.map(function(e){return[e[0],e[1]]}):"Polygon"===e.type||"MultiLineString"===e.type?t.coordinates=e.coordinates.map(function(e){return e.map(function(e){return[e[0],e[1]]})}):"MultiPolygon"===e.type&&(t.coordinates=e.coordinates.map(function(e){return e.map(function(e){return e.map(function(e){return[e[0],e[1]]})})})),t}},Zr.transformGeometry=function(e,t){null!=e&&("Point"===e.type?t(e.coordinates):"LineString"===e.type||"MultiPoint"===e.type?e.coordinates.forEach(t):"Polygon"===e.type||"MultiLineString"===e.type?e.coordinates.forEach(function(e){return e.forEach(t)}):"MultiPolygon"===e.type&&e.coordinates.forEach(function(e){e.forEach(function(e){return e.forEach(t)})}))},Zr.boxIntersect=function(e,t){return!(t.sw.x>e.ne.x||t.ne.x<e.sw.x||t.sw.y>e.ne.y||t.ne.y<e.sw.y)},Zr.findBoundingBox=function(e){for(var t=1/0,i=-1/0,r=1/0,n=-1/0,o=e[0].length,a=0;a<o;a++){var s=e[0][a];s[0]<t&&(t=s[0]),s[1]<r&&(r=s[1]),s[0]>i&&(i=s[0]),s[1]>n&&(n=s[1])}return[t,r,i,n]},Zr.geometryType=function(e){return"Polygon"===e||"MultiPolygon"===e?"polygon":"LineString"===e||"MultiLineString"===e?"line":"Point"===e||"MultiPoint"===e?"point":void 0},Zr.centroid=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(e&&0!==e.length){var i,r=0,n=0,o=0,a=e[0],s=a.length;t&&(i=a[0],a=a.map(function(e){return[e[0]-i[0],e[1]-i[1]]}));for(var l=0,u=s-1;l<s;u=l,l++){var c=a[l],h=a[u],f=c[1]*h[0]-h[1]*c[0];r+=(c[0]+h[0])*f,n+=(c[1]+h[1])*f,o+=3*f}var d=[r/o,n/o];return t&&(d[0]+=i[0],d[1]+=i[1]),d}},Zr.multiCentroid=function(e){for(var t=e.length,i=[0,0],r=0;r<e.length;r++){var n=Zr.centroid(e[r]);i[0]+=n[0],i[1]+=n[1]}return i[0]/=t,i[1]/=t,i},Zr.signedPolygonRingAreaSum=function(e){for(var t=0,i=e.length,r=0;r<i-1;r++){var n=e[r],o=e[r+1];t+=n[0]*o[1]-o[0]*n[1]}return t+=e[i-1][0]*e[0][1]-e[0][0]*e[i-1][1]},Zr.polygonRingArea=function(e){return Math.abs(Zr.signedPolygonRingAreaSum(e))/2},Zr.polygonArea=function(e){if(e)return Zr.polygonRingArea(e[0])},Zr.multiPolygonArea=function(e){for(var t=0,i=0;i<e.length;i++)t+=Zr.polygonArea(e[i]);return t},Zr.ringWinding=function(e){var t=Zr.signedPolygonRingAreaSum(e);return 0<t?"CW":t<0?"CCW":void 0},Zr.getTileBoundingBox=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=Zr.wrapTile(e,{x:!0}),n=Zr.metersForTile(r),o=Zr.metersPerPixel(r.z),a=Zr.metersToLatLng([n.x-i*o,n.y+i*o]),s=Zr.metersToLatLng([n.x+(t+i)*o,n.y-(t+i)*o]),l=Zr.isLastTile(r);return new Wr.H.geo.Rect(0===e.y?90:Kr.clamp(a[1],-90,90),Kr.clamp(a[0],-180,180),l.row?-90:Kr.clamp(s[1],-90,90),l.column?180:Kr.clamp(s[0],-180,180))},Zr.isLastTile=function(e){var t=e.x,i=e.y,r=e.z;return{row:i===Math.pow(2,r)-1,column:t===Math.pow(2,r)-1}};var rn,nn,on=function(){br(r,Er(Error));var i=Rr(r);function r(e){var t;return pr(this,r),(t=i.call(this)).name="MethodNotImplemented",t.message="Method "+e+" must be implemented in subclass",t}return r}(),an=!1,sn=!1;try{window.document!==HTMLDocument&&(sn=!0)}catch(e){void 0!==self&&(an=!0,self.window={document:{}},self.document=self.window.document)}var ln={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return void 0!==nn?nn:an||self.is_fake_worker},set is_worker(e){nn=e},get is_main(){return void 0!==rn?rn:sn&&!self.is_fake_worker},set is_main(e){rn=e},is_native_worker:an},un={},cn=0,hn={},fn={},dn={};function _n(e,t,i){var r=2<arguments.length&&void 0!==i?i:fn,n=[];if("string"==typeof e&&(e=(n=e.split(".")).pop()),ln.is_main&&t&&1===n.length&&"self"===n[0])r=t;else for(var o=0;o<n.length;o++){if(!r[n[o]])return[];r=r[n[o]]}return[e,r]}un.addTarget=function(e,t){ln.is_fake_worker?dn[e]=t:fn[e]=t},un.removeTarget=function(e){delete fn[e],delete dn[e]};var pn=" No object with that name is registered on main thread.",gn=" Object has no method with that name.",vn="_worker_broker_error_not_set_";function mn(e){Array.isArray(e)&&e.filter(function(e){return e.parent&&e.property}).forEach(function(e){return delete e.parent[e.property]})}un.withTransferables=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(!(this instanceof un.withTransferables))return kr(un.withTransferables,t);this.value=t,this.transferables=function i(r){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[];if(!r)return n;if(Array.isArray(r))r.forEach(function(e,t){return i(e,r,t,n)});else if("object"===_r(r))if(r instanceof ArrayBuffer)n.push({object:r,parent:e,property:t});else if(r.buffer instanceof ArrayBuffer)n.push({object:r.buffer,parent:e,property:t});else for(var o in r)i(r[o],r,o,n);return n}(this.value)},ln.is_main&&(un.postMessage=function(e,i){for(var t=arguments.length,r=new Array(2<t?t-2:0),n=2;n<t;n++)r[n-2]=arguments[n];if(Array.isArray(e))return Promise.all(e.map(function(e){return un.postMessage.apply(un,[e,i].concat(zr(r)))}));var o,a={};"object"===_r(i)&&(i=(a=i).method);var s="main_send";"string"==typeof e?(i=e,r=Array.prototype.slice.call(arguments,1),o=!0,s="worker_send"):e.init&&(o=!0);var l,u=[];if(r&&1===r.length&&r[0]instanceof un.withTransferables&&(u=r[0].transferables,r=r[0].value),l={type:s,message_id:++cn,method:i,message:r},o)return function(r,e){var t=r.type,i=Pr(_n(r.method,e,"main_send"===t?dn:fn),2),n=i[0],o=i[1],a="Worker broker could not dispatch message type ".concat(r.method," on target ").concat(r.target,".");if(!o)throw Error(a+pn);var s="function"==typeof o[n]&&o[n];if(!s)throw Error(a+gn);return new Promise(function(t,i){var e;try{e=s.apply(o,r.message)}catch(e){return void i(e)}e instanceof Promise?e.then(function(e){e instanceof un.withTransferables&&(e=e.value[0]),t(e)},function(e){i(e instanceof Error?"".concat(e.message,": ").concat(e.stack):e)}):(e instanceof un.withTransferables&&(e=e.value[0]),t(e))})}(l,e&&e.init?e:void 0);var c=new Promise(function(e,t){hn[cn]={method:i,message:r,resolve:e,reject:t}});return a.stringify&&(l=JSON.stringify(l)),e.postMessage(l,u.map(function(e){return e.object})),mn(u),c},un.addWorker=function(f){if(!(f instanceof Worker))throw Error("Worker broker could not add non-Worker object",f);f.addEventListener("message",function(e){var t="string"==typeof e.data?JSON.parse(e.data):e.data,i=t.message_id;if("worker_reply"===t.type)hn[i]&&(t.error?hn[i].reject(t.error):hn[i].resolve(t.message),delete hn[i]);else if("worker_send"===t.type&&null!=i){var r=Pr(_n(t.method),2),n=r[0],o=r[1],a="Worker broker could not dispatch message type ".concat(t.method," on target ").concat(t.target,".");if(!o)throw Error(a+pn);var s="function"==typeof o[n]&&o[n];if(!s)throw Error(a+gn);var l,u=vn;try{l=s.apply(o,t.message)}catch(e){u=e}var c,h=[];l&&"function"==typeof l.then?l.then(function(e){e instanceof un.withTransferables&&(h=e.transferables,e=e.value[0]),c={type:"main_reply",message_id:i,message:e},f.postMessage(c,h.map(function(e){return e.object})),mn(h)},function(e){f.postMessage({type:"main_reply",message_id:i,error:e instanceof Error?"".concat(e.message,": ").concat(e.stack):e})}):(l instanceof un.withTransferables&&(h=l.transferables,l=l.value[0]),c={type:"main_reply",message_id:i,message:l,error:u instanceof Error?"".concat(u.message,": ").concat(u.stack):u},f.postMessage(c,h.map(function(e){return e.object})),mn(h))}})},un.getMessages=function(){return hn},un.getMessageId=function(){return cn}),ln.is_worker&&(un.postMessage=function(i){for(var e=arguments.length,r=new Array(1<e?e-1:0),t=1;t<e;t++)r[t-1]=arguments[t];var n={};"object"===_r(i)&&(i=(n=i).method);var o,a=new Promise(function(e,t){hn[cn]={method:i,message:r,resolve:e,reject:t}}),s=[];return r&&1===r.length&&r[0]instanceof un.withTransferables&&(s=r[0].transferables,r=r[0].value),o={type:"worker_send",message_id:cn,method:i,message:r},n.stringify&&(o=JSON.stringify(o)),self.postMessage(o,s.map(function(e){return e.object})),mn(s),cn++,a},self.addEventListener("message",function(e){var t="string"==typeof e.data?JSON.parse(e.data):e.data,i=t.message_id;if("main_reply"===t.type)hn[i]&&(t.hasOwnProperty("error")&&t.error!==vn?hn[i].reject(t.error):hn[i].resolve(t.message),delete hn[i]);else if("main_send"===t.type&&null!=i){var r=Pr(_n(t.method),2),n=r[0],o=r[1],a="Worker broker could not dispatch message type ".concat(t.method," on target ").concat(t.target,".");if(!o)throw Error(a+pn);var s,l,u="function"==typeof o[n]&&o[n];if(!u)throw Error(a+gn);try{s=u.apply(o,t.message)}catch(e){l=e}var c,h=[];s instanceof Promise?s.then(function(e){e instanceof un.withTransferables&&(h=e.transferables,e=e.value[0]),c={type:"worker_reply",message_id:i,message:e},self.postMessage(c,h.map(function(e){return e.object})),mn(h)},function(e){self.postMessage({type:"worker_reply",message_id:i,error:e instanceof Error?"".concat(e.message,": ").concat(e.stack):e})}):(s instanceof un.withTransferables&&(h=s.transferables,s=s.value[0]),c={type:"worker_reply",message_id:i,message:s,error:l instanceof Error?"".concat(l.message,": ").concat(l.stack):l},self.postMessage(c,h.map(function(e){return e.object})),mn(h))}}));var yn,xn={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},bn={},wn={};function An(e){var t,i="object"===_r(e)?e.level:e;if(xn[i]<=xn[An.level]){for(var r=arguments.length,n=new Array(1<r?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(ln.is_native_worker)un.postMessage.apply(un,[{method:"_logProxy",stringify:!0},e].concat(n));else{if("object"===_r(e)&&!0===e.once){if(wn[JSON.stringify(n)])return;wn[JSON.stringify(n)]=!0}var a=(bn[t=i]=bn[t]||(console[t]?console[t]:console.log).bind(console),bn[t]);1<n.length?a.apply(void 0,["Tangram [".concat(i,"]: ").concat(n[0])].concat(zr(n.slice(1)))):a("Tangram [".concat(i,"]: ").concat(n[0]))}}}function Tn(r,n,o){var a,s;return o=o||0,function(){var e=this,t=arguments;function i(){s=0,r.apply(e,t)}clearTimeout(a),s&&o&&Date.now()-s>=o?i():(s=s||Date.now(),a=setTimeout(function(){i()},n))}}An.level="info",An.workers=null,An.setLevel=function(e){An.level=e,ln.is_main&&Array.isArray(An.workers)&&un.postMessage(An.workers,"_logSetLevelProxy",e)},ln.is_main&&(An.setWorkers=function(e){An.workers=e},An.reset=function(){wn={}}),un.addTarget("_logProxy",An),un.addTarget("_logSetLevelProxy",An.setLevel);var kn=yn={};un.addTarget("Utils",yn),yn.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},yn.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},yn._requests={},yn._proxy_requests={},yn.io=function(i){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:6e4,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"text",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"GET",e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},t=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,a=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(ln.is_worker&&yn.isMicrosoft())return An("debug","Proxying request for URL to worker",i),t&&(yn._proxy_requests[t]=!0),un.postMessage("Utils.io",i,r,n,o,e,t,!0);var s=new XMLHttpRequest,l=(l=new Promise(function(e,t){s.open(o,i,!0),s.timeout=r,s.responseType=n,s.onload=function(){200===s.status?-1<["text","json"].indexOf(s.responseType)?e(s.responseText):e(s.response):t(Error("Request error with a status of "+s.statusText))},s.onerror=function(e){t(Error("There was a network error"+e.toString()))},s.ontimeout=function(e){t(Error("timeout "+e.toString()))},s.send()})).then(function(e){return t&&delete yn._requests[t],a?un.withTransferables(e):e});return t&&(yn._requests[t]=s),l},yn.cancelRequest=function(e){if(ln.is_worker&&yn._proxy_requests[e])return un.postMessage("Utils.cancelRequest",e);yn._requests[e]?(An("trace","Cancelling network request key '".concat(e,"'")),yn._requests[e].abort(),delete yn._requests[e]):An("trace","Could not find network request key '".concat(e,"'"))},yn.requestAnimationFramePolyfill=function(){"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)})},yn.serializeWithFunctions=function(e){return"function"==typeof e?e.toString():JSON.stringify(e,function(e,t){return"function"==typeof t?t.toString():t})},yn.stringsToFunctions=function(e,t){if("string"==typeof e)e=yn.stringToFunction(e,t);else if(null!=e&&"object"===_r(e))for(var i in e)e[i]=yn.stringsToFunctions(e[i],t);return e},yn._use_count=0,yn._function_cache={};var En,Mn,Rn=Tn(function(){An("trace","Cleared cached ".concat(Object.keys(yn._function_cache).length," functions (reused ").concat(yn._use_count," times)")),yn._use_count=0,yn._function_cache={}},1e4),Sn=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m;function Pn(e){if("string"!=typeof e||-1!==e.search(/^(data|blob):/))return"";var t=e.indexOf("?");-1<t&&(e=e.substr(0,t));var i=e.indexOf("#");return-1<i&&(e=e.substr(0,i)),e.substr(0,e.lastIndexOf("/")+1)||""}function zn(e){return"string"==typeof e&&!(-1<e.search(/^(http|https|data|blob):/)||"//"===e.substr(0,2))}function Nn(e,t){if(!t||0===Object.keys(t).length)return[e,[]];var i=e.indexOf("?"),r=e.indexOf("#"),n="";-1<r&&(n=e.slice(r),e=e.slice(0,r)),-1===i&&(i=e.length,e+="?"),i++;var o="",a=[];for(var s in t)""===function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))}(s,e)?o+="".concat(s,"=").concat(t[s],"&"):a.push([s,t[s]]);return[e=e.slice(0,i)+o+e.slice(i)+n,a]}function On(e){return void 0===En&&"function"!=typeof(En=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)&&(En=null,An("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),En?En(e):e}yn.stringToFunction=function(t,e){var i=t;e&&(i+=e.toString());var r=yn._function_cache[i];if(Rn(),r)return yn._use_count++,r;var n="string"==typeof t&&t.match(Sn);if(n&&2<n.length)try{var o=n[2],a=0<(a=0<n[1].length&&n[1].split(",").map(function(e){return e.trim()}).filter(function(e){return e})).length?a:["context"],s=new Function(a.toString(),"function"==typeof e?e(o):o);return yn._function_cache[i]=s}catch(e){return t}return t},yn.device_pixel_ratio=1,yn.isPowerOf2=function(e){return 0==(e&e-1)},yn.interpolate=function(e,t,i){if(!Array.isArray(t)||!Array.isArray(t[0]))return t;if(t.length<1)return t;var r,n,o,a,s;if(e<=t[0][0])a=t[0][1],"function"==typeof i&&(a=i(a));else if(e>=t[t.length-1][0])a=t[t.length-1][1],"function"==typeof i&&(a=i(a));else for(var l=0;l<t.length-1;l++)if(e>=t[l][0]&&e<t[l+1][0]){if(r=t[l][0],n=t[l+1][0],Array.isArray(t[l][1])){a=[];for(var u=0;u<t[l][1].length;u++)"function"==typeof i?(s=i(t[l][1][u]),o=i(t[l+1][1][u])-s,a[u]=o*(e-r)/(n-r)+s):(o=t[l+1][1][u]-t[l][1][u],a[u]=o*(e-r)/(n-r)+t[l][1][u])}else a="function"==typeof i?(s=i(t[l][1]),(o=i(t[l+1][1])-s)*(e-r)/(n-r)+s):(o=t[l+1][1]-t[l][1])*(e-r)/(n-r)+t[l][1];break}return a},yn.toCSSColor=function(e){return 1===e[3]?"rgb(".concat(e.slice(0,3).map(function(e){return Math.round(255*e)}).join(", "),")"):"rgba(".concat(e.map(function(e,t){return t<3&&Math.round(255*e)||e}).join(", "),")")},yn.pointInTile=function(e){return 0<=e[0]&&e[1]>-Jr.tile_scale&&e[0]<Jr.tile_scale&&e[1]<=0},yn.zoomToTileLevel=function(e){return Math.floor(e)};var In=function(){function u(e,t){var i=this;if(pr(this,u),this.config=e,this.sources=t,this.id=e.id,this.name=e.name,this.pad_scale=e.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(e.rasters)&&e.rasters.forEach(function(e){-1===i.rasters.indexOf(e)&&i.rasters.push(e)}),this.preprocess=e.preprocess,"function"==typeof this.preprocess&&this.preprocess.bind(this),this.transform=e.transform,"function"==typeof this.transform)this.transform=this.transform.bind(this);else if("object"===_r(this.transform))for(var r in this.transform)"function"==typeof this.transform[r]&&(this.transform[r]=this.transform[r].bind(this));this.extra_data=e.extra_data,this.scripts=e.scripts,this.max_zoom=null!=e.max_zoom?e.max_zoom:Jr.default_source_max_zoom,this.setTileSize(e.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=null!=e.min_display_zoom?e.min_display_zoom:0,this.max_display_zoom=null!=e.max_display_zoom?e.max_display_zoom:null,this._has_volatile_data=!!e.has_volatile_data}return vr(u,[{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(e){if(e.source_data.layers){var t={coords:e.coords},i=[];if("function"==typeof this.transform)i.push(this.transform);else if("object"===_r(this.transform))for(var r=Object.keys(this.transform).sort(),n=0;n<r.length;n++)i.push(this.transform[r[n]]);for(var o=1===Object.keys(e.source_data.layers).length&&e.source_data.layers._default,a=0;a<i.length;a++)o?e.source_data.layers._default=i[a](e.source_data.layers._default,this.extra_data,t):e.source_data.layers=i[a](e.source_data.layers,this.extra_data,t)}}},{key:"_postProcessTile",value:function(e){var t=this;for(var i in this._transformTile(e),e.source_data.layers){var r=e.source_data.layers[i];r&&r.features&&r.features.forEach(function(e){Jr.transformGeometry(e.geometry,function(e){e[1]=-e[1],t.pad_scale&&(e[0]=Math.round(e[0]*(1+t.pad_scale)-Jr.tile_scale*t.pad_scale/2),e[1]=Math.round(e[1]*(1+t.pad_scale)-Jr.tile_scale*t.pad_scale/2))}),t.updateDefaultWinding(e.geometry)})}e.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(e){return e.source_data={},e.source_data.layers={},e.pad_scale=this.pad_scale,e.rasters=zr(this.rasters),this._load(e)}},{key:"_load",value:function(){throw new on("_load")}},{key:"setTileSize",value:function(e){this.tile_size=e||256,("number"!=typeof this.tile_size||this.tile_size<256||!kn.isPowerOf2(this.tile_size))&&(An({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(e,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(e){return null==this.default_winding&&("Polygon"===e.type?this.default_winding=Jr.ringWinding(e.coordinates[0]):"MultiPolygon"===e.type&&(this.default_winding=Jr.ringWinding(e.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(e,t){if(e.z<this.min_display_zoom||null!=this.max_display_zoom&&t>this.max_display_zoom)return!1;for(var i=0;i<this.rasters.length;i++){var r=this.rasters[i];if(this.sources[r]&&this.sources[r]!==this&&!this.sources[r].includesTile(e,e.z))return!1}return!0}},{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(e){var t=0<arguments.length&&void 0!==e&&e;this._has_volatile_data=t}}],[{key:"create",value:function(e,t){for(var i in t)if(!u.changed(t[i],{config:e}))return t[i];if(u.types[e.type])return new u.types[e.type](e,t)}},{key:"changed",value:function(e,t){if(!e||!t)return!0;var i=Object.assign({},e.config,{id:null}),r=Object.assign({},t.config,{id:null});return JSON.stringify(i)!==JSON.stringify(r)}},{key:"coordsToMeters",value:function(e){var t=Pr(Jr.latLngToMeters(e),2),i=t[0],r=t[1];e[0]=i,e[1]=r}},{key:"projectData",value:function(e){for(var t in e.layers)for(var i=e.layers[t].features.length,r=0;r<i;r++){var n=e.layers[t].features[r];Jr.transformGeometry(n.geometry,u.coordsToMeters)}}},{key:"metersToTileUnits",value:function(e,t,i){i[0]=Math.round((i[0]-t.x)*e),i[1]=-1*Math.round((i[1]-t.y)*e)}},{key:"scaleData",value:function(e,t){var i=t.coords.z,r=t.min,n=(t.max,u.metersToTileUnits.bind(this,Jr.unitsPerMeter(i),r));for(var o in e.layers)for(var a=e.layers[o].features.length,s=0;s<a;s++){var l=e.layers[o].features[s];Jr.transformGeometry(l.geometry,n)}}},{key:"register",value:function(e,t){e&&t&&(u.types[t]=e)}}]),u}();In.types={};var Ln=0,Cn=function(){br(s,In);var a=Rr(s);function s(n,e){var o;pr(this,s),(o=a.call(this,n,e)).response_type="";var t=Pr(Nn(n.url,n.url_params),2),i=t[0],r=t[1];if(o.url=i,r.forEach(function(e){var t=Pr(e,2),i=t[0],r=t[1];An({level:"warn",once:!0},"Data source '".concat(o.name,"': parameter '").concat(i,"' already present in URL '").concat(n.url,"', ")+"skipping value '".concat(i,"=").concat(r,"' specified in 'url_params'"))}),"string"!=typeof o.url)throw Error("Network data source must provide a string `url` property");return o}return vr(s,[{key:"_load",value:function(n){var o=this,a=this.formatUrl(this.url,n),s=n.source_data;return s.url=a,new Promise(function(t,e){s.error=null;var i=Ln+++"-"+a,r=kn.io(a,6e4,o.response_type,"GET",{},i);s.request_id=i,r.then(function(e){"function"==typeof o.preprocess&&(e=o.preprocess(e)),(e=e instanceof Promise?e:Promise.resolve(e)).then(function(e){o.parseSourceData(n,s,e),o._postProcessTile(n),t(n)})},function(e){s.error=e.stack,o._postProcessTile(n),t(n)})})}},{key:"formatUrl",value:function(){throw new on("formatUrl")}},{key:"parseSourceData",value:function(){throw new on("parseSourceData")}}]),s}(),Fn=function(){br(n,Cn);var r=Rr(n);function n(e,t){var i;return pr(this,n),(i=r.call(this,e,t)).tiled=!0,i.parseBounds(e),i.builds_geometry_tiles=!1,i.tms=!0===e.tms,-1<i.url.search("{s}")&&(Array.isArray(e.url_subdomains)&&0<e.url_subdomains.length?(i.url_subdomains=e.url_subdomains,i.next_url_subdomain=0):An({level:"warn",once:!0},"Data source '".concat(i.name,"': source URL includes '{s}' subdomain marker ('").concat(i.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),i}return vr(n,[{key:"parseBounds",value:function(e){var t,i,r,n,o;Array.isArray(e.bounds)&&4===e.bounds.length&&(this.bounds=e.bounds,i=(t=Pr(this.bounds,4))[0],r=t[1],n=t[2],o=t[3],this.bounds_meters={min:Jr.latLngToMeters([i,o]),max:Jr.latLngToMeters([n,r])},this.bounds_tiles={min:{},max:{}})}},{key:"checkBounds",value:function(e){if(this.bounds){e=Jr.wrapTile(e,{x:!0});var t=(t=this.bounds_tiles.min[e.z])||(this.bounds_tiles.min[e.z]=Jr.tileForMeters(this.bounds_meters.min,e.z)),i=(i=this.bounds_tiles.max[e.z])||(this.bounds_tiles.max[e.z]=Jr.tileForMeters(this.bounds_meters.max,e.z));if(e.x<t.x||e.x>i.x||e.y<t.y||e.y>i.y)return!1}return!0}},{key:"includesTile",value:function(e,t){return!!Sr(wr(n.prototype),"includesTile",this).call(this,e,t)&&!!this.checkBounds(e)}},{key:"formatUrl",value:function(e,t){var i=Jr.wrapTile(t.coords,{x:!0});this.tms&&(i.y=Math.pow(2,i.z)-1-i.y);var r=e.replace("{x}",i.x).replace("{y}",i.y).replace("{z}",i.z);return null!=this.url_subdomains&&(r=r.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),r}},{key:"urlHasTilePattern",value:function(e){return e&&-1<e.search("{x}")&&-1<e.search("{y}")&&-1<e.search("{z}")}}]),n}(),Dn=function(){br(n,In);var r=Rr(n);function n(e,t){var i;return pr(this,n),(i=r.call(this,e,t)).target_name="MapsJsSource"+e.uid,i.tiled=!!e.tiled,un.addTarget(i.target_name,Mr(i)),ln.is_worker&&un.postMessage(i.target_name+".onWorkerInitialized"),ln.is_main&&(i._workers_left=0),i}return vr(n,[{key:"initialize",value:function(e,t,i,r){this._main_initialized||(this.provider=e,this.worker=r,this._workers_left+=i,this._on_update=t,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),e.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(e){this._isReady()&&this.onProviderUpdate(e)}},{key:"onProviderUpdate",value:function(e){this.dispatchUpdate(void 0,e.data)}},{key:"dispatchUpdate",value:function(e,t){this._on_update(this.name,e,t)}},{key:"dispose",value:function(){un.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}]),n}(),jn=function(e,t,i,r,n){var o,a,s=8*n-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?n-1:0,f=i?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=s;0<c;o=256*o+e[t+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+e[t+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)},Un=function(e,t,i,r,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,h=c>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,_=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(t+=1<=a+h?f/l:f*Math.pow(2,1-h))*l&&(a++,l/=2),c<=a+h?(s=0,a=c):1<=a+h?(s=(t*l-1)*Math.pow(2,n),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,n),a=0));8<=n;e[i+d]=255&s,d+=_,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;e[i+d]=255&a,d+=_,a/=256,u-=8);e[i+d-_]|=128*p},Gn=Bn;function Bn(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Bn.Varint=0,Bn.Fixed64=1,Bn.Bytes=2,Bn.Fixed32=5;var Vn=4294967296,qn=1/Vn;function Hn(e){return e.type===Bn.Bytes?e.readVarint()+e.pos:e.pos+1}function Yn(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Xn(e,t,i){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;e<=n;n--)i.buf[n+r]=i.buf[n]}function Wn(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Zn(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Kn(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function $n(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Jn(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Qn(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function eo(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function to(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function io(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function ro(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function no(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function oo(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function ao(e){var t={};for(var i in e.layers){for(var r=e.layers[i],n=[],o=Jr.tile_scale/r.extent,a=0,s=r.length;a<s;a++){var l=r.feature(a),u=Yr.types[l.type],c=l.loadGeometry(o),h=null;switch(u){case"Point":h=function(e){var t=e.coordinates.length;if(1<t){e.type="MultiPoint";for(var i=[],r=0;r<t;r++)i.push(e.coordinates[r][0]);e.coordinates=i}else e.type="Point",e.coordinates=e.coordinates[0][0];return e}({coordinates:c});break;case"LineString":h=1===c.length?{type:u,coordinates:c[0]}:{type:"MultiLineString",coordinates:c};break;case"Polygon":h=uo({coordinates:c})}h&&h.coordinates&&n.push({type:"Feature",geometry:h,properties:l.properties})}t[i]={type:"FeatureCollection",features:n}}return t}Bn.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,o=this.pos;this.type=7&r,e(n,t,this),this.pos===o&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=ro(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=oo(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=ro(this.buf,this.pos)+ro(this.buf,this.pos+4)*Vn;return this.pos+=8,e},readSFixed64:function(){var e=ro(this.buf,this.pos)+oo(this.buf,this.pos+4)*Vn;return this.pos+=8,e},readFloat:function(){var e=jn(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=jn(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,i=t[this.pos++],r=127&i;return i<128?r:(r|=(127&(i=t[this.pos++]))<<7,i<128?r:(r|=(127&(i=t[this.pos++]))<<14,i<128?r:(r|=(127&(i=t[this.pos++]))<<21,i<128?r:function(e,t,i){var r,n,o=i.buf;if(n=o[i.pos++],r=(112&n)>>4,n<128)return Yn(e,r,t);if(n=o[i.pos++],r|=(127&n)<<3,n<128)return Yn(e,r,t);if(n=o[i.pos++],r|=(127&n)<<10,n<128)return Yn(e,r,t);if(n=o[i.pos++],r|=(127&n)<<17,n<128)return Yn(e,r,t);if(n=o[i.pos++],r|=(127&n)<<24,n<128)return Yn(e,r,t);if(n=o[i.pos++],r|=(1&n)<<31,n<128)return Yn(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(i=t[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=function(e,t,i){var r,n,o,a="",s=t;for(;s<i;){var l=e[s],u=null,c=239<l?4:223<l?3:191<l?2:1;if(i<s+c)break;1===c?l<128&&(u=l):2===c?128==(192&(r=e[s+1]))&&(u=(31&l)<<6|63&r)<=127&&(u=null):3===c?(r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&((u=(15&l)<<12|(63&r)<<6|63&n)<=2047||55296<=u&&u<=57343)&&(u=null)):4===c&&(r=e[s+1],n=e[s+2],o=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&((u=(15&l)<<18|(63&r)<<12|(63&n)<<6|63&o)<=65535||1114112<=u)&&(u=null)),null===u?(u=65533,c=1):65535<u&&(u-=65536,a+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),a+=String.fromCharCode(u),s+=c}return a}(this.buf,this.pos,e);return this.pos=e,t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){var i=Hn(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var t=Hn(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Bn.Varint)for(;127<this.buf[this.pos++];);else if(t===Bn.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Bn.Fixed32)this.pos+=4;else{if(t!==Bn.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t,i=this.length||16;i<this.pos+e;)i*=2;i!==this.length&&((t=new Uint8Array(i)).set(this.buf),this.buf=t,this.length=i)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),no(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),no(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),no(this.buf,-1&e,this.pos),no(this.buf,Math.floor(e*qn),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),no(this.buf,-1&e,this.pos),no(this.buf,Math.floor(e*qn),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||e<0?function(e,t){var i,r;0<=e?(i=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:r=r+1|(i=0));if(0x10000000000000000<=e||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t){t.buf[t.pos++]=127&e|128,e>>>=7,t.buf[t.pos++]=127&e|128,e>>>=7,t.buf[t.pos++]=127&e|128,e>>>=7,t.buf[t.pos++]=127&e|128,e>>>=7,t.buf[t.pos]=127&e}(i,t),function(e,t){var i=(7&e)<<4;if(t.buf[t.pos++]|=i|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var r,n,o=0;o<t.length;o++){if(55295<(r=t.charCodeAt(o))&&r<57344){if(!n){56319<r||o+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):n=r;continue}if(r<56320){e[i++]=239,e[i++]=191,e[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(e[i++]=239,e[i++]=191,e[i++]=189,n=null);r<128?e[i++]=r:(r<2048?e[i++]=r>>6|192:(r<65536?e[i++]=r>>12|224:(e[i++]=r>>18|240,e[i++]=r>>12&63|128),e[i++]=r>>6&63|128),e[i++]=63&r|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;128<=i&&Xn(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),Un(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Un(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var r=this.pos-i;128<=r&&Xn(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,i){this.writeTag(e,Bn.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){this.writeMessage(e,Wn,t)},writePackedSVarint:function(e,t){this.writeMessage(e,Zn,t)},writePackedBoolean:function(e,t){this.writeMessage(e,Jn,t)},writePackedFloat:function(e,t){this.writeMessage(e,Kn,t)},writePackedDouble:function(e,t){this.writeMessage(e,$n,t)},writePackedFixed32:function(e,t){this.writeMessage(e,Qn,t)},writePackedSFixed32:function(e,t){this.writeMessage(e,eo,t)},writePackedFixed64:function(e,t){this.writeMessage(e,to,t)},writePackedSFixed64:function(e,t){this.writeMessage(e,io,t)},writeBytesField:function(e,t){this.writeTag(e,Bn.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Bn.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Bn.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Bn.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Bn.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Bn.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Bn.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Bn.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Bn.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Bn.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}},Yr.prototype.loadGeometry=function(e){var t=this._pbf;t.pos=this._geometry;for(var i,r,n=t.readVarint()+t.pos,o=1,a=0,s=0,l=0,u=[];t.pos<n;){if(a<=0&&(o=7&(r=t.readVarint()),a=r>>3),a--,1===o||2===o)s+=t.readSVarint(),l+=t.readSVarint(),1===o&&(i&&u.push(i),i=[]),i.push([s*e,l*e]);else{if(7!==o)throw new Error("unknown command "+o);i&&i.push(i[0].slice())}}return i&&u.push(i),u};var so={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3};function lo(e){var t=[],i=e&&e.features;if(i)for(var r=0,n=i.length;r<n;r++){var o=i[r],a=o.type,s=void 0;switch(a){case so.POINT:s={type:"MultiPoint",coordinates:o.geometry.map(function(e){return e.slice()})};break;case so.LINESTRING:case so.POLYGON:if(s={type:"MultiLineString",coordinates:o.geometry.map(function(e){return e.map(function(e){return e.slice()})})},a===so.POLYGON&&null==(s=uo(s)))continue;break;default:continue}t.push({id:o.id,type:"Feature",geometry:s,properties:o.tags})}return{type:"FeatureCollection",features:t}}function uo(e){for(var t,i=[],r=[],n=0,o=e.coordinates.length;n<o;n++){var a=e.coordinates[n],s=Jr.ringWinding(a);null!=s&&(s===(t=t||s)&&r.length&&(i.push(r),r=[]),r.push(a))}return 0<r.length&&i.push(r),1===i.length?(e.type="Polygon",e.coordinates=i[0]):1<i.length?(e.type="MultiPolygon",e.coordinates=i):e=null,e}var co={type:"FeatureCollection",features:[]},ho=function(){br(r,Dn);var i=Rr(r);function r(e,t){return pr(this,r),e.tiled=!0,i.call(this,e,t)}return vr(r,[{key:"fetchTile",value:function(e,t,i){return this.provider?this.provider.requestTileAsPromise(e,t,i).then(function(e){return e.data}):Promise.resolve()}},{key:"_load",value:function(i){var r=this,e=Jr.wrapTile(i.coords,{x:!0,y:!0}),t=e.x,n=e.y,o=e.z;return un.postMessage(this.target_name+".fetchTile",t,n,o).then(function(e){var t;return e instanceof ArrayBuffer?(t=new Gn(new Uint8Array(e)),i.source_data.layers=ao(new Hr(t))):e?i.source_data.error=e:i.source_data.layers={_default:co},r._postProcessTile(i),i})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),r}();In.register(ho,"MVT"),In.register(ho,"OMV");function fo(e){return Math.max(e,0)}function _o(e){return isNaN(e)?0:e}function po(e){return Array.isArray(e)?e.map(parseFloat).map(_o):_o(parseFloat(e))}function go(e){return Array.isArray(e)?e.map(po).map(fo):fo(po(e))}var vo=i(function(e,t){var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function _(e){return(e=Math.round(e))<0?0:255<e?255:e}function i(e){return e<0?0:1<e?1:e}function p(e){return"%"===e[e.length-1]?_(parseFloat(e)/100*255):_(parseInt(e))}function g(e){return"%"===e[e.length-1]?i(parseFloat(e)/100):i(parseFloat(e))}function v(e,t,i){return i<0?i+=1:1<i&&--i,6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}try{t.parseCSSColor=function(e){var t,i=e.replace(/ /g,"").toLowerCase();if(i in d)return d[i].slice();if("#"===i[0])return 4===i.length?0<=(t=parseInt(i.substr(1),16))&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===i.length&&0<=(t=parseInt(i.substr(1),16))&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var r=i.indexOf("("),n=i.indexOf(")");if(-1!==r&&n+1===i.length){var o=i.substr(0,r),a=i.substr(r+1,n-(r+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return null;s=g(a.pop());case"rgb":return 3!==a.length?null:[p(a[0]),p(a[1]),p(a[2]),s];case"hsla":if(4!==a.length)return null;s=g(a.pop());case"hsl":if(3!==a.length)return null;var l=(parseFloat(a[0])%360+360)%360/360,u=g(a[1]),c=g(a[2]),h=c<=.5?c*(u+1):c+u-c*u,f=2*c-h;return[_(255*v(f,h,l+1/3)),_(255*v(f,h,l)),_(255*v(f,h,l-1/3)),s];default:return null}}return null}}catch(e){}}),mo=(vo.parseCSSColor,{});Object.assign(mo,{clampPositive:fo,noNaN:_o,parseNumber:po,parsePositiveNumber:go}),mo.wrapFunction=function(e){return"\n        var feature = context.feature.properties;\n        var global = context.global;\n        var $zoom = context.zoom;\n        var $layer = context.layer;\n        var $source = context.source;\n        var sources = context.sources;\n        var $geometry = context.geometry;\n        var $meters_per_pixel = context.meters_per_pixel;\n\n        var val = (function(){ ".concat(e," }());\n\n        if (typeof val === 'number' && isNaN(val)) {\n            val = null; // convert NaNs to nulls\n        }\n\n        return val;\n    ")},mo.zeroPair=Object.freeze([0,0]),mo.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},mo.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},mo.getFeatureParseContext=function(e,t,i,r){return{feature:e,tile:t,global:i,sources:r,zoom:t.style_zoom,geometry:Jr.geometryType(e.geometry.type),meters_per_pixel:t.meters_per_pixel,meters_per_pixel_sq:t.meters_per_pixel_sq,units_per_meter_overzoom:t.units_per_meter_overzoom}};var yo={STATIC:0,DYNAMIC:1,ZOOM:2};mo.CACHE_TYPE=yo,mo.createPropertyCache=function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(null!=e){if(e.value)return{value:e.value,zoom:e.zoom?{}:null,type:e.type};var t={value:e,type:yo.STATIC};return Array.isArray(t.value)&&Array.isArray(t.value[0])?(t.zoom={},t.type=yo.ZOOM):"function"==typeof t.value&&(t.type=yo.DYNAMIC),"function"==typeof i&&(t.zoom?t.value=t.value.map(function(e,t){return[e[0],i(e[1],t)]}):"function"!=typeof t.value&&(t.value=i(t.value,0))),t}},mo.createColorPropertyCache=function(e){return mo.createPropertyCache(e,function(e){return"Style.color.pseudoRandomColor"===e?kn.stringToFunction(mo.wrapFunction(mo.macros["Style.color.pseudoRandomColor"])):"Style.color.randomColor"===e?mo.macros["Style.color.randomColor"]:e})};function xo(e){return"string"==typeof e&&"%"===e[e.length-1]}function bo(e){return"auto"===e}function wo(e){return xo(e)||bo(e)}var Ao="'size' can specify either width or height as derived from aspect ratio, but not both";mo.createPointSizePropertyCache=function(e){var t=null,i=null;if(xo(e))t=[!0];else if(Array.isArray(e))if(Array.isArray(e[0])){if(e.some(function(e){return Array.isArray(e[1])?e[1].some(wo):xo(e[1])})&&(t=e.map(function(e){return Array.isArray(e[1])?e[1].map(xo):xo(e[1])}),(i=e.map(function(e){return Array.isArray(e[1])&&e[1].map(bo)})).some(function(e){return Array.isArray(e)&&e.every(function(e){return e})})))throw Ao}else if(e.some(wo)&&(t=[e.map(xo)],(i=[e.map(bo)])[0].every(function(e){return e})))throw Ao;return t?((e={value:e}).has_pct=t,e.has_ratio=i,e.sprites={}):e=mo.createPropertyCache(e,go),e},mo.evalCachedPointSizeProperty=function(r,n,e){return r.has_pct||r.has_ratio?n?(r.sprites[n.sprite]||(r.sprites[n.sprite]=mo.createPropertyCache(r.value,function(t,i){return Array.isArray(t)?(t=t.map(function(e,t){return r.has_ratio[i][t]?e:go(e)}).map(function(e,t){return r.has_pct[i][t]?n.css_size[t]*e/100:e}),r.has_ratio[i][0]?t[0]=t[1]*n.aspect:r.has_ratio[i][1]&&(t[1]=t[0]/n.aspect)):(t=go(t),t=r.has_pct[i]?n.css_size.map(function(e){return e*t/100}):[t,t]),t})),mo.evalCachedProperty(r.sprites[n.sprite],e)):void 0:mo.evalCachedProperty(r,e)},mo.evalCachedProperty=function(e,t){if(null!=e)return e.dynamic?e.dynamic(t):e.static?e.static:e.zoom&&e.zoom[t.zoom]?e.zoom[t.zoom]:"function"!=typeof e.value?Array.isArray(e.value)&&Array.isArray(e.value[0])?(e.zoom=e.zoom||{},e.zoom[t.zoom]=kn.interpolate(t.zoom,e.value),e.zoom[t.zoom]):(e.static=e.value,e.static):(e.dynamic=e.value,e.dynamic(t))},mo.convertUnits=function(e,t){if(null!=e.val)return"px"===e.units?e.val*Jr.metersPerPixel(t.zoom):e.val;if("string"==typeof e)"px"===e.trim().slice(-2)?(e=po(e),e*=Jr.metersPerPixel(t.zoom)):e=po(e);else if(Array.isArray(e))return Array.isArray(e[0])?e.map(function(e){return[e[0],mo.convertUnits(e[1],t)]}):e.map(function(e){return mo.convertUnits(e,t)});return e},mo.parseUnits=function(e){var t={val:po(e)};return 0!==t.val&&"string"==typeof e&&"px"===e.trim().slice(-2)&&(t.units="px"),t},mo.evalCachedDistanceProperty=function(e,t){return e.dynamic?e.dynamic(t):e.zoom&&e.zoom[t.zoom]?e.zoom[t.zoom]:"function"!=typeof e.value?e.zoom?(e.zoom[t.zoom]=kn.interpolate(t.zoom,e.value,function(e){return mo.convertUnits(e,t)}),e.zoom[t.zoom]):mo.convertUnits(e.value,t):(e.dynamic=e.value,e.dynamic(t))},mo.string_colors={},mo.colorForString=function(e){if(mo.string_colors[e])return mo.string_colors[e];var t=null;return"none"!==e&&((t=vo.parseCSSColor(e))&&4===t.length?(t[0]/=255,t[1]/=255,t[2]/=255):t=mo.defaults.color),mo.string_colors[e]=t},mo.evalCachedColorProperty=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(e.dynamic){var i=e.dynamic(t);return"string"==typeof i&&(i=mo.colorForString(i)),i&&null==i[3]&&(i[3]=1),i}if(e.static)return e.static;if(e.zoom&&e.zoom[t.zoom])return e.zoom[t.zoom];if("function"==typeof e.value){e.dynamic=e.value;var r=e.dynamic(t);return"string"==typeof r&&(r=mo.colorForString(r)),r&&null==r[3]&&(r[3]=1),r}if("string"==typeof e.value)return e.static=mo.colorForString(e.value),e.static;if(e.zoom){if(!e.zoom_preprocessed){for(var n=0;n<e.value.length;n++){var o=e.value[n];o&&"string"==typeof o[1]&&(o[1]=mo.colorForString(o[1]))}e.zoom_preprocessed=!0}return e.zoom[t.zoom]=kn.interpolate(t.zoom,e.value),e.zoom[t.zoom][3]=e.zoom[t.zoom][3]||1,e.zoom[t.zoom]}return e.static=e.value.map(function(e){return e}),e.static&&null==e.static[3]&&(e.static[3]=1),e.static},mo.parseColor=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof e&&(e=e(t)),"string"==typeof e)e=mo.colorForString(e);else if(Array.isArray(e)&&Array.isArray(e[0])){for(var i=0;i<e.length;i++){var r=e[i];"string"==typeof r[1]&&(r[1]=mo.colorForString(r[1]))}t.zoom&&(e=kn.interpolate(t.zoom,e))}return Array.isArray(e)?null==(e=e.map(function(e){return e}))[3]&&(e[3]=1):e=[0,0,0,1],e},mo.calculateOrder=function(e,t){return"function"==typeof e?e=e(t):"string"==typeof e&&(e=t.feature.properties[e]?t.feature.properties[e]:go(e)),e},mo.evalProperty=function(e,t){return"function"==typeof e?e(t):e};var To=function(){function r(e,t){pr(this,r),this.key=e,this.repeat_dist=t,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return vr(r,[{key:"check",value:function(e){for(var t=e.position,i=0;i<this.positions.length;i++){var r=this.positions[i],n=t[0]-r[0],o=t[1]-r[1],a=n*n+o*o;if(a<this.repeat_dist_sq)return{dist_sq:a,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(e){e&&e.position&&this.positions.push(e.position)}}],[{key:"clear",value:function(e){this.groups[e]={}}},{key:"check",value:function(e,t,i){if(t.repeat_distance&&t.repeat_group&&this.groups[i][t.repeat_group])return this.groups[i][t.repeat_group].check(e)}},{key:"add",value:function(e,t,i){t.repeat_distance&&t.repeat_group&&(null==this.groups[i][t.repeat_group]&&(this.groups[i][t.repeat_group]=new r(t.repeat_group,t.repeat_distance*t.repeat_scale)),this.groups[i][t.repeat_group].add(e))}}]),r}();To.groups={};var ko=function(){function a(e,t,i){pr(this,a);var r=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(t/i);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}return vr(a,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(e,t,i,r,n){this._forEachCell(t,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}},{key:"insertCircle",value:function(e,t,i,r){this._forEachCell(t-r,i-r,t+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(r)}},{key:"insertCircleList",value:function(e,t){for(var i=0;i<t.length-2;i+=3)this.insertCircle("".concat(e,"/").concat(i),t[i],t[i+1],t[i+2])}},{key:"_insertBoxCell",value:function(e,t,i,r,n,o){this.boxCells[n].push(o)}},{key:"_insertCircleCell",value:function(e,t,i,r,n,o){this.circleCells[n].push(o)}},{key:"_query",value:function(e,t,i,r,n,o){if(i<0||e>this.width||r<0||t>this.height)return!n&&[];var a=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=r){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return o?a.filter(o):a}var f={hitTest:n,seenUids:{box:{},circle:{}}};return this._forEachCell(e,t,i,r,this._queryCell,a,f,o),n?0<a.length:a}},{key:"_queryCircle",value:function(e,t,i,r,n){var o=e-i,a=e+i,s=t-i,l=t+i;if(a<0||o>this.width||l<0||s>this.height)return!r&&[];var u=[],c={hitTest:r,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,u,c,n),r?0<u.length:u}},{key:"query",value:function(e,t,i,r,n){return this._query(e,t,i,r,!1,n)}},{key:"hitTest",value:function(e,t,i,r,n){return this._query(e,t,i,r,!0,n)}},{key:"hitTestCircle",value:function(e,t,i,r){return this._queryCircle(e,t,i,!0,r)}},{key:"hitTestCircleList",value:function(e,t){for(var i=0;i<e.length-2;i+=3)if(this.hitTestCircle(e[i],e[i+1],e[i+2],t))return!0;return!1}},{key:"_queryCell",value:function(e,t,i,r,n,o,a,s){var l=a.seenUids,u=this.boxCells[n];if(null!==u){var c,h=this.bboxes,f=Ir(u);try{for(f.s();!(c=f.n()).done;){var d=c.value;if(!l.box[d]){l.box[d]=!0;var _=4*d;if(e<=h[2+_]&&t<=h[3+_]&&i>=h[0+_]&&r>=h[1+_]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:h[_],y1:h[1+_],x2:h[2+_],y2:h[3+_]})}}}}catch(e){f.e(e)}finally{f.f()}}var p=this.circleCells[n];if(null!==p){var g,v=this.circles,m=Ir(p);try{for(m.s();!(g=m.n()).done;){var y=g.value;if(!l.circle[y]){l.circle[y]=!0;var x=3*y;if(this._circleAndRectCollide(v[x],v[1+x],v[2+x],e,t,i,r)&&(!s||s(this.circleKeys[y]))){if(a.hitTest)return o.push(!0),!0;var b=v[x],w=v[1+x],A=v[2+x];o.push({key:this.circleKeys[y],x1:b-A,y1:w-A,x2:b+A,y2:w+A})}}}}catch(e){m.e(e)}finally{m.f()}}}},{key:"_queryCellCircle",value:function(e,t,i,r,n,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[n];if(null!==c){var h,f=this.bboxes,d=Ir(c);try{for(d.s();!(h=d.n()).done;){var _=h.value;if(!u.box[_]){u.box[_]=!0;var p=4*_;if(this._circleAndRectCollide(l.x,l.y,l.radius,f[0+p],f[1+p],f[2+p],f[3+p])&&(!s||s(this.boxKeys[_])))return o.push(!0),!0}}}catch(e){d.e(e)}finally{d.f()}}var g=this.circleCells[n];if(null!==g){var v,m=this.circles,y=Ir(g);try{for(y.s();!(v=y.n()).done;){var x=v.value;if(!u.circle[x]){u.circle[x]=!0;var b=3*x;if(this._circlesCollide(m[b],m[1+b],m[2+b],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return o.push(!0),!0}}}catch(e){y.e(e)}finally{y.f()}}}},{key:"_forEachCell",value:function(e,t,i,r,n,o,a,s){for(var l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(i),h=this._convertToYCellCoord(r),f=l;f<=c;f++)for(var d=u;d<=h;d++){var _=this.xCellCount*d+f;if(n.call(this,e,t,i,r,_,o,a,s))return}}},{key:"_convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"_convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}},{key:"_circlesCollide",value:function(e,t,i,r,n,o){var a=r-e,s=n-t,l=i+o;return a*a+s*s<l*l}},{key:"_circleAndRectCollide",value:function(e,t,i,r,n,o,a){var s=(o-r)/2,l=Math.abs(e-(r+s));if(s+i<l)return!1;var u=(a-n)/2,c=Math.abs(t-(n+u));if(u+i<c)return!1;if(l<=s||c<=u)return!0;var h=l-s,f=c-u;return h*h+f*f<=i*i}}]),a}(),Eo=function(e,t,i,r){var n;if(r&&(n=function(e){return e!==r.id}),!t){if("point"===e.type&&!e.angle){var o=e.getAABB(),a=o.left,s=o.top,l=o.right,u=o.bottom;if(i.hitTest(a,-s,l,-u,n)){if(Array.isArray(e.layout.anchor))for(var c=1;c<e.layout.anchor.length;c++){e.setAnchor(e.layout.anchor[c]);var h=e.getAABB(),f=h.left,d=h.top,_=h.right,p=h.bottom;if(!i.hitTest(f,-d,_,-p,n))return!1}return!0}return!1}var g=e.getBoundingCircles();return i.hitTestCircleList(g,n)}if(t){if("point"===e.type&&!e.isFlat()){var v=e.getScreenSpaceBoundingBox(),m=v.left,y=v.top,x=v.right,b=v.bottom;return i.hitTest(m,y,x,b,n)}var w=e.getBoundingCircles();return i.hitTestCircleList(w,n)}return!1},Mo=function(e,t,i){var r,n,o,a,s,l,u,c,h,f,d,_,p=e.id;e.placed=!0,t||("point"!==e.type||e.angle?(r=e.getBoundingCircles(),i.insertCircleList(p,r)):(o=(n=e.getAABB()).left,a=n.top,s=n.right,l=n.bottom,i.insert(p,o,-a,s,-l))),t&&("point"!==e.type||e.isFlat()?(u=e.getBoundingCircles(),i.insertCircleList(p,u)):(h=(c=e.getScreenSpaceBoundingBox()).left,f=c.top,d=c.right,_=c.bottom,i.insert(p,h,f,d,_)))},Ro={tiles:{},startTile:function(e,t){var i=1<arguments.length&&void 0!==t?t:{},r=i.apply_repeat_groups,n=void 0===r||r,o=i.return_hidden,a=void 0!==o&&o,s=i.grid_index,l=void 0===s?null:s,u=this.tiles[e]={grid_index:l||new ko(Jr.tile_scale,Jr.tile_scale,240),objects:{},labels:{},styles:{},repeat:n,return_hidden:a};null==u.complete&&(u.complete=new Promise(function(e,t){u.resolve=e,u.reject=t}))},resetTile:function(e){delete this.tiles[e]},abortTile:function(e){this.tiles[e]&&this.tiles[e].resolve&&this.tiles[e].resolve([]),this.resetTile(e)},addStyle:function(e,t){this.tiles[t].styles[e]=!0},collide:function(e,t,i){var r=this.tiles[i];if(!r)return Promise.resolve([]);for(var n=r.objects,o=0;o<e.length;o++){var a=e[o],s=a.label.layout.priority;n[s]=n[s]||{},n[s][t]=n[s][t]||[],n[s][t].push(a)}return delete r.styles[t],0===Object.keys(r.styles).length&&this.endTile(i),r.complete.then(function(){return r.resolve=null,r.labels[t]||[]})},endTile:function(e){var t=this.tiles[e],i=t.labels;t.repeat&&To.clear(e);for(var r=Object.keys(t.objects).sort(function(e,t){return e-t}),n=0;n<r.length;n++){var o=t.objects[r[n]];if(o)for(var a in o){var s=o[a];i[a]=i[a]||[];for(var l=0;l<s.length;l++){var u=s[l];this.canBePlaced(u,e,u.linked,t)?u.linked?this.canBePlaced(u.linked,e,u,t)?(u.show=!0,(u.label.breach||u.linked.label.breach)&&(u.label.breach=!0,u.linked.label.breach=!0),i[a].push(u),this.place(u,e,t),this.place(u.linked,e,t)):t.return_hidden&&(u.show=!1,i[a].push(u)):(u.show=!0,i[a].push(u),this.place(u,e,t)):t.return_hidden&&(u.show=!1,i[a].push(u))}}}delete this.tiles[e],t.resolve()},canBePlaced:function(e,t,i,r){var n=2<arguments.length&&void 0!==i?i:null,o=(3<arguments.length&&void 0!==r?r:{}).repeat,a=void 0===o||o,s=e.label,l=e.label.layout;if(null!==s.placed)return s.placed;var u=this.tiles[t].grid_index;if(l.collide&&Eo(s,"main"===t,u,n&&n.label))l.collide&&(s.placed=!1);else{if(!(a&&To.check(s,l,t)))return!0;s.placed=!1}return s.placed},place:function(e,t,i){var r=e.label,n=i.repeat,o=void 0===n||n;null===r.placed&&(o&&To.add(r,r.layout,t),Mo(r,"main"===t,this.tiles[t].grid_index))}},So={id:0,queue:[],max_time:20,start_time:null,state:{},add:function(i){i.id=So.id++,i.max_time=i.max_time||So.max_time,i.pause_factor=i.pause_factor||1;var e=new Promise(function(e,t){i.resolve=e,i.reject=t});return i.promise=e,i.total_elapsed=0,i.stats={calls:0},this.queue.push(i),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<So.max_time&&this.process(i),i.promise},remove:function(e){var t=this.queue.indexOf(e);-1<t&&this.queue.splice(t,1)},process:function(e){if(!this.state.user_moving_view||!1!==e.user_moving_view)return e.pause?(e.pause--,!0):(e.stats.calls++,e.start_time=performance.now(),e.run(e))},processAll:function(){this.start_time=this.start_time||performance.now();for(var e=0;e<this.queue.length;e++){var t=this.queue[e];if(!0!==this.process(t)&&(t.pause||(t.pause=t.elapsed>t.max_time?t.pause_factor:0),t.total_elapsed+=t.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=So.max_time){this.start_time=null;break}}},finish:function(e,t){return e.elapsed=performance.now()-e.start_time,e.total_elapsed+=e.elapsed,this.remove(e),e.resolve(t),e.promise},cancel:function(e){var t;e.cancel instanceof Function&&(t=e.cancel(e)),e.resolve(t||{})},shouldContinue:function(e){return e.elapsed=performance.now()-e.start_time,this.elapsed=performance.now()-this.start_time,e.elapsed<e.max_time&&this.elapsed<So.max_time},removeForTile:function(e){for(var t=this.queue.length-1;0<=t;t--)this.queue[t].tile_id===e&&(this.cancel(this.queue[t]),this.queue.splice(t,1))},setState:function(e){this.state=e},hasPendingTasks:function(){return!!this.queue.length}};function Po(e){return{coords:e.coords,uid:e.uid,filtering:e.filtering,sprites:e.sprites,url:e.url,element:e.element,data:e.data,width:e.width,height:e.height,density:e.density,repeat:e.repeat,TEXTURE_WRAP_S:e.TEXTURE_WRAP_S,TEXTURE_WRAP_T:e.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:e.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:e.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var zo=function(){function n(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};pr(this,n),r=Po(r),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.manager=i,this.bind(),this.name=t,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=r.filtering,this.density=r.density||1,this.sprites=r.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),(this.manager.textures[this.name]=this).manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:t},r)),this.load(r),An("trace","creating Texture ".concat(this.name))}return vr(n,[{key:"destroy",value:function(e){var t=(0<arguments.length&&void 0!==e?e:{}).force;0<this.retain_count&&!t?An("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,An("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&An("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(e){var t=0<arguments.length&&void 0!==e?e:0;this.valid&&(this.manager.activeUnit!==t&&(this.gl.activeTexture(this.gl.TEXTURE0+t),this.manager.activeUnit=t,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(e){var t=this;return e?(this.loading=null,"string"==typeof e.url?(this.config_type="url",this.setUrl(e.url,e)):e.element?(this.config_type="element",this.setElement(e.element,e)):e.data&&e.width&&e.height&&(this.config_type="data",this.setData(e.width,e.height,e.data,e)),this.loading=this.loading&&this.loading.then(function(){return t.calculateSprites(),t})||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(e,t){var r=this,n=1<arguments.length&&void 0!==t?t:{};if(this.valid)return this.url=e,this.loading=new Promise(function(t,e){var i=new Image;i.onload=function(){try{r.setElement(i,n)}catch(e){r.loaded=!1,An("warn","Texture '".concat(r.name,"': failed to load url: '").concat(r.url,"'"),e,n),r.manager.trigger("warning",{message:"Failed to load texture from ".concat(r.url),error:e,texture:n})}r.loaded=!0,t(r)},i.onerror=function(e){r.loaded=!1,An("warn","Texture '".concat(r.name,"': failed to load url: '").concat(r.url,"'"),e,n),r.manager.trigger("warning",{message:"Failed to load texture from ".concat(r.url),error:e,texture:n}),t(r)},kn.isSafari()&&"data:"===r.url.slice(0,5)||(i.crossOrigin="anonymous"),i.src=r.url}),this.loading}},{key:"setData",value:function(e,t,i,r){var n=3<arguments.length&&void 0!==r?r:{};return this.width=e,this.height=t,Array.isArray(i)&&(i=new Uint8Array(i)),this.update(i,n),this.setFiltering(n),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(e,t){var i,r=e;return"string"==typeof e&&(e=document.querySelector(e)),e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof HTMLVideoElement?(this.update(e,t),this.setFiltering(t)):(this.loaded=!1,i="the 'element' parameter (`element: ".concat(JSON.stringify(r),"`) must be a CSS "),i+="selector string, or a <canvas>, <image> or <video> object",An("warn","Texture '".concat(this.name,"': ").concat(i),t),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(i),texture:t})),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:{};this.valid&&(this.bind(),e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof HTMLImageElement&&e.complete?(this.width=e.width,this.height=e.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==i.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)):(this._byte_length=e?e.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:{};this.valid&&(i.filtering=i.filtering||"linear",t=this.gl,this.bind(),kn.isPowerOf2(this.width)&&kn.isPowerOf2(this.height)?(this.power_of_2=!0,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,i.TEXTURE_WRAP_S||i.repeat&&t.REPEAT||t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,i.TEXTURE_WRAP_T||i.repeat&&t.REPEAT||t.CLAMP_TO_EDGE),"mipmap"===i.filtering?(this.filtering="mipmap",t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.generateMipmap(t.TEXTURE_2D)):"linear"===i.filtering?(this.filtering="linear",t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):"nearest"===i.filtering&&(this.filtering="nearest",t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST))):(this.power_of_2=!1,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),"nearest"===i.filtering?(this.filtering="nearest",t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)):(this.filtering="linear",t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR))),this.manager.trigger("update",this))}},{key:"calculateSprites",value:function(){if(this.sprites)for(var e in this.sprites){var t=this.sprites[e];this.texcoords[e]=this.manager.getTexcoordsForSprite([t[0],t[1]],[t[2],t[3]],[this.width,this.height]),this.sizes[e]=[t[2],t[3]],this.css_sizes[e]=[t[2]/this.density,t[3]/this.density],this.aspects[e]=t[2]/t[3]}}}]),n}();function No(e){var n=[];return Object.assign(e,{subscribe:function(e){-1===n.indexOf(e)&&n.push(e)},unsubscribe:function(e){var t=n.indexOf(e);-1<t&&n.splice(t,1)},unsubscribeAll:function(){n=[]},trigger:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];n.forEach(function(e){if("function"==typeof e[t])try{e[t].apply(e,i)}catch(e){An("warn","Caught exception in listener for event '".concat(t,"':"),e)}})},hasSubscribersFor:function(t){var i=!1;return n.forEach(function(e){"function"==typeof e[t]&&(i=!0)}),i}})}var Oo=function(){function s(e){pr(this,s),this.default=s.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=e,un.addTarget("Texture"+this.scene_id,this),No(this)}return vr(s,[{key:"create",value:function(e,t,i){for(var r=s.matchers_,n=0;n<r.length;n++){var o=r[n][0],a=r[n][1];if(a&&a(i))return new o(e,t,this,i)}return new zo(e,t,this,i)}},{key:"retain",value:function(e){this.textures[e]&&this.textures[e].retain()}},{key:"release",value:function(e){this.textures[e]&&this.textures[e].release()}},{key:"getRetainCount",value:function(e){if(this.textures[e])return this.textures[e].retain_count}},{key:"getByteLength",value:function(e){if(this.textures[e])return this.textures[e].getByteLength()}},{key:"destroy",value:function(i){var r=this;Object.keys(this.textures).forEach(function(e){var t=r.textures[e];e!==r.default&&t.gl===i&&t.destroy({force:!0})})}},{key:"getSpriteInfo",value:function(e,t){var i=this.textures[e];return i&&{size:i.sizes[t],css_size:i.css_sizes[t],aspect:i.aspects[t],texcoords:i.texcoords[t]}}},{key:"getTexcoordsForSprite",value:function(e,t,i){var r=i[1]-e[1]-t[1];return[e[0]/i[0],r/i[1],(t[0]+e[0])/i[0],(t[1]+r)/i[1]]}},{key:"createFromObject",value:function(e,t){var i=[];if(t)for(var r in t){var n,o=t[r];this.changed(r,o)&&(n=this.create(e,r,o),i.push(n.loading))}return Promise.all(i)}},{key:"createDefault",value:function(e){return this.create(e,this.default)}},{key:"changed",value:function(e,t){var i=this.textures[e];if(i){if("element"===i.config_type||null!=t.element)return!0;if(t=Po(t),this.texture_configs[e]===JSON.stringify(Object.assign({name:e},t)))return!1}return!0}},{key:"getInfo",value:function(e){var t=this;if(e=e||Object.keys(this.textures),Array.isArray(e))return Promise.all(e.map(function(e){return t.getInfo(e)}));var i=this.textures[e];return i?(i.loading||Promise.resolve(i)).then(function(){return{name:i.name,width:i.width,height:i.height,density:i.density,sprites:i.sprites,texcoords:i.texcoords,sizes:i.sizes,css_sizes:i.css_sizes,aspects:i.aspects,filtering:i.filtering,power_of_2:i.power_of_2,valid:i.valid}}):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(e){var i=this;return ln.is_main?Promise.all(e.map(function(e){var t=i.textures[e];return t&&t.loading||Promise.resolve()})).then(function(){return i.textures}):un.postMessage("Texture"+this.scene_id+".getInfo",e).then(function(e){return e.forEach(function(e){i.textures[e.name]=e}),i.textures})}},{key:"getMaxTextureSize",value:function(e){return e.getParameter(e.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(e,t){var i=s.matchers_;if(!(e instanceof Function&&t instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(e),i.push([e,t])}},{key:"deRegister",value:function(e){for(var t=s.matchers_,i=0;i<t.length;i++)t[i][0]===e&&t.splice(i,1)}}]),s}();Oo.DEFAULT_TEXTURE_NAME="__default",Oo.matchers_=[];var Io={};function Lo(e){return Io[e]||(Io[e]=new Oo(e)),Io[e]}var Co=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};var Fo={fromValues:function(e,t,i){var r=new Float64Array(3);return r[0]=e,r[1]=t,r[2]=i,r},transformMat4:function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[3]*r+i[7]*n+i[11]*o+i[15];return a=a||1,e[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/a,e[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/a,e[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/a,e}},Do={normalFromMat4:function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],_=t[12],p=t[13],g=t[14],v=t[15],m=i*s-r*a,y=i*l-n*a,x=i*u-o*a,b=r*l-n*s,w=r*u-o*s,A=n*u-o*l,T=c*p-h*_,k=c*g-f*_,E=c*v-d*_,M=h*g-f*p,R=h*v-d*p,S=f*v-d*g,P=m*S-y*R+x*M+b*E-w*k+A*T;return P?(P=1/P,e[0]=(s*S-l*R+u*M)*P,e[1]=(l*E-a*S-u*k)*P,e[2]=(a*R-s*E+u*T)*P,e[3]=(n*R-r*S-o*M)*P,e[4]=(i*S-n*E+o*k)*P,e[5]=(r*E-i*R-o*T)*P,e[6]=(p*A-g*w+v*b)*P,e[7]=(g*x-_*A-v*y)*P,e[8]=(_*w-p*x+v*m)*P,e):null},invert:function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=c*a-s*u,f=-c*o+s*l,d=u*o-a*l,_=i*h+r*f+n*d;return _?(_=1/_,e[0]=h*_,e[1]=(-c*r+n*u)*_,e[2]=(s*r-n*a)*_,e[3]=f*_,e[4]=(c*i-n*l)*_,e[5]=(-s*i+n*o)*_,e[6]=d*_,e[7]=(-u*i+r*l)*_,e[8]=(a*i-r*o)*_,e):null},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},jo={multiply:function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=t[9],d=t[10],_=t[11],p=t[12],g=t[13],v=t[14],m=t[15],y=i[0],x=i[1],b=i[2],w=i[3];return e[0]=y*r+x*s+b*h+w*p,e[1]=y*n+x*l+b*f+w*g,e[2]=y*o+x*u+b*d+w*v,e[3]=y*a+x*c+b*_+w*m,y=i[4],x=i[5],b=i[6],w=i[7],e[4]=y*r+x*s+b*h+w*p,e[5]=y*n+x*l+b*f+w*g,e[6]=y*o+x*u+b*d+w*v,e[7]=y*a+x*c+b*_+w*m,y=i[8],x=i[9],b=i[10],w=i[11],e[8]=y*r+x*s+b*h+w*p,e[9]=y*n+x*l+b*f+w*g,e[10]=y*o+x*u+b*d+w*v,e[11]=y*a+x*c+b*_+w*m,y=i[12],x=i[13],b=i[14],w=i[15],e[12]=y*r+x*s+b*h+w*p,e[13]=y*n+x*l+b*f+w*g,e[14]=y*o+x*u+b*d+w*v,e[15]=y*a+x*c+b*_+w*m,e},translate:function(e,t,i){var r,n,o,a,s,l,u,c,h,f,d,_,p=i[0],g=i[1],v=i[2];t===e?(e[12]=t[0]*p+t[4]*g+t[8]*v+t[12],e[13]=t[1]*p+t[5]*g+t[9]*v+t[13],e[14]=t[2]*p+t[6]*g+t[10]*v+t[14],e[15]=t[3]*p+t[7]*g+t[11]*v+t[15]):(r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=t[9],d=t[10],_=t[11],e[0]=r,e[1]=n,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=f,e[10]=d,e[11]=_,e[12]=r*p+s*g+h*v+t[12],e[13]=n*p+l*g+f*v+t[13],e[14]=o*p+u*g+d*v+t[14],e[15]=a*p+c*g+_*v+t[15]);return e},scale:function(e,t,i){var r=i[0],n=i[1],o=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},perspective:function(e,t,i,r,n){var o=1/Math.tan(t/2),a=1/(r-n);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*r*a,e[15]=0,e},lookAt:function(e,t,i,r){var n,o,a,s,l,u,c,h,f,d,_=t[0],p=t[1],g=t[2],v=r[0],m=r[1],y=r[2],x=i[0],b=i[1],w=i[2];if(Math.abs(_-x)<1e-6&&Math.abs(p-b)<1e-6&&Math.abs(g-w)<1e-6)return Co(e);c=_-x,h=p-b,f=g-w,d=1/Math.sqrt(c*c+h*h+f*f),n=m*(f*=d)-y*(h*=d),o=y*(c*=d)-v*f,a=v*h-m*c,(d=Math.sqrt(n*n+o*o+a*a))?(n*=d=1/d,o*=d,a*=d):a=o=n=0;s=h*a-f*o,l=f*n-c*a,u=c*o-h*n,(d=Math.sqrt(s*s+l*l+u*u))?(s*=d=1/d,l*=d,u*=d):u=l=s=0;return e[0]=n,e[1]=s,e[2]=c,e[3]=0,e[4]=o,e[5]=l,e[6]=h,e[7]=0,e[8]=a,e[9]=u,e[10]=f,e[11]=0,e[12]=-(n*_+o*p+a*g),e[13]=-(s*_+l*p+u*g),e[14]=-(c*_+h*p+f*g),e[15]=1,e},identity:Co,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},invert:function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],_=t[12],p=t[13],g=t[14],v=t[15],m=i*s-r*a,y=i*l-n*a,x=i*u-o*a,b=r*l-n*s,w=r*u-o*s,A=n*u-o*l,T=c*p-h*_,k=c*g-f*_,E=c*v-d*_,M=h*g-f*p,R=h*v-d*p,S=f*v-d*g,P=m*S-y*R+x*M+b*E-w*k+A*T;return P?(P=1/P,e[0]=(s*S-l*R+u*M)*P,e[1]=(n*R-r*S-o*M)*P,e[2]=(p*A-g*w+v*b)*P,e[3]=(f*w-h*A-d*b)*P,e[4]=(l*E-a*S-u*k)*P,e[5]=(i*S-n*E+o*k)*P,e[6]=(g*x-_*A-v*y)*P,e[7]=(c*A-f*x+d*y)*P,e[8]=(a*R-s*E+u*T)*P,e[9]=(r*E-i*R-o*T)*P,e[10]=(_*w-p*x+v*m)*P,e[11]=(h*x-c*w-d*m)*P,e[12]=(s*k-a*M-l*T)*P,e[13]=(i*M-r*k+n*T)*P,e[14]=(p*y-_*b-g*m)*P,e[15]=(c*b-h*y+f*m)*P,e):null}},Uo={transformMat4:function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3];return e[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*a,e[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*a,e[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*a,e[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*a,e},normalize:function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i*i+r*r+n*n+o*o;0<a&&(a=1/Math.sqrt(a),e[0]=i*a,e[1]=r*a,e[2]=n*a,e[3]=o*a);return e},scale:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}},Go=0,Bo=0,Vo=function(){function A(e){var t=e.coords,i=e.style_zoom,r=e.source,n=e.worker,o=e.view,a=e.sceneId;pr(this,A),this.textureManager=Lo(a),this.id=Go++,this.worker=n,this.view=o,this.source=r,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=i,this.coords=A.normalizedCoordinate(t,this.source,this.style_zoom),this.key=A.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=Jr.metersForTile(this.coords),this.max=Jr.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=Jr.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=Jr.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=Jr.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return vr(A,[{key:"freeResources",value:function(){for(var e in this.meshes)this.meshes[e].forEach(function(e){return e.destroy()});this.meshes={}}},{key:"destroy",value:function(){So.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return un.postMessage.apply(un,[this.worker].concat(t))}},{key:"build",value:function(e,t){var i=(1<arguments.length&&void 0!==t?t:{}).fade_in,r=void 0===i||i;return this.generation=e,this.fade_in=r,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(e,t){if(!this.error){this.build_id=Bo++;var i={},r=this.mesh_data;if(r)for(var n in r){for(var o in r[n].meshes){var a=r[n].meshes[o];if(a.vertex_data){if(!e[n]){An("warn","Could not create mesh because style '".concat(n,"' not found, for tile ").concat(this.key,", aborting tile"));break}var s=Object.assign({},r[n]);s.uniforms=Object.assign({},s.uniforms,a.uniforms),s.variant=a.variant,a.textures&&(s.textures=a.textures),a.labels&&(s.retain=!0);var l=e[n].makeMesh(a.vertex_data,a.vertex_elements,s);l.variant=s.variant,l.labels=a.labels,i[n]=i[n]||[],i[n].push(l),null==l.variant.order&&(l.variant.order=i[n].length-1)}}i[n]&&i[n].sort(function(e,t){var i=e.variant.order,r=t.variant.order;return null!=i&&(null==r||i<r)?-1:1})}for(var u in delete this.mesh_data,i)this.meshes[u]&&this.meshes[u].forEach(function(e){return e.destroy()}),this.meshes[u]=i[u],this.new_mesh_styles.push(u);if(t.done){for(var c in this.meshes)-1===this.new_mesh_styles.indexOf(c)&&(this.meshes[c].forEach(function(e){return e.destroy()}),delete this.meshes[c]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(e){e?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(e),this.proxy_depth=1,e.proxied_as=e.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return null!=this.proxy_for}},{key:"shouldProxyForStyle",value:function(t){return!this.proxy_for||this.proxy_for.some(function(e){return null==e.meshes[t]})}},{key:"setupProgram",value:function(e,t){var i=e.model,r=e.model32;t.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),t.uniform("1f","u_tile_proxy_depth",this.proxy_depth),jo.identity(i),jo.translate(i,i,Fo.fromValues(this.min.x,this.min.y,0)),jo.scale(i,i,Fo.fromValues(this.span.x/Jr.tile_scale,-1*this.span.y/Jr.tile_scale,1)),jo.copy(r,i),t.uniform("Matrix4fv","u_model",r),t.uniform("1i","u_tile_fade_in",this.fade_in&&"child"!==this.proxied_as)}},{key:"merge",value:function(e){return this.loading=e.loading,this.loaded=e.loaded,this.generation=e.generation,this.error=e.error,this.mesh_data=e.mesh_data,this.selection_data?Object.assign(this.selection_data,e.selection_data):this.selection_data=e.selection_data,this}}],[{key:"coord",value:function(e){return{x:e.x,y:e.y,z:e.z,key:A.coordKey(e)}}},{key:"coordKey",value:function(e){return e.x+"/"+e.y+"/"+e.z}},{key:"key",value:function(e,t,i){if(!(e.y<0||e.y>=1<<e.z||e.z<0))return[t.name,i,e.x,e.y,e.z].join("/")}},{key:"normalizedKey",value:function(e,t,i){return A.key(A.normalizedCoordinate(e,t,i),t,i)}},{key:"normalizedCoordinate",value:function(e,t){return t.zoom_bias&&(e=A.coordinateAtZoom(e,Math.max(0,e.z-t.zoom_bias))),A.coordinateWithMaxZoom(e,t.max_zoom)}},{key:"coordinateAtZoom",value:function(e,t){var i,r=e.x,n=e.y,o=e.z;return o!==t&&(i=Math.pow(2,o-t),r=Math.floor(r/i),n=Math.floor(n/i),o=t),A.coord({x:r,y:n,z:o})}},{key:"coordinateWithMaxZoom",value:function(e,t){var i=e.x,r=e.y,n=e.z;return void 0!==t&&t<n?A.coordinateAtZoom({x:i,y:r,z:n},t):A.coord({x:i,y:r,z:n})}},{key:"childrenForCoordinate",value:function(e){var t=e.x,i=e.y,r=e.z,n=e.key;return A.coord_children[n]||(r++,t*=2,i*=2,A.coord_children[n]=[A.coord({x:t,y:i,z:r}),A.coord({x:t+1,y:i,z:r}),A.coord({x:t,y:i+1,z:r}),A.coord({x:t+1,y:i+1,z:r})]),A.coord_children[n]}},{key:"isDescendant",value:function(e,t){if(t.z>e.z){var i=A.coordinateAtZoom(t,e.z),r=i.x,n=i.y;return e.x===r&&e.y===n}return!1}},{key:"cancel",value:function(e){e&&(e.canceled=!0,e.source_data&&e.source_data.request_id&&(kn.cancelRequest(e.source_data.request_id),e.source_data.request_id=null),A.abortBuild(e))}},{key:"buildGeometry",value:function(e,t){var i=t.scene_id,r=t.layers,n=t.styles,o=t.global,a=t.sources,s=e.source_data;for(var l in Ro.startTile(e.id,{apply_repeat_groups:!0}),r){var u=r[l];if(u&&u.config_data){if(u.config_data.source===e.source)for(var c=A._getDataForSource(s,u.config_data,l),h=0;h<c.length;h++){var f=c[h],d=f.geom;if(d)for(var _=0;_<d.features.length;_++){var p=d.features[_];if(null!=p.geometry){var g=mo.getFeatureParseContext(p,e,o,a);g.winding=e.default_winding,g.source=e.source,g.layer=f.layer;var v=u.buildDrawGroups(g,!0);if(v)for(var m in v){var y=v[m],x=y.style||m,b=n[x];b?null!=(y=b.preprocess(y,e.source))&&!1!==y.visible&&(g.layers=y.layers,b.addFeature(p,y,g)):An("warn","Style '".concat(x,"' not found, skipping layer '").concat(l,"':"),y,p)}}}}}else An("warn","Layer ".concat(l," was defined without a geometry data source and will not be rendered."))}var w=A._stylesForTile(e,n);A._sendStyleGroups(e,w,{scene_id:i},function(e){return e.collision?"collision":"non-collision"})}},{key:"_stylesForTile",value:function(e,t){var i=[];for(var r in t)t[r].hasDataForTile(e)&&i.push(t[r]);return i}},{key:"_sendStyleGroups",value:function(r,e,t,i){var n=t.scene_id,o={};e.forEach(function(e){var t=i(e);o[t]=o[t]||[],o[t].push(e)}),0<Object.keys(o).length?function(){var i={start:!0};r.mesh_data={};for(var e in o)!function(t){var e=o[t];Promise.all(e.map(function(e){return e.endData(r)})).then(function(){An("trace","Finished style group '".concat(t,"' for tile ").concat(r.key)),o[t]=[],Object.keys(o).every(function(e){return 0===o[e].length})&&(i.done=!0),un.postMessage("TileManager_".concat(n,".buildTileStylesCompleted"),un.withTransferables({tile:A.slice(r,["mesh_data","selection_data"]),progress:i})),i.start=null,r.mesh_data={},r.selection_data={},i.done&&Ro.resetTile(r.id)},function(e){An("error","Error for style group '".concat(t,"' for tile ").concat(r.key),e)})}(e)}():(un.postMessage("TileManager_".concat(n,".buildTileStylesCompleted"),un.withTransferables({tile:A.slice(r),progress:{start:!0,done:!0}})),Ro.resetTile(r.id))}},{key:"_getDataForSource",value:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:null,n=[];return null!=e&&null!=t&&null!=t.layers&&(!e.layer&&t.layers._default||"string"==typeof e.layer&&!t.layers[e.layer]&&new RegExp("^\\d+_"+e.layer+"$").test(r)&&t.layers._default?n.push({geom:t.layers._default}):!e.layer&&r?n.push({layer:r,geom:t.layers[r]}):"string"==typeof e.layer?n.push({layer:e.layer,geom:t.layers[e.layer]}):Array.isArray(e.layer)&&e.layer.forEach(function(e){t.layers[e]&&t.layers[e].features&&n.push({layer:e,geom:t.layers[e]})})),n}},{key:"abortBuild",value:function(i,r){if(So.removeForTile(i.id),Ro.abortTile(i.id),i.mesh_data)for(var e in i.mesh_data){var t=i.mesh_data[e].textures;t&&t.forEach(function(e){var t=Lo(r).textures[e];t&&(An("trace","releasing texture ".concat(e," for tile ").concat(i.key)),t.release())})}}},{key:"slice",value:function(e,t){var i=["id","key","loading","loaded","generation","error","debug"];Array.isArray(t)&&i.push.apply(i,zr(t));for(var r={},n=0;n<i.length;n++){var o=i[n];r[o]=e[o]}return r}}]),A}();Vo.coord_children={};var qo,Ho=function(){br(n,Fn);var r=Rr(n);function n(e,t){var i;return pr(this,n),-1===(i=r.call(this,e,t)).rasters.indexOf(i.name)&&i.rasters.unshift(i.name),i.filtering=e.filtering,i.textures={},i}return vr(n,[{key:"load",value:function(e){e.source_data={},e.source_data.layers={},e.pad_scale=this.pad_scale,e.rasters=zr(this.rasters);var t=Jr.tile_scale;return e.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[t,0],[t,-t],[0,-t],[0,0]]]},properties:{}}]}},e.default_winding="CW",Promise.resolve(e)}},{key:"tileTexture",value:function(e){var t,i,r=e.coords.key;return this.textures[r]||(t=Vo.coordinateWithMaxZoom(e.coords,this.max_zoom),i=this.formatUrl(this.url,{coords:t}),this.textures[r]={url:i,filtering:this.filtering,coords:t}),this.textures[r]}}]),n}();In.register(Ho,"Raster");var Yo=qo={};function Xo(e,t,i,r){for(var n,o=r,a=i-t>>1,s=i-t,l=e[t],u=e[t+1],c=e[i],h=e[i+1],f=t+3;f<i;f+=3){var d,_=function(e,t,i,r,n,o){var a=n-i,s=o-r;{var l;0===a&&0===s||(1<(l=((e-i)*a+(t-r)*s)/(a*a+s*s))?(i=n,r=o):0<l&&(i+=a*l,r+=s*l))}return(a=e-i)*a+(s=t-r)*s}(e[f],e[f+1],l,u,c,h);o<_?(n=f,o=_):_!==o||(d=Math.abs(f-a))<s&&(n=f,s=d)}r<o&&(3<n-t&&Xo(e,t,n,r),e[n+2]=o,3<i-n&&Xo(e,n,i,r))}function Wo(e,t,i,r){var n={id:void 0===e?null:e,type:t,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,i=e.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)Zo(e,t);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<t.length;r++)Zo(e,t[r]);else if("MultiPolygon"===i)for(r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)Zo(e,t[r][n])}(n),n}function Zo(e,t){for(var i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}function Ko(e,t){var i=[];if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)$o(i,e.features[r],t,r);else"Feature"===e.type?$o(i,e,t):$o(i,{geometry:e},t);return i}function $o(e,t,i,r){if(t.geometry){var n=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=t.id;if(i.promoteId?l=t.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===o)Jo(n,s);else if("MultiPoint"===o)for(var u=0;u<n.length;u++)Jo(n[u],s);else if("LineString"===o)Qo(n,s,a,!1);else if("MultiLineString"===o){if(i.lineMetrics){for(u=0;u<n.length;u++)s=[],Qo(n[u],s,a,!1),e.push(Wo(l,"LineString",s,t.properties));return}ea(n,s,a,!1)}else if("Polygon"===o)ea(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(u=0;u<t.geometry.geometries.length;u++)$o(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},i,r);return}for(u=0;u<n.length;u++){var c=[];ea(n[u],c,a,!0),s.push(c)}}e.push(Wo(l,o,s,t.properties))}}function Jo(e,t){t.push(ta(e[0])),t.push(ia(e[1])),t.push(0)}function Qo(e,t,i,r){for(var n,o,a=0,s=0;s<e.length;s++){var l=ta(e[s][0]),u=ia(e[s][1]);t.push(l),t.push(u),t.push(0),0<s&&(a+=r?(n*u-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-o,2))),n=l,o=u}var c=t.length-3;t[2]=1,Xo(t,0,c,i),t[2+c]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function ea(e,t,i,r){for(var n=0;n<e.length;n++){var o=[];Qo(e[n],o,i,r),t.push(o)}}function ta(e){return e/360+.5}function ia(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:1<i?1:i}function ra(e,t,i,r,n,o,a,s){if(r/=t,(i/=t)<=o&&a<r)return e;if(a<i||r<=o)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],h=c.geometry,f=c.type,d=0===n?c.minX:c.minY,_=0===n?c.maxX:c.maxY;if(i<=d&&_<r)l.push(c);else if(!(_<i||r<=d)){var p=[];if("Point"===f||"MultiPoint"===f)!function(e,t,i,r,n){for(var o=0;o<e.length;o+=3){var a=e[o+n];i<=a&&a<=r&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}(h,p,i,r,n);else if("LineString"===f)na(h,p,i,r,n,!1,s.lineMetrics);else if("MultiLineString"===f)aa(h,p,i,r,n,!1);else if("Polygon"===f)aa(h,p,i,r,n,!0);else if("MultiPolygon"===f)for(var g=0;g<h.length;g++){var v=[];aa(h[g],v,i,r,n,!0),v.length&&p.push(v)}if(p.length){if(s.lineMetrics&&"LineString"===f){for(g=0;g<p.length;g++)l.push(Wo(c.id,f,p[g],c.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===p.length?(f="LineString",p=p[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===p.length?"Point":"MultiPoint"),l.push(Wo(c.id,f,p,c.tags))}}}return l.length?l:null}function na(e,t,i,r,n,o,a){for(var s,l,u=oa(e),c=0===n?la:ua,h=e.start,f=0;f<e.length-3;f+=3){var d=e[f],_=e[f+1],p=e[f+2],g=e[f+3],v=e[f+4],m=0===n?d:_,y=0===n?g:v,x=!1;a&&(s=Math.sqrt(Math.pow(d-g,2)+Math.pow(_-v,2))),m<i?i<y&&(l=c(u,d,_,g,v,i),a&&(u.start=h+s*l)):r<m?y<r&&(l=c(u,d,_,g,v,r),a&&(u.start=h+s*l)):sa(u,d,_,p),y<i&&i<=m&&(l=c(u,d,_,g,v,i),x=!0),r<y&&m<=r&&(l=c(u,d,_,g,v,r),x=!0),!o&&x&&(a&&(u.end=h+s*l),t.push(u),u=oa(e)),a&&(h+=s)}var b=e.length-3,d=e[b],_=e[b+1],p=e[b+2];i<=(m=0===n?d:_)&&m<=r&&sa(u,d,_,p),b=u.length-3,o&&3<=b&&(u[b]!==u[0]||u[b+1]!==u[1])&&sa(u,u[0],u[1],u[2]),u.length&&t.push(u)}function oa(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function aa(e,t,i,r,n,o){for(var a=0;a<e.length;a++)na(e[a],t,i,r,n,o,!1)}function sa(e,t,i,r){e.push(t),e.push(i),e.push(r)}function la(e,t,i,r,n,o){var a=(o-t)/(r-t);return e.push(o),e.push(i+(n-i)*a),e.push(1),a}function ua(e,t,i,r,n,o){var a=(o-i)/(n-i);return e.push(t+(r-t)*a),e.push(o),e.push(1),a}function ca(e,t){var i=t.buffer/t.extent,r=e,n=ra(e,1,-1-i,i,0,-1,2,t),o=ra(e,1,1-i,2+i,0,-1,2,t);return(n||o)&&(r=ra(e,1,-i,1+i,0,-1,2,t)||[],n&&(r=ha(n,1).concat(r)),o&&(r=r.concat(ha(o,-1)))),r}function ha(e,t){for(var i=[],r=0;r<e.length;r++){var n,o=e[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=fa(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(fa(o.geometry[s],t))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(fa(o.geometry[s][u],t));n.push(l)}i.push(Wo(o.id,a,n,o.tags))}return i}function fa(e,t){var i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(var r=0;r<e.length;r+=3)i.push(e[r]+t,e[r+1],e[r+2]);return i}function da(e,t){if(e.transformed)return e;for(var i,r=1<<e.z,n=e.x,o=e.y,a=0;a<e.features.length;a++){var s=e.features[a],l=s.geometry,u=s.type;if(s.geometry=[],1===u)for(i=0;i<l.length;i+=2)s.geometry.push(_a(l[i],l[i+1],t,r,n,o));else for(i=0;i<l.length;i++){for(var c=[],h=0;h<l[i].length;h+=2)c.push(_a(l[i][h],l[i][h+1],t,r,n,o));s.geometry.push(c)}}return e.transformed=!0,e}function _a(e,t,i,r,n,o){return[Math.round(i*(e*r-n)),Math.round(i*(t*r-o))]}function pa(e,t,i,r,n){for(var o=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,function(e,t,i,r){var n=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)ga(a,n,e,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)ga(a,n[s],e,i,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++)ga(a,u[s],e,i,!0,0===s)}if(a.length){var c=t.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==t.id&&(f.id=t.id),e.features.push(f)}}(a,e[s],o,n);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,h=e[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function ga(e,t,i,r,n,o){var a=r*r;if(0<r&&t.size<(n?a:r))i.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===r||t[l+2]>a)&&(i.numSimplified++,s.push(t[l]),s.push(t[l+1])),i.numPoints++;n&&function(e,t){for(var i=0,r=0,n=e.length,o=n-2;r<n;o=r,r+=2)i+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(0<i===t)for(r=0,n=e.length;r<n/2;r+=2){var a=e[r],s=e[r+1];e[r]=e[n-2-r],e[r+1]=e[n-1-r],e[n-2-r]=a,e[n-1-r]=s}}(s,o),e.push(s)}}var va={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!(qo.deepClone=function(e){return Array.isArray(e)?e.map(qo.deepClone):e}),promoteId:null,generateId:!1};function ma(e,t,i,r,n){var o=Object.assign({},va,n),a=Ko(e,o),s=function(e){var t,i=2,r=-1,n=1,o=0,a=Ir(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;s.minX<i&&(i=s.minX),s.maxX>r&&(r=s.maxX),s.minY<n&&(n=s.minY),s.maxY>o&&(o=s.maxY)}}catch(e){a.e(e)}finally{a.f()}return{minX:i,maxX:r,minY:n,maxY:o}}(a=ca(a,o)),l=s.minX,u=s.minY,c=s.maxX,h=s.maxY,f=1<<t,d=o.buffer/o.extent,_=1+d;return a=ra(a,f,i-d,i+_,0,l,c,o)||[],da(pa(a=ra(a,f,r-d,r+_,1,u,h,o)||[],t,i,r,o),o.extent)}function ya(e,t){this.items=[],this.algorithm=e;var i=void 0===(t=t||{}).sort||t.sort;this.sort=i}ya.prototype={addItem:function(e){this.items.push(e)},normalizeCoordinates:function(){var e=this.items,i=1/0,r=1/0;e.forEach(function(e){var t=e;i=Math.min(i,t.x),r=Math.min(r,t.y)}),e.forEach(function(e){var t=e;t.x-=i,t.y-=r})},getStats:function(){var e=this.items.map(function(e){return e}),t=e.map(function(e){return e.x}),i=e.map(function(e){return e.y}),r=e.map(function(e){return e.x+e.width}),n=e.map(function(e){return e.y+e.height});return{minX:Math.max.apply(Math,t),minY:Math.max.apply(Math,i),maxX:Math.max.apply(Math,r),maxY:Math.max.apply(Math,n)}},getItems:function(){return this.items},processItems:function(){var e=this.items;return this.sort&&(e=this.algorithm.sort(e)),e=this.algorithm.placeItems(e),this.items=e},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var e=this.exportItems(),t=this.getStats();return{height:t.maxY,width:t.maxX,items:e}}};var xa=ya,ba=[],wa=[],Aa="undefined"!=typeof Uint8Array?Uint8Array:Array,Ta=!1;function ka(){Ta=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,i=e.length;t<i;++t)ba[t]=e[t],wa[e.charCodeAt(t)]=t;wa["-".charCodeAt(0)]=62,wa["_".charCodeAt(0)]=63}function Ea(e){var t,i,r,n;Ta||ka();var o=e.length;if(0<o%4)throw new Error("Invalid string. Length must be a multiple of 4");r="="===e[o-2]?2:"="===e[o-1]?1:0,n=new Aa(3*o/4-r),t=0<r?o-4:o;for(var a=0,s=0;s<t;s+=4,0)i=wa[e.charCodeAt(s)]<<18|wa[e.charCodeAt(s+1)]<<12|wa[e.charCodeAt(s+2)]<<6|wa[e.charCodeAt(s+3)],n[a++]=i>>16&255,n[a++]=i>>8&255,n[a++]=255&i;return 2==r?(i=wa[e.charCodeAt(s)]<<2|wa[e.charCodeAt(s+1)]>>4,n[a++]=255&i):1==r&&(i=wa[e.charCodeAt(s)]<<10|wa[e.charCodeAt(s+1)]<<4|wa[e.charCodeAt(s+2)]>>2,n[a++]=i>>8&255,n[a++]=255&i),n}function Ma(e,t,i){for(var r,n,o=[],a=t;a<i;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(ba[(n=r)>>18&63]+ba[n>>12&63]+ba[n>>6&63]+ba[63&n]);return o.join("")}function Ra(e){var t;Ta||ka();for(var i=e.length,r=i%3,n="",o=[],a=0,s=i-r;a<s;a+=16383)o.push(Ma(e,a,s<a+16383?s:a+16383));return 1==r?(t=e[i-1],n+=ba[t>>2],n+=ba[t<<4&63],n+="=="):2==r&&(t=(e[i-2]<<8)+e[i-1],n+=ba[t>>10],n+=ba[t>>4&63],n+=ba[t<<2&63],n+="="),o.push(n),o.join("")}function Sa(e,t,i,r,n){var o,a,s=8*n-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?n-1:0,f=i?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=s;0<c;o=256*o+e[t+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+e[t+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)}function Pa(e,t,i,r,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,h=c>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,_=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(t+=1<=a+h?f/l:f*Math.pow(2,1-h))*l&&(a++,l/=2),c<=a+h?(s=0,a=c):1<=a+h?(s=(t*l-1)*Math.pow(2,n),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,n),a=0));8<=n;e[i+d]=255&s,d+=_,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;e[i+d]=255&a,d+=_,a/=256,u-=8);e[i+d-_]|=128*p}var za={}.toString,Na=Array.isArray||function(e){return"[object Array]"==za.call(e)};Ca.TYPED_ARRAY_SUPPORT=void 0===Xr.TYPED_ARRAY_SUPPORT||Xr.TYPED_ARRAY_SUPPORT;var Oa=Ia();function Ia(){return Ca.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function La(e,t){if(Ia()<t)throw new RangeError("Invalid typed array length");return Ca.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Ca.prototype:(null===e&&(e=new Ca(t)),e.length=t),e}function Ca(e,t,i){if(!(Ca.TYPED_ARRAY_SUPPORT||this instanceof Ca))return new Ca(e,t,i);if("number"!=typeof e)return Fa(this,e,t,i);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return ja(this,e)}function Fa(e,t,i,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,r){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===i&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,i):new Uint8Array(t,i,r);Ca.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Ca.prototype:e=Ua(e,t);return e}(e,t,i,r):"string"==typeof t?function(e,t,i){"string"==typeof i&&""!==i||(i="utf8");if(!Ca.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var r=0|Va(t,i),n=(e=La(e,r)).write(t,i);n!==r&&(e=e.slice(0,n));return e}(e,t,i):function(e,t){if(Ba(t)){var i=0|Ga(t.length);return 0===(e=La(e,i)).length?e:(t.copy(e,0,0,i),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?La(e,0):Ua(e,t);if("Buffer"===t.type&&Na(t.data))return Ua(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function Da(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function ja(e,t){if(Da(t),e=La(e,t<0?0:0|Ga(t)),!Ca.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function Ua(e,t){var i=t.length<0?0:0|Ga(t.length);e=La(e,i);for(var r=0;r<i;r+=1)e[r]=255&t[r];return e}function Ga(e){if(e>=Ia())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ia().toString(16)+" bytes");return 0|e}function Ba(e){return null!=e&&e._isBuffer}function Va(e,t){if(Ba(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return as(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return ss(e).length;default:if(r)return as(e).length;t=(""+t).toLowerCase(),r=!0}}function qa(e,t,i){var r,n,o,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,i){var r=e.length;(!t||t<0)&&(t=0);(!i||i<0||r<i)&&(i=r);for(var n="",o=t;o<i;++o)n+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[o]);return n}(this,t,i);case"utf8":case"utf-8":return Ka(this,t,i);case"ascii":return function(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}(this,t,i);case"latin1":case"binary":return function(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}(this,t,i);case"base64":return r=this,o=i,0===(n=t)&&o===r.length?Ra(r):Ra(r.slice(n,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,i){for(var r=e.slice(t,i),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}(this,t,i);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function Ha(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function Ya(e,t,i,r,n){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return-1;i=e.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof t&&(t=Ca.from(t,r)),Ba(t))return 0===t.length?-1:Xa(e,t,i,r,n);if("number"==typeof t)return t&=255,Ca.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):Xa(e,[t],i,r,n);throw new TypeError("val must be string, number or Buffer")}function Xa(e,t,i,r,n){var o=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a/=o=2,s/=2,i/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(n)for(var u=-1,c=i;c<a;c++)if(l(e,c)===l(t,-1===u?0:c-u)){if(-1===u&&(u=c),c-u+1===s)return u*o}else-1!==u&&(c-=c-u),u=-1;else for(a<i+s&&(i=a-s),c=i;0<=c;c--){for(var h=!0,f=0;f<s;f++)if(l(e,c+f)!==l(t,f)){h=!1;break}if(h)return c}return-1}function Wa(e,t,i,r){return ls(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,r)}function Za(e,t,i,r){return ls(function(e,t){for(var i,r,n,o=[],a=0;a<e.length&&!((t-=2)<0);++a)i=e.charCodeAt(a),r=i>>8,n=i%256,o.push(n),o.push(r);return o}(t,e.length-i),e,i,r)}function Ka(e,t,i){i=Math.min(e.length,i);for(var r=[],n=t;n<i;){var o,a,s,l,u=e[n],c=null,h=239<u?4:223<u?3:191<u?2:1;if(n+h<=i)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[n+1]))&&127<(l=(31&u)<<6|63&o)&&(c=l);break;case 3:o=e[n+1],a=e[n+2],128==(192&o)&&128==(192&a)&&2047<(l=(15&u)<<12|(63&o)<<6|63&a)&&(l<55296||57343<l)&&(c=l);break;case 4:o=e[n+1],a=e[n+2],s=e[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,h=1):65535<c&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),n+=h}return function(e){var t=e.length;if(t<=$a)return String.fromCharCode.apply(String,e);var i="",r=0;for(;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=$a));return i}(r)}Ca.poolSize=8192,Ca._augment=function(e){return e.__proto__=Ca.prototype,e},Ca.from=function(e,t,i){return Fa(null,e,t,i)},Ca.TYPED_ARRAY_SUPPORT&&(Ca.prototype.__proto__=Uint8Array.prototype,Ca.__proto__=Uint8Array),Ca.alloc=function(e,t,i){return r=null,o=t,a=i,Da(n=e),n<=0||void 0===o?La(r,n):"string"==typeof a?La(r,n).fill(o,a):La(r,n).fill(o);var r,n,o,a},Ca.allocUnsafe=function(e){return ja(null,e)},Ca.allocUnsafeSlow=function(e){return ja(null,e)},Ca.isBuffer=us,Ca.compare=function(e,t){if(!Ba(e)||!Ba(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,r=t.length,n=0,o=Math.min(i,r);n<o;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0},Ca.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ca.concat=function(e,t){if(!Na(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Ca.alloc(0);if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;for(var i=Ca.allocUnsafe(t),r=0,n=0;n<e.length;++n){var o=e[n];if(!Ba(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},Ca.byteLength=Va,Ca.prototype._isBuffer=!0,Ca.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Ha(this,t,t+1);return this},Ca.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Ha(this,t,t+3),Ha(this,t+1,t+2);return this},Ca.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Ha(this,t,t+7),Ha(this,t+1,t+6),Ha(this,t+2,t+5),Ha(this,t+3,t+4);return this},Ca.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?Ka(this,0,e):qa.apply(this,arguments)},Ca.prototype.equals=function(e){if(!Ba(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Ca.compare(this,e)},Ca.prototype.inspect=function(){var e="";return 0<this.length&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(e+=" ... ")),"<Buffer "+e+">"},Ca.prototype.compare=function(e,t,i,r,n){if(!Ba(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(n<=r&&i<=t)return 0;if(n<=r)return-1;if(i<=t)return 1;if(this===e)return 0;for(var o=(n>>>=0)-(r>>>=0),a=(i>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(r,n),u=e.slice(t,i),c=0;c<s;++c)if(l[c]!==u[c]){o=l[c],a=u[c];break}return o<a?-1:a<o?1:0},Ca.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},Ca.prototype.indexOf=function(e,t,i){return Ya(this,e,t,i,!0)},Ca.prototype.lastIndexOf=function(e,t,i){return Ya(this,e,t,i,!1)},Ca.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-t;if((void 0===i||n<i)&&(i=n),0<e.length&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,a,s,l,u,c,h=!1;;)switch(r){case"hex":return function(e,t,i,r){i=Number(i)||0;var n=e.length-i;(!r||n<(r=Number(r)))&&(r=n);var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<r&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[i+a]=s}return a}(this,e,t,i);case"utf8":case"utf-8":return u=t,c=i,ls(as(e,(l=this).length-u),l,u,c);case"ascii":return Wa(this,e,t,i);case"latin1":case"binary":return Wa(this,e,t,i);case"base64":return o=this,a=t,s=i,ls(ss(e),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Za(this,e,t,i);default:if(h)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),h=!0}},Ca.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $a=4096;function Ja(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(i<e+t)throw new RangeError("Trying to access beyond buffer length")}function Qa(e,t,i,r,n,o){if(!Ba(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<t||t<o)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function es(e,t,i,r){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-i,2);n<o;++n)e[i+n]=(t&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function ts(e,t,i,r){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-i,4);n<o;++n)e[i+n]=t>>>8*(r?n:3-n)&255}function is(e,t,i,r){if(i+r>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function rs(e,t,i,r,n){return n||is(e,0,i,4),Pa(e,t,i,r,23,4),i+4}function ns(e,t,i,r,n){return n||is(e,0,i,8),Pa(e,t,i,r,52,8),i+8}Ca.prototype.slice=function(e,t){var i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e),Ca.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=Ca.prototype;else for(var r=t-e,n=new Ca(r,void 0),o=0;o<r;++o)n[o]=this[o+e];return n},Ca.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||Ja(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r},Ca.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||Ja(e,t,this.length);for(var r=this[e+--t],n=1;0<t&&(n*=256);)r+=this[e+--t]*n;return r},Ca.prototype.readUInt8=function(e,t){return t||Ja(e,1,this.length),this[e]},Ca.prototype.readUInt16LE=function(e,t){return t||Ja(e,2,this.length),this[e]|this[e+1]<<8},Ca.prototype.readUInt16BE=function(e,t){return t||Ja(e,2,this.length),this[e]<<8|this[e+1]},Ca.prototype.readUInt32LE=function(e,t){return t||Ja(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ca.prototype.readUInt32BE=function(e,t){return t||Ja(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ca.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||Ja(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return(n*=128)<=r&&(r-=Math.pow(2,8*t)),r},Ca.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||Ja(e,t,this.length);for(var r=t,n=1,o=this[e+--r];0<r&&(n*=256);)o+=this[e+--r]*n;return(n*=128)<=o&&(o-=Math.pow(2,8*t)),o},Ca.prototype.readInt8=function(e,t){return t||Ja(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ca.prototype.readInt16LE=function(e,t){t||Ja(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},Ca.prototype.readInt16BE=function(e,t){t||Ja(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},Ca.prototype.readInt32LE=function(e,t){return t||Ja(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ca.prototype.readInt32BE=function(e,t){return t||Ja(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ca.prototype.readFloatLE=function(e,t){return t||Ja(e,4,this.length),Sa(this,e,!0,23,4)},Ca.prototype.readFloatBE=function(e,t){return t||Ja(e,4,this.length),Sa(this,e,!1,23,4)},Ca.prototype.readDoubleLE=function(e,t){return t||Ja(e,8,this.length),Sa(this,e,!0,52,8)},Ca.prototype.readDoubleBE=function(e,t){return t||Ja(e,8,this.length),Sa(this,e,!1,52,8)},Ca.prototype.writeUIntLE=function(e,t,i,r){e=+e,t|=0,i|=0,r||Qa(this,e,t,i,Math.pow(2,8*i)-1,0);var n=1,o=0;for(this[t]=255&e;++o<i&&(n*=256);)this[t+o]=e/n&255;return t+i},Ca.prototype.writeUIntBE=function(e,t,i,r){e=+e,t|=0,i|=0,r||Qa(this,e,t,i,Math.pow(2,8*i)-1,0);var n=i-1,o=1;for(this[t+n]=255&e;0<=--n&&(o*=256);)this[t+n]=e/o&255;return t+i},Ca.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,1,255,0),Ca.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Ca.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,2,65535,0),Ca.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):es(this,e,t,!0),t+2},Ca.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,2,65535,0),Ca.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):es(this,e,t,!1),t+2},Ca.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,4,4294967295,0),Ca.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ts(this,e,t,!0),t+4},Ca.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,4,4294967295,0),Ca.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ts(this,e,t,!1),t+4},Ca.prototype.writeIntLE=function(e,t,i,r){var n;e=+e,t|=0,r||Qa(this,e,t,i,(n=Math.pow(2,8*i-1))-1,-n);var o=0,a=1,s=0;for(this[t]=255&e;++o<i&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+i},Ca.prototype.writeIntBE=function(e,t,i,r){var n;e=+e,t|=0,r||Qa(this,e,t,i,(n=Math.pow(2,8*i-1))-1,-n);var o=i-1,a=1,s=0;for(this[t+o]=255&e;0<=--o&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+i},Ca.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,1,127,-128),Ca.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Ca.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,2,32767,-32768),Ca.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):es(this,e,t,!0),t+2},Ca.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,2,32767,-32768),Ca.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):es(this,e,t,!1),t+2},Ca.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,4,2147483647,-2147483648),Ca.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ts(this,e,t,!0),t+4},Ca.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||Qa(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Ca.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ts(this,e,t,!1),t+4},Ca.prototype.writeFloatLE=function(e,t,i){return rs(this,e,t,!0,i)},Ca.prototype.writeFloatBE=function(e,t,i){return rs(this,e,t,!1,i)},Ca.prototype.writeDoubleLE=function(e,t,i){return ns(this,e,t,!0,i)},Ca.prototype.writeDoubleBE=function(e,t,i){return ns(this,e,t,!1,i)},Ca.prototype.copy=function(e,t,i,r){if(i=i||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<i&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var n,o=r-i;if(this===e&&i<t&&t<r)for(n=o-1;0<=n;--n)e[n+t]=this[n+i];else if(o<1e3||!Ca.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)e[n+t]=this[n+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+o),t);return o},Ca.prototype.fill=function(e,t,i,r){if("string"==typeof e){var n;if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),1!==e.length||(n=e.charCodeAt(0))<256&&(e=n),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Ca.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,"number"==typeof(e=e||0))for(s=t;s<i;++s)this[s]=e;else for(var o=Ba(e)?e:as(new Ca(e,r).toString()),a=o.length,s=0;s<i-t;++s)this[s+t]=o[s%a];return this};var os=/[^+\/0-9A-Za-z-_]/g;function as(e,t){var i;t=t||1/0;for(var r=e.length,n=null,o=[],a=0;a<r;++a){if(55295<(i=e.charCodeAt(a))&&i<57344){if(!n){if(56319<i){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&o.push(239,191,189);continue}n=i;continue}if(i<56320){-1<(t-=3)&&o.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&-1<(t-=3)&&o.push(239,191,189);if(n=null,i<128){if(--t<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function ss(e){return Ea(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(os,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function ls(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function us(e){return null!=e&&(!!e._isBuffer||cs(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&cs(t.slice(0,0)));var t}function cs(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var hs=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:Oa,Buffer:Ca,SlowBuffer:function(e){return+e!=e&&(e=0),Ca.alloc(+e)},isBuffer:us});Xr.setTimeout,Xr.clearTimeout;Xr.performance;var fs="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;function i(){}i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e},ds=fs;function _s(e,t){var i={seen:[],stylize:gs};return 3<=arguments.length&&(i.depth=arguments[2]),4<=arguments.length&&(i.colors=arguments[3]),xs(t)?i.showHidden=t:t&&function(e,t){if(!t||!ks(t))return;var i=Object.keys(t),r=i.length;for(;r--;)e[i[r]]=t[i[r]]}(i,t),As(i.showHidden)&&(i.showHidden=!1),As(i.depth)&&(i.depth=2),As(i.colors)&&(i.colors=!1),As(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=ps),vs(i,e,i.depth)}function ps(e,t){var i=_s.styles[t];return i?"\x1b["+_s.colors[i][0]+"m"+e+"\x1b["+_s.colors[i][1]+"m":e}function gs(e,t){return e}function vs(t,i,r){if(t.customInspect&&i&&Rs(i.inspect)&&i.inspect!==_s&&(!i.constructor||i.constructor.prototype!==i)){var e=i.inspect(r,t);return ws(e)||(e=vs(t,e,r)),e}var n=function(e,t){if(As(t))return e.stylize("undefined","undefined");if(ws(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if("number"==typeof t)return e.stylize(""+t,"number");if(xs(t))return e.stylize(""+t,"boolean");if(bs(t))return e.stylize("null","null")}(t,i);if(n)return n;var o,a=Object.keys(i),s=(o={},a.forEach(function(e,t){o[e]=!0}),o);if(t.showHidden&&(a=Object.getOwnPropertyNames(i)),Ms(i)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return ms(i);if(0===a.length){if(Rs(i)){var l=i.name?": "+i.name:"";return t.stylize("[Function"+l+"]","special")}if(Ts(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(Es(i))return t.stylize(Date.prototype.toString.call(i),"date");if(Ms(i))return ms(i)}var u,c,h="",f=!1,d=["{","}"];return u=i,Array.isArray(u)&&(f=!0,d=["[","]"]),Rs(i)&&(h=" [Function"+(i.name?": "+i.name:"")+"]"),Ts(i)&&(h=" "+RegExp.prototype.toString.call(i)),Es(i)&&(h=" "+Date.prototype.toUTCString.call(i)),Ms(i)&&(h=" "+ms(i)),0!==a.length||f&&0!=i.length?r<0?Ts(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),c=f?function(t,i,r,n,e){for(var o=[],a=0,s=i.length;a<s;++a)zs(i,String(a))?o.push(ys(t,i,r,n,String(a),!0)):o.push("");return e.forEach(function(e){e.match(/^\d+$/)||o.push(ys(t,i,r,n,e,!0))}),o}(t,i,r,s,a):a.map(function(e){return ys(t,i,r,s,e,f)}),t.seen.pop(),function(e,t,i){if(60<e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0))return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(c,h,d)):d[0]+h+d[1]}function ms(e){return"["+Error.prototype.toString.call(e)+"]"}function ys(e,t,i,r,n,o){var a,s,l=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]};if(l.get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),zs(r,n)||(a="["+n+"]"),s||(e.seen.indexOf(l.value)<0?-1<(s=bs(i)?vs(e,l.value,null):vs(e,l.value,i-1)).indexOf("\n")&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),As(a)){if(o&&n.match(/^\d+$/))return s;a=(a=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(a,"string"))}return a+": "+s}function xs(e){return"boolean"==typeof e}function bs(e){return null===e}function ws(e){return"string"==typeof e}function As(e){return void 0===e}function Ts(e){return ks(e)&&"[object RegExp]"===Ps(e)}function ks(e){return"object"==typeof e&&null!==e}function Es(e){return ks(e)&&"[object Date]"===Ps(e)}function Ms(e){return ks(e)&&("[object Error]"===Ps(e)||e instanceof Error)}function Rs(e){return"function"==typeof e}function Ss(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function Ps(e){return Object.prototype.toString.call(e)}function zs(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ns(e,t){if(e===t)return 0;for(var i=e.length,r=t.length,n=0,o=Math.min(i,r);n<o;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0}_s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},_s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var Os,Is=Object.prototype.hasOwnProperty,Ls=Object.keys||function(e){var t=[];for(var i in e)Is.call(e,i)&&t.push(i);return t},Cs=Array.prototype.slice;function Fs(){return void 0!==Os?Os:Os="foo"===function(){}.name}function Ds(e){return Object.prototype.toString.call(e)}function js(e){if(!us(e)&&"function"==typeof Xr.ArrayBuffer){if("function"==typeof ArrayBuffer.isView)return ArrayBuffer.isView(e);if(e)return e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)}}function Us(e,t){e||Ys(e,!0,t,"==",Xs)}var Gs=/\s*function\s+([^\(\s]*)\s*/;function Bs(e){if(Rs(e)){if(Fs())return e.name;var t=e.toString().match(Gs);return t&&t[1]}}function Vs(e){var t;this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=qs(Hs((t=this).actual),128)+" "+t.operator+" "+qs(Hs(t.expected),128),this.generatedMessage=!0);var i,r,n,o,a,s=e.stackStartFunction||Ys;Error.captureStackTrace?Error.captureStackTrace(this,s):(i=new Error).stack&&(a=i.stack,r=Bs(s),0<=(n=a.indexOf("\n"+r))&&(o=a.indexOf("\n",n+1),a=a.substring(o+1)),this.stack=a)}function qs(e,t){return"string"!=typeof e||e.length<t?e:e.slice(0,t)}function Hs(e){if(Fs()||!Rs(e))return _s(e);var t=Bs(e);return"[Function"+(t?": "+t:"")+"]"}function Ys(e,t,i,r,n){throw new Vs({message:i,actual:e,expected:t,operator:r,stackStartFunction:n})}function Xs(e,t){e||Ys(e,!0,t,"==",Xs)}function Ws(e,t,i,r){if(e===t)return!0;if(us(e)&&us(t))return 0===Ns(e,t);if(Es(e)&&Es(t))return e.getTime()===t.getTime();if(Ts(e)&&Ts(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(js(e)&&js(t)&&Ds(e)===Ds(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===Ns(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(us(e)!==us(t))return!1;var n=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==n&&n===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,i,r){if(null==e||null==t)return!1;if(Ss(e)||Ss(t))return e===t;if(i&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=Zs(e),o=Zs(t);if(n&&!o||!n&&o)return!1;if(n)return e=Cs.call(e),t=Cs.call(t),Ws(e,t,i);var a,s,l=Ls(e),u=Ls(t);if(l.length!==u.length)return!1;for(l.sort(),u.sort(),s=l.length-1;0<=s;s--)if(l[s]!==u[s])return!1;for(s=l.length-1;0<=s;s--)if(a=l[s],!Ws(e[a],t[a],i,r))return!1;return!0}(e,t,i,r))}return i?e===t:e==t}function Zs(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function Ks(e,t){if(e&&t){if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return 1}catch(e){}if(!Error.isPrototypeOf(t))return!0===t.call({},e)}}function $s(e,t,i,r){var n;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(r=i,i=null),n=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(i&&i.name?" ("+i.name+").":".")+(r?" "+r:"."),e&&!n&&Ys(n,i,"Missing expected exception"+r);var o="string"==typeof r,a=!e&&n&&!i;if((!e&&Ms(n)&&o&&Ks(n,i)||a)&&Ys(n,i,"Got unwanted exception"+r),e&&n&&i&&!Ks(n,i)||!e&&n)throw n}ds(Us.AssertionError=Vs,Error),Us.fail=Ys,Us.ok=Xs,Us.equal=function e(t,i,r){t!=i&&Ys(t,i,r,"==",e)},Us.notEqual=function e(t,i,r){t==i&&Ys(t,i,r,"!=",e)},Us.deepEqual=function e(t,i,r){Ws(t,i,!1)||Ys(t,i,r,"deepEqual",e)},Us.deepStrictEqual=function e(t,i,r){Ws(t,i,!0)||Ys(t,i,r,"deepStrictEqual",e)},Us.notDeepEqual=function e(t,i,r){Ws(t,i,!1)&&Ys(t,i,r,"notDeepEqual",e)},Us.notDeepStrictEqual=function e(t,i,r){Ws(t,i,!0)&&Ys(t,i,r,"notDeepStrictEqual",e)},Us.strictEqual=function e(t,i,r){t!==i&&Ys(t,i,r,"===",e)},Us.notStrictEqual=function e(t,i,r){t===i&&Ys(t,i,r,"!==",e)},Us.throws=function(e,t,i){$s(!0,e,t,i)},Us.doesNotThrow=function(e,t,i){$s(!1,e,t,i)},Us.ifError=function(e){if(e)throw e};function Js(){}var Qs={sort:function(e){return e.sort(function(e,t){return e.height-t.height}),e},placeItems:function(e){var t=0;return e.forEach(function(e){e.x=0,e.y=t,t+=e.height}),e}},el={sort:function(e){return e.sort(function(e,t){return e.width-t.width}),e},placeItems:function(e){var t=0;return e.forEach(function(e){e.x=t,e.y=0,t+=e.width}),e}},tl={sort:function(e){return e.sort(function(e,t){return Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))-Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))}),e},placeItems:function(e){var t=0,i=0;return e.forEach(function(e){e.x=t,e.y=i,t+=e.width,i+=e.height}),e}},il={sort:function(e){return e.sort(function(e,t){return Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))-Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))}),e},placeItems:function(e){var i=0,r=0;return e.forEach(function(e){var t=e.width;e.x=i-t,e.y=r,i-=t,r+=e.height}),e}};Js.prototype={fit:function(e){var t,i,r,n,o=e.length,a=0<o?e[0].width:0,s=0<o?e[0].height:0;for(this.root={x:0,y:0,width:a,height:s},t=0;t<o;t++)r=e[t],n=(i=this.findNode(this.root,r.width,r.height))?this.splitNode(i,r.width,r.height):this.growNode(r.width,r.height),r.x=n.x,r.y=n.y},findNode:function(e,t,i){return e.used?this.findNode(e.right,t,i)||this.findNode(e.down,t,i):t<=e.width&&i<=e.height?e:null},splitNode:function(e,t,i){return e.used=!0,e.down={x:e.x,y:e.y+i,width:e.width,height:e.height-i},e.right={x:e.x+t,y:e.y,width:e.width-t,height:i},e},growNode:function(e,t){var i=e<=this.root.width,r=t<=this.root.height,n=r&&this.root.height>=this.root.width+e,o=i&&this.root.width>=this.root.height+t;return n?this.growRight(e,t):o?this.growDown(e,t):r?this.growRight(e,t):i?this.growDown(e,t):null},growRight:function(e,t){var i;return this.root={used:!0,x:0,y:0,width:this.root.width+e,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:e,height:this.root.height}},(i=this.findNode(this.root,e,t))?this.splitNode(i,e,t):null},growDown:function(e,t){var i;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+t,down:{x:0,y:this.root.height,width:this.root.width,height:t},right:this.root},(i=this.findNode(this.root,e,t))?this.splitNode(i,e,t):null}};var rl=Js,nl={sort:function(e){return e},placeItems:function(e){return function(e,t){t=t||{};var i=new rl,r=t.inPlace||!1,n=(n=e.map(function(e){return r?e:{width:e.width,height:e.height,item:e}})).sort(function(e,t){return t.width*t.height-e.width*e.height});i.fit(n);var o={width:n.reduce(function(e,t){return Math.max(e,t.x+t.width)},0),height:n.reduce(function(e,t){return Math.max(e,t.y+t.height)},0)};r||(o.items=n)}(e,{inPlace:!0}),e}},ol={};function al(e,t){var i=e||"top-down";return"string"==typeof i&&Us(i=ol[e],"Sorry, the '"+e+"' algorithm could not be loaded."),new xa(i,t)}function sl(e,t){ol[e]=t}al.PackingSmith=xa,al.addAlgorithm=sl,al.algorithms=ol,sl("top-down",Qs),sl("left-right",el),sl("diagonal",tl),sl("alt-diagonal",il),sl("binary-tree",nl);var ll=al;function ul(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var i=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if(i)for(var r in i){var n=i[r];null===n||"object"!==_r(n)||Array.isArray(n)?void 0!==n&&(e[r]=n):null===e[r]||"object"!==_r(e[r])||Array.isArray(e[r])?e[r]=ul({},n):e[r]=ul(e[r],n)}}return e}function cl(e){var t;try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){t=e.message}return t}function hl(e,t,i){var r;return e instanceof HTMLImageElement&&((r=e.ownerDocument.createElement("canvas")).width=t,r.height=i,r.getContext("2d").drawImage(e,0,0,t,i),e=r),e}var fl=Jr.metersToLatLng([Jr.half_circumference_meters,Jr.half_circumference_meters]),dl=Math.log(Jr.tile_size)/Math.LN2,_l=function(){br(p,Dn);var r=Rr(p);function p(e,t){var i;return pr(this,p),i=r.call(this,e,t),ln.is_worker&&(i._quad_tree=new Wr.H.geo.QuadTree,i._marker_quad_tree=new Wr.H.geo.QuadTree,i._tree_entries_by_object_id={},i._groups_by_id={},i._layersCache=new Wr.H.util.Cache(100)),ln.is_main&&(i._objects_by_id={},i._commands=[],i._sendCommands=Tn(i._sendCommands,100,200),i.dispatchUpdate=i.dispatchUpdate.bind(Mr(i))),i}return vr(p,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var e,t,i=this.provider.getRootGroup(),r=i.getObjects(!0),n=[];for(r.push(i),e=r.length;e--;)t=r[e],this._isObjectSupported(t)&&this._shouldBeStored(t)&&(this._objects_by_id[t.getId()]=t,n.push(t.forWorkerMessage()));var o=[{method_name:"addObjects",arguments:[n]}];this._sendImmediateCommands(o)}},{key:"onProviderUpdate",value:function(e){var t,i,r,n,o=e.target,a=e.currentTarget.getInvalidations(o.type);this._isObjectSupported(o)&&(t=this._synced_at,i=o.getId(),a.isRemove(t)?(delete this._objects_by_id[i],this._commands.push({method_name:"removeObjectsByIds",arguments:[[i],!0]})):a.isAdd(t)?this._shouldBeStored(o)&&(this._objects_by_id[i]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]})):a.isSpatial(t)||a.isZOrder(t)?this._shouldBeStored(o)&&(r=[{method_name:"removeObjectsByIds",arguments:[[i],!0]},{method_name:"addObjects",arguments:[[(this._objects_by_id[i]=o).forWorkerMessage()]]}],this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(r):this._commands.push(r[0],r[1])):a.isVisual(t)?this._shouldBeStored(o)&&(n={method_name:"updateObjectProperties",arguments:[(this._objects_by_id[i]=o).forWorkerMessage()]},this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([n]):this._commands.push(n)):a.isVolatility(t)&&(delete this._objects_by_id[i],this._commands.push({method_name:"removeObjectsByIds",arguments:[[i],!0]}),this._shouldBeStored(o)&&(this._objects_by_id[i]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]}))),this._commands.length&&this._sendCommands()),this._synced_at=a.getMark()}},{key:"_shouldBeStored",value:function(e){return 16===e.type||(!e.getIcon||1===e.getIcon().getState())&&this._hasSameVolatility(e)}},{key:"_hasSameVolatility",value:function(e){return e.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return 0<this._commands.length}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(e){e.length&&un.postMessage(this.worker,this.target_name+".executeCommands",e).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(e){return e.forWorkerMessage&&8!==e.type}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(e){return this._objects_by_id[e]}},{key:"getIconBitmapByObjectId",value:function(e,t){var i=this.getMapObjectById(e);if(i){var r=i.getIcon();if(r.uid===t&&1===r.getState()){var n=r.getSize();return hl(r.getBitmap(),n.w,n.h)}}}},{key:"_getRastersForMarkers",value:function(e){for(var t={},i=ll("binary-tree"),r=0;r<e.length;r++){var n=e[r],o=n.properties.icon;t[o.id]||(i.addItem({width:o.size.w,height:o.size.h,meta:{objectId:n.id,id:o.id}}),t[o.id]=!0)}return i.export()}},{key:"fetchFeaturesForTile",value:function(e){var t=[],i=[],r=[],n=[],o=[],a=this._marker_quad_tree.intersectBoundingBox(Jr.getTileBoundingBox(e.coords,this.tile_size));e.source_data.error=null;for(var s=0;s<a.length;s++){var l={id:a[s].$feature$.id,properties:Object.assign({},a[s].$feature$.properties),geometry:{type:a[s].$feature$.geometry.type,coordinates:Yo.deepClone(a[s].$feature$.geometry.coordinates)}};t.push(l)}a=this._quad_tree.intersectBoundingBox(Jr.getTileBoundingBox(e.coords,this.tile_size,100));for(var u=0;u<a.length;u++){var c,h={id:a[u].$feature$.id,properties:Object.assign({},a[u].$feature$.properties),geometry:{type:a[u].$feature$.geometry.type,coordinates:Yo.deepClone(a[u].$feature$.geometry.coordinates)}};h.properties.overlay?i.push(h):h.geometry.type.includes("LineString")?r.push(h):h.geometry.type.includes("Polygon")&&(n.push(h),c={id:h.id,properties:h.properties,geometry:{type:h.geometry.type,coordinates:Yo.deepClone(h.geometry.coordinates)}},o.push(c))}t.sort(function(e,t){return p._compareZInfo(t,e)}),n.sort(p._compareZInfo),i.sort(p._compareZInfo);var f=this.has_volatile_data?4096:0;o.sort(p._compareZInfo);for(var d=0;d<o.length;d++)o[d].properties.effectiveZIdx=f++;r.sort(p._compareZInfo);for(var _=0;_<r.length;_++)r[_].properties.effectiveZIdx=f++;e.source_data.layers.markers={type:"FeatureCollection",features:t},e.source_data.layers.polylines={type:"FeatureCollection",features:r},e.source_data.layers.polygons={type:"FeatureCollection",features:n},e.source_data.layers.outlines={type:"FeatureCollection",features:o},e.source_data.layers.overlays={type:"FeatureCollection",features:i}}},{key:"tileTexture",value:function(e){var t=e.source_data.layers.overlays;if(t){var i=this.name+"_"+e.coords.key,r=Vo.coordinateWithMaxZoom(e.coords,this.max_zoom),n=t.features[0].properties.overlays_config;return{name:i,filtering:this.filtering,coords:r,width:Jr.tile_size,height:Jr.tile_size,overlays_config:n,source:this.name}}}},{key:"_load",value:function(e){var t=Jr.wrapTile(e.coords,{x:!0}),i=t.z,r=t.x,n=t.y,o="".concat(i,"_").concat(r,"_").concat(n),a=this._layersCache.get(o),s=!1;if(a)e.source_data.layers=a;else{this.fetchFeaturesForTile(e);var l={maxZoom:this.max_zoom,tolerance:1.5,extent:Jr.tile_scale},u=e.source_data.layers.overlays;u.features.length&&delete e.source_data.layers.overlays;var c=e.source_data.layers.markers;for(var h in c.features.length&&delete e.source_data.layers.markers,e.source_data.layers){var f,d=e.source_data.layers[h];d.features.length&&(l.buffer=h.includes("lines")?100*Jr.units_per_pixel:0,f=ma(d,i,r,n,l),e.source_data.layers[h]=lo(f))}e.source_data.layers.overlays=this._processOverlays(e,u);for(var _=e.source_data.layers.overlays.features.length;_--;)if(!e.source_data.layers.overlays.features[_].id){s=!0,this._layersCache.drop(o);break}e.source_data.layers.markers=this._processMarkers(e,c),this._postProcessTile(e),s||this._layersCache.add(o,e.source_data.layers,1)}return e.rasters=this._getRastersForMarkers(e.source_data.layers.markers.features),Promise.resolve(e)}},{key:"_processMarkers",value:function(e,t){var i=t.features.length;if(i){for(var n=Jr.unitsPerMeter(e.coords.z),r=Jr.wrapTile(e.coords,{x:!0}),o=Jr.metersForTile(r),a=Jr.isLastTile(r),s=Jr.tile_scale,l=function(e){In.coordsToMeters(e),In.metersToTileUnits(n,o,e);var t=Pr(e,2),i=t[0],r=t[1];return 0<=i&&(a.column||i<s)&&0<=r&&(a.row||r<s)},u=[],c=0;c<i;c++){var h,f=t.features[c].geometry,d=!1;"Point"===f.type?l(h=f.coordinates)?f.coordinates=h:d=!0:"MultiPoint"===f.type&&(f.coordinates=f.coordinates.filter(l),0===f.coordinates.length&&(d=!0)),d||u.push(t.features[c])}t.features=u}return t}},{key:"_processOverlays",value:function(t,e){var i=this;if(!e.features.length)return e;var r={coords:t.coords,min:Jr.metersForTile(Jr.wrapTile(t.coords,{x:!0}))},n={coords:t.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:e.features}}}},h=Math.pow(2,t.coords.z+dl);Dn.projectData(n.source_data),Dn.scaleData(n.source_data,r);var o=e.features.map(function(e){var t=e.geometry.coordinates[0],i=t[0],r=t[5===t.length?2:3],n=Math.floor(i[0]/Jr.tile_scale*Jr.tile_size),o=Math.floor(i[1]/Jr.tile_scale*Jr.tile_size),a=Math.floor(r[0]/Jr.tile_scale*Jr.tile_size),s=Math.floor(r[1]/Jr.tile_scale*Jr.tile_size)-o,l=a<=n,u=l?h-(n-a):a-n,c=[];return n<=Jr.tile_size&&c.push([n,o,u,s]),l&&0<a&&c.push([n-h,o,u,s]),{id:e.id,properties:e.properties,texcoords:c}}).filter(function(e){return i._isVisible(e.properties)&&i.isInMinMaxRange(e.properties,t.style_zoom)}),a=Jr.tile_scale;return t.pad_scale=this.pad_scale,t.default_winding="CW",e.features=o.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[a,0],[a,a],[0,a],[0,0]]]},properties:{overlays_config:o}}]:o,e}},{key:"executeCommands",value:function(e){for(var t,i=e.length<10,r=0;r<e.length;r++){var n=e[r];n.arguments.push(i);var o=this[n.method_name].apply(this,n.arguments);i&&(o&&t?t.mergeRect(o,!0,t):o&&(t=o))}return t?t.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(e){var t=e.geometry.boundingBox;return new Wr.H.geo.Rect(Kr.clamp(t[0],-fl[1],fl[1]),t[1],Kr.clamp(t[2],-fl[1],fl[1]),t[3])}},{key:"addObjects",value:function(e,t){for(var i,r=1<arguments.length&&void 0!==t&&t,n=0;n<e.length;n++){var o,a,s,l=e[n];"Group"===l.type?(l.$children_ids$={},this._groups_by_id[l.id]=l):(p._preprocessGeometry(l.geometry),o=this._getClampedGeoRectForFeature(l),r&&(i?i.mergeRect(o,!0,i):i=o),(s=(a=-1!==l.geometry.type.indexOf("Point")?this._marker_quad_tree:this._quad_tree).insertBoundingBox(o)).$tree=a,s.$feature$=l,this._tree_entries_by_object_id[l.id]=s)}for(var u=0;u<e.length;u++){var c=e[u];c.properties.parent&&(this._groups_by_id[c.properties.parent].$children_ids$[c.id]=c.id),c.properties.ref={effectiveVisibility:this._isVisible(c.properties),zInfo:this._getZInfo([],c)}}return this._layersCache.removeAll(),i}},{key:"removeObjectsByIds",value:function(e,t,i){for(var r,n=2<arguments.length&&void 0!==i&&i,o=0;o<e.length;o++){var a,s=e[o],l=void 0,u=void 0;(l=this._tree_entries_by_object_id[s])?(n&&(a=this._getClampedGeoRectForFeature(l.$feature$),r?r.mergeRect(a,!0,r):r=a),delete this._groups_by_id[l.$feature$.properties.parent].$children_ids$[s],l.$tree.remove(l),delete this._tree_entries_by_object_id[s]):(u=this._groups_by_id[s])&&(u.properties.parent&&delete this._groups_by_id[u.properties.parent].$children_ids$[s],t&&this.removeObjectsByIds(Object.keys(u.$children_ids$),!0),delete this._groups_by_id[s])}return this._layersCache.removeAll(),r}},{key:"updateObjectProperties",value:function(e,t){var i,r=1<arguments.length&&void 0!==t&&t;return"Group"===e.type?(ul(this._groups_by_id[e.id].properties,e.properties),this._groups_by_id[e.id].properties.ref.effectiveVisibility=this._isVisible(e.properties)):(this._tree_entries_by_object_id[e.id]||this.addObjects([e]),ul(this._tree_entries_by_object_id[e.id].$feature$.properties,e.properties),this._tree_entries_by_object_id[e.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(e.properties),r&&(i=this._getClampedGeoRectForFeature(e))),i}},{key:"_getZInfo",value:function(e,t){var i=t.properties.zIdx,r=t.properties.sIdx;return e[0]|=void 0!==i,e.splice(1,0,i||0,r<0?t.id:r),0===t.properties.parent?e:this._getZInfo(e,this._groups_by_id[t.properties.parent])}},{key:"_isVisible",value:function(e){var t=e.visible,i=!e.parent||this._isVisible(this._groups_by_id[e.parent].properties);return t&&i}},{key:"isInMinMaxRange",value:function(e,t){var i=e.min<=t&&e.max>=t,r=!e.parent||this.isInMinMaxRange(this._groups_by_id[e.parent].properties,t);return i&&r}},{key:"dispose",value:function(){this._commands=[],Sr(wr(p.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(e,t){for(var i,r=e.properties.ref.zInfo,n=t.properties.ref.zInfo,o=r.length,a=n.length,s=Math.min(o,a),l=1;l<s;l++)if(i=r[l]-n[l])return i;return o-a}},{key:"_preprocessGeometry",value:function(e){var t=e.type;e.coordinates="Point"===t?p._processPointCoordinates(e.coordinates):"MultiPoint"===t?e.coordinates.map(p._processPointCoordinates):"LineString"===t?p._processLineStringCoordinates(e.coordinates):"MultiLineString"===t?e.coordinates.map(p._processLineStringCoordinates):"Polygon"===t?e.coordinates.map(p._processPolygonCoordinates):"MultiPolygon"===t?e.coordinates.map(p._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(e){return[e[1],e[0],e[2]]}},{key:"_processLineStringCoordinates",value:function(e){return p._latLngAltArrayToLineString(e,!1)}},{key:"_processPolygonCoordinates",value:function(e){return p._latLngAltArrayToLineString(e,!0)}},{key:"_processMultiPolygonCoordinates",value:function(e){return e.map(p._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(e,t){for(var i=[],r=e.length,n=0;n<r;n+=3)i.push([e[n+1],e[n]]);return t&&i.push([e[1],e[0]]),i}}]),p}();Dn.register(_l,"ObjectSource");var pl=1,gl=2,vl=3,ml=function(){function e(){pr(this,e),this._map={}}return vr(e,[{key:"set",value:function(e,t,i){var r;this._map[e]?this._map[e].accumulator.add(i):((r=new Set).add(i),this._map[e]={value:t,accumulator:r})}},{key:"get",value:function(e){return this._map[e]&&this._map[e].value}},{key:"delete",value:function(e,t){var i=this._map[e];i&&i.accumulator&&(i.accumulator.delete(t),0===i.accumulator.size&&delete this._map[e])}}]),e}(),yl=function(){br(n,Dn);var r=Rr(n);function n(e,t){var i;return pr(this,n),i=r.call(this,e,t),ln.is_worker||(i._icons=new ml),i}return vr(n,[{key:"onProviderUpdate",value:function(e){e.target instanceof H.map.provider.Tile?this.dispatchUpdate(e.target,e.data):this.dispatchUpdate(void 0,e.data)}},{key:"onReady",value:function(){var e=this.provider;e.setTileCanvasRendering&&e.setTileCanvasRendering(!1),e.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),e.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){Sr(wr(n.prototype),"dispose",this).call(this);var e=this.provider;e.providesMarkers()&&e.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(e,t){this.provider.cacheFilter(e)&&this._deleteIcons(e,t.data)}},{key:"_deleteIcons",value:function(e,t){for(var i=0,r=t.length;i<r;i++){var n=t[i].getIcon();this._icons.delete(n.uid,e)}}},{key:"getIconBitmapByObjectId",value:function(e,t){var i=this._icons.get(t);return i&&i.getBitmap()}},{key:"requestMarkerTile",value:function(t){var s=this;return new Promise(function(a,e){s.provider?s.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then(function(e){var t,i,r=[];if(e.data)for(i=(t=e.data).length;i--;){var n=t[i],o=n.getIcon();s._icons.set(o.uid,o,e.key),r.push(n.forWorkerMessage())}a(r)}):a([])})}},{key:"requestSpatialTile",value:function(t){var i=this;return new Promise(function(o,e){i.provider?i.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then(function(e){var t,i=[];if(e.getObjects){t=e.getObjects();for(var r=0;r<t.length;r++){var n=t[r];i.push({id:n.getId(),geometries:n.getGeometriesForTile(e),isClosed:n.isClosed(),style:n.getStyle().forWorkerMessage()})}}o(i)}):o([])})}},{key:"_pointToArray",value:function(e){var t=Jr.tile_scale/this.tile_size;return[e.x*t,e.y*t]}},{key:"_getGeoJsonMultiPolygon",value:function(e){for(var t=e.geometries,i=t.length,r=[],n={coordinates:r,type:"MultiPolygon"},o=0;o<i;o++){for(var a=t[o],s=a.paths,l=s.length,u=a.interiorsIndex,c=a.outlinesIndex,h=Math.min(u,c,l),f=void 0,d=void 0,d=0;d<h;d++)f=[s[d].map(this._pointToArray,this)],r.push(f);if(1===h)for(h=Math.min(c,l),d=u;d<h;d++)f.push(s[d].map(this._pointToArray,this))}return n}},{key:"_getGeoJsonMultiLineString",value:function(e,t){for(var i=1<arguments.length&&void 0!==t&&t,r={coordinates:[],type:"MultiLineString"},n=e.geometries,o=0;o<n.length;o++)for(var a=n[o],s=i?a.outlinesIndex:0,l=i?a.paths.length:Math.min(a.interiorsIndex,a.outlinesIndex,a.paths.length),u=s;u<l;u++){var c=a.paths[u].map(this._pointToArray,this);r.coordinates.push(c)}return r}},{key:"_getGeoJsonGeometry",value:function(e,t){var i=t===pl?this._getGeoJsonMultiPolygon(e):this._getGeoJsonMultiLineString(e,t===vl);return i.coordinates.length?i:null}},{key:"_load",value:function(f){var d=this;return new Promise(function(t,e){var i=un.postMessage(d.target_name+".requestMarkerTile",f.coords).then(d._prepareTileData.bind(d,f)),r=new Promise(function(h,e){un.postMessage(d.target_name+".requestSpatialTile",f.coords).then(function(e){for(var t=[],i=[],r=[],n=0;n<e.length;n++){var o,a=e[n],s=void 0,l=void 0,l=a.isClosed?(s=i,pl):(s=t,gl),u=d._getGeoJsonGeometry(a,l);u&&(o={id:a.id,type:"Feature",properties:{height:0,style:a.style},geometry:u},l===gl&&(o.properties.effectiveZIdx=t.length),s.push(o));var c=d._getGeoJsonGeometry(a,vl);c&&r.push({id:a.id,type:"Feature",properties:{height:0,style:a.style,effectiveZIdx:r.length},geometry:c})}f.source_data.layers.polylines={type:"FeatureCollection",features:t},f.source_data.layers.polygons={type:"FeatureCollection",features:i},f.source_data.layers.outlines={type:"FeatureCollection",features:r},h(f)})});Promise.all([i,r]).then(function(e){d._postProcessTile(f),t(f)})})}},{key:"_prepareTileData",value:function(e,t){var i=Jr.wrapTile(e.coords,{x:!0,y:!0}),r=Jr.metersForTile(i);e.source_data.layers={markers:{features:t,type:"FeatureCollection"}};var n={coords:i,min:r},o=e.source_data,a=ll("binary-tree"),s={};for(var l in o.layers)for(var u=o.layers[l].features.length,c=0;c<u;c++){var h=o.layers[l].features[c],f=h.properties.icon;s[f.id]||(a.addItem({width:f.size.w,height:f.size.h,meta:{objectId:h.id,id:f.id}}),s[f.id]=!0),Jr.transformGeometry(h.geometry,function(e){var t=e[0];e[0]=e[1],e[1]=t})}return e.rasters=a.export(),Dn.projectData(e.source_data),Dn.scaleData(e.source_data,n),e}}]),n}();Dn.register(yl,"ObjectTileSource");var xl=function(){br(n,Ho);var r=Rr(n);function n(e,t){var i;return pr(this,n),(i=r.call(this,e,t)).uid_=e.uid,i}return vr(n,[{key:"initialize",value:function(e,t){this.provider=e,this._on_update=t,this._onProviderUpdate=this._onProviderUpdate.bind(this),e.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(){this._on_update(this.name)}},{key:"tileTexture",value:function(e){return Object.assign(Sr(wr(n.prototype),"tileTexture",this).call(this,e),{uid:this.uid_,url:this.uid_+"_"+e.coords.key,coords:e.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}]),n}();function bl(e,t){var i=(t=this.options=function(e,t){for(var i in t)e[i]=t[i];return e}(Object.create(this.options),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||24<t.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=Ko(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=ca(r,t)).length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wl(e,t,i){return 32*((1<<e)*i+t)+e}In.register(xl,"RemoteRasterTileSource"),bl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},bl.prototype.splitTile=function(e,t,i,r,n,o,a){for(var s=[e,t,i,r],l=this.options,u=l.debug;s.length;){r=s.pop(),i=s.pop(),t=s.pop(),e=s.pop();var c,h,f,d,_,p,g,v,m,y,x,b=1<<t,w=wl(t,i,r),A=this.tiles[w];if(A||(1<u&&console.time("creation"),A=this.tiles[w]=pa(e,t,i,r,l),this.tileCoords.push({z:t,x:i,y:r}),u&&(1<u&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,r,A.numFeatures,A.numPoints,A.numSimplified),console.timeEnd("creation")),c="z"+t,this.stats[c]=(this.stats[c]||0)+1,this.total++)),A.source=e,n){if(t===l.maxZoom||t===n)continue;var T=1<<n-t;if(i!==Math.floor(o/T)||r!==Math.floor(a/T))continue}else if(t===l.indexMaxZoom||A.numPoints<=l.indexMaxPoints)continue;A.source=null,0!==e.length&&(1<u&&console.time("clipping"),f=.5-(h=.5*l.buffer/l.extent),_=1+h,m=p=g=v=null,y=ra(e,b,i-h,i+(d=.5+h),0,A.minX,A.maxX,l),x=ra(e,b,i+f,i+_,0,A.minX,A.maxX,l),e=null,y&&(m=ra(y,b,r-h,r+d,1,A.minY,A.maxY,l),p=ra(y,b,r+f,r+_,1,A.minY,A.maxY,l),y=null),x&&(g=ra(x,b,r-h,r+d,1,A.minY,A.maxY,l),v=ra(x,b,r+f,r+_,1,A.minY,A.maxY,l),x=null),1<u&&console.timeEnd("clipping"),s.push(m||[],t+1,2*i,2*r),s.push(p||[],t+1,2*i,2*r+1),s.push(g||[],t+1,2*i+1,2*r),s.push(v||[],t+1,2*i+1,2*r+1))}},bl.prototype.getTile=function(e,t,i){var r=this.options,n=r.extent,o=r.debug;if(e<0||24<e)return null;var a=1<<e,s=wl(e,t=(t%a+a)%a,i);if(this.tiles[s])return da(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",e,t,i);for(var l,u=e,c=t,h=i;!l&&0<u;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[wl(u,c,h)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",u,c,h),1<o&&console.time("drilling down"),this.splitTile(l.source,u,c,h,e,t,i),1<o&&console.timeEnd("drilling down"),this.tiles[s]?da(this.tiles[s],n):null):null};var Al={type:"FeatureCollection",features:[]},Tl=function(){br(r,Dn);var i=Rr(r);function r(e,t){return pr(this,r),e.tiled=!0,e.url="",i.call(this,e,t)}return vr(r,[{key:"fetchTile",value:function(e,t,i){return this.provider?this.provider.requestTileAsPromise(e,t,i).then(function(e){return e.data}):Promise.resolve(Al)}},{key:"_load",value:function(r){var n=this,o=Jr.wrapTile(r.coords,{x:!0,y:!0}),a={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:Jr.tile_scale};return un.postMessage(this.target_name+".fetchTile",o.x,o.y,o.z).then(function(e){for(var t in r.source_data.layers="FeatureCollection"===e.type?{_default:e}:e,r.source_data.layers){var i=new bl(r.source_data.layers[t],a).getTile(o.z,o.x,o.y);r.source_data.layers[t]=lo(i)}return n._postProcessTile(r),r})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),r}();In.register(Tl,"GeoJSONTileSource");var kl,El={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},Ml=function(){br(r,In);var i=Rr(r);function r(e,t){return pr(this,r),e.max_zoom=0,i.call(this,e,t)}return vr(r,[{key:"load",value:function(e){return e.source_data="0/0/0"===e.coords.key?El:void 0,Promise.resolve(e)}}]),r}();In.register(Ml,"SkyBox");var Rl=kl={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};var Sl,Pl=0,zl=1;function Nl(t,e){var i={};return e.forEach(function(e){return i[e]=t[e]}),i}var Ol=Sl={},Il=0;Sl.getContext=function(e,t){var i=!1;null==e&&((e=document.createElement("canvas")).style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=-1,document.body.appendChild(e),i=!0);var r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);if(!r)throw new Error("Couldn't create WebGL context.");return r._tangram_id=Il++,i?(Sl.resize(r,window.innerWidth,window.innerHeight,t.device_pixel_ratio),window.addEventListener("resize",function(){Sl.resize(r,window.innerWidth,window.innerHeight,t.device_pixel_ratio)})):Sl.resize(r,parseFloat(e.style.width),parseFloat(e.style.height),t.device_pixel_ratio),r},Sl.resize=function(e,t,i,r){e.canvas.style.width=t+"px",e.canvas.style.height=i+"px",e.canvas.width=Math.round(t*r),e.canvas.height=Math.round(i*r),e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height)};var Ll={parseUniforms:function(e){var t=[];for(var i in e){var r,n=i,o=e[i];if("number"==typeof o)t.push({type:"float",method:"1f",name:i,value:o,key:n,uniforms:e});else if(Array.isArray(o)){if("number"==typeof o[0])2<=o.length&&o.length<=4?t.push({type:"vec"+o.length,method:o.length+"fv",name:i,value:o,key:n,uniforms:e}):4<o.length&&t.push({type:"float[]",method:"1fv",name:i+"[0]",value:o,key:n,uniforms:e});else if("string"==typeof o[0])for(r=0;r<o.length;r++)t.push({type:"sampler2D",method:"1i",name:i+"["+r+"]",value:o[r],key:r,uniforms:o});else if(Array.isArray(o[0])&&"number"==typeof o[0][0]&&2<=o[0].length&&o[0].length<=4)for(r=0;r<o.length;r++)t.push({type:"vec"+o[0].length,method:o[r].length+"fv",name:i+"["+r+"]",value:o[r],key:r,uniforms:o})}else"boolean"==typeof o?t.push({type:"bool",method:"1i",name:i,value:o,key:n,uniforms:e}):"string"==typeof o&&t.push({type:"sampler2D",method:"1i",name:i,value:o,key:n,uniforms:e})}return t},defineVariable:function(e,t){var i,r;if("number"==typeof t)i="float";else if(Array.isArray(t))"number"==typeof t[0]?2<=t.length&&t.length<=4?i="vec"+t.length:(i="float",r=t.length):"string"==typeof t[0]&&(i="sampler2D",r=t.length);else if("boolean"==typeof t)i="bool";else{if("string"!=typeof t)return;i="sampler2D"}var n="";return n+="".concat(i," ").concat(e),r&&(n+="[".concat(r,"]")),n+=";\n"},defineUniform:function(e,t){var i=Ll.defineVariable(e,t);if(i)return"uniform "+i},isUniformDefined:function(e,t){var i=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+e+"\\b","g");return!!t.match(i)},isSymbolReferenced:function(e,t){var i=new RegExp("\\b"+e+"\\b","g");return 0<=t.search(i)},expandVec3:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(e)){if(2!==e.length)return e;t=[].concat(zr(e),[i]).map(parseFloat)}else t=[e,e,e].map(parseFloat);if(t&&t.every(function(e){return"number"==typeof e&&!isNaN(e)}))return t},expandVec4:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(e)){if(3!==e.length)return e;t=[].concat(zr(e),[i]).map(parseFloat)}else t=[e,e,e,i].map(parseFloat);if(t&&t.every(function(e){return"number"==typeof e&&!isNaN(e)}))return t}},Cl=[];function Fl(t,e){var i=Cl.filter(function(e){return e[0]===t})[0];return(i=i&&i[1])||(Cl.push([t,{}]),i=Cl[Cl.length-1][1]),i[e]||(i[e]=t.getExtension(e)),i[e]}function Dl(e){var t,i,r=0;if(0===e.length)return r;for(t=0,i=e.length;t<i;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r}var jl=i(function(e){var r="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",n=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,o=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,i=e.exports=function(e,t){return e?i.block(i.line(e,t),t):""};i.block=function(e,t){t=t||{};var i=new RegExp("\\/\\*"+r,"gm");return t.safe&&(i=new RegExp("\\/\\*(?!\\*?\\!)"+r,"gm")),e?e.replace(i,""):""},i.line=function(e,t){var i=n;return(t=t||{}).safe&&(i=o),e?e.replace(i,""):""}}),Ul=function(e){e=String(e);var t,i=[];for(;t=e.match(/ERROR\:([^\n]+)/);){e=e.slice(t.index+1);var r=(a=t[1].trim()).split(":"),n=r.slice(2).join(":").trim(),o=parseInt(r[0],10),a=parseInt(r[1],10);i.push({message:n,file:o,line:a})}return i};var Gl=/^\s*#pragma.*$/gm,Bl=/\\\s*\n/gm,Vl=function(){function f(e,t,i,r,n){if(pr(this,f),n=n||{},this.textureManager=Lo(r),this.gl=e,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!f.polyfills[r]){f.polyfills[r]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch(e){f.polyfills[r].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function(e,t,i){f.polyfills[r].uniformMatrix3fv.call(this,e,t,new Float32Array(i))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch(e){f.polyfills[r].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function(e,t,i){f.polyfills[r].uniformMatrix4fv.call(this,e,t,new Float32Array(i))}}}this.defines=Object.assign({},n.defines||{}),this.blocks=Object.assign({},n.blocks||{}),this.block_scopes=Object.assign({},n.block_scopes||{}),this.extensions=n.extensions||[],this.dependent_uniforms=n.uniforms,this.uniforms={},this.attribs={},this.vertex_source=t,this.fragment_source=i,this.id=f.id++,this.name=n.name}return vr(f,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(f.current!==this&&this.gl.useProgram(this.program),f.current=this)}},{key:"compile",value:function(){var i=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var e,t=this.checkExtensions(),r=this.buildDefineList(),n=this.buildShaderBlockList();for(var o in n){var a,s,l,u=n[o];!u||Array.isArray(u)&&0===u.length||(e=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+o+"\\s*$","m"),a=this.computed_vertex_source.match(e),s=this.computed_fragment_source.match(e),null==a&&null==s||(l="",u.forEach(function(e){var t="".concat(e.scope,", ").concat(e.key,", ").concat(e.num);l+="\n// tangram-block-start: ".concat(t,"\n"),l+=e.source,l+="\n// tangram-block-end: ".concat(t,"\n")}),null!=a&&(this.computed_vertex_source=this.computed_vertex_source.replace(e,l)),null!=s&&(this.computed_fragment_source=this.computed_fragment_source.replace(e,l)),r["TANGRAM_BLOCK_"+o.replace(/[\s-]+/g,"_").toUpperCase()]=!0))}this.computed_vertex_source=this.computed_vertex_source.replace(Gl,""),this.computed_fragment_source=this.computed_fragment_source.replace(Gl,""),this.ensureUniforms(this.dependent_uniforms);var c="",h=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT),c=h&&0<h.precision?"precision highp float;\n":"precision mediump float;\n";r.TANGRAM_VERTEX_SHADER=!0,r.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=c+f.buildDefineString(r)+this.computed_vertex_source,r.TANGRAM_VERTEX_SHADER=!1,r.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=f.buildExtensionString(t)+c+f.buildDefineString(r)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(Bl,""),this.computed_fragment_source=this.computed_fragment_source.replace(Bl,"");try{this.program=f.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(t){throw this.program=null,this.compiled=!1,this.compiling=!1,"vertex"!==(this.error=t).type&&"fragment"!==t.type||(this.shader_errors=t.errors,this.shader_errors.forEach(function(e){e.type=t.type,e.block=i.block(t.type,e.line)})),t}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var e,t={};for(e in f.defines)t[e]=f.defines[e];for(e in this.defines)t[e]=this.defines[e];return t}},{key:"buildShaderBlockList",value:function(){var i,e,t={};for(i in f.blocks){t[i]=[],Array.isArray(f.blocks[i])?(e=t[i]).push.apply(e,zr(f.blocks[i].map(function(e,t){return{key:i,source:e,num:t,scope:"ShaderProgram"}}))):t[i]=[{key:i,source:f.blocks[i],num:0,scope:"ShaderProgram"}]}for(i in this.blocks)if(t[i]=t[i]||[],Array.isArray(this.blocks[i]))for(var r=this.block_scopes&&this.block_scopes[i]||[],n=null,o=0,a=0;a<this.blocks[i].length;a++)r[a]!==n&&(n=r[a],o=0),t[i].push({key:i,source:this.blocks[i][a],num:o,scope:n||this.name}),o++;else t[i].push({key:i,source:this.blocks[i],num:0,scope:this.name});return t}},{key:"ensureUniforms",value:function(e){if(e){var t,i=jl(this.computed_vertex_source),r=jl(this.computed_fragment_source),n=[],o=[];for(var a in e){var s=Ll.isUniformDefined(a,i),l=Ll.isUniformDefined(a,r);if(!s||!l){if(!(t=Ll.defineUniform(a,e[a])))continue;s||(An("trace","Program ".concat(this.name,": ").concat(a," not defined in vertex shader, injecting: '").concat(t,"'")),n.push(t)),l||(An("trace","Program ".concat(this.name,": ").concat(a," not defined in fragment shader, injecting: '").concat(t,"'")),o.push(t))}}0<n.length&&(this.computed_vertex_source=n.join("\n")+this.computed_vertex_source),0<o.length&&(this.computed_fragment_source=o.join("\n")+this.computed_fragment_source)}}},{key:"setUniforms",value:function(e,t){var i=!(1<arguments.length&&void 0!==t)||t;if(this.compiled){i&&(this.texture_unit=0);for(var r=Ll.parseUniforms(e),n=0;n<r.length;n++){var o=r[n];"sampler2D"===o.type?this.setTextureUniform(o.name,o.value):this.uniform(o.method,o.name,o.value)}}}},{key:"saveUniforms",value:function(e){var t=e||this.uniforms;for(var i in t){var r=this.uniforms[i];r&&(r.saved_value=r.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(e){var t=e||this.uniforms;for(var i in t){var r=this.uniforms[i];r&&r.saved_value&&(r.value=r.saved_value,this.updateUniform(r))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(e,t){var i=this.textureManager.textures[t];null!=i?(i.bind(this.texture_unit),this.uniform("1i",e,this.texture_unit),this.texture_unit++):An("warn","Cannot find texture '".concat(t,"'"))}},{key:"uniform",value:function(e,t,i){var r;this.compiled&&(this.uniforms[t]=this.uniforms[t]||{},r=this.uniforms[t],r.name=t,void 0===r.location&&(r.location=this.gl.getUniformLocation(this.program,t)),r.method=e,r.value=i,this.updateUniform(r))}},{key:"updateUniform",value:function(e){this.compiled&&e&&null!=e.location&&(this.use(),this.commitUniform(e))}},{key:"commitUniform",value:function(e){var t=e.location,i=e.value;switch(e.method){case"1i":this.gl.uniform1i(t,i);break;case"1f":this.gl.uniform1f(t,i);break;case"2f":this.gl.uniform2f(t,i[0],i[1]);break;case"3f":this.gl.uniform3f(t,i[0],i[1],i[2]);break;case"4f":this.gl.uniform4f(t,i[0],i[1],i[2],i[3]);break;case"1iv":this.gl.uniform1iv(t,i);break;case"3iv":this.gl.uniform3iv(t,i);break;case"1fv":this.gl.uniform1fv(t,i);break;case"2fv":this.gl.uniform2fv(t,i);break;case"3fv":this.gl.uniform3fv(t,i);break;case"4fv":this.gl.uniform4fv(t,i);break;case"Matrix3fv":this.gl.uniformMatrix3fv(t,!1,i);break;case"Matrix4fv":this.gl.uniformMatrix4fv(t,!1,i)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var e in this.uniforms){var t=this.uniforms[e];t.location=this.gl.getUniformLocation(this.program,e),this.updateUniform(t)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(e){if(this.compiled){var t=this.attribs[e]=this.attribs[e]||{};return null!=t.location?t:(t.name=e,t.location=this.gl.getAttribLocation(this.program,e),t)}}},{key:"source",value:function(e){return"vertex"===e?this.computed_vertex_source:"fragment"===e?this.computed_fragment_source:void 0}},{key:"lines",value:function(e){var t=this.source(e);return t?t.split("\n"):[]}},{key:"line",value:function(e,t){var i=this.lines(e);if(i)return i[t]}},{key:"block",value:function(e,t){for(var i,r=this.lines(e),n=0;n<t&&n<r.length;n++){var o=r[n],a=o.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);a&&1<a.length?i={scope:a[1],name:a[2],num:a[3]}:(a=o.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&1<a.length&&(i=null),i&&(i.line=null==i.line?-1:i.line+1,i.source=o)}return i}},{key:"checkExtensions",value:function(){var r=this,n=[];return this.extensions.forEach(function(e){var t=Fl(r.gl,e),i="TANGRAM_EXTENSION_".concat(e);r.defines[i]=null!=t,t?n.push(e):An("debug","Could not enable extension '".concat(e,"'"))}),n}}]),f}();Vl.polyfills={},Vl.id=0,Vl.current=null,Vl.defines={},Vl.blocks={},Vl.reset=function(){Vl.programs_by_source={},Vl.shaders_by_source={}},Vl.reset(),Vl.buildDefineString=function(e){var t="";for(var i in e)null!=e[i]&&!1!==e[i]&&("boolean"==typeof e[i]&&!0===e[i]?t+="#define "+i+"\n":"number"==typeof e[i]&&Math.floor(e[i])===e[i]?t+="#define "+i+" "+e[i].toFixed(1)+"\n":t+="#define "+i+" "+e[i]+"\n");return t},Vl.buildExtensionString=function(e){var t="";return(e=e||[]).forEach(function(e){t+="#ifdef GL_".concat(e,"\n#extension GL_").concat(e," : enable\n#endif\n")}),t},Vl.addBlock=function(e){var t;Vl.blocks[e]=Vl.blocks[e]||[];for(var i=arguments.length,r=new Array(1<i?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];(t=Vl.blocks[e]).push.apply(t,r)},Vl.removeBlock=function(e){Vl.blocks[e]=[]},Vl.replaceBlock=function(e){Vl.removeBlock(e);for(var t=arguments.length,i=new Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];Vl.addBlock.apply(Vl,[e].concat(i))},Vl.updateProgram=function(e,t,i,r){var n=Dl(e._tangram_id+"::"+i+"::"+r);if(Vl.programs_by_source[n])return An("trace","Reusing identical source GL program object"),Vl.programs_by_source[n];var o=Vl.createShader(e,i,e.VERTEX_SHADER),a=Vl.createShader(e,r,e.FRAGMENT_SHADER);if(e.useProgram(null),null!=t)for(var s=e.getAttachedShaders(t),l=0;l<s.length;l++)e.detachShader(t,s[l]);else t=e.createProgram();if(null==o||null==a)return t;if(e.attachShader(t,o),e.attachShader(t,a),e.linkProgram(t),e.getProgramParameter(t,e.LINK_STATUS))return Vl.programs_by_source[n]=t;var u=new Error("WebGL program error:\n            VALIDATE_STATUS: ".concat(e.getProgramParameter(t,e.VALIDATE_STATUS),"\n            ERROR: ").concat(e.getError(),"\n            --- Vertex Shader ---\n            ").concat(i,"\n            --- Fragment Shader ---\n            ").concat(r));throw Object.assign(new Error(u),{type:"program"})};var ql={disabled:!(Vl.createShader=function(e,t,i){var r=Dl(e._tangram_id+"::"+t);if(Vl.shaders_by_source[r])return An("trace","Reusing identical source GL shader object"),Vl.shaders_by_source[r];var n=e.createShader(i);if(e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return Vl.shaders_by_source[r]=n;var o=i===e.VERTEX_SHADER?"vertex":"fragment",a=e.getShaderInfoLog(n),s=Ul(a);throw Object.assign(new Error(a),{type:o,errors:s})}),bound_vao:[],init:function(e){var t;!0!==this.disabled&&(t=Fl(e,"OES_vertex_array_object")),null!=t?An("info","Vertex Array Object extension available"):!0!==this.disabled?An("warn","Vertex Array Object extension NOT available"):An("warn","Vertex Array Object extension force disabled")},create:function(e,t,i){var r={};r.setup=t,r.teardown=i;var n=Fl(e,"OES_vertex_array_object");return null!=n&&(r._vao=n.createVertexArrayOES(),n.bindVertexArrayOES(r._vao)),r.setup(!0),r},getCurrentBinding:function(t){var e=this.bound_vao.filter(function(e){return e[0]===t})[0];return e&&e[1]},setCurrentBinding:function(t,e){var i=this.bound_vao,r=i.filter(function(e){return e[0]===t})[0];null==r?i.push([t,e]):r[1]=e},bind:function(e,t){var i,r=Fl(e,"OES_vertex_array_object");null!=t?null!=r&&null!=t._vao?(r.bindVertexArrayOES(t._vao),this.setCurrentBinding(e,t)):t.setup(!1):(i=this.getCurrentBinding(e),null!=r?r.bindVertexArrayOES(null):null!=i&&"function"==typeof i.teardown&&i.teardown(),this.setCurrentBinding(e,null))},destroy:function(e,t){var i=Fl(e,"OES_vertex_array_object");null!=i&&null!=t&&null!=t._vao&&(i.deleteVertexArrayOES(t._vao),t._vao=null)}},Hl=function(){function b(e,t){pr(this,b),this._gl=e,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var i=Lo(t).create(this._gl,"selection_fbo",{filtering:"nearest"});i.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,i.texture,0);var r=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,r),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,r),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return vr(b,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var e;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(e=this._gl).clearColor.apply(e,zr(b.defaultColor))}},{key:"getFeatureAt",value:function(e,t,i){var r=t.radius,n=t.top_most_only,o=void 0===n||n;!e||e.x<0||e.y<0||1<e.x||1<e.y?i({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:e,radius:r,top_most_only:o,ttl:o?1:b.MAX_PICKING_TRIES,callback:i})}},{key:"hasPendingRequests",value:function(){return 0<Object.keys(this._requests).length}},{key:"clearPendingRequests",value:function(){for(var e in this._requests){this._requests[e].callback(new Error("cleared")),delete this._requests[e]}this._pending_deep_request=null}},{key:"read",value:function(e){if(this.hasPendingRequests()){var t=this._gl;for(var i in t.bindFramebuffer(t.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,e),this._requests)if(this.processRequest(this._requests[i],e))break;t.bindFramebuffer(t.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(e,t){var i,r,n,o=this._gl,a=255,s=e.point,l=e.radius,u=(n=l?(r=Math.min(this._fbo_size.width,this._fbo_size.height),{x:Math.min(Math.ceil(2*l.x*this._fbo_size.width),r),y:Math.min(Math.ceil(2*l.y*this._fbo_size.height),r)}):(l={x:0,y:0},{x:1,y:1})).x*n.y*4;if(null==this._pixels||this._pixels.byteLength<u)this._pixels=new Uint8Array(u);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,u);else for(var c=0;c<u;c++)this._pixels[c]=0;o.readPixels(Math.round((s.x-l.x)*this._fbo_size.width),Math.round((1-s.y-l.y)*this._fbo_size.height),n.x,n.y,o.RGBA,o.UNSIGNED_BYTE,this._pixels),e.ttl--;var h=Math.floor(n.x/2),f=Math.floor(n.y/2),d=4*(f*n.x+h),_=this._pixels.slice(d,d+4),p=_[0]+(_[1]<<8)+(_[2]<<16);if(0<p)i=p+(_[3]<<24)>>>0,a=_[3];else if(4<u)for(var g=1/0,d=0,v=0;v<n.y;v++)for(var m,y=0;y<n.x;y++,d+=4){0<(p=(_=this._pixels.slice(d,d+4))[0]+(_[1]<<8)+(_[2]<<16))&&((m=Math.pow(y-h,2)+Math.pow(v-f,2))<g&&(i=p+(_[3]<<24)>>>0,a=_[3],g=m))}if(255!==a){var x=this._getFeatureByKey(i,t);if(e.features||(e.features=[]),!x)return void this._finishRead(e);if(e.features.every(function(e){return e.id!==x.id})&&e.features.push(x),e.ttl)return this._pending_deep_request=e,b._discardColor(_),this._has_dirty_buffer=!0;this._finishRead(e)}else this._finishRead(e)}},{key:"_finishRead",value:function(e){var t=e.features||b.EMPTY_ARRAY;e.top_most_only||(this._pending_deep_request=null,b._resetDiscardedColors()),delete this._requests[e.id],e.callback({features:t})}},{key:"_getFeatureByKey",value:function(e,t){for(var i=null,r=0;r<t.length;r++){var n=t[r];if(n.selection_data&&(i=n.selection_data[e])){i.tile={coords:n.coords};break}}return i}},{key:"setupDiscards",value:function(e){for(var t=b.MAX_PICKING_TRIES;t--;)e.uniform("4fv","u_selection_discard".concat(t),b._discarded_colors[t]||b.defaultColor)}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(){this._has_dirty_buffer=!!this._pending_deep_request}}],[{key:"makeEntry",value:function(){this.map_entry++;var e=255&this.map_entry,t=this.map_entry>>8&255,i=this.map_entry>>16&255,r=this.map_prefix;return{key:e+(t<<8)+(i<<16)+(r<<24)>>>0,color:[e/255,t/255,i/255,r/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(e){this.map_prefix=e}},{key:"_discardColor",value:function(e){this._discarded_colors.push([e[0]/255,e[1]/255,e[2]/255,e[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}]),b}();Hl._discarded_colors=[],Hl.map_entry=0,Hl.map_prefix=0,Hl.defaultColor=[0,0,0,1],Hl.MAX_PICKING_TRIES=10,Hl.EMPTY_ARRAY=Object.freeze([]);var Yl,Xl=function(){function a(e,t,i,r,n,o){pr(this,a),o=o||{},this.textureManager=Lo(n),this.gl=e,this.vertex_data=t,this.element_data=i,this.vertex_layout=r,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=o.draw_mode||this.gl.TRIANGLES,this.data_usage=o.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=o.uniforms,this.textures=o.textures,this.retain=o.retain||!1,this.created_at=+new Date,this.fade_in_time=o.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0}return vr(a,[{key:"render",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(!this.valid)return!1;var i=t.program||Vl.current;i.use(),this.uniforms&&(i.saveUniforms(this.uniforms),i.setUniforms(this.uniforms,!1));var r=(new Date-this.created_at)/1e3;return i.uniform("1f","u_visible_time",r),this.bind(i),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),ql.bind(this.gl,null),this.uniforms&&i.restoreUniforms(this.uniforms),r<this.fade_in_time}},{key:"bind",value:function(t){var i=this,e=this.vaos[t.id];e?ql.bind(this.gl,e):this.vaos[t.id]=ql.create(this.gl,function(e){i.gl.bindBuffer(i.gl.ARRAY_BUFFER,i.vertex_buffer),i.toggle_element_array&&i.gl.bindBuffer(i.gl.ELEMENT_ARRAY_BUFFER,i.element_buffer),i.vertex_layout.enable(i.gl,t,e)})}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var t=this;if(!this.valid)return!1;for(var e in this.valid=!1,this.vaos)ql.destroy(this.gl,this.vaos[e]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach(function(e){return t.textureManager.release(e)}),!0}}]),a}(),Wl=["emission","ambient","diffuse","specular"],Zl=function(){function e(i){var r=this;pr(this,e),i=i||{},Wl.forEach(function(e){var t=i[e];null!=t&&(t.texture?r[e]={texture:t.texture,mapping:t.mapping||"spheremap",scale:Ll.expandVec3(null!=t.scale?t.scale:1),amount:Ll.expandVec4(null!=t.amount?t.amount:1)}:"number"==typeof t||Array.isArray(t)?r[e]={amount:Ll.expandVec4(t)}:r[e]="string"==typeof t?{amount:mo.parseColor(t)}:t)}),this.specular&&(this.specular.shininess=i.shininess?parseFloat(i.shininess):.2),null!=i.normal&&(this.normal={texture:i.normal.texture,mapping:i.normal.mapping||"triplanar",scale:Ll.expandVec3(null!=i.normal.scale?i.normal.scale:1),amount:null!=i.normal.amount?i.normal.amount:1})}return vr(e,[{key:"inject",value:function(r){var n=this;Wl.forEach(function(e){var t="TANGRAM_MATERIAL_".concat(e.toUpperCase()),i=t+"_TEXTURE";r.defines[t]=null!=n[e],n[e]&&n[e].texture&&(r.defines[i]=!0,r.defines[i+"_"+n[e].mapping.toUpperCase()]=!0,r.defines["TANGRAM_MATERIAL_TEXTURE_".concat(n[e].mapping.toUpperCase())]=!0,r.texcoords=r.texcoords||"uv"===n[e].mapping)}),this.normal&&this.normal.texture&&(r.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,r.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,r.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,r.texcoords=r.texcoords||"uv"===this.normal.mapping),r.replaceShaderBlock(e.block,"/*Defines globals:materiallight_accumulator_**/struct Material{\n#ifdef TANGRAM_MATERIAL_EMISSION\nvec4 emission;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nvec3 emissionScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT\nvec4 ambient;\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nvec3 ambientScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nvec4 diffuse;\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nvec3 diffuseScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 specular;float shininess;\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nvec3 specularScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvec3 normalScale;float normalAmount;\n#endif\n};uniform Material u_material;Material material;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nuniform sampler2D u_material_emission_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nuniform sampler2D u_material_ambient_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nuniform sampler2D u_material_diffuse_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nuniform sampler2D u_material_specular_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nuniform sampler2D u_material_normal_texture;\n#endif\nvec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 light_accumulator_specular=vec4(vec3(0.0),1.);\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP\nvec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR\nvec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR\nvec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvoid calculateNormal(inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV\n_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR\nvec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR\nvec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n_normal=normalize(_normal);}\n#endif\nvoid calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV\nmaterial.emission*=texture2D(u_material_emission_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR\nmaterial.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR\nmaterial.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP\nmaterial.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV\nmaterial.ambient*=texture2D(u_material_ambient_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR\nmaterial.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR\nmaterial.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP\nmaterial.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV\nmaterial.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR\nmaterial.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR\nmaterial.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP\nmaterial.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV\nmaterial.specular*=texture2D(u_material_specular_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR\nmaterial.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR\nmaterial.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP\nmaterial.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n}","Material"),r.addShaderBlock("setup","\nmaterial = u_material;\n","Material")}},{key:"setupProgram",value:function(t){var i=this;Wl.forEach(function(e){i[e]&&(i[e].texture?(t.setTextureUniform("u_material_".concat(e,"_texture"),i[e].texture),t.uniform("3fv","u_material.".concat(e,"Scale"),i[e].scale),t.uniform("4fv","u_material.".concat(e),i[e].amount)):i[e].amount&&t.uniform("4fv","u_material.".concat(e),i[e].amount))}),this.specular&&t.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(t.setTextureUniform("u_material_normal_texture",this.normal.texture),t.uniform("3fv","u_material.normalScale",this.normal.scale),t.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(e){return null!=e&&(null!=e.emission||null!=e.ambient||null!=e.diffuse||null!=e.specular)}}]),e}();Zl.block="material";var Kl=Yl={};Yl.copy=function(e){for(var t=[],i=e.length,r=0;r<i;r++)t[r]=e[r];return t},Yl.neg=function(e){for(var t=[],i=e.length,r=0;r<i;r++)t[r]=-e[r];return t},Yl.add=function(e,t){for(var i=[],r=Math.min(e.length,t.length),n=0;n<r;n++)i[n]=e[n]+t[n];return i},Yl.sub=function(e,t){for(var i=[],r=Math.min(e.length,t.length),n=0;n<r;n++)i[n]=e[n]-t[n];return i},Yl.signed_area=function(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(t[1]-e[1])},Yl.mult=function(e,t){var i,r=[],n=e.length;if("number"==typeof t)for(i=0;i<n;i++)r[i]=e[i]*t;else for(n=Math.min(e.length,t.length),i=0;i<n;i++)r[i]=e[i]*t[i];return r},Yl.multMatrix=function(e,t){return[e[0][0]*t[0]+e[0][1]*t[1],e[1][0]*t[0]+e[1][1]*t[1]]},Yl.div=function(e,t){var i=[];if("number"==typeof t)for(n=0;n<e.length;n++)i[n]=e[n]/t;else for(var r=Math.min(e.length,t.length),n=0;n<r;n++)i[n]=e[n]/t[n];return i},Yl.perp=function(e,t){return[t[1]-e[1],e[0]-t[0]]},Yl.rot=function(e,t){var i=Math.cos(t),r=Math.sin(t);return[e[0]*i-e[1]*r,e[0]*r+e[1]*i]},Yl.angle=function(e){var t=Pr(e,2),i=t[0],r=t[1];return Math.atan2(r,i)},Yl.angleBetween=function(e,t){var i=Yl.dot(Yl.normalize(Yl.copy(e)),Yl.normalize(Yl.copy(t)));return 1<i&&(i=1),Math.acos(i)},Yl.signedAngleBetween=function(e,t){return Math.atan2(e[0]*t[1]-e[1]*t[0],e[0]*t[0]+e[1]*t[1])},Yl.isEqual=function(e,t){for(var i=e.length,r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0},Yl.lengthSq=function(e){return 2===e.length?e[0]*e[0]+e[1]*e[1]:3<=e.length?e[0]*e[0]+e[1]*e[1]+e[2]*e[2]:0},Yl.length=function(e){return Math.sqrt(Yl.lengthSq(e))},Yl.normalize=function(e){var t;if(2===e.length){if(1===(t=e[0]*e[0]+e[1]*e[1]))return e;0!==(t=Math.sqrt(t))?(e[0]/=t,e[1]/=t):(e[0]=0,e[1]=0)}else if(3<=e.length){if(1===(t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2]))return e;0!==(t=Math.sqrt(t))?(e[0]/=t,e[1]/=t,e[2]/=t):(e[0]=0,e[1]=0,e[2]=0)}return e},Yl.cross=function(e,t){return 2===e.length?e[0]*t[1]-e[1]*t[0]:3===e.length?[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]:void 0},Yl.dot=function(e,t){for(var i=0,r=Math.min(e.length,t.length),n=0;n<r;n++)i+=e[n]*t[n];return i};var $l=function(){function s(e,t){pr(this,s),this.name=t.name,this.view=e,null==t.ambient||"number"==typeof t.ambient?this.ambient=Ll.expandVec3(t.ambient||0):this.ambient=mo.parseColor(t.ambient).slice(0,3),null==t.diffuse||"number"==typeof t.diffuse?this.diffuse=Ll.expandVec3(null!=t.diffuse?t.diffuse:1):this.diffuse=mo.parseColor(t.diffuse).slice(0,3),null==t.specular||"number"==typeof t.specular?this.specular=Ll.expandVec3(t.specular||0):this.specular=mo.parseColor(t.specular).slice(0,3)}return vr(s,[{key:"inject",value:function(){var e="\n            uniform ".concat(this.struct_name," u_").concat(this.name,";\n            ").concat(this.struct_name," ").concat(this.name,";\n            "),t="\n            ".concat(this.name," = u_").concat(this.name,";\n\n        ");Vl.addBlock(s.block,e),Vl.addBlock("setup",t)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(e){e.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),e.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),e.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(e,t){if(s.types[t.type])return new s.types[t.type](e,t)}},{key:"setMode",value:function(e,t){!0===e&&(e="fragment"),e=s.enabled&&(null!=e?e:"fragment"),t.defines.TANGRAM_LIGHTING_FRAGMENT="fragment"===e,t.defines.TANGRAM_LIGHTING_VERTEX="vertex"===e}},{key:"inject",value:function(e){if(Vl.removeBlock(s.block),s.enabled){var t="";if(e&&0<Object.keys(e).length){var i={};for(var r in e)i[e[r].type]=!0;for(var n in i)s.types[n].inject();for(var o in e)e[o].inject(),t+="calculateLight(".concat(o,", _eyeToPoint, _normal);\n")}var a="\n            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {\n\n                // Do initial material calculations over normal, emission, ambient, diffuse and specular values\n                calculateMaterial(_eyeToPoint,_normal);\n\n                // Un roll the loop of individual ligths to calculate\n                ".concat(t,"\n\n                //  Final light intensity calculation\n                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha\n\n                #ifdef TANGRAM_MATERIAL_EMISSION\n                    color.rgb = material.emission.rgb;\n                    color.a *= material.emission.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_AMBIENT\n                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;\n                    color.a *= material.ambient.a;\n                #else\n                    #ifdef TANGRAM_MATERIAL_DIFFUSE\n                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;\n                    #endif\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_DIFFUSE\n                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;\n                    color.a *= material.diffuse.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_SPECULAR\n                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;\n                    color.a *= material.specular.a;\n                #endif\n\n                // Clamp final color\n                color = clamp(color, 0.0, 1.0);\n\n                return color;\n            }");Vl.addBlock(s.block,a)}}}]),s}();$l.types={},$l.block="lighting",$l.enabled=!0;var Jl=function(){br(n,$l);var r=Rr(n);function n(e,t){var i;return pr(this,n),(i=r.call(this,e,t)).type="ambient",i.struct_name="AmbientLight",i}return vr(n,[{key:"setupProgram",value:function(e){e.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){Vl.addBlock($l.block,"/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}")}}]),n}();$l.types.ambient=Jl;var Ql=function(){br(o,$l);var n=Rr(o);function o(e,t){var i,r;return pr(this,o),(i=n.call(this,e,t)).type="directional",i.struct_name="DirectionalLight",t.direction?i._direction=t.direction:(r=Math.sin(60*Math.PI/180),i._direction=[Math.cos(135*Math.PI/180)*r,Math.sin(135*Math.PI/180)*r,-.5]),null==t.ambient&&(i.ambient=Ll.expandVec3(.5)),i.direction=i._direction.map(parseFloat),i._initial_direction=[i.direction[0],i.direction[1],i.direction[2]],i}return vr(o,[{key:"update",value:function(){Fo.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(e){Sr(wr(o.prototype),"setupProgram",this).call(this,e),e.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}},{key:"direction",get:function(){return this._direction},set:function(e){this._direction=Kl.normalize(Kl.copy(e))}}],[{key:"inject",value:function(){Vl.addBlock($l.block,"/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;\n#endif\n}")}}]),o}();$l.types.directional=Ql;var eu=function(){br(n,$l);var r=Rr(n);function n(e,t){var i;return pr(this,n),(i=r.call(this,e,t)).type="point",i.struct_name="PointLight",i.position=t.position||[0,0,"100px"],i.position_eye=[],i.origin=t.origin||"ground",i.attenuation=isNaN(parseFloat(t.attenuation))?0:parseFloat(t.attenuation),t.radius?Array.isArray(t.radius)&&2===t.radius.length?i.radius=t.radius:i.radius=[null,t.radius]:i.radius=null,i}return vr(n,[{key:"inject",value:function(){Sr(wr(n.prototype),"inject",this).call(this),Vl.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=0!==this.attenuation,Vl.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=null!=this.radius&&null!=this.radius[0],Vl.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=null!=this.radius}},{key:"update",value:function(){var e,t,i,r=this.view.lookAtManipulator.getLookAtData().zoom;"world"===this.origin?(t=(e=Pr(Jr.latLngToMeters(this.position),2))[0],i=e[1],this.position_eye[0]=t-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=i-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=mo.convertUnits(this.position[2],{zoom:r,meters_per_pixel:Jr.metersPerPixel(r)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance):"ground"!==this.origin&&"camera"!==this.origin||(this.position_eye=mo.convertUnits(this.position,{zoom:r,meters_per_pixel:Jr.metersPerPixel(r)}),"ground"===this.origin&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance)),this.position_eye[3]=1}},{key:"setupProgram",value:function(e){Sr(wr(n.prototype),"setupProgram",this).call(this,e),e.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),Vl.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&e.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var t=this.view.lookAtManipulator.getLookAtData().zoom;Vl.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&e.uniform("1f","u_".concat(this.name,".innerRadius"),mo.convertUnits(this.radius[0],{zoom:t,meters_per_pixel:Jr.metersPerPixel(t)})),Vl.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&e.uniform("1f","u_".concat(this.name,".outerRadius"),mo.convertUnits(this.radius[1],{zoom:t,meters_per_pixel:Jr.metersPerPixel(t)}))}}],[{key:"inject",value:function(){Vl.addBlock($l.block,"/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\n};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nlight_accumulator_ambient.rgb+=_light.ambient*attenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;\n#endif\n}")}}]),n}();$l.types.point=eu;var tu=function(){br(n,eu);var r=Rr(n);function n(e,t){var i;return pr(this,n),(i=r.call(this,e,t)).type="spotlight",i.struct_name="SpotLight",i.direction=i._direction=(t.direction||[0,0,-1]).map(parseFloat),i._initial_direction=[i.direction[0],i.direction[1],i.direction[2]],i.exponent=t.exponent?parseFloat(t.exponent):.2,i.angle=t.angle?parseFloat(t.angle):20,i}return vr(n,[{key:"setupProgram",value:function(e){Sr(wr(n.prototype),"setupProgram",this).call(this,e),e.uniform("3fv","u_".concat(this.name,".direction"),this.direction),e.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),e.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){Sr(wr(n.prototype),"update",this).call(this),Fo.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"direction",get:function(){return this._direction},set:function(e){this._direction=Kl.normalize(Kl.copy(e))}}],[{key:"inject",value:function(){Vl.addBlock($l.block,"/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\nvec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nfloat spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;\n#endif\n}")}}]),n}();$l.types.spotlight=tu;var iu,ru="#ifdef TANGRAM_FRAGMENT_SHADER\nuniform sampler2D u_raster;uniform vec3 u_raster_offset;\n#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))\n#endif\n",nu={init:function(e){var t=0<arguments.length&&void 0!==e?e:{},i=t.generation,r=t.styles,n=t.sources,o=void 0===n?{}:n,a=t.introspection,s=t.id,l=void 0!==s?s+"/":"";this.scene_id=s,this.textureManager=Lo(s),this.main_thread_target="".concat(l,"Style/").concat(this.name),this.setGeneration(i),this.styles=r,this.sources=o,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=a||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,null==this.blend_order&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof Zl||(Zl.isValid(this.material)||(this.material=mo.defaults.material),this.material=new Zl(this.material)),this.material.inject(this),$l.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),un.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(e){this.generation=e,ln.is_main&&un.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(e,t,i,r){var n=r.size,o=void 0===(o=r.offset)?0:o,a=e.index[t];if(void 0!==a)for(var s=0;s<n;++s){var l=i.length>s?i[s]:i;this.vertex_template[a+s+o]=l}else An("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(t,"'"))},startData:function(e){this.tile_data[e.id]=this.tile_data[e.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(e){var t=this.tile_data[e.id];if(this.tile_data[e.id]=null,t&&0<Object.keys(t.meshes).length){for(var i in t.meshes){var r=t.meshes[i];0!==r.vertex_data.vertex_count?(r.vertex_data.end(),r.vertex_elements=r.vertex_data.element_buffer,r.vertex_data=r.vertex_data.vertex_buffer):delete t.meshes[i]}return e.mesh_data[this.name]=t,this.buildRasterTextures(e,t).then(function(e){return e})}return Promise.resolve(null)},hasDataForTile:function(e){return null!=this.tile_data[e.id]},getTileMesh:function(e,t){var i=this.tile_data[e.id].meshes;return null==i[t.key]&&(i[t.key]={variant:t,vertex_data:this.vertexLayoutForMeshVariant(t).createVertexData()}),i[t.key]},vertexLayoutForMeshVariant:function(){return this.vertex_layout},default_mesh_variant:{key:0},meshVariantTypeForDraw:function(){return this.default_mesh_variant},addFeature:function(e,t,i){var r=i.tile;this.tile_data[r.id]||this.startData(r);var n,o,a,s=this.parseFeature(e,t,i);s&&(o=(n=this.getTileMesh(r,this.meshVariantTypeForDraw(s))).vertex_data.offset,a=n.vertex_data.vertex_count,0<this.buildGeometry(e.geometry,s,n,i)?e.generation=this.generation:n.vertex_data.vertex_count>a&&(n.vertex_data.vertex_buffer.fill(0,o,n.vertex_data.offset),n.vertex_data.vertex_count=a,n.vertex_data.offset=o))},buildGeometry:function(e,t,i,r){var n;return"Polygon"===e.type?n=this.buildPolygons([e.coordinates],t,i,r):"MultiPolygon"===e.type?n=this.buildPolygons(e.coordinates,t,i,r):"LineString"===e.type?n=this.buildLines([e.coordinates],t,i,r):"MultiLineString"===e.type?n=this.buildLines(e.coordinates,t,i,r):"Point"===e.type?n=this.buildPoints([e.coordinates],t,i,r):"MultiPoint"===e.type&&(n=this.buildPoints(e.coordinates,t,i,r)),n},parseFeature:function(t,e,i){try{var r,n,o,a=this.feature_style;if(a.order=this.parseOrder(e.order,i),null==a.order&&"overlay"!==this.blend){var s="Layer '".concat(e.layers.join(", "),"', draw group '").concat(e.group,"': ");return s+="'order' parameter is required unless blend mode is 'overlay'",null!=e.order&&(s+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",s+="or JS function), but evaluated to null for one or more features"),void An({level:"warn",once:!0},s)}if(!(a=this._parseFeature(t,e,i)))return;return this.selection?a.interactive=mo.evalProperty(this.introspection||e.interactive,i):a.interactive=!1,!0===a.interactive?(n=(r=Hl.makeEntry()).color,o=r.key,a.selection_color=n,i.tile.selection_data||(i.tile.selection_data={}),i.tile.selection_data[o]={id:t.id||o,properties:t.properties,source_name:i.source,source_layer:i.layer,layers:i.layers}):a.selection_color=Hl.defaultColor,a}catch(e){An("error","Style.parseFeature: style parsing error",t,a,e.stack)}},_parseFeature:function(){return this.feature_style},preprocess:function(e,t){if(!e.preprocessed){if(this.draw)for(var i in this.draw){var r=this.draw[i];"object"!==_r(r)||Array.isArray(r)?null==e[i]&&(e[i]=r):e[i]=ul({},r,e[i])}var n=t||"";if(!(e=this._preprocess(e,n)))return;e.preprocessed=!0}return e},_preprocess:function(e){return e},parseOrder:function(e,t){return"number"!=typeof e?mo.calculateOrder(e,t):e},scaleOrder:function(e){return 2*e},parseColor:function(e,t){return e?mo.evalCachedColorProperty(e,t):this.shaders.blocks.color||this.shaders.blocks.filter?mo.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(e){this.gl=e,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(e,t,i){var r=2<arguments.length&&void 0!==i?i:{},n=this.vertexLayoutForMeshVariant(r.variant);return new Xl(this.gl,e,t,n,this.scene_id,r)},render:function(e){return e.render()},getProgram:function(e){var t=0<arguments.length&&void 0!==e?e:"program";this.compileSetup();var i=this[t];if(i&&!i.error){if(!i.compiled)try{i.compile()}catch(e){An("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(t,"')"),this,e.stack)}return i}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var e,t=this.buildDefineList();this.selection&&((e=Object.assign({},t)).TANGRAM_FEATURE_SELECTION=!0);var i=this.shaders&&this.shaders.blocks,r=this.shaders&&this.shaders.block_scopes,n=Object.assign({},this.shaders&&this.shaders.uniforms);for(var o in n)null==n[o]&&An({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(o,"': uniform values must be non-null"));var a=this.shaders&&this.shaders.extensions;"string"==typeof a&&(a=[a]),this.program=new Vl(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:t,uniforms:n,blocks:i,block_scopes:r,extensions:a}),this.selection?this.selection_program=new Vl(this.gl,this.vertex_shader_src,this.crop_by_tile?"\n#pragma tangram: utils\n#ifdef TANGRAM_FEATURE_SELECTION\nuniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}":"\n#ifdef TANGRAM_FEATURE_SELECTION\nvarying vec4 v_selection_color;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\ngl_FragColor=v_selection_color;\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}",this.scene_id,{name:this.name+" (selection)",defines:e,uniforms:n,blocks:i,block_scopes:r,extensions:a}):this.selection_program=null,this.compile_setup=!0}},addShaderBlock:function(e,t,i){var r=2<arguments.length&&void 0!==i?i:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[e]=this.shaders.blocks[e]||[],this.shaders.blocks[e].push(t),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[e]=this.shaders.block_scopes[e]||[],this.shaders.block_scopes[e].push(r)},removeShaderBlock:function(e){this.shaders.blocks&&(this.shaders.blocks[e]=null)},replaceShaderBlock:function(e,t,i){var r=2<arguments.length&&void 0!==i?i:null;this.removeShaderBlock(e),this.addShaderBlock(e,t,r)},buildDefineList:function(){var e={};if(null!=this.defines)for(var t in this.defines)e[t]=this.defines[t];if(null!=this.shaders&&null!=this.shaders.defines)for(t in this.shaders.defines)e[t]=this.shaders.defines[t];return e},hasRasters:function(){return-1<["color","normal","custom"].indexOf(this.raster)},setupRasters:function(){if(!ln.is_main)return!1;if(!this.hasRasters())return!1;"color"===this.raster?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:"normal"===this.raster&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var e=!1;for(var t in this.sources)if(this.sources[t]instanceof Ho){e=!0;break}return!!e&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",ru,"Raster"),!0)},buildRasterTextures:function(o,a){var t=this;if(!this.hasRasters())return Promise.resolve(a);var s={};return o.rasters.map(function(e){return t.sources[e]}).filter(function(e){return e}).forEach(function(e,t){var i;e instanceof Ho&&(i=e.tileTexture(o),s[i.url]=i)}),0===Object.keys(s).length?Promise.resolve(a):un.postMessage(this.main_thread_target+".loadTextures",s).then(function(e){if(!e||e.length<1)return An("trace","Missing texture info for tile ".concat(o.key)),null;if(e.some(function(e){return!e.loaded}))return null;a.uniforms=a.uniforms||{},a.textures=a.textures||[];var t,i,r=e[0].name,n=s[r].coords;return a.uniforms.u_raster=r,a.textures.push(r),o.coords.z>n.z?(t=o.coords.z-n.z,i=Math.pow(2,t),a.uniforms.u_raster_offset=[(o.coords.x%i+i)%i/i,(i-1-o.coords.y%i)/i,1/i]):a.uniforms.u_raster_offset=[0,0,1],a})},loadTextures:function(e){var t=this;return this.textureManager.createFromObject(this.gl,e).then(function(){return Promise.all(Object.keys(e).map(function(e){return t.textureManager.textures[e]&&t.textureManager.textures[e].load()}).filter(function(e){return e}))}).then(function(e){return e.forEach(function(e){return e.retain()}),e.map(function(e){return{name:e.name,width:e.width,height:e.height,loaded:e.loaded}})})},setup:function(){this.setUniforms(),this.material.setupProgram(Vl.current)},setUniforms:function(){var e=Vl.current;e&&e.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(e){var t=[],i={};for(var r in e.forEach(function(e){var t=parseInt(e.name,10)||0;i[t]||(i[t]=[]),i[t].push(e)}),i)t.push.apply(t,zr(i[r].sort(nu.blendOrderSort)));return t},blendOrderSort:function(e,t){return"opaque"===e.blend||"opaque"===t.blend?"opaque"===e.blend&&"opaque"===t.blend?e.name<t.name?-1:1:"opaque"===e.blend?-1:1:e.blend_order<t.blend_order||!(e.blend_order>t.blend_order)&&(nu.default_blend_orders[e.blend]<nu.default_blend_orders[t.blend]||!(nu.default_blend_orders[e.blend]>nu.default_blend_orders[t.blend])&&e.name<t.name)?-1:1}},ou=iu={};iu.BYTE=5120,iu.UNSIGNED_BYTE=5121,iu.SHORT=5122,iu.UNSIGNED_SHORT=5123,iu.INT=5124,iu.UNSIGNED_INT=5125,iu.FLOAT=5126;var au,su=Math.pow(2,16)-1,lu=1024,uu=!1,cu=function(){function t(e){pr(this,t),this.size_=e||lu,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1}return vr(t,[{key:"push",value:function(e){if(!this.overflows_||uu){if(su<e){if(this.overflows_=!0,!uu)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=e,this.position_+=1}}},{key:"end",value:function(){if(0===this.position_)return!1;var e=this.buffer_,t=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,e.subarray(0,t)}},{key:"expand_",value:function(){this.size_=this.size_<<1;var e=new this.ArrayType_(this.size_);e.set(this.buffer_),this.buffer_=e}}]),t}();cu.setElementIndexUint=function(e){uu=e};var hu=(mr(au={},ou.FLOAT,Float32Array),mr(au,ou.BYTE,Int8Array),mr(au,ou.UNSIGNED_BYTE,Uint8Array),mr(au,ou.INT,Int32Array),mr(au,ou.UNSIGNED_INT,Uint32Array),mr(au,ou.SHORT,Int16Array),mr(au,ou.UNSIGNED_SHORT,Uint16Array),au),fu=function(){function r(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).prealloc,i=void 0===t?500:t;pr(this,r),this.vertex_layout=e,this.vertex_elements=new cu,this.stride=this.vertex_layout.stride,0<r.array_pool.length?(this.vertex_buffer=r.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),An("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=i,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return vr(r,[{key:"setBufferViews",value:function(){var i=this;this.views={},this.views[ou.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach(function(e){var t;null==i.views[e.type]&&(t=hu[e.type],i.views[e.type]=new t(i.vertex_buffer.buffer))})}},{key:"checkBufferSize",value:function(){var e;this.offset+this.stride>this.byte_length&&(this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size,(e=new Uint8Array(this.byte_length)).set(this.vertex_buffer),r.array_pool.push(this.vertex_buffer),this.vertex_buffer=e,this.setBufferViews(),this.realloc_count++)}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(e){this.checkBufferSize(),this.vertexLayoutAddVertex(e,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),An("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}]),r}();fu.array_pool=[];var du=function(){function l(e){pr(this,l),this.attribs=e,this.dynamic_attribs=this.attribs.filter(function(e){return!e.static}),this.components=[],this.index={},this.offset={};for(var t=this.stride=0,i=0,r=0;r<this.attribs.length;r++){var n=this.attribs[r];if(null==n.static){n.offset=this.stride,n.byte_size=n.size;var o=0;switch(n.type){case ou.FLOAT:case ou.INT:case ou.UNSIGNED_INT:n.byte_size*=4,o=2;break;case ou.SHORT:case ou.UNSIGNED_SHORT:n.byte_size*=2,o=1}3&n.byte_size&&(n.byte_size+=4-(3&n.byte_size)),this.stride+=n.byte_size;for(var a=n.offset>>o,s=0;s<n.size;s++)this.components.push({type:n.type,shift:o,offset:a++,index:i++});this.index[n.name]=t,t+=n.size,this.offset[n.name]=n.offset}else n.static=Array.isArray(n.static)?n.static:[n.static],n.method="vertexAttrib".concat(n.static.length,"fv")}}return vr(l,[{key:"enable",value:function(e,t,i){for(var r,n,o=0;o<this.attribs.length;o++)r=this.attribs[o],-1!==(n=t.attribute(r.name).location)&&(null==r.static?(l.enabled_attribs[n]&&!i||e.enableVertexAttribArray(n),e.vertexAttribPointer(n,r.size,r.type,r.normalized,this.stride,r.offset),l.enabled_attribs[n]=t):e[r.method]instanceof Function&&(e.enableVertexAttribArray(n),e[r.method](n,r.static),e.disableVertexAttribArray(n),delete l.enabled_attribs[n]));for(n in l.enabled_attribs)this.disableUnusedAttribute(e,n,t)}},{key:"disableUnusedAttribute",value:function(e,t,i){l.enabled_attribs[t]!==i&&(e.disableVertexAttribArray(t),delete l.enabled_attribs[t])}},{key:"createVertexData",value:function(){return new fu(this)}},{key:"getAddVertexFunction",value:function(){return null==this.addVertex&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var e=Dl(JSON.stringify(this.attribs));if(null==l.add_vertex_funcs[e]){var t,i=["var t, o;"],r=zr(this.components);r.sort(function(e,t){return e.type!==t.type?e.type-t.type:e.index-t.index});for(var n=0;n<r.length;n++){var o=r[n];t!==o.type&&(i.push("t = vs[".concat(o.type,"];")),i.push("o = off".concat(o.shift?" >> "+o.shift:"",";")),t=o.type),i.push("t[o + ".concat(o.offset,"] = v[").concat(o.index,"];"))}i=i.join("\n");var a=new Function("v","vs","off",i);l.add_vertex_funcs[e]=a}this.addVertex=l.add_vertex_funcs[e]}}]),l}();du.enabled_attribs={},du.add_vertex_funcs={};var _u=[{x:0,y:0},{x:Jr.tile_scale,y:-Jr.tile_scale}],pu=[0,0,1,1];function gu(e,t,i){var r=_u[0],n=_u[1];return e[0]<=r.x+i&&t[0]<=r.x+i||e[0]>=n.x-i&&t[0]>=n.x-i||e[1]>=r.y-i&&t[1]>=r.y-i||e[1]<=n.y+i&&t[1]<=n.y+i}function vu(e,t){t=t||0;var i=_u[0],r=_u[1];return e[0]<=i.x+t||e[0]>=r.x-t||e[1]>=i.y-t||e[1]<=r.y+t}var mu=yu;function yu(e,t,i){i=i||2;var r,n,o,a,s,l,u,c=t&&t.length,h=c?t[0]*i:e.length,f=xu(e,0,h,i,!0),d=[];if(!f)return d;if(c&&(f=function(e,t,i,r){var n,o,a,s,l,u=[];for(n=0,o=t.length;n<o;n++)a=t[n]*r,s=n<o-1?t[n+1]*r:e.length,(l=xu(e,a,s,r,!1))===l.next&&(l.steiner=!0),u.push(function(e){var t=e,i=e;for(;t.x<i.x&&(i=t),t=t.next,t!==e;);return i}(l));for(u.sort(Au),n=0;n<u.length;n++)!function(e,t){{var i;(t=function(e,t){var i,r=t,n=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&a<s){if((a=s)===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(n===a)return i.prev;var l,u=i,c=i.x,h=i.y,f=1/0;r=i.next;for(;r!==u;)n>=r.x&&r.x>=c&&ku(o<h?n:a,o,c,h,o<h?a:n,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(n-r.x))<f||l===f&&r.x>i.x)&&Su(r,e)&&(i=r,f=l),r=r.next;return i}(e,t))&&bu(i=Pu(t,e),i.next)}}(u[n],i),i=bu(i,i.next);return i}(e,t,f,i)),e.length>80*i){r=o=e[0],n=a=e[1];for(var _=i;_<h;_+=i)(s=e[_])<r&&(r=s),(l=e[_+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);u=Math.max(o-r,a-n)}return wu(f,d,i,r,n,u),d}function xu(e,t,i,r,n){var o,a;if(n===0<Iu(e,t,i,r))for(o=t;o<i;o+=r)a=zu(o,e[o],e[o+1],a);else for(o=i-r;t<=o;o-=r)a=zu(o,e[o],e[o+1],a);return a&&Mu(a,a.next)&&(Nu(a),a=a.next),a}function bu(e,t){if(!e)return e;t=t||e;var i,r=e;do{if(i=!1,r.steiner||!Mu(r,r.next)&&0!==Eu(r.prev,r,r.next))r=r.next;else{if(Nu(r),(r=t=r.prev)===r.next)return null;i=!0}}while(i||r!==t);return t}function wu(e,t,i,r,n,o,a){if(e){!a&&o&&function(e,t,i,r){var n=e;for(;null===n.z&&(n.z=Tu(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next,n!==e;);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,i,r,n,o,a,s,l,u=1;do{for(i=e,o=e=null,a=0;i;){for(a++,r=i,t=s=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;0<s||0<l&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(i=(n=i).nextZ,s--):(r=(n=r).nextZ,l--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=r}o.nextZ=null,u*=2}while(1<a)}(n)}(e,r,n,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?function(e,t,i,r){var n=e.prev,o=e,a=e.next;if(0<=Eu(n,o,a))return!1;var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,l=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,u=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,c=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,h=Tu(s,l,t,i,r),f=Tu(u,c,t,i,r),d=e.nextZ;for(;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&ku(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=Eu(d.prev,d,d.next))return!1;d=d.nextZ}d=e.prevZ;for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&ku(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=Eu(d.prev,d,d.next))return!1;d=d.prevZ}return!0}(e,r,n,o):function(e){var t=e.prev,i=e,r=e.next;if(0<=Eu(t,i,r))return!1;var n=e.next.next;for(;n!==e.prev;){if(ku(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&0<=Eu(n.prev,n,n.next))return!1;n=n.next}return!0}(e))t.push(s.i/i),t.push(e.i/i),t.push(l.i/i),Nu(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?wu(e=function(e,t,i){var r=e;do{var n=r.prev,o=r.next.next;!Mu(n,o)&&Ru(n,r,r.next,o)&&Su(n,o)&&Su(o,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(o.i/i),Nu(r),Nu(r.next),r=e=o),r=r.next}while(r!==e);return r}(e,t,i),t,i,r,n,o,2):2===a&&function(e,t,i,r,n,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Ru(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&Su(e,t)&&Su(t,e)&&function(e,t){var i=e,r=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;for(;i.y>o!=i.next.y>o&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next,i!==e;);return r}(e,t)}(a,s)){var l=Pu(a,s);return a=bu(a,a.next),l=bu(l,l.next),wu(a,t,i,r,n,o),wu(l,t,i,r,n,o)}s=s.next}a=a.next}while(a!==e)}(e,t,i,r,n,o):wu(bu(e),t,i,r,n,o,1);break}}}function Au(e,t){return e.x-t.x}function Tu(e,t,i,r,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)/n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)/n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ku(e,t,i,r,n,o,a,s){return 0<=(n-a)*(t-s)-(e-a)*(o-s)&&0<=(e-a)*(r-s)-(i-a)*(t-s)&&0<=(i-a)*(o-s)-(n-a)*(r-s)}function Eu(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Mu(e,t){return e.x===t.x&&e.y===t.y}function Ru(e,t,i,r){return Mu(e,t)&&Mu(i,r)||Mu(e,r)&&Mu(i,t)||0<Eu(e,t,i)!=0<Eu(e,t,r)&&0<Eu(i,r,e)!=0<Eu(i,r,t)}function Su(e,t){return Eu(e.prev,e,e.next)<0?0<=Eu(e,t,e.next)&&0<=Eu(e,e.prev,t):Eu(e,t,e.prev)<0||Eu(e,e.next,t)<0}function Pu(e,t){var i=new Ou(e.i,e.x,e.y),r=new Ou(t.i,t.x,t.y),n=e.next,o=t.prev;return(e.next=t).prev=e,(i.next=n).prev=i,(r.next=i).prev=r,(o.next=r).prev=o,r}function zu(e,t,i,r){var n=new Ou(e,t,i);return r?(n.next=r.next,(n.prev=r).next.prev=n,r.next=n):(n.prev=n).next=n,n}function Nu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ou(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Iu(e,t,i,r){for(var n=0,o=t,a=i-r;o<i;o+=r)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}yu.deviation=function(e,t,i,r){var n=t&&t.length,o=n?t[0]*i:e.length,a=Math.abs(Iu(e,0,o,i));if(n)for(var s=0,l=t.length;s<l;s++){var u=t[s]*i,c=s<l-1?t[s+1]*i:e.length;a-=Math.abs(Iu(e,u,c,i))}for(var h=0,s=0;s<r.length;s+=3){var f=r[s]*i,d=r[s+1]*i,_=r[s+2]*i;h+=Math.abs((e[f]-e[_])*(e[1+d]-e[1+f])-(e[f]-e[d])*(e[1+_]-e[1+f]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},yu.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},r=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)i.vertices.push(e[n][o][a]);0<n&&(r+=e[n-1].length,i.holes.push(r))}return i};var Lu=[0,0,1];function Cu(e,t,i,r){var n,o,a,s,l,u=r.texcoord_index,c=r.texcoord_scale,h=r.texcoord_normalize,f=t.vertex_elements;u&&(h=h||1,o=(n=Pr(c||pu,4))[0],a=n[1],s=n[2],l=n[3]);for(var d,_=0,p=e.length,g=0;g<p;g++){var v,m,y,x,b,w=t.vertex_count,A=e[g];u&&(m=(v=Pr(Jr.findBoundingBox(A),4))[0],y=v[1],x=(s-o)/(v[2]-m),b=(l-a)/(v[3]-y));for(var T=0;T<A.length;T++)for(var k=A[T],E=0;E<k.length;E++){var M=k[E];i[0]=M[0],i[1]=M[1],u&&(i[u+0]=((M[0]-m)*x+o)*h,i[u+1]=((M[1]-y)*b+a)*h),t.addVertex(i)}for(var R=(d=mu.flatten(A),mu(d.vertices,d.holes,d.dimensions)),S=0;S<R.length;S++)f.push(w+R[S]);_+=R.length/3}return _}var Fu="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;\n#ifdef TANGRAM_NORMAL_ATTRIBUTE\nattribute vec3 a_normal;\n#define TANGRAM_NORMAL a_normal\n#else\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nattribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;\n#endif\nvarying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nattribute vec2 a_texcoord;varying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvoid main(){\n#pragma tangram: setup\n#ifdef TANGRAM_TEXTURE_COORDS\nv_texcoord=a_texcoord;\n#ifdef TANGRAM_EXTRUDE_LINES\nv_texcoord.y*=u_v_scale_adjust;\n#endif\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nvec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);\n#ifdef TANGRAM_EXTRUDE_LINES\nvec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;\n#ifdef TANGRAM_BLOCK_WIDTH\nfloat width=1.;\n#pragma tangram: width\nextrude*=width;\n#endif\nposition.xy+=extrude+offset;\n#endif\nv_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#if defined(SNAP_TO_PIXEL_GRID)\nsnapToPixelGrid(position);\n#endif\ngl_Position=position;}",Du="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_EXTRUDE_LINES\nuniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;\n#endif\n#define TANGRAM_NORMAL v_normal\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nvarying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#pragma tangram: utils\nvoid main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_COLOR\ncolor*=sampleRaster();\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nif(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)\nif(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;\n#else\ncolor=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));\n#endif\n}else{color*=_line_color;}}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_NORMAL\nnormal=normalize(sampleRaster().rgb*2.-1.);\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\ngl_FragColor=color;}",ju=Object.create(nu);Object.assign(ju,{name:"polygons",built_in:!0,vertex_shader_src:Fu,fragment_shader_src:Du,selection:!0,init:function(){nu.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:ou.SHORT,normalized:!1},{name:"a_normal",size:3,type:ou.BYTE,normalized:!0},{name:"a_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0}],this.texcoords&&e.push({name:"a_texcoord",size:2,type:ou.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new du(e)),this.vertex_layout},_parseFeature:function(e,t,i){var r=this.feature_style;return r.color=this.parseColor(t.color,i),r.color?(r.z=t.z&&mo.evalCachedDistanceProperty(t.z,i)||mo.defaults.z,r.z*=Jr.height_scale,r.extrude=mo.evalProperty(t.extrude,i),r.extrude&&(!0===r.extrude?(r.height=void 0!==e.properties.height?e.properties.height:mo.defaults.height,r.min_height=void 0!==e.properties.min_height?e.properties.min_height:mo.defaults.min_height):"number"==typeof r.extrude?(r.height=r.extrude,r.min_height=0):Array.isArray(r.extrude)&&(r.min_height=r.extrude[0],r.height=r.extrude[1]),r.height*=Jr.height_scale,r.min_height*=Jr.height_scale),r.tile_edges=t.tile_edges,r):null},_preprocess:function(e){return e.color=mo.createColorPropertyCache(e.color),e.z=mo.createPropertyCache(e.z,mo.parseUnits),e},makeVertexTemplate:function(e){var t=0;return this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=e.z||0,this.vertex_template[t++]=this.scaleOrder(e.order),this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=127,this.vertex_template[t++]=255*e.color[0],this.vertex_template[t++]=255*e.color[1],this.vertex_template[t++]=255*e.color[2],this.vertex_template[t++]=255*e.color[3],this.selection&&(this.vertex_template[t++]=255*e.selection_color[0],this.vertex_template[t++]=255*e.selection_color[1],this.vertex_template[t++]=255*e.selection_color[2],this.vertex_template[t++]=255*e.selection_color[3]),this.texcoords&&(this.vertex_template[t++]=0,this.vertex_template[t++]=0),this.vertex_template},buildPolygons:function(e,t,i,r){var n=this.makeVertexTemplate(t),o={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!t.tile_edges,tile_edge_tolerance:Jr.tile_scale*r.tile.pad_scale*4,winding:r.winding};return t.extrude&&t.height?function(e,t,i,r,n,o,a,s,l){var u=l.remove_tile_edges,c=l.tile_edge_tolerance,h=l.texcoord_index,f=l.texcoord_scale,d=l.texcoord_normalize,_=l.winding,p=t+(r||0),g=t+i;o[2]=g;var v,m,y,x,b,w,A=Cu(e,n,o,{texcoord_index:h,texcoord_scale:f,texcoord_normalize:d}),T=n.vertex_elements,k=n.vertex_count;h&&(d=d||1,m=(v=Pr(f||pu,4))[0],y=v[1],x=v[2],w=[[m,b=v[3]],[m,y],[x,y],[x,b]]);for(var E=e.length,M=0;M<E;M++)for(var R=e[M],S=0;S<R.length;S++)for(var P=R[S],z=0;z<P.length-1;z++)if(!u||!gu(P[z],P[z+1],c)){var N=void 0,O=void 0,I=[[P[O="CCW"===_?(N=z)+1:(N=z+1,z)][0],P[O][1],g],[P[O][0],P[O][1],p],[P[N][0],P[N][1],p],[P[N][0],P[N][1],g]],L=Kl.normalize([P[O][0]-P[N][0],P[O][1]-P[N][1],0]),C=Kl.cross(Lu,L);o[a+0]=C[0]*s,o[a+1]=C[1]*s,o[a+2]=C[2]*s;for(var F=0;F<I.length;F++)o[0]=I[F][0],o[1]=I[F][1],o[2]=I[F][2],h&&(o[h+0]=w[F][0]*d,o[h+1]=w[F][1]*d),n.addVertex(o);T.push(k+0),T.push(k+1),T.push(k+2),T.push(k+2),T.push(k+3),T.push(k+0),k+=4,A+=2}return A}(e,t.z,t.height,t.min_height,i.vertex_data,n,this.vertex_layout.index.a_normal,127,o):Cu(e,i.vertex_data,n,o)}});var Uu=[0,0],Gu={butt:0,square:1,round:2},Bu={miter:0,bevel:1,round:2},Vu={MITER_LIMIT:3,TEXCOORD_NORMALIZE:1,TEXCOORD_RATIO:1,MIN_FAN_WIDTH:5},qu=Jr.tile_scale,Hu=[0,0],Yu=[1,0],Xu=[.5,0];function Wu(e,t){if(!(e.length<2)){var i,r,n=t.join_type,o=t.cap_type,a=t.closed_polygon,s=t.remove_tile_edges,l=t.tile_edge_tolerance,u=t.v_scale,c=t.miter_len_sq,h=t.crop_by_tile,f=null!=t.texcoord_index,d=0;if(a&&n===Bu.miter){var _=function(e){if(vu(e[0]))return 0;for(var t=0;t<e.length;t++){if(vu(e[e.length-1-t]))return e.length-1-t}return 0}(e);if(0!==_){var p=function(e,t){for(var i=[],r=0;r<e.length;r++){var n=(r+t)%e.length;0!=n&&i.push(e[n])}return i.push(i[0]),i}(e,_);return t.extra_lines=t.extra_lines||[],void t.extra_lines.push(p)}}var g=0,v=e.length-1,m=0;for(A=e[g],T=e[g+1];Kl.isEqual(A,T);)if(A=T,T=e[++g+1],m++,g===e.length-1)return;for(;Kl.isEqual(e[v],e[v-1]);)if(m++,0===--v)return;if(!(e.length<2+m))if(r=Kl.normalize(Kl.perp(A,T)),s&&gu(A,T,l)){var y=Zu(e,g,l);y&&(t.extra_lines=t.extra_lines||[],t.extra_lines.push(y))}else{a?function(e,t,i,r,n){{void 0===r||vu(e)&&!n.crop_by_tile?(ec(e,i,i,1,0,n,1),ec(e,i,i,0,0,n,-1)):r===Bu.miter?$u(0,e,t,i,n.miter_len_sq,!0,n):Ju(r,0,e,t,i,!0,n)}}(A,i=Kl.normalize(Kl.perp(e[v-1],A)),r,n,t):(!h&&vu(A)||(rc(A,d,r,o,!0,t),f&&o!==Gu.butt&&(d+=.5*u*t.texcoord_width)),ec(A,r,r,1,d,t,1),ec(A,r,r,0,d,t,-1)),f&&(d+=u*Kl.length(Kl.sub(T,A)));for(var x=g+1;x<v;x++){var b=x,w=x+1,A=e[b],T=e[w];if(!Kl.isEqual(A,T)){if(s&&gu(A,T,l)){ec(A,r,r,1,d,t,1),ec(A,r,r,0,d,t,-1),Qu(1,t);var k=Zu(e,b+1,l);return void(k&&(t.extra_lines=t.extra_lines||[],t.extra_lines.push(k)))}i=r,r=Kl.normalize(Kl.perp(A,T)),n===Bu.miter?$u(d,A,i,r,c,!1,t):Ju(n,d,A,i,r,!1,t),f&&(d+=u*Kl.length(Kl.sub(T,A)))}}A=T,i=r,a?function(e,t,i,r,n,o){{var a;vu(e)&&!o.crop_by_tile?(ec(e,t,t,1,n,o,1),ec(e,t,t,0,n,o,-1)):(a=Ku(t,i),r===Bu.miter&&Kl.lengthSq(a)>o.miter_len_sq&&(r=Bu.bevel),r===Bu.miter?(ec(e,a,t,1,n,o,1),ec(e,a,t,0,n,o,-1)):(ec(e,t,t,1,n,o,1),ec(e,t,t,0,n,o,-1))),Qu(1,o)}}(A,i,r=Kl.normalize(Kl.perp(A,e[1])),n,d,t):(ec(A,i,r,1,d,t,1),ec(A,i,r,0,d,t,-1),Qu(1,t),!h&&vu(A)||rc(A,d,i,o,!1,t))}}}function Zu(e,t,i){for(var r=t;e[r+1]&&gu(e[r],e[r+1],i);)r++;return 2<=e.length-r&&e.slice(r)}function Ku(e,t){var i=Kl.normalize(Kl.add(e,t)),r=2/(1+Math.abs(Kl.dot(e,i)));return Kl.mult(i,r*r)}function $u(e,t,i,r,n,o,a){var s=Ku(i,r);Kl.lengthSq(s)>n?Ju(Bu.bevel,e,t,i,r,o,a):(ec(t,s,s,1,e,a,1),ec(t,s,s,0,e,a,-1),o||Qu(1,a))}function Ju(e,t,i,r,n,o,a){var s=Ku(r,n),l=0<n[0]*r[1]-n[1]*r[0];null!=a.texcoord_index&&(Hu[1]=t,Yu[1]=t),l?(ec(i,s,s,1,t,a,1),ec(i,r,s,0,t,a,-1),o||Qu(1,a),ic(i,Kl.neg(r),s,Kl.neg(n),s,Hu,Yu,Hu,!1,e===Bu.bevel,a),ec(i,s,s,1,t,a,1),ec(i,n,s,0,t,a,-1)):(ec(i,r,s,1,t,a,1),ec(i,s,s,0,t,a,-1),o||Qu(1,a),ic(i,r,Kl.neg(s),n,s,Yu,Hu,Yu,!1,e===Bu.bevel,a),ec(i,n,s,1,t,a,1),ec(i,s,s,0,t,a,-1))}function Qu(e,t){for(var i=t.vertex_data.vertex_elements,r=t.vertex_data.vertex_count-2*e-2,n=0;n<e;n++)i.push(r+2*n+2),i.push(r+2*n+1),i.push(r+2*n),i.push(r+2*n+2),i.push(r+2*n+3),i.push(r+2*n+1),t.geom_count+=2}function ec(e,t,i,r,n,o,a){var s=o.vertex_template,l=o.vertex_data;s[0]=e[0],s[1]=e[1];var u=o.half_width*a;s[o.extrude_index+0]=t[0]*u,s[o.extrude_index+1]=t[1]*u,o.offset&&(s[o.offset_index+0]=i[0]*o.offset,s[o.offset_index+1]=i[1]*o.offset),null!=o.texcoord_index&&(s[o.texcoord_index+0]=r*o.texcoord_normalize,s[o.texcoord_index+1]=n*o.texcoord_normalize),l.addVertex(s)}var tc=[0,0];function ic(e,t,i,r,n,o,a,s,l,u,c){for(var h=t[0]*r[1]-t[1]*r[0],f=Kl.dot(t,r),d=Math.atan2(h,f);d>=Math.PI;)d-=2*Math.PI;if(u)_=1;else{var _=function(e,t){e<0&&(e=-e);var i=t>2*Vu.MIN_FAN_WIDTH?Math.log2(t/Vu.MIN_FAN_WIDTH):1;return Math.ceil(e/Math.PI*i)}(d,c.half_width);if(_<1)return}var p=c.vertex_data.vertex_count,g=c.vertex_data.vertex_elements;ec(e,i,n,a[0],a[1],c,1),ec(e,t,n,o[0],o[1],c,1);var v,m,y=t,x=null!=c.texcoord_index;x&&(l?v=Kl.sub(o,a):(tc=Kl.copy(o),m=Kl.div(Kl.sub(s,o),_)));for(var b,w=d/_,A=d<0?-1:1,T=0<h?(b=2,1):(b=1,2),k=0;k<_;k++)0===k&&d<0&&(y=Kl.neg(y)),y=Kl.rot(y,w),x&&(l?(v=Kl.rot(v,w),tc[0]=v[0]+a[0],tc[1]=v[1]*c.texcoord_width*c.v_scale+a[1]):tc=Kl.add(tc,m)),ec(e,y,n,tc[0],tc[1],c,A),g.push(p+k+b),g.push(p),g.push(p+k+T)}function rc(e,t,i,r,n,o){var a,s=Kl.neg(i),l=null!=o.texcoord_index;switch(r){case Gu.square:n?(a=[i[1],-i[0]],ec(e,Kl.add(i,a),i,1,t,o,1),ec(e,Kl.add(s,a),i,0,t,o,1),l&&(t+=.5*o.texcoord_width*o.v_scale),ec(e,i,i,1,t,o,1),ec(e,s,i,0,t,o,1)):(a=[-i[1],i[0]],ec(e,i,i,1,t,o,1),ec(e,s,i,0,t,o,1),l&&(t+=.5*o.texcoord_width*o.v_scale),ec(e,Kl.add(i,a),i,1,t,o,1),ec(e,Kl.add(s,a),i,0,t,o,1)),Qu(1,o);break;case Gu.round:var u,c,h=Hu,f=Yu,d=Xu;n?(u=i,c=s,l&&(t+=.5*o.texcoord_width*o.v_scale,h=Yu,f=Hu,d=Xu)):(u=s,c=i),l&&(Hu[1]=t,Yu[1]=t,Xu[1]=t),ic(e,u,Uu,c,i,h,d,f,!0,!1,o);break;case Gu.butt:return}}var nc=[255,255,255,255],oc=[0,0,0,0];var ac=Object.create(nu);ac.vertex_layouts=[[],[]],ac.variants={},ac.dash_textures={};function sc(e,t,i,r,n,o){for(var a={closed:o,vertex_data:i,vertex_template:r,half_width:t/2,vertex_layout_index:n,geom_count:0},s=0,l=e.length;s<l;s++)!function(e,t){if(e.length<2)return;for(var i=[e[0]],r=0,n=[],o=[],a=1,s=e.length;a<s;a++){var l,u;e[a][0]===e[a-1][0]&&e[a][1]===e[a-1][1]||(i.push(e[a]),l=Kl.sub(e[a],e[a-1]),u=Kl.length(l),n.push(l),o.push([r,r+u]),r+=u)}if(i.length<2)return;var c=0,h=n[n.length-1],f=n[0],d=n[1],_=[0,0];2<i.length&&(t.closed&&(_[0]=Kl.signedAngleBetween(h,f)),_[1]=Kl.signedAngleBetween(f,d));var p=i[0],g=o[0];t.closed?(cc(p,t,c++,g,r,_,[h,f]),cc(p,t,c++,g,r,_,[h,f])):(cc(p,t,c++,g,r,_,[f,f]),cc(p,t,c++,g,r,_,[f,f]));for(var v=1,m=i.length-1;v<m;v++)p=i[v],h=n[v-1],f=n[v],d=n[v+1],g=o[v-1],cc(p,t,c++,g,r,_,[h,f]),cc(p,t,c++,g,r,_,[h,f]),lc(t),g=o[v],_[0]=_[1],_[1]=v!==m-1?Kl.signedAngleBetween(f,d):t.closed?Kl.signedAngleBetween(f,n[0]):0,cc(p,t,c++,g,r,_,[h,f]),cc(p,t,c++,g,r,_,[h,f]);p=i[i.length-1],g=o[o.length-1],f=n[n.length-1],t.closed?(cc(p,t,c++,g,r,_,[f,n[0]]),cc(p,t,c++,g,r,_,[f,n[0]])):(cc(p,t,c++,g,r,_,[f,f]),cc(p,t,c++,g,r,_,[f,f]));lc(t)}(e[s],a);return a.geom_count}function lc(e){var t=e.vertex_data.vertex_elements,i=e.vertex_data.vertex_count-4;t.push(2+i),t.push(1+i),t.push(i),t.push(2+i),t.push(3+i),t.push(1+i),e.geom_count+=2}Object.assign(ac,{name:"lines",built_in:!0,vertex_shader_src:Fu,fragment_shader_src:Du,selection:!0,init:function(){nu.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(e,t){return e&&mo.evalCachedDistanceProperty(e,t)||0},calcDistanceNextZoom:function(e,t){t.zoom++;var i=this.calcDistance(e,t);return t.zoom--,i},calcWidth:function(e,t,i){var r=this.calcDistance(e.width,i);if(!(r<0)){var n,o=e.next_width?this.calcDistanceNextZoom(e.next_width,i):r/2;return 0===r&&0===o||o<0?!1:(t.width_unscaled=r,t.next_width_unscaled=o,e.next_width?(n=.5*(r+(o*=2)),t.width=n*i.units_per_meter_overzoom,t.width_scale=1-o/n):(t.width=r*i.units_per_meter_overzoom,t.width_scale=0),e.texcoords&&(e.inline_texcoord_width?t.texcoord_width=e.inline_texcoord_width:t.texcoord_width=(t.width_unscaled||t.next_width_unscaled)*i.units_per_meter_overzoom/i.tile.overzoom2),!0)}},calcOffset:function(e,t,i){var r,n;e.offset_precalc?(t.offset=e.offset_precalc,t.offset_scale=e.offset_scale_precalc):e.offset?(r=this.calcDistance(e.offset,i),e.next_offset?(n=2*this.calcDistanceNextZoom(e.next_offset,i),Math.abs(r)>=Math.abs(n)?(t.offset=r*i.units_per_meter_overzoom,t.offset_scale=0!==r?1-n/r:0):(t.offset=n*i.units_per_meter_overzoom,t.offset_scale=0!=n?-1*(1-r/n):0)):(t.offset=r*i.units_per_meter_overzoom,t.offset_scale=0)):(t.offset=0,t.offset_scale=0),mo.evalProperty(e.offset_reverse,i)&&(t.offset*=-1)},_parseFeature:function(e,t,i){var r,n,o=this.feature_style;if(!1!==this.calcWidth(t,o,i)&&(this.calcOffset(t,o,i),o.color=this.parseColor(t.color,i),o.color))return o.variant=t.variant,o.z=t.z&&mo.evalCachedDistanceProperty(t.z||0,i)||mo.defaults.z,o.height=e.properties.height||mo.defaults.height,o.extrude=mo.evalProperty(t.extrude,i),o.extrude&&("number"==typeof o.extrude?o.height=o.extrude:Array.isArray(o.extrude)&&(o.height=o.extrude[1])),o.extrude&&o.height&&(o.z+=o.height),o.z*=Jr.height_scale,o.height*=Jr.height_scale,o.cap=mo.evalProperty(t.cap,i),o.join=mo.evalProperty(t.join,i),o.miter_limit=mo.evalProperty(t.miter_limit,i),o.tile_edges=t.tile_edges,o.outline=o.outline||{width:{},next_width:{},preprocessed:!0},t.outline&&!1!==t.outline.visible&&t.outline.color&&t.outline.width?(r=2*this.calcDistance(t.outline.width,i),n=2*this.calcDistanceNextZoom(t.outline.next_width,i),0==r&&0==n||r<0||n<0?(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null,o.outline.texcoords=!1):(o.outline.width.value=r+o.width_unscaled,o.outline.next_width.value=n+o.next_width_unscaled,o.outline.inline_texcoord_width=o.texcoord_width,o.outline.offset_precalc=o.offset,o.outline.offset_scale_precalc=o.offset_scale,o.outline.color=t.outline.color,o.outline.cap=t.outline.cap,o.outline.join=t.outline.join,o.outline.miter_limit=t.outline.miter_limit,o.outline.texcoords=t.outline.texcoords,o.outline.style=t.outline.style,o.outline.variant=t.outline.variant,t.outline.order?o.outline.order=this.parseOrder(t.outline.order,i):o.outline.order=o.order,o.outline.order>o.order&&(o.outline.order=o.order),o.outline.order-=.5,o.outline.variant_order=0)):(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null),o},_preprocess:function(e,t){var i,r=this.sources[t]?this.sources[t].config.uid:"";return e.color=mo.createColorPropertyCache(e.color),e.width=mo.createPropertyCache(e.width,mo.parseUnits),e.width&&e.width.type!==mo.CACHE_TYPE.STATIC&&(e.next_width=mo.createPropertyCache(e.width,mo.parseUnits)),e.offset=e.offset&&mo.createPropertyCache(e.offset,mo.parseUnits),e.offset&&e.offset.type!==mo.CACHE_TYPE.STATIC&&(e.next_offset=mo.createPropertyCache(e.offset,mo.parseUnits)),e.z=mo.createPropertyCache(e.z,mo.parseUnits),e.dash=void 0!==e.dash?e.dash:this.dash,e.dash_key=e.dash&&this.dashTextureKey(e.dash,r),e.dash_background_color=void 0!==e.dash_background_color?e.dash_background_color:this.dash_background_color,e.dash_background_color=e.dash_background_color&&mo.parseColor(e.dash_background_color),e.texture_merged=e.dash_key||(void 0!==e.texture?e.texture:this.texture),e.texcoords=this.texcoords||e.texture_merged?1:0,this.computeVariant(e),e.outline&&(e.outline.style=e.outline.style||this.name,e.outline.color=mo.createColorPropertyCache(e.outline.color),e.outline.width=mo.createPropertyCache(e.outline.width,mo.parseUnits),e.outline.next_width=mo.createPropertyCache(e.outline.width,mo.parseUnits),e.outline.cap=e.outline.cap||e.cap,e.outline.join=e.outline.join||e.join,e.outline.miter_limit=e.outline.miter_limit||e.miter_limit,e.outline.offset=e.offset,(i=this.styles[e.outline.style])?(e.outline.dash=void 0!==e.outline.dash?e.outline.dash:i.dash,e.outline.texture=void 0!==e.outline.texture?e.outline.texture:i.texture,null!=e.outline.dash?(e.outline.dash_key=e.outline.dash&&this.dashTextureKey(e.outline.dash,r),e.outline.texture_merged=e.outline.dash_key):null===e.outline.dash||null!=e.outline.texture?(e.outline.dash_key=null,e.outline.texture_merged=e.outline.texture):(e.outline.dash=e.dash,e.outline.dash_key=e.outline.dash&&this.dashTextureKey(e.outline.dash,r),e.outline.texture_merged=e.outline.dash_key),e.outline.dash_background_color=void 0!==e.outline.dash_background_color?e.outline.dash_background_color:i.dash_background_color,e.outline.dash_background_color=void 0!==e.outline.dash_background_color?e.outline.dash_background_color:e.dash_background_color,e.outline.dash_background_color=e.outline.dash_background_color&&mo.parseColor(e.outline.dash_background_color),e.outline.texcoords=i.texcoords||e.outline.texture_merged?1:0,this.computeVariant(e.outline)):(An({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(e.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),e.outline=null)),e},dashTextureKey:function(e,t){return"__dash_"+t+"_"+this.scene_id+"_"+JSON.stringify(e)},getDashTexture:function(e,t){var i,r=this.dashTextureKey(e,this.sources[t].config.uid);null==ac.dash_textures[r]&&(ac.dash_textures[r]=!0,i=function(e,t){var i=1<arguments.length&&void 0!==t?t:{},r=i.dash_color||nc,n=i.background_color||oc,o=e,a=i.scale||1;o.length%2==1&&Array.prototype.push.apply(o,o);for(var s=!0,l=[],u=0;u<o.length;u++){for(var c=Math.floor(o[u]*a),h=0;h<c;h++)Array.prototype.push.apply(l,s?r:n);s=!s}return{pixels:l=new Uint8Array(l),length:l.length/4}}(e,{scale:20}),this.textureManager.create(this.gl,r,{data:i.pixels,height:i.length,width:1,filtering:"nearest"}))},endData:function(a){var s=this;return nu.endData.call(this,a).then(function(n){if(n){n.uniforms.u_has_line_texture=!1,n.uniforms.u_texture=s.textureManager.default,n.uniforms.u_v_scale_adjust=Jr.tile_scale;var o=[];for(var e in n.meshes)!function(e){var i,t,r=n.meshes[e].variant;r.texture&&((i=n.meshes[e].uniforms=n.meshes[e].uniforms||{}).u_has_line_texture=!0,i.u_texture=r.texture,i.u_texture_ratio=1,r.dash&&(i.u_v_scale_adjust=20*Jr.tile_scale,i.u_dash_background_color=r.dash_background_color||[0,0,0,0]),r.dash_key&&null==ac.dash_textures[r.dash_key]&&(ac.dash_textures[r.dash_key]=!0,un.postMessage(s.main_thread_target+".getDashTexture",r.dash,a.source)),null==s.textureManager.textures[r.texture]?o.push(s.textureManager.syncTexturesToWorker([r.texture]).then(function(e){var t=e[r.texture];t&&(i.u_texture_ratio=t.height/t.width)})):(t=s.textureManager.textures[r.texture],i.u_texture_ratio=t.height/t.width))}(e);return a.mesh_data[s.name]=n,Promise.all(o).then(function(){return n})}return n})},computeVariant:function(e){var t=e.offset?1:0;e.dash_key&&(t+=e.dash_key,e.dash_background_color&&(t+=e.dash_background_color)),e.texture_merged&&(t+=e.texture_merged),t=Dl(t+="/"+e.texcoords),e.variant=t,null==ac.variants[t]&&(ac.variants[t]={key:t,order:e.variant_order,offset:e.offset?1:0,texcoords:e.texcoords,texture:e.texture_merged,dash:e.dash,dash_key:e.dash_key,dash_background_color:e.dash_background_color})},vertexLayoutForMeshVariant:function(e){var t;return null==ac.vertex_layouts[e.key]&&(t=[{name:"a_position",size:4,type:ou.SHORT,normalized:!1},{name:"a_extrude",size:2,type:ou.SHORT,normalized:!1},{name:"a_offset",size:2,type:ou.SHORT,normalized:!1,static:e.offset?null:[0,0]},{name:"a_scaling",size:2,type:ou.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:ou.UNSIGNED_SHORT,normalized:!0,static:e.texcoords?null:[0,0]},{name:"a_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0}],ac.vertex_layouts[e.key]=new du(t)),ac.vertex_layouts[e.key]},meshVariantTypeForDraw:function(e){return ac.variants[e.variant]},makeVertexTemplate:function(e,t){var i=0;return this.vertex_template[i++]=0,this.vertex_template[i++]=0,this.vertex_template[i++]=e.z||0,this.vertex_template[i++]=this.scaleOrder(e.order),this.vertex_template[i++]=0,this.vertex_template[i++]=0,t.variant.offset&&(this.vertex_template[i++]=0,this.vertex_template[i++]=0),this.vertex_template[i++]=1024*e.width_scale,this.vertex_template[i++]=1024*e.offset_scale,t.variant.texcoords&&(this.vertex_template[i++]=0,this.vertex_template[i++]=0),this.vertex_template[i++]=255*e.color[0],this.vertex_template[i++]=255*e.color[1],this.vertex_template[i++]=255*e.color[2],this.vertex_template[i++]=255*e.color[3],this.selection&&(this.vertex_template[i++]=255*e.selection_color[0],this.vertex_template[i++]=255*e.selection_color[1],this.vertex_template[i++]=255*e.selection_color[2],this.vertex_template[i++]=255*e.selection_color[3]),this.vertex_template},buildLines:function(e,t,i,r,n){var o;this.feature_style=this.outline_feature_style,!t.outline||null==t.outline.color||null==t.outline.width.value||(o=this.styles[t.outline.style])&&o.addFeature(r.feature,t.outline,r),this.feature_style=this.inline_feature_style;var a=i.vertex_data,s=a.vertex_layout,l=this.makeVertexTemplate(t,i);return function(e,t,i,r,n){var o,a,s=n.closed_polygon,l=n.remove_tile_edges,u=n.tile_edge_tolerance,c=n.texcoord_index,h=(n.texcoord_scale,n.texcoord_width),f=n.texcoord_ratio,d=n.texcoord_normalize,_=n.extrude_index,p=n.offset_index,g=n.join,v=n.cap,m=n.miter_limit,y=n.offset,x=n.crop_by_tile,b=v?Gu[v]:Gu.butt,w=g?Bu[g]:Bu.miter;w===Bu.miter&&(o=(m=m||Vu.MITER_LIMIT)*m),c&&(d=d||Vu.TEXCOORD_NORMALIZE,a=1/(h*(f=f||Vu.TEXCOORD_RATIO)*qu));for(var A={closed_polygon:s,remove_tile_edges:l,tile_edge_tolerance:u,miter_len_sq:o,join_type:w,cap_type:b,vertex_data:i,vertex_template:r,half_width:t/2,extrude_index:_,offset_index:p,v_scale:a,texcoord_index:c,texcoord_width:h,texcoord_normalize:d,offset:y,geom_count:0,crop_by_tile:x},T=0;T<e.length;T++)Wu(e[T],A);if(A.extra_lines)for(var k=0;k<A.extra_lines.length;k++)Wu(A.extra_lines[k],A);return A.geom_count}(e,t.width,a,l,{cap:t.cap,join:t.join,miter_limit:t.miter_limit,extrude_index:s.index.a_extrude,offset_index:s.index.a_offset,texcoord_index:s.index.a_texcoord,texcoord_width:t.texcoord_width,texcoord_normalize:65535,closed_polygon:n&&n.closed_polygon,remove_tile_edges:!t.tile_edges&&n&&n.remove_tile_edges,tile_edge_tolerance:Jr.tile_scale*r.tile.pad_scale*2,offset:t.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(e,t,i,r){for(var n=0,o=0;o<e.length;o++)n+=this.buildLines(e[o],t,i,r,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return n}});var uc=[[1,1],[1,-1],[-1,1],[-1,-1]];function cc(e,t,i,r,n,o,a){var s,l=t.vertex_template,u=t.vertex_data;hc(t,"a_position",e),hc(t,"a_width",t.half_width),t.vertex_layout_index.a_barycentric&&((s=[0,0,0])[i%3]=1,hc(t,"a_barycentric",s)),hc(t,"a_tangents",a[0].concat(a[1])),hc(t,"a_segment",r),hc(t,"a_texcoord",uc[i%4]),hc(t,"a_length",n),hc(t,"a_closed",t.closed?1:0),hc(t,"a_angles",o),u.addVertex(l)}function hc(e,t,i){var r=i.length,n=e.vertex_template,o=e.vertex_layout_index[t],a=0;if(r)for(;a!==r;)n[o+a]=i[a],a++;else n[o+a]=i}function fc(e,a){for(var s=e.reduce(function(e,t){return e+t}),t=0,l=[],i=0,r=e.length;i<=r;i+=2){var n=Math.max(1e-4,e[i%r]),o=Math.max(1e-4,e[(i+1)%r]);l.push(t,t+n),t+=n+o}for(var u=new Uint8Array(4*a),c=0,h=0;h<a;h++)!function(e){var t=s*e/(a-1),i=function(e){for(var t=e[0],i=0,r=1,n=e.length;r<n;r++)e[r]<t&&(t=e[i=r]);return i}(l.map(function(e){return Math.abs(e-t)})),r=void 0,n=void 0,o=void 0,o=i%2==0?(r=t<=l[i]?1:0,n=l[i],l[i+1]):(r=t>l[i]?2:0,n=l[i-1],l[i]);u[c++]=l[i],u[c++]=r,u[c++]=n,u[c++]=o}(h);return u}var dc=Object.create(nu),_c={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},pc={miter:0,round:1,bevel:2},gc=_c.round,vc=pc.miter,mc=[0,0],yc="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");Object.assign(dc,{name:"pattern-lines",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nattribute vec3 a_barycentric;\n#endif\nattribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#ifndef TANGRAM_HEIGHT_SCALE\nfloat TANGRAM_HEIGHT_SCALE=16.0;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\nconst float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){\n#pragma tangram: setup\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nfloat linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nv_barycentric=a_barycentric;\n#endif\nv_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#endif\ngl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL v_normal\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\n#pragma tangram: utils\nconst float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka \xb11*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,\xb11*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\nif(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}\n#ifdef TANGRAM_DEBUG_TRIANGLES\nif(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}\n#endif\ngl_FragColor=color;}",selection:!0,init:function(){nu.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},dc.vertex_layouts=[],dc.variants={}},calcDistance:function(e,t){return e&&mo.evalCachedDistanceProperty(e,t)||0},calcDash:function(e,t){var i=mo.evalProperty(e.dash,t),r=0;return i&&((i=Array.isArray(i)&&i.length?i:mc).length%2==1&&(i=i.concat(i)),r=+(r=i.reduce(function(e,t){return e+t}))||0),{dash:i,dash_period:r}},calcWidth:function(e,t,i){var r=this.calcDistance(e.width,i);return!(r<0)&&(t.width=r*i.units_per_meter_overzoom,!0)},getCapType:function(e,t,i){var r=mo.evalProperty(e,t);return void 0!==_c[r]?_c[r]:i},_parseFeature:function(e,t,i){if(!1!==this.calcWidth(t,this.feature_style,i)){var r=this.parseColor(t.color,i);if(r&&0!==r[3]){var n=this.getCapType(t.cap,i,gc),o=mo.evalProperty(t.join,i),a=+mo.evalProperty(t.miter_limit,i),s=this.calcDash(t,i),l=s.dash,u=s.dash_period,c=Object.assign({color:r,antialias:t.antialias,linecaps:[this.getCapType(t.tail_cap,i,n),this.getCapType(t.head_cap,i,n)],join:void 0!==pc[o]?pc[o]:vc,miter_limit:0<=a?a:3,dash_index:0===u?0:1,dash:l,dash_caps:[this.getCapType(t.tail_cap,i,n),this.getCapType(t.head_cap,i,n)],dash_phase:+mo.evalProperty(t.dash_phase,i)||0,dash_period:u},this.feature_style);return c.z=t.z&&mo.evalCachedDistanceProperty(t.z||0,i)||mo.defaults.z,c.z*=Jr.height_scale,c.extrude=mo.evalProperty(t.extrude,i),c.extrude&&(!0===c.extrude?(c.height=void 0!==e.properties.height?e.properties.height:mo.defaults.height,c.min_height=void 0!==e.properties.min_height?e.properties.min_height:mo.defaults.min_height):"number"==typeof c.extrude?(c.height=c.extrude,c.min_height=0):Array.isArray(c.extrude)&&(c.min_height=c.extrude[0],c.height=c.extrude[1]),c.height*=Jr.height_scale,c.min_height*=Jr.height_scale),this.computeVariant(c),c}}},_preprocess:function(e){e.color=mo.createColorPropertyCache(e.color),e.width=mo.createPropertyCache(e.width,mo.parseUnits),e.width&&e.width.type!==mo.CACHE_TYPE.STATIC&&(e.next_width=mo.createPropertyCache(e.width,mo.parseUnits)),e.z=mo.createPropertyCache(e.z,mo.parseUnits);var t=+e.antialias;return e.antialias=isNaN(t)?0:t,e},buildRasterTextures:function(e,t){var i=[];for(var r in t.meshes){var n,o=dc.variants[r],a=o.uniforms,s=o.pattern;a.u_dash_index&&(n="__dash_"+s.join("_")+"_"+e.key+"_"+e.id,i.push({name:n,data:fc(s,1024)}),a.u_dash_atlas=n,t.meshes[r].textures=[n]),t.meshes[r].uniforms=a}return t.uniforms=t.uniforms||{},i.length?un.postMessage(this.main_thread_target+".loadTextures",i).then(function(e){return t}):Promise.resolve(t)},loadTextures:function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i],n=(n=this.textureManager.textures[r.name])||this.textureManager.create(this.gl,r.name,{filtering:"nearest",repeat:!0,width:1024,height:1,data:r.data});t.push(n.loading)}return Promise.all(t).then(function(e){return e.map(function(e){return e.retain(),e.name})})},computeVariant:function(e){var t=function(e){for(var t=[],i=0,r=yc.length;i<r;i++){var n=e[yc[i]];Array.isArray(n)?t.push(n.join("_")):"boolean"==typeof n?t.push(n?1:0):n&&t.push(n.toString())}return t.join("/")}(e);e.variant=t,null==dc.variants[t]&&(dc.variants[t]={key:t,order:e.variant_order,uniforms:{u_antialias:e.antialias,u_linecaps:e.linecaps,u_linejoin:e.join,u_miter_limit:e.miter_limit,u_dash_index:e.dash_index,u_dash_caps:e.dash_caps,u_dash_phase:e.dash_phase,u_dash_period:e.dash_period},pattern:e.dash})},vertexLayoutForMeshVariant:function(e){var t;return null==dc.vertex_layouts[e.key]&&(t=[{name:"a_position",size:4,type:ou.SHORT,normalized:!1},{name:"a_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:ou.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:ou.FLOAT,normalized:!1},{name:"a_segment",size:2,type:ou.FLOAT,normalized:!1},{name:"a_angles",size:2,type:ou.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:ou.FLOAT,normalized:!0},{name:"a_length",size:1,type:ou.FLOAT,normalized:!1},{name:"a_closed",size:1,type:ou.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0}],this.defines.TANGRAM_DEBUG_TRIANGLES&&t.push({name:"a_barycentric",size:3,type:ou.SHORT,normalized:!1}),dc.vertex_layouts[e.key]=new du(t)),dc.vertex_layouts[e.key]},meshVariantTypeForDraw:function(e){return dc.variants[e.variant]},makeVertexTemplate:function(e){var t=0;return this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=e.z+e.height||0,this.vertex_template[t++]=this.scaleOrder(e.order),this.vertex_template[t++]=255*e.color[0],this.vertex_template[t++]=255*e.color[1],this.vertex_template[t++]=255*e.color[2],this.vertex_template[t++]=255*e.color[3],this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.selection&&(this.vertex_template[t++]=255*e.selection_color[0],this.vertex_template[t++]=255*e.selection_color[1],this.vertex_template[t++]=255*e.selection_color[2],this.vertex_template[t++]=255*e.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[t++]=0,this.vertex_template[t++]=0,this.vertex_template[t++]=0),this.vertex_template},buildLines:function(e,t,i,r,n){var o=4<arguments.length&&void 0!==n&&n,a=i.vertex_data,s=a.vertex_layout,l=this.makeVertexTemplate(t,i);return sc(e,t.width,a,l,s.index,o)},buildPolygons:function(e,t,i,r){for(var n=0,o=0,a=e.length;o<a;o++)n+=this.buildLines(e[o],t,i,r,!0);return n}});var xc=0,bc={id_prefix:"",nextLabelId:function(){return"".concat(bc.id_prefix,"/").concat(xc++)}};function wc(e){return{priority:e.priority,collide:e.collide,repeat_distance:e.repeat_distance,repeat_group:e.repeat_group,buffer:e.buffer,italic:e.italic}}var Ac=["left","top-left","bottom-left"],Tc=["right","top-right","bottom-right"],kc=["top","top-left","top-right"],Ec=["bottom","bottom-left","bottom-right"],Mc={computeOffset:function(e,t,i,r){var n=3<arguments.length&&void 0!==r?r:null;if(!i||"center"===i)return e;var o=[e[0],e[1]],n=n||this.default_buffer;return this.isLeftAnchor(i)?(o[0]-=t[0]/2,"left"===i&&(o[0]-=n[0])):this.isRightAnchor(i)&&(o[0]+=t[0]/2,"right"===i&&(o[0]+=n[1])),this.isTopAnchor(i)?(o[1]-=t[1]/2,"top"===i&&(o[1]-=n[2])):this.isBottomAnchor(i)&&(o[1]+=t[1]/2,"bottom"===i&&(o[1]+=n[3])),o},alignForAnchor:function(e){if(e&&"center"!==e){if(this.isLeftAnchor(e))return"right";if(this.isRightAnchor(e))return"left"}return"center"},isLeftAnchor:function(e){return-1<Ac.indexOf(e)},isRightAnchor:function(e){return-1<Tc.indexOf(e)},isTopAnchor:function(e){return-1<kc.indexOf(e)},isBottomAnchor:function(e){return-1<Ec.indexOf(e)},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function Rc(e,t,i,r,n){var o=[],a=i-e,s=r-t,l=Kr.getLineLength(e,t,i,r),u=2*n;if((c=l/u)<=1)o.push(e+a/2,t+s/2,n);else{var c,h=u/l,f=a*h,d=s*h;(c=l/n/2)%1&&o.push(i-f/2,r-d/2,n),c|=0;for(var _=e+f/2,p=t+d/2;c--;)o.push(_,p,n),_+=f,p+=d}return o}var Sc=function(){function n(e,t,i,r){pr(this,n),this.id=bc.nextLabelId(),this.position=[e[0],e[1]],void 0!==e[2]&&this.position.push(e[2]),this.size=t,this.layout=r,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||Mc.alignForAnchor(this.anchor),this._is_flat=i}return vr(n,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:wc(this.layout)}}},{key:"inTileBounds",value:function(){var e=this.getAABB(),t=e.left,i=e.top,r=e.right,n=e.bottom;return kn.pointInTile([t,i])&&kn.pointInTile([r,n])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(e){this._circles=void 0,this._aabb=void 0,this.anchor=e,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var e,t=[this.layout.offset[0],this.layout.offset[1]];return this.parent&&(e=this.parent,t=Mc.computeOffset(t,e.size,e.anchor,Mc.zero_buffer),t=Mc.computeOffset(t,e.size,this.anchor,Mc.zero_buffer),e.offset!==mo.zeroPair&&(t===mo.zeroPair?t=e.offset:(t[0]+=e.offset[0],t[1]+=e.offset[1]))),Mc.computeOffset(t,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){return this.angle?(this._circles||(e=this.layout.units_per_pixel,n=-(i=(t=this.size[0]/2*e)*Math.cos(this.angle)),o=-(r=t*Math.sin(this.angle)),s=(a=Pr(this.position,2))[0],l=a[1],i+=s,r+=l*=-1,n+=s,o+=l,u=this.size[1]/2*e,this._circles=Rc(i,r,n,o,u)),this._circles):[];var e,t,i,r,n,o,a,s,l,u}},{key:"getAABB",value:function(){var e,t,i,r,n;return this._aabb||(e=this.layout.units_per_pixel,t=(this.size[0]/2+this.layout.buffer[0])*e,i=(this.size[1]/2+this.layout.buffer[1])*e,r=this.position[0]+this.offset[0]*e,n=this.position[1]-this.offset[1]*e,this._aabb={left:r-t,top:n+i,right:r+t,bottom:n-i}),this._aabb}},{key:"getSides",value:function(){var e=this.getAABB(),t=e.left,i=e.top,r=e.right,n=(i+e.bottom)/2;return[t,n,r,n]}}]),n}();Sc.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var Pc=Sc.PLACEMENT,zc=80;function Nc(e,t,i,r){var n=[],o=r.placement,a=Math.max(t[0],t[1])*r.placement_min_length_ratio*r.units_per_pixel;switch(o){case Pc.SPACED:var s=function(e,t,i){var r=i.units_per_pixel,n=(i.placement_spacing||zc)*r,o=function(e){for(var t=0,i=0;i<e.length-1;i++)t+=Ic(e[i],e[i+1]);return t}(e);if(o<=t)return!1;for(var a=Math.max(Math.floor(o/n),1),s=[],l=[],u=.5*(o-(a-1)*n),c=0;c<a;c++){var h=function(e,t,i,r){for(var n,o,a=0,s=0;s<e.length-1;s++){var l=e[s],u=e[s+1],c=Ic(l,u);if(!(c<=i)&&t<(a+=c)){n=function(e,t,i){var r=Ic(e,t),n=i/r;return[n*e[0]+(1-n)*t[0],n*e[1]+(1-n)*t[1]]}(l,u,a-t),o=Oc(l,u,r.angle);break}}return{position:n,angle:o}}(e,u,t,i),f=h.position,d=h.angle;null!=f&&null!=d&&(s.push(f),l.push(d)),u+=n}return{positions:s,angles:l}}(e,a,r);if(!s)return[];for(var l=s.positions,u=s.angles,c=0;c<l.length;c++){var h,f=l[c],d=u[c];!0!==r.tile_edges&&vu(f)||((h=new Sc(f,t,i,r)).angle=d,n.push(h))}break;case Pc.VERTEX:for(var _,p,g,v=0;v<e.length-1;v++)_=e[v],p=e[v+1],!0!==r.tile_edges&&vu(_)||((g=new Sc(_,t,i,r)).angle=Oc(_,p,r.angle),n.push(g));(g=new Sc(p,t,i,r)).angle=Oc(_,p,r.angle),n.push(g);break;case Pc.MIDPOINT:for(var m=0;m<e.length-1;m++){var y,x=e[m],b=e[m+1],w=[.5*(x[0]+b[0]),.5*(x[1]+b[1])];!0!==r.tile_edges&&vu(w)||(!a||Ic(x,b)>a)&&((y=new Sc(w,t,i,r)).angle=Oc(x,b,r.angle),n.push(y))}}return n}function Oc(e,t,i){var r=2<arguments.length&&void 0!==i?i:0;return"auto"===r?Math.atan2(t[0]-e[0],t[1]-e[1]):r}function Ic(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}var Lc={key:function(e){return[e.style,e.weight,e.family,e.px_size,e.fill,e.stroke,e.stroke_width,e.transform,e.text_wrap,e.max_lines,e.supersample,e.background_color,e.outline_color,e.outline_width,e.padding,kn.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(e,t,i){var r={};t.font=t.font||this.defaults,r.can_articulate=t.can_articulate,r.fill=t.font.fill&&kn.toCSSColor(mo.evalCachedColorProperty(t.font.fill,i))||this.defaults.fill,r.style=t.font.style||this.defaults.style,r.weight=t.font.weight||this.defaults.weight,t.font.family?(r.family=t.font.family,r.family!==this.defaults.family&&(r.family+=", "+this.defaults.family)):r.family=this.defaults.family,r.transform=t.font.transform,r.size=t.font.size||this.defaults.size,r.supersample=t.supersample_text?1.5:1,r.px_size=mo.evalCachedProperty(t.font.px_size,i)*r.supersample,t.font.stroke&&t.font.stroke.color&&(r.stroke=kn.toCSSColor(mo.evalCachedColorProperty(t.font.stroke.color,i)||this.defaults.stroke),r.stroke_width=mo.evalCachedProperty(t.font.stroke.width,i)||this.defaults.stroke_width),r.font_css=this.fontCSS(r);var n=t.text_wrap;return null==n&&"line"!==Jr.geometryType(e.geometry.type)&&(n=!0),!0===n&&(n=this.defaults.text_wrap),r.text_wrap=n,r.max_lines=t.max_lines||this.defaults.max_lines,r.background_color=t.background&&t.background.color&&!t.can_articulate?kn.toCSSColor(mo.evalCachedColorProperty(t.background.color,i)):this.defaults.background_color,r.outline_color=t.outline&&t.outline.color&&!t.can_articulate?kn.toCSSColor(mo.evalCachedColorProperty(t.outline.color,i)):this.defaults.outline_color,r.outline_width=t.outline&&t.outline.width&&!t.can_articulate?mo.evalCachedProperty(t.outline.width,i):this.defaults.outline_width,r.padding=t.padding&&!t.can_articulate?mo.evalCachedProperty(t.padding,i):this.defaults.padding,r},fontCSS:function(e){return[e.style,e.weight,e.px_size+"px",e.family].filter(function(e){return e}).join(" ")}},Cc=i(function(e){function n(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function y(e){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(e)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function x(e,t){e.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+t+";"}function o(e){var t=e.a.offsetWidth,i=t+100;return e.f.style.width=i+"px",e.c.scrollLeft=i,e.b.scrollLeft=e.b.scrollWidth+100,e.g!==t&&(e.g=t,1)}function b(e,t){function i(){var e=r;o(e)&&e.a.parentNode&&t(e.g)}var r=e;n(e.b,i),n(e.c,i),o(e)}function t(e,t){var i=t||{};this.family=e,this.style=i.style||"normal",this.weight=i.weight||"normal",this.stretch=i.stretch||"normal"}function w(e,t){return[e.style,e.weight,function(){if(null===i){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(e){}i=""!==e.style.font}return i}()?e.stretch:"","100px",t].join(" ")}var A,r,i,a;a=i=r=A=null,t.prototype.load=function(e,t){var _=this,p=e||"BESbswy",g=0,v=t||3e3,m=(new Date).getTime();return new Promise(function(f,d){var e,t,i;null===a&&(a=!!document.fonts),(e=a)&&(null===r&&(r=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),e=!r),e?(e=new Promise(function(i,e){!function t(){(new Date).getTime()-m>=v?e():document.fonts.load(w(_,'"'+_.family+'"'),p).then(function(e){1<=e.length?i():setTimeout(t,25)},function(){e()})}()}),t=new Promise(function(e,t){g=setTimeout(t,v)}),Promise.race([t,e]).then(function(){clearTimeout(g),f(_)},function(){d(_)})):(i=function(){function t(){var e;(e=-1!=o&&-1!=a||-1!=o&&-1!=s||-1!=a&&-1!=s)&&((e=o!=a&&o!=s&&a!=s)||(null===A&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),A=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)),e=A&&(o==l&&a==l&&s==l||o==u&&a==u&&s==u||o==c&&a==c&&s==c)),e=!e),e&&(h.parentNode&&h.parentNode.removeChild(h),clearTimeout(g),f(_))}var i=new y(p),r=new y(p),n=new y(p),o=-1,a=-1,s=-1,l=-1,u=-1,c=-1,h=document.createElement("div");h.dir="ltr",x(i,w(_,"sans-serif")),x(r,w(_,"serif")),x(n,w(_,"monospace")),h.appendChild(i.a),h.appendChild(r.a),h.appendChild(n.a),document.body.appendChild(h),l=i.a.offsetWidth,u=r.a.offsetWidth,c=n.a.offsetWidth,function H(){var e;(new Date).getTime()-m>=v?(h.parentNode&&h.parentNode.removeChild(h),d(_)):(!0!==(e=document.hidden)&&void 0!==e||(o=i.a.offsetWidth,a=r.a.offsetWidth,s=n.a.offsetWidth,t()),g=setTimeout(H,50))}(),b(i,function(e){o=e,t()}),x(i,w(_,'"'+_.family+'",sans-serif')),b(r,function(e){a=e,t()}),x(r,w(_,'"'+_.family+'",serif')),b(n,function(e){s=e,t()}),x(n,w(_,'"'+_.family+'",monospace'))},document.body?i():document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),i()}):document.attachEvent("onreadystatechange",function e(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",e),i())}))})},e.exports=t}),Fc={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(r){var n=this,e=JSON.stringify(r)===this.last_loaded;return r&&!e&&function(){var i=[];for(var e in r)!function(t){Array.isArray(r[t])?r[t].forEach(function(e){return i.push(n.loadFontFace(t,e))}):i.push(n.loadFontFace(t,r[t]))}(e);n.last_loaded=JSON.stringify(r),n.fonts_loaded=Promise.all(i.filter(function(e){return e}))}(),this.fonts_loaded},loadFontFace:function(e,t){if(null!=t&&("object"===_r(t)||"external"===t)){var i={family:e},r=Promise.resolve();"object"===_r(t)&&(Object.assign(i,t),"string"==typeof t.url&&(r=this.injectFontFace(i)));var n=new Cc(e,i);return r.then(function(){return n.load()}).then(function(){An("debug","Font face '".concat(e,"' is available"),i)},function(){An("debug","Font face '".concat(e,"' is NOT available"),i)})}},injectFontFace:function(e){var n=this,o=e.family,t=e.url,a=e.weight,s=e.style;void 0===this.supports_native_font_loading&&(this.supports_native_font_loading=void 0!==window.FontFace);var i=Promise.resolve(t);return"blob:"===t.slice(0,5)&&(i=kn.io(t,6e4,"arraybuffer").then(function(e){var t=new Uint8Array(e);if(n.supports_native_font_loading)return t;for(var i="",r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return"data:font/opentype;base64,"+btoa(i)})),i.then(function(e){var t,i,r;n.supports_native_font_loading?("string"==typeof e?t=new FontFace(o,"url(".concat(encodeURI(e),")"),{weight:a,style:s}):e instanceof Uint8Array&&(t=new FontFace(o,e,{weight:a,style:s})),document.fonts.add(t),An("trace","Adding FontFace to document.fonts:",t)):(i="\n                    @font-face {\n                        font-family: '".concat(o,"';\n                        font-weight: ").concat(a||"normal",";\n                        font-style: ").concat(s||"normal",";\n                        src: url(").concat(encodeURI(e),");\n                    }\n                "),(r=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(r),r.sheet.insertRule(i,0),An("trace","Injecting CSS font face:",i))})}},Dc=function(){function E(){pr(this,E),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=ll("binary-tree")}return vr(E,[{key:"createCanvas",value:function(e,t){var i=document.createElement("canvas");return e&&t&&(i.width=e,i.height=t),i.style.backgroundColor="transparent",i}},{key:"setFont",value:function(e,t){var i=t.font_css,r=t.fill,n=t.stroke,o=t.stroke_width,a=t.px_size,s=t.supersample;this.px_size=a;var l=kn.device_pixel_ratio*s;n&&0<o&&(e.strokeStyle=n,e.lineWidth=o*l),e.fillStyle=r,e.textBaseline="bottom",e.font=i,e.miterLimit=2}},{key:"textSizes",value:function(e,t,i){var r=this;return Fc.loadFonts().then(function(){return So.add({type:"textSizes",run:r.processTextSizesTask.bind(r),texts:t,tile_id:e,cursor:{ctx:i,styles:Object.keys(t),texts:null,style_idx:null,text_idx:null}})})}},{key:"processTextSizesTask",value:function(e){var t,i=e.cursor,r=e.texts,n=i.ctx;for(i.style_idx=i.style_idx||0;i.style_idx<i.styles.length;){var o=i.styles[i.style_idx];null==i.text_idx&&(i.text_idx=0,i.texts=Object.keys(r[o]));for(var a=r[o],s=!0;i.text_idx<i.texts.length;){var l=i.texts[i.text_idx],u=a[l],c=u.text_settings;if(s&&(this.setFont(n,c),s=!1),u.size=this.textSize(n,o,l,c).size,c.can_articulate){var h=!1,f=!1;if(Uc(l)&&(Vc(l)?h=!0:f=!0),u.isRTL=h,u.no_curving=f||(t=l,$c.test(t)),u.vertical_buffer=this.vertical_text_buffer+c.outline_width+(c.padding[0]+c.padding[2])/2,u.segment_sizes=[],!u.no_curving){var d=function(e,t){var i=t?1:Jc;if(e.length<i)return[e];var r=e;if(Dc.cache.segment[r])return Dc.cache.stats.segment_hits++,Dc.cache.segment[r];var n=[];if(qc.exec(e)){n=e.split(Hc);for(var o,a=-1,s=0;s<n.length-1;s++){0<s&&((o=Yc.exec(n[s]))&&(n[s]=n[s].substring(o[0].length),n[s-1]+=o[0],a+=o[0].length)),a+=1+n[s].length,n[s]+=e.slice(a,a+1)}e=""}for(;e.length;){for(var l="",u=e,c=0;c<i&&u.length;c++){var h=(Wc.exec(u)||u)[0];l+=h,u=u.substring(h.length)}n.push(l),e=e.substring(l.length)}t&&n.reverse();return Dc.cache.stats.segment_misses++,Dc.cache.segment[r]=n}(l,h);u.segments=d;for(var _=0;_<d.length;_++)u.segment_sizes.push(this.textSize(n,o,d[_],c).size)}}if(i.text_idx++,!So.shouldContinue(e))return!1}i.text_idx=null,i.style_idx++}return So.finish(e,{texts:r}),!0}},{key:"textSize",value:function(e,t,i,r){var n=r.transform,o=r.text_wrap,a=r.max_lines,s=r.stroke_width,l=void 0===s?0:s,u=r.supersample,c=r.padding,h=r.outline_width,f=r.can_articulate;if(E.cache.text[t]=E.cache.text[t]||{},E.cache.text[t][i])return E.cache.stats.text_hits++,E.cache.text[t][i];E.cache.stats.text_misses++,E.cache.text_count++;var d=kn.device_pixel_ratio*u,_=this.applyTextTransform(i,n),p=d*(this.vertical_text_buffer+h+(c[0]+c[2])/2),g=d*(this.horizontal_text_buffer+h+l+(c[1]+c[3])/2),v=2*d,m=this.px_size+v,y=Qc.parse(_,o,a,m,e),x=y.height,b=y.width,w=y.lines,A=[b/d,x/d];f||(A[0]+=2*g/d,A[1]+=2*p/d);var T=[b+2*g,x+2*p],k=[T[0]/d,T[1]/d];return E.cache.text[t][i]={lines:w,size:{collision_size:A,texture_size:T,logical_size:k,line_height:m}},E.cache.text[t][i]}},{key:"drawTextMultiLine",value:function(e,t,i,r,n,o){var a=Pr(i,2),s=a[0],l=a[1],u=kn.device_pixel_ratio*n.supersample,c=n.stroke_width||0,h=n.stroke;n.background_color&&(e.fillStyle=n.background_color,e.fillRect(s,l,r.texture_size[0],r.texture_size[1]));var f=n.outline_width*u,d=n.outline_color;f&&d&&(e.strokeStyle=d,e.lineWidth=f,e.strokeRect(s+f/2,l+f/2,r.texture_size[0]-f,r.texture_size[1]-f)),(n.background_color||f&&d)&&this.setFont(e,n);for(var _,p,g,v,m=r.line_height,y=l,x=0;x<t.length;x++){var b=t[x];this.drawTextLine(e,b,[s,y],r,n,o),y+=m}Rl.draw_label_collision_boxes&&(e.save(),_=u*(this.horizontal_text_buffer+n.outline_width+c+(n.padding[1]+n.padding[3])/2),p=u*(this.vertical_text_buffer+n.outline_width+(n.padding[0]+n.padding[2])/2),g=r.collision_size,e.strokeStyle="blue",e.lineWidth=2,e.strokeRect(s+_,l+p,u*g[0],u*g[1]),"curved"===o&&h&&0<c&&e.strokeRect(s+r.texture_size[0]+_,l+p,u*g[0],u*g[1]),e.restore()),Rl.draw_label_texture_boxes&&(e.save(),v=r.texture_size,e.strokeStyle="green",e.lineWidth=2,e.strokeRect(s+2,l+2,v[0]-4,v[1]-4),"curved"===o&&h&&0<c&&e.strokeRect(s+2+r.texture_size[0],l+2,v[0]-4,v[1]-4),e.restore())}},{key:"drawTextLine",value:function(e,t,i,r,n,o){var a,s=Pr(i,2),l=s[0],u=s[1],c=n.stroke,h=n.stroke_width,f=void 0===h?0:h,d=n.transform,_=n.align,p=n.supersample,g=n.padding,v=n.outline_width,m=kn.device_pixel_ratio*p,_=_||"center",y=r.texture_size,x=r.line_height,b=m*(this.vertical_text_buffer+v),w=m*(this.horizontal_text_buffer+v+f),A=this.applyTextTransform(t.text,d);"left"===_?a=l+w+g[3]*m:"center"===_?a=l+y[0]/2-t.width/2-(g[1]-g[3])*m/2:"right"===_&&(a=l+y[0]-t.width-w-g[1]*m);var T,k=u+b+x+g[0]*m;c&&0<f&&(T="curved"===o?y[0]:0,e.strokeText(A,a+T,k)),e.fillText(A,a,k)}},{key:"rasterize",value:function(e,t,i,r,n,o){return So.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:E.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:e,textures:t,texture_prefix:r,gl:n,tile_id:i,texture_manager:o,cursor:{styles:Object.keys(e),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(e){if(!So.shouldContinue(e))return!1;for(var t=e.cursor,i=e.texts,r=e.textures;t.texture_idx<e.textures.length;){for(var n=!1,o=r[t.texture_idx],a=this.createCanvas.apply(this,zr(o.texture_size)),s=a.getContext("2d");t.style_idx<t.styles.length;){var l=t.styles[t.style_idx];null==t.text_idx&&(t.text_idx=0,t.texts=Object.keys(i[l]));for(var u=i[l],c=!0;t.text_idx<t.texts.length;){var h=t.texts[t.text_idx],f=u[h],d=f.text_settings;if(c&&(this.setFont(s,d),c=!1),d.can_articulate){f.texcoords=f.texcoords||{};for(var _=0;_<f.type.length;_++){var p=f.type[_];switch(p){case"straight":if(f.textures[_]!==t.texture_idx)continue;var g,v,m,y,x=f.isRTL?h.split().reverse().join():h,b=o.texcoord_cache[l][x],w=void 0;b.texcoord?w=b.texcoord:(g=b.texture_position,m=(v=this.textSize(s,l,x,d)).size,y=v.lines,this.drawTextMultiLine(s,y,g,m,d,p),w=e.texture_manager.getTexcoordsForSprite(g,m.texture_size,o.texture_size),b.texcoord=w),f.texcoords[p]={texcoord:w,texture_id:b.texture_id};break;case"curved":var A=f.segments;f.texcoords.curved=[],f.texcoords_stroke=[];for(var T,k,E,M,R,S,P,z,N=0;N<A.length;N++){f.textures[_][N]===t.texture_idx&&(T=A[N],M=E=void 0,(k=o.texcoord_cache[l][T]).texcoord&&k.texcoord_stroke?(E=k.texcoord,M=k.texcoord_stroke):(R=k.texture_position,P=(S=this.textSize(s,l,T,d)).size,z=S.lines,this.drawTextMultiLine(s,z,R,P,d,p),E=e.texture_manager.getTexcoordsForSprite(R,P.texture_size,o.texture_size),M=d.stroke&&0<d.stroke_width?e.texture_manager.getTexcoordsForSprite([R[0]+P.texture_size[0],R[1]],P.texture_size,o.texture_size):(n=!0,e.texture_manager.getTexcoordsForSprite([o.texture_size[0],o.texture_size[1]],[0,0],o.texture_size)),k.texcoord=E,k.texcoord_stroke=M),f.texcoords_stroke.push(M),f.texcoords.curved.push({texcoord:E,texture_id:k.texture_id}))}}}}else{var O=this.textSize(s,l,h,d).lines;for(var I in f.align)f.align[I].texture_id===t.texture_idx&&(this.drawTextMultiLine(s,O,f.align[I].texture_position,f.size,{stroke:d.stroke,stroke_width:d.stroke_width,transform:d.transform,supersample:d.supersample,align:I,background_color:d.background_color,outline_width:d.outline_width,outline_color:d.outline_color,padding:d.padding,fill:d.fill,font_css:d.font_css,px_size:d.px_size}),f.align[I].texcoords=e.texture_manager.getTexcoordsForSprite(f.align[I].texture_position,f.size.texture_size,o.texture_size))}t.text_idx++}t.text_idx=null,t.style_idx++}!0===n&&(s.fillStyle="rgba(0, 0, 0, 0)",s.fillRect(a.width-1,a.height-1,1,1));var L=e.texture_prefix+t.texture_idx;e.texture_manager.create(e.gl,L,{element:a,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),t.texture_names.push(L),t.texture_idx++,t.style_idx=0,a.width=0,a.height=0}return So.finish(e,t.texture_names),!0}},{key:"setTextureTextPositions",value:function(e){var t={texture_id:0,texcoord_cache:{}},i=[];for(var r in e){var n=e[r];for(var o in n){var a=n[o],s=a.text_settings,l=s.can_articulate,u=s.stroke,c=s.stroke_width;if(l){a.textures=[],t.texcoord_cache[r]=t.texcoord_cache[r]||{};for(var h=0;h<a.type.length;h++){switch(a.type[h]){case"straight":var f,d=a.isRTL?o.split().reverse().join():o;t.texcoord_cache[r][d]||(f=a.size.texture_size,t.texcoord_cache[r][d]={},this.placeText(f[0],f[1],{can_articulate:l,style:r,word:d})),a.textures[h]=t.texture_id;break;case"curved":a.textures[h]=[];for(var _=0;_<a.segment_sizes.length;_++){var p,g,v=a.segments[_];t.texcoord_cache[r][v]||(g=(p=a.segment_sizes[_].texture_size)[0],u&&0<c&&(g*=2),t.texcoord_cache[r][v]={},this.placeText(g,p[1],{can_articulate:l,style:r,word:v})),a.textures[h].push(t.texture_id)}}}}else{var m=a.size.texture_size;this.placeText(m[0],m[1],{can_articulate:l,text_info:a})}}}var y=this.layout.export(),x=y.items,b=y.width,w=y.height;t.texcoord_cache={};for(var A=0,T=x.length;A<T;A++){var k=x[A],E=k.x,M=k.y;if(!k.meta.can_articulate){var R=k.meta.text_info;for(var S in R.align)R.align[S].texture_id=t.texture_id,R.align[S].texture_position=[E,M]}else{var P=k.meta,z=P.style,N=P.word;t.texcoord_cache[z]=t.texcoord_cache[z]||{},t.texcoord_cache[z][N]||(t.texcoord_cache[z][N]={texture_id:t.texture_id,texture_position:[E,M]})}}return 0<b&&0<w&&(i[t.texture_id]={texture_size:[b,w],texcoord_cache:t.texcoord_cache}),i}},{key:"placeText",value:function(e,t,i){this.layout.addItem({width:e+1,height:t+1,meta:i})}},{key:"applyTextTransform",value:function(e,t){return"capitalize"===t?e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}):"uppercase"===t?e.toUpperCase():"lowercase"===t?e.toLowerCase():e}}],[{key:"fontPixelSize",value:function(e){if(null!=e){var t=Pr((e="string"==typeof e?e:String(e)).match(E.font_size_re)||[],3),i=t[1],r=t[2];return"em"===(r=r||"px")?i*=16:"pt"===r?i/=.75:"%"===r&&(i/=6.25),i=mo.parsePositiveNumber(i),i*=kn.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){E.cache.text_count>E.cache.text_count_max&&(E.cache.text={},E.cache.text_count=0,An("debug","CanvasText: pruning text cache")),Object.keys(E.cache.segment).length>E.cache.segment_count_max&&(E.cache.segment={},An("debug","CanvasText: pruning segment cache"))}}]),E}();Dc.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,Dc.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},Dc.EMPTY_TEXTURES_ARR=[],Dc.returnNoTextures=function(){return Dc.EMPTY_TEXTURES_ARR};var jc=new RegExp("[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]");function Uc(e){return jc.test(e)}var Gc="\0-/:-@[-`{-\xbf\xd7\xf7\u02b9-\u02ff\u2000-\u2bff\u2010-\u2029\u202c\u202f-\u2bff",Bc=new RegExp("["+Gc+"]+");function Vc(e){return Bc.test(e)}var qc=new RegExp("^["+Gc+"\u0600-\u06ff]+"),Hc=new RegExp("["+Gc+"\u0622-\u0625\u0627\u062f-\u0632\u0648\u0671-\u0677\u0688-\u0699\u06c4-\u06cb\u06cf\u06d2\u06d3\u06ee\u06ef]"),Yc=new RegExp("^[\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed]+"),Xc="[\u0300-\u036f\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u07a6-\u07b0\u0900-\u0903\u093a-\u094c\u094e\u094f\u0951-\u0957\u0962\u0963\u0981-\u0983\u09bc\u09be-\u09cc\u09d7\u09e2\u09e3\u0a01-\u0a03\u0a3c-\u0a4c\u0a51\u0a81-\u0a83\u0abc\u0abe-\u0acc\u0ae2\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b4c\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe-\u0bcd\u0bd7\u0c00-\u0c03\u0c3e-\u0c4c\u0c55\u0c56\u0c62\u0c63\u0c81-\u0c83\u0cbc\u0cbe-\u0ccc\u0cd5\u0cd6\u0ce2\u0ce3\u0d01-\u0d03\u0d3e-\u0d4c\u0d4e\u0d57\u0d62\u0d63\u0d82\u0d83\u0dca-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f83\u0f86\u0f87\u0f8d-\u0fbc\u0fc6\u102b-\u1038\u103a-\u103e\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f\u109a-\u109d\u17b4-\u17d1\u17d3\u1a55-\u1a5e\u1a61-\u1a7c\u1dc0-\u1dff\u20d0-\u20ff]",Wc=new RegExp("^.(?:"+Xc+"+)?([\u094d\u09cd\u0a4d\u0acd\u0b4d\u0c4d\u0ccd\u0d4d\u0f84\u1039\u17d2\u1a60\u1a7f]\\W(?:"+Xc+"+)?)*"),Zc={Mongolian:"\u1800-\u18af"},Kc=Object.keys(Zc).map(function(e){return Zc[e]}).join(""),$c=new RegExp("["+Kc+"]");var Jc=2;var Qc=function(){function _(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0;pr(this,_),this.width=0,this.height=0,this.lines=[],this.max_lines=t,this.text_wrap=i,this.context=e}return vr(_,[{key:"createLine",value:function(e){return this.lines.length<this.max_lines&&new eh(e,this.text_wrap)}},{key:"push",value:function(e){if(this.lines.length<this.max_lines){var t=this.context.measureText(e.text).width;return(e.width=t)>this.width&&(this.width=Math.ceil(t)),this.lines.push(e),this.height+=e.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(e,t){return!!this.push(e)&&this.createLine(t)}},{key:"addEllipsis",value:function(){var e=this.lines[this.lines.length-1],t=Math.ceil(this.context.measureText(_.ellipsis).width);e.append(_.ellipsis),e.width+=t,e.width>this.width&&(this.width=e.width)}},{key:"finish",value:function(e){e?this.push(e):this.addEllipsis()}}],[{key:"parse",value:function(e,t,i,r,n){for(var o="number"==typeof t?e.split(" "):[e],a=new _(n,i,t),s=a.createLine(r),l=0;l<o.length;l++){for(var u=o[l].split("\n"),c=0===l,h=0;h<u.length&&s;h++){var f=u[h];Uc(f)&&Vc(f[f.length-1])&&(f+="\u200f");var d=c?f:" "+f;if(t&&0<l&&s.exceedsTextwrap(d)){if(!(s=a.advance(s,r)))break;s.append(f),c=!0}else s.append(d);h<u.length-1&&(s=a.advance(s,r),c=!0)}l===o.length-1&&a.finish(s)}return a}}]),_}();Qc.ellipsis="...";var eh=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;pr(this,i),this.chars=0,this.text="",this.height=Math.ceil(e),this.text_wrap=t}return vr(i,[{key:"append",value:function(e){this.chars+=e.length,this.text+=e}},{key:"exceedsTextwrap",value:function(e){return e.length+this.chars>this.text_wrap}}]),i}(),th={resetText:function(){this.texts={}},freeText:function(e){delete this.texts[e.id]},parseTextFeature:function(e,t,i,r){var n=this.parseTextSource(e,t,i);if(null!=n&&""!==n){var o=Lc.compute(e,t,i),a=Lc.key(o);this.texts[r.id]=this.texts[r.id]||{};var s=this.texts[r.id][a]=this.texts[r.id][a]||{};if(n instanceof Object){var l=[],u=n.left+"-"+n.right;for(var c in n){var h,f=n[c];f&&(h=this.computeTextLayout({},e,t,i,r,f,o,u,c),s[f]||(s[f]={text_settings:o,ref:0}),l.push({draw:t,text:f,text_settings_key:a,layout:h}))}return 0<l.length&&l}var d=this.computeTextLayout({},e,t,i,r,n,o);return s[n]||(s[n]={text_settings:o,ref:0}),{draw:t,text:n,text_settings_key:a,layout:d}}},parseTextSource:function(e,t,i){var r,n=t.text_source||"name";if(null!=n&&"object"===_r(n))for(var o in r={},n)r[o]=this.parseTextSourceValue(n[o],e,i);else r=this.parseTextSourceValue(n,e,i);return r},parseTextSourceValue:function(e,t,i){var r;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("string"==typeof e[n]?r=t.properties[e[n]]:"function"==typeof e[n]&&(r=e[n](i)),r)return r}else"string"==typeof e?r=t.properties[e]:e instanceof Function&&(r=e(i));return r},prepareTextLabels:function(i,e,r){var n=this;return 0===Object.keys(this.texts[i.id]||{}).length?Promise.resolve([]):un.postMessage(this.main_thread_target+".calcTextSizes",i.id,this.texts[i.id]).then(function(e){var t=e.texts;return i.canceled?(An("trace","Style ".concat(n.name,": stop tile build because tile was canceled: ").concat(i.key,", post-calcTextSizes()")),[]):(n.texts[i.id]=t||[],t?n.buildTextLabels(i,r):(Ro.abortTile(i.id),[]))})},collideAndRenderTextLabels:function(t,i,e){var n=this;return this.prepareTextLabels(t,i,e).then(function(e){return 0===e.length?(Ro.collide([],i,t.id),Promise.resolve({})):Ro.collide(e,i,t.id).then(function(e){if(t.canceled)return An("trace","stop tile build because tile was canceled: ".concat(t.key,", post-collide()")),{};var r=n.texts[t.id];return null==r||0===e.length?{}:(n.cullTextStyles(r,e),e.forEach(function(e){var t=e.text_settings_key,i=r[t]&&r[t][e.text];i.text_settings.can_articulate?(i.type||(i.type=[]),-1===i.type.indexOf(e.label.type)&&i.type.push(e.label.type)):(i.align=i.align||{},i.align[e.label.align]={})}),{labels:e,texts:r,textures:[]})})})},cullTextStyles:function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e[r.text_settings_key][r.text].ref++}for(var n in e)for(var o in e[n])e[n][o].ref<1&&delete e[n][o];for(var a in e)0===Object.keys(e[a]).length&&delete e[a]},calcTextSizes:function(e,t){return this._canvas_text||(this._canvas_text=new Dc,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(e,t,this._canvas_ctx_for_sizes)},preprocessText:function(e){if(e&&e.font&&"object"===_r(e.font))return e.font.fill=mo.createPropertyCache(e.font.fill),e.font.stroke&&(e.font.stroke.color=mo.createPropertyCache(e.font.stroke.color)),e.background&&e.background.color&&(e.background.color=mo.createPropertyCache(e.background.color)),e.outline&&(e.outline.color&&(e.outline.color=mo.createPropertyCache(e.outline.color)),e.outline.width&&(e.outline.width=mo.createPropertyCache(e.outline.width,mo.parsePositiveNumber))),e.padding&&(Array.isArray(e.padding)?2===e.padding.length&&(e.padding=[e.padding[0],e.padding[1],e.padding[0],e.padding[1]]):e.padding=Array(4).fill(e.padding),e.padding=mo.createPropertyCache(e.padding,function(e){return e.map(mo.parsePositiveNumber)})),e.font.px_size=mo.createPropertyCache(e.font.size||Lc.defaults.size,Dc.fontPixelSize),e.font.stroke&&null!=e.font.stroke.width&&(e.font.stroke.width=mo.createPropertyCache(e.font.stroke.width,mo.parsePositiveNumber)),e.offset=mo.createPropertyCache(e.offset,function(e){return Array.isArray(e)&&e.map(mo.parseNumber)}),e.buffer=mo.createPropertyCache(e.buffer,function(e){return(Array.isArray(e)?e:[e,e]).map(mo.parsePositiveNumber)}),e.repeat_distance=mo.createPropertyCache(e.repeat_distance||Jr.tile_size,mo.parsePositiveNumber),e},computeTextLayout:function(e,t,i,r,n,o,a,s,l){var u=e||{};return(u=this.computeLayout(u,t,i,r,n)).repeat_distance&&(s&&(u.repeat_group+="/"+s),u.repeat_group+="/"+o),u.subdiv=n.overzoom2,u.align=i.align,u.italic="normal"!==a.style,"right"===l?u.orientation=1:"left"===l&&(u.orientation=-1),u}};var ih=Math.PI/180,rh=function(){function i(e,t){pr(this,i),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=e,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),t?this.setLookAtData(t):this._updateMatrices(),Vl.replaceBlock("camera","\n            uniform mat4 u_projection;\n            uniform vec3 u_eye;\n            uniform vec2 u_center_offset;\n\n            void cameraProjection (inout vec4 position) {\n                position = u_projection * position;\n            }")}return vr(i,[{key:"_getZoomForBounds",value:function(e,t,i,r){for(var n=this.clone(),o=this._max_zoom;o>=this._min_zoom;){if(n.setLookAtData({zoom:o-=.1,position:t,tilt:i,heading:r}),e.every(function(e){return Kr.isPointInsidePolygon(e,n.getLookAtData().bounds)}))break}return n.getLookAtData().zoom}},{key:"setZoomConstraints",value:function(e,t){this._min_zoom=e,this._max_zoom=t,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(e,t){var i,r,n,o,a,s=e.position,l=e.zoom;s===i&&e.bounds!==i&&(s=Kr.getBBoxCenter(Kr.getBBox(e.bounds))),l===i&&e.bounds!==i&&(l=this._getZoomForBounds(e.bounds,s,e.tilt,e.heading)),t!==i&&(r=s||this.screenToWorld(t)),l!==i&&(l=Kr.clamp(l,this._min_zoom,this._max_zoom),(n=kn.zoomToTileLevel(l))!==(o=this._lookAtData.tile_level)&&(this._zoom_direction=o<n?1:-1),this._lookAtData.zoom=l,this._lookAtData.tile_level=n),e.tilt!==i&&(this._lookAtData.tilt=e.tilt),e.heading!==i&&(this._lookAtData.heading=e.heading),t!==i?(this._updateMatrices(),a=this.screenToWorld(t),this._lookAtData.position[0]-=a[0]-r[0],this._lookAtData.position[1]-=a[1]-r[1]):s&&(this._lookAtData.position=s),this._lookAtData.position[2]=0,this._lookAtData.position[1]=Kr.clamp(this._lookAtData.position[1],-Jr.half_circumference_meters,Jr.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(e){var t=0<arguments.length&&void 0!==e&&e,i=this._viewport,r=i.width,n=i.height;this._viewport_aspect_ratio=r/n;var o=this._viewport.center.x-(r/2<<0),a=this._viewport.center.y-(n/2<<0);this._center_offset[0]=o,this._center_offset[1]=a,this._center_offset_normalized[0]=o/r,this._center_offset_normalized[1]=a/-n,t||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(e,t){jo.multiply(e.model_view32,this._view_matrix,e.model),t.uniform("Matrix4fv","u_modelView",e.model_view32),Do.normalFromMat4(e.normal32,e.model_view32),Do.invert(e.inverse_normal32,e.normal32),t.uniform("Matrix3fv","u_normalMatrix",e.normal32),t.uniform("Matrix3fv","u_inverseNormalMatrix",e.inverse_normal32)}},{key:"_updateMatrices",value:function(){var e=this._viewport.height*Jr.metersPerPixel(this._lookAtData.zoom),t=kn.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=e/2*t;var i=this._lookAtData.position[0],r=this._lookAtData.position[1];jo.lookAt(this._view_matrix,Fo.fromValues(i,r,0),Fo.fromValues(i,r,-1),Fo.fromValues(0,1,0)),this._heading_matrix=jo.identity(this._heading_matrix);var n=180-this._lookAtData.heading;n*=ih,this._heading_matrix[0]=Math.cos(n),this._heading_matrix[1]=-Math.sin(n),this._heading_matrix[4]=Math.sin(n),this._heading_matrix[5]=Math.cos(n),this._tilt_matrix=jo.identity(this._tilt_matrix),n=0<(n=this._lookAtData.tilt?this._lookAtData.tilt*ih:0)?-n:n,this._tilt_matrix[5]=Math.cos(n),this._tilt_matrix[6]=Math.sin(n),this._tilt_matrix[9]=-Math.sin(n),this._tilt_matrix[10]=Math.cos(n),jo.multiply(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),jo.multiply(this._view_matrix,this._transformation_matrix,this._view_matrix);var o=2*Math.atan(1/t),a=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log(a),jo.perspective(this._projection_matrix,o,this._viewport_aspect_ratio,1,a),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],jo.translate(this._projection_matrix,this._projection_matrix,Fo.fromValues(0,0,-this._lookAtData.distance)),this._camera_matrix=jo.multiply(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var e,t,i,r,n,o=this._viewport,a=o.width,s=o.height,l=o.padding,u=this._lookAtData.tilt*Math.PI/180;this._horizon=Math.max((l.top+s)/2-Math.cos(u)*(l.top*(1-Math.sin(u))+.75*s),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([a,this._horizon]),this.screenToWorld([a,s]),this.screenToWorld([0,s])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),0===l.left&&0===l.top&&0===l.right&&0===l.bottom?this._lookAtData.bounds=this._lookAtData.unpadded_bounds:(e=l.left,t=Math.max(this._horizon,l.top),i=a-l.right,r=s-l.bottom,n=[this.screenToWorld([e,t]),this.screenToWorld([i,t]),this.screenToWorld([i,r]),this.screenToWorld([e,r])],this._lookAtData.bounds=this._clipAgainstGeoBounds(n))}},{key:"_clipAgainstGeoBounds",value:function(e){var t=Pr(Kr.getBBox(e),4),i=t[0],r=t[1],n=t[2],o=t[3],a=[[i,Jr.half_circumference_meters],[n,Jr.half_circumference_meters],[n,-Jr.half_circumference_meters],[i,-Jr.half_circumference_meters]],s=Kr.clipPolygon(a,e)[0],l=Pr(Kr.getBBox(s),4),i=l[0],r=l[1],n=l[2],o=l[3];n-i>=Jr.circumference_meters&&(s=[[-Jr.half_circumference_meters,o],[Jr.half_circumference_meters,o],[Jr.half_circumference_meters,r],[-Jr.half_circumference_meters,r]]);var u=[];return s&&(u=Kr.splitLegs(s,Jr.half_circumference_meters)),u}},{key:"applyPxOffset",value:function(e){var t=Pr(e,2),i=t[0],r=t[1],n=Math.PI-this._lookAtData.heading*ih,o=Jr.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(i*Math.cos(n)+r*Math.sin(n))*o,this._lookAtData.position[1]-=(r*Math.cos(n)-i*Math.sin(n))*o,this._lookAtData.position[1]=Kr.clamp(this._lookAtData.position[1],-Jr.half_circumference_meters,Jr.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(e){var t=Pr(e,2),i=t[0],r=t[1],n=this._viewport,o=n.width,a=n.height;return 0===o||0===a?[0,0]:(i-=o/2,r-=a/2,this._clipCoordsToWorldPlaneCoords([2*(i+o/2)/o-1,1-2*(r+a/2)/a,-1,1]))}},{key:"_clipToScreenCoords",value:function(e){var t=this._viewport,i=t.width,r=t.height;return[(.5*e[0]+.5)*i,r-(.5*e[1]+.5)*r]}},{key:"_isScreenPointInViewPort",value:function(e){var t=this._viewport,i=t.width,r=t.height;return 0<=e[0]&&e[0]<=i&&0<=e[1]&&e[1]<=r}},{key:"worldToScreen",value:function(e,t){var i,r,n,o,a,s,l=1<arguments.length&&void 0!==t&&t;return e[2]||(e[2]=0),l?(i=this._worldToClipCoords(e),a=this._clipToScreenCoords(i)):(r=Math.sign(this._lookAtData.position[0]),n=Math.trunc(this._lookAtData.position[0]/Jr.circumference_meters+r/2),e[0]+=Jr.circumference_meters*n,o=this._worldToClipCoords(e),s=a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([e[0]+Jr.circumference_meters,e[1],e[2]]),a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([e[0]-Jr.circumference_meters,e[1],e[2]]),a=this._clipToScreenCoords(o)),this._isScreenPointInViewPort(a)||(a=s))),a}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(e){var t=[],i=this._lookAtData.distance,r=this._lookAtData.position,n=[0,0,i,0],o=0,a=i*Math.sin(ih*this._lookAtData.tilt)*Math.cos(ih*this._lookAtData.heading),s=i*Math.sin(ih*this._lookAtData.tilt)*Math.sin(ih*this._lookAtData.heading),l=new Float64Array(16),u=new Float64Array(16);return jo.invert(l,this._projection_matrix),Uo.transformMat4(t,e,l),t[2]=-1,t[3]=0,jo.invert(u,this._view_matrix),Uo.transformMat4(t,t,u),Uo.normalize(t,t),Uo.transformMat4(n,n,this._transformation_matrix),0!==t[2]&&(o=-n[2]/t[2]),Uo.scale(t,t,o),[r[0]+(t[0]+s),r[1]+(t[1]+a)]}},{key:"_worldToClipCoords",value:function(e){var t=[e[0],e[1],e[2],1];return Uo.transformMat4(t,t,this._view_matrix),Uo.transformMat4(t,t,this._projection_matrix),Uo.scale(t,t,1/t[3]),t}},{key:"setupProgram",value:function(e){e.uniform("Matrix4fv","u_projection",this._projection_matrix),e.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),e.uniform("2fv","u_center_offset",this._center_offset_normalized),e.uniform("1f","u_tilt",this._lookAtData.tilt*ih),e.uniform("1f","u_heading",this._lookAtData.heading*ih),e.uniform("1f","u_near_plane",1),e.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var e=new i(this._viewport,this._lookAtData);return e.setZoomConstraints(this._min_zoom,this._max_zoom),e}},{key:"getViewport",value:function(){return this._viewport}}]),i}();function nh(e){return void 0===e.x?e[0]:e.x}function oh(e){return void 0===e.y?e[1]:e.y}function ah(e,t){return nh(e)-nh(t)}function sh(e,t){return oh(e)-oh(t)}function lh(e){return e.sort(ah)}function uh(e,t){for(var i,r=e[0],n=r,o=0;o<e.length;o+=1)t(i=e[o],r)<0?r=i:0<t(i,n)&&(n=i);return[r,n]}function ch(r,e){return Object.values(e.reduce(function(e,t){var i=t[+r];return e[i]||(e[i]=[]),e[i].push(t),e},{}))}function hh(e,t,i){var r=+e,n=t[r],o=i[r];if(o<n)return[];var a=[t];if(o<n)return a;for(var s=t[(1+r)%2],l=e?function(e){return a.push([s,e])}:function(e){return a.push([e,s])},u=n+1;u<o;u+=1)l(u);return a.push(i),a}function fh(e,t){return hh(!1,e,t)}function dh(e,t){return hh(!0,e,t)}function _h(e){var i={},r=[];return e.forEach(function(e){var t=e.key||(Array.isArray(e)?"".concat(e[0],"/").concat(e[1]):"".concat(e.x,"/").concat(e.y));i[t]||(i[t]=!0,r.push(e))}),r}function ph(e){return e.reduce(function(e,t){return e.concat(t)})}function gh(e,a){if(a<=0)return e;var t,i,r=function(e){var t=Pr(uh(e,ah),2),i=t[0],r=t[1],n=[i[0]-a,i[1]],o=[r[0]+a,r[1]];return e.concat(fh(n,i),fh(r,o))},n=function(e){var t=Pr(uh(e,sh),2),i=t[0],r=t[1],n=[i[0],i[1]-a],o=[r[0],r[1]+a];return e.concat(dh(n,i),dh(r,o))};return _h((i=ch(!1,e),t=ph(i.map(n)),ph(ch(!0,t).map(r))))}function vh(t,e,i){function r(e){return Object.values(Jr.metersToExactTileCoords(e,t.tile_level))}var n,o,a,s,l,u,c,h,f;return _h((n=gh((s=r(t.tetragon[0]),l=r(t.tetragon[1]),u=r(t.tetragon[3]),c=r(t.tetragon[2]),h=mh(l,s,u),f=mh(u,c,l),_h(h.concat(f))),e),o=t.tile_level,a=i,n.map(function(e){var t=Pr(e,2),i=t[0],r=t[1];return Vo.coord(Jr.wrapTile({x:i,y:r,z:o},{x:!a,y:!0}))})))}function mh(e,t,i){var r=function(e,t,i){var r=Pr(e,2),n=r[0],o=r[1],a=Pr(t,2),s=a[0],l=a[1],u=Pr(i,2),c=u[0],h=u[1],f=n+(l-o)/(h-o)*(c-n);return[[[n,o]].concat(zr(lh([[s,l],[f,l]]))),[].concat(zr(lh([[s,l],[f,l]])),[[c,h]])]}.apply(void 0,zr([e,t,i].sort(sh))),n=Pr(r,2),o=n[0],a=n[1];return _h(function(e,t,i){var r=Pr(e,2),n=r[0],o=r[1],a=Pr(t,2),s=a[0],l=a[1],u=Pr(i,1)[0];return xh(n,s,u,o,l)}.apply(void 0,zr(o)).concat(function(e,t,i){var r=Pr(e,2),n=r[0],o=r[1],a=Pr(t,1)[0],s=Pr(i,2),l=s[0],u=s[1];return xh(l,n,a,u,o)}.apply(void 0,zr(a))))}var yh=.125;function xh(e,t,i,r,n){var o,a,s,l,u,c,h,f,d,_,p=Math.min(e,t),g=Math.max(e,i),v=Math.min(r,n),m=Math.max(r,n);if(Math.floor(r)===Math.floor(n))return Ah(p,g,r);if(m-v<yh)return o=[g,m],a=Pr([p,v],2),s=a[0],l=a[1],u=Pr(o,2),c=u[0],h=u[1],f=wh(s,c),d=bh(f,l),_=bh(f,h),d.concat(_);function y(e){E=E.concat(Ah(M,R,Math.floor(e))),M+=T,R+=k}var x,b,w=yh*((b=m)-(x=v))/(Math.ceil(b)-Math.floor(x)),A=(m-v)/w,T=(t-e)/A,k=(i-e)/A,E=[],M=e,R=e;if(r<n)for(var S=v;S<=m;S+=w)y(S);else for(var P=m;v<=P;P-=w)y(P);return _h(E)}function bh(e,t){return e.map(function(e){return[e,t]})}function wh(e,t){var i=Math.floor(e),r=Math.floor(t);if(r<i)return[];if(i===r)return[i];for(var n=[],o=i;o<=r;o+=1)n.push(o);return n}function Ah(e,t,i){return bh(wh(e,t),i)}var Th=function(){function i(e,t){pr(this,i),No(this),this.scene=e,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=!1!==t.wrapView,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new rh(t.viewport),this._viewport=t.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return vr(i,[{key:"update",value:function(){this.pan_snap_timer=(new Date-this.panning_stop_at)/1e3,this.user_input_active=new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(e){var t=0<arguments.length&&void 0!==e&&e,i=this._viewport,r=i.width,n=i.height;this.size.css={width:r,height:n},this.size.device={width:Math.round(r*kn.device_pixel_ratio),height:Math.round(n*kn.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),t||this.updateBounds()}},{key:"setLookAtData",value:function(e,t){var i,r,n=e.position,o=e.zoom,a=e.tilt,s=e.heading,l=e.bounds,u={zoom:o,tilt:a,heading:s};n&&"number"==typeof n.lng&&"number"==typeof n.lat&&(u.position=Jr.latLngToMeters([n.lng,n.lat])),l&&(i=[],r=l.getBoundingBox(),i.push(Jr.latLngToMeters([r.getLeft(),r.getTop()])),i.push(Jr.latLngToMeters([r.getRight(),r.getTop()])),i.push(Jr.latLngToMeters([r.getRight(),r.getBottom()])),i.push(Jr.latLngToMeters([r.getLeft(),r.getBottom()])),u.bounds=i),this.lookAtManipulator.setLookAtData(u,t),this.updateBounds()}},{key:"getLookAtData",value:function(e){var t=0<arguments.length&&void 0!==e&&e,i=this.lookAtManipulator.getLookAtData(),r=i.heading,n=i.incline,o=i.tilt,a=i.zoom,s=i.position,l=i.bounds,u=i.unpadded_bounds,c=Pr(Jr.metersToLatLng(s),2),h=c[0],f=c[1],d=new H.geo.LineString;return(t?u:l).forEach(function(e){var t=Jr.metersToLatLng(e);d.pushLatLngAlt(t[1],t[0],0)}),{heading:r,incline:n,tilt:o,zoom:a,bounds:new H.geo.Polygon(d),position:{lat:f,lng:h,alt:s[2]}}}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(e){var t=this._offset_buffer;t[0]+=e[0],t[1]+=e[1];var i,r,n=Math.abs(t[0]),o=Math.abs(t[1]);(1<=n||1<=o)&&(i=~~t[0],r=~~t[1],this.lookAtManipulator.applyPxOffset([n<1?0:i,o<1?0:r]),1<=n&&(t[0]-=i),1<=o&&(t[1]-=r),this.updateBounds())}},{key:"setPanning",value:function(e){this.panning=e,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return"number"==typeof this.size.css.width&&"number"==typeof this.size.css.height}},{key:"updateBounds",value:function(){var e,t;this.markUserInput(),this.ready()&&(this.center_tile=Jr.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level),e=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),t=this.lookAtManipulator.screenToWorld([this.size.css.width,0]),this.bounds={sw:{x:e[0],y:e[1]},ne:{x:t[0],y:t[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw())}},{key:"getTileGridFlatForBBox",value:function(e,t,i,r,n,o){var a,s=4<arguments.length&&void 0!==n?n:0,l=!(5<arguments.length&&void 0!==o)||o,u=this.lookAtManipulator.getLookAtData().tile_level,c=Jr.tileForMeters([t,e],u),h=Jr.tileForMeters([r,i],u);c.x-=s,c.y-=s,h.x+=s,h.y+=s,!1===l&&(a=(1<<u)-1,c.x=Math.min(Math.max(0,c.x),a),c.y=Math.min(Math.max(0,c.y),a),h.x=Math.min(Math.max(0,h.x),a),h.y=Math.min(Math.max(0,h.y),a));for(var f=[],d={},_=c.x;_<=h.x;_++)for(var p=c.y;p<=h.y;p++){var g=Vo.coord(Jr.wrapTile({x:_,y:p,z:u},{x:!l,y:!0}));d[g.key]||(d[g.key]=!0,f.push(g))}return f}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return vh(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var e=this.lookAtManipulator.getLookAtData(),t=e.tilt,i=e.heading;return 0===t&&180===i?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(e,t){e.setupProgram(this.matrices,t),this.lookAtManipulator.setupMatrices(this.matrices,t)}},{key:"setupProgram",value:function(e){var t=this.lookAtManipulator.getLookAtData();e.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),e.uniform("3fv","u_map_position",[t.position[0],t.position[1],Math.trunc(1e5*t.zoom)/1e5]),e.uniform("1f","u_meters_per_pixel",Jr.metersPerPixel(t.zoom)),e.uniform("1f","u_device_pixel_ratio",kn.device_pixel_ratio),e.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),e.uniform("1i","u_view_panning",this.panning),e.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(e)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=.5}},{key:"xyToGeo",value:function(e,t){var i=this.lookAtManipulator.screenToWorld([e,t]),r=Pr(Jr.metersToLatLng(i),2),n=r[0];return{lat:r[1],lng:n}}},{key:"geoToPixel",value:function(e){var t=Jr.latLngToMeters([e.lng,e.lat]);t.push(e.alt||0);var i=this.lookAtManipulator.worldToScreen(t);return{x:Math.floor(i[0]),y:Math.floor(i[1])}}},{key:"geoToMeters",value:function(e){var t=Pr(Jr.latLngToMeters([e.lng,e.lat]),2);return{x:t[0],y:t[1],z:e.alt||0}}},{key:"metersToGeo",value:function(e){var t=Pr(Jr.metersToLatLng([e.x,e.y]),2),i=t[0];return{lat:t[1],lng:i,alt:e.z||0}}},{key:"setZoomConstraints",value:function(e,t){this.lookAtManipulator.setZoomConstraints(e,t)}}]),i}(),kh=Sc.PLACEMENT,Eh=128/Math.PI,Mh=16384/Math.PI,Rh=Object.create(nu);Rh.variants={};Object.assign(Rh,th),Object.assign(Rh,{name:"points",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;\n#ifdef TANGRAM_IS_TEXT_STYLE\nattribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nattribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;\n#endif\nvarying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nattribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#define PI 3.14159265359\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}\n#ifdef TANGRAM_IS_TEXT_STYLE\nfloat mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}\n#endif\nvoid main(){\n#pragma tangram: setup\n#ifndef TANGRAM_SHOW_HIDDEN_LABELS\nif(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}\n#else\nif(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}\n#endif\nv_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nv_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}\n#endif\nvec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);\n#ifdef TANGRAM_POINT_DRAW_STICK\nv_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;\n#endif\nfloat zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){\n#ifdef TANGRAM_IS_TEXT_STYLE\nif(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}\n#else\nshape.xy=rotate2D(shape.xy+offset*256.,theta);\n#endif\nshape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;\n#ifdef TANGRAM_POINT_DRAW_STICK\nshape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;\n#endif\nshape.xy=rotate2D(shape.xy+offset,theta);}\n#ifdef TANGRAM_FADE_IN_RATE\nif(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}\n#endif\n#ifdef TANGRAM_FADE_ON_ZOOM_OUT\nv_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);\n#endif\nv_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);\n#pragma tangram: position\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;\n#endif\nif(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}\n#endif\nif(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nvarying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nvarying float v_is_stick;\n#endif\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#ifdef TANGRAM_HAS_SHADER_POINTS\nfloat _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}\n#endif\nvoid mixTextureColor(inout vec4 color){\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;\n#ifdef TANGRAM_BLEND_ADD\ncolor.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;\n#else\ncolor.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);\n#endif\n}\n#else\ncolor=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);\n#endif\nif(u_apply_color_blocks){\n#pragma tangram: color\n#pragma tangram: filter\n}color.a*=v_alpha_factor;\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nif(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}\n#endif\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)\nif(color.a<TANGRAM_ALPHA_TEST){discard;}\n#endif\n}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;\n#ifdef TANGRAM_POINT_DRAW_STICK\nif(v_is_stick==0.0){mixTextureColor(color);}\n#else\nmixTextureColor(color);\n#endif\ngl_FragColor=color;}",selection:!0,collision:!0,blend:"overlay",init:function(e){var t=0<arguments.length&&void 0!==e?e:{};nu.init.call(this,t),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=1,this.defines.TANGRAM_POINT_TYPE_LABEL=2,this.defines.TANGRAM_POINT_TYPE_SHADER=3,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){"overlay"!==this.blend&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,Rl.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),Rl.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=2),Rl.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(e,t,i){var r,n,o,a=i.tile,s={};if(s.color=this.parseColor(t.color,i),s.texture=t.texture,s.label_texture=null,s.color||s.texture){if(this.hasSprites(s)){if(!(r=this.parseSprite(s,t,i)))return;s.texcoords=r.texcoords}if(s.size=t.size,s.size){if(s.size=mo.evalCachedPointSizeProperty(t.size,r,i),null==s.size)return void An({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(t.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");"number"==typeof s.size&&(s.size=[s.size,s.size])}else s.size=r&&r.css_size||[16,16];t.outline&&(s.outline_width=mo.evalCachedProperty(t.outline.width,i)||mo.defaults.outline.width,s.outline_color=this.parseColor(t.outline.color,i)),s.outline_edge_pct=0,s.outline_width&&s.outline_color&&(n=s.outline_width,s.size[0]+=n,s.size[1]+=n,s.outline_edge_pct=n/Math.min(s.size[0],s.size[1])*2),s.size[0]=Math.min(s.size[0],256),s.size[1]=Math.min(s.size[1],256),s.placement=t.placement,s.placement_min_length_ratio=mo.evalCachedProperty(t.placement_min_length_ratio,i),s.placement===kh.SPACED&&t.placement_spacing&&(s.placement_spacing=mo.evalCachedProperty(t.placement_spacing,i)),s.angle=mo.evalProperty(t.angle,i)||0,s.elevate_by_altitude=!!t.elevate_by_altitude,s.z=t.z?Kr.clamp(mo.evalCachedDistanceProperty(t.z,i),0,32767):mo.defaults.z,s.flat=t.flat,s.tile_edges=t.tile_edges,this.computeLayout(s,e,t,i,a),t.stick&&!s.flat&&(o=mo.parseNumber(mo.evalProperty(t.stick.height,i)),s.stick={color:this.parseColor(t.stick.color,i)||mo.defaults.color,height:o?Math.max(o,0):0});var l=t.text&&!1!==mo.evalProperty(t.text.visible,i)&&this.parseTextFeature(e,t.text,i,a);Array.isArray(l)&&An({level:"warn",once:!(l=null)},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(t.text.text_source))),l&&(l.layout.parent=s,l.layout.priority=t.text.priority?Math.max(l.layout.priority,s.priority+.5):s.priority+.5,l.layout.move_into_tile=!1,Ro.addStyle(this.collision_group_text,a.id)),this.queueFeature({feature:e,draw:t,context:i,style:s,text_feature:l},a),Ro.addStyle(this.collision_group_points,a.id)}},hasSprites:function(e){return e.texture&&this.textureManager.textures[e.texture]&&this.textureManager.textures[e.texture].sprites},getSpriteInfo:function(e,t){var i=this.textureManager.textures[e.texture].sprites[t]&&this.textureManager.getSpriteInfo(e.texture,t);return t&&!i?(this.texture_missing_sprites[e.texture]=this.texture_missing_sprites[e.texture]||{},this.texture_missing_sprites[e.texture][t]||(An("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(t,"' for texture '").concat(e.texture,"'")),this.texture_missing_sprites[e.texture][t]=!0)):i&&(i.sprite=t),i},parseSprite:function(e,t,i){var r=mo.evalProperty(t.sprite,i);return this.getSpriteInfo(e,r)||this.getSpriteInfo(e,t.sprite_default)},queueFeature:function(e,t){this.tile_data[t.id]&&this.queues[t.id]||this.startData(t),this.queues[t.id]=this.queues[t.id]||[],this.queues[t.id].push(e)},endData:function(r){var u=this;if(r.canceled)return An("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(r.key)),Promise.resolve();var e=this.queues[r.id];delete this.queues[r.id];var c=[],h=[];return e.forEach(function(e){for(var t=e.style,i=e.feature,r=i.geometry,n=u.buildLabels(t.size,r,t),o=0;o<n.length;o++){var a,s=n[o],l={feature:i,draw:e.draw,context:e.context,style:t,label:s};h.push(l),e.text_feature&&(a={feature:i,draw:e.text_feature.draw,context:e.context,text:e.text_feature.text,text_settings_key:e.text_feature.text_settings_key,layout:e.text_feature.layout,point_label:s,linked:l},c.push(a),e.draw.text.optional||(l.linked=a))}}),Promise.all([Ro.collide(h,this.collision_group_points,r.id).then(function(e){e.forEach(function(e){u.feature_style=e.style,u.feature_style.label=e.label,u.feature_style.linked=e.linked,nu.addFeature.call(u,e.feature,e.draw,e.context)})}),this.collideAndRenderTextLabels(r,this.collision_group_text,c)]).then(function(e){var t=Pr(e,2)[1],i=t.labels,n=t.texts;return i&&n&&i.forEach(function(e){var t=e.text_settings_key,i=n[t]&&n[t][e.text],r=u.feature_style;r.label=e.label,r.linked=e.linked,r.size=i.size.logical_size,r.angle=0,e.label.text_data={text_info:i,text_settings_key:t,text:e.text},r.label_texture=u.textureManager.default,nu.addFeature.call(u,e.feature,e.draw,e.context)}),u.freeText(r),nu.endData.call(u,r)})},_preprocess:function(t){t.color=mo.createColorPropertyCache(t.color),t.texture=void 0!==t.texture?t.texture:this.texture,t.outline&&(t.outline.color=mo.createColorPropertyCache(t.outline.color),t.outline.width=mo.createPropertyCache(t.outline.width,mo.parsePositiveNumber)),t.z=mo.createPropertyCache(t.z,mo.parseUnits);try{t.size=mo.createPointSizePropertyCache(t.size)}catch(e){return An({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"".concat(e," (").concat(JSON.stringify(t.size),"), skipping features in layer")),null}return t.offset=mo.createPropertyCache(t.offset,function(e){return Array.isArray(e)&&e.map(mo.parseNumber)}),t.buffer=mo.createPropertyCache(t.buffer,function(e){return(Array.isArray(e)?e:[e,e]).map(mo.parsePositiveNumber)}),t.repeat_distance=mo.createPropertyCache(t.repeat_distance,mo.parseNumber),null==t.repeat_group&&(t.repeat_group=t.layers.join("-")),t.placement=kh[t.placement&&t.placement.toUpperCase()],null==t.placement&&(t.placement=kh.VERTEX),t.placement_spacing=null!=t.placement_spacing?t.placement_spacing:80,t.placement_spacing=mo.createPropertyCache(t.placement_spacing,mo.parsePositiveNumber),t.placement_min_length_ratio=null!=t.placement_min_length_ratio?t.placement_min_length_ratio:1,t.placement_min_length_ratio=mo.createPropertyCache(t.placement_min_length_ratio,mo.parsePositiveNumber),"number"==typeof t.angle?t.angle=t.angle*Math.PI/180:t.angle=t.angle||0,t.text=this.preprocessText(t.text),t.text&&(t.text.key=t.key,t.text.group=t.group,t.text.layers=t.layers,t.text.order=t.order,t.text.repeat_group=t.text.repeat_group||t.repeat_group,t.text.anchor=t.text.anchor||this.default_anchor,t.text.optional="boolean"==typeof t.text.optional&&t.text.optional,t.text.interactive=t.text.interactive||t.interactive),t.stick&&(t.stick.color=mo.createColorPropertyCache(t.stick.color)),t},default_anchor:["bottom","top","right","left"],computeLayout:function(e,t,i,r,n){var o=e||{};o.id=t,o.units_per_pixel=n.units_per_pixel||1,o.collide=!1!==i.collide,o.anchor=i.anchor,o.offset=mo.evalCachedProperty(i.offset,r)||mo.zeroPair,o.buffer=mo.evalCachedProperty(i.buffer,r)||mo.zeroPair,o.repeat_distance=mo.evalCachedProperty(i.repeat_distance,r),o.repeat_distance&&(o.repeat_distance*=o.units_per_pixel,o.repeat_scale=1,"function"==typeof i.repeat_group?o.repeat_group=i.repeat_group(r):o.repeat_group=i.repeat_group);var a=i.priority;return null!=a?"function"==typeof a&&(a=a(r)):a=-1>>>0,o.priority=a,o},buildTextLabels:function(e,t){for(var i=[],r=0;r<t.length;r++){var n=t[r],o=this.texts[e.id][n.text_settings_key][n.text].size.collision_size;n.label=new Sc(n.point_label.position,o,n.point_label.isFlat(),n.layout),i.push(n)}return i},buildLabels:function(e,t,i){var r=!!i.flat,n=[];if("Point"===t.type)n.push(new Sc(t.coordinates,e,r,i));else if("MultiPoint"===t.type)for(var o=t.coordinates,a=0;a<o.length;++a){var s=o[a];n.push(new Sc(s,e,r,i))}else if("LineString"===t.type)for(var l=Nc(t.coordinates,e,r,i),u=0;u<l.length;++u)n.push(l[u]);else if("MultiLineString"===t.type)for(var c=t.coordinates,h=0;h<c.length;h++)for(var f=Nc(c[h],e,r,i),d=0;d<f.length;++d)n.push(f[d]);else if("Polygon"===t.type)if(i.placement===kh.CENTROID){var _=Jr.centroid(t.coordinates);n.push(new Sc(_,e,r,i))}else for(var p=t.coordinates,g=0;g<p.length;g++)for(var v=Nc(p[g],e,r,i),m=0;m<v.length;++m)n.push(v[m]);else if("MultiPolygon"===t.type)if(i.placement===kh.CENTROID){var y=Jr.multiCentroid(t.coordinates);n.push(new Sc(y,e,r,i))}else for(var x=t.coordinates,b=0;b<x.length;b++)for(var w=x[b],A=0;A<w.length;A++)for(var T=Nc(w[A],e,r,i),k=0;k<T.length;++k)n.push(T[k]);return n},makeVertexTemplate:function(e,t){var i,r=e.color||mo.defaults.color,n=t.vertex_data.vertex_layout;return this.fillVertexTemplate(n,"a_position",0,{size:2}),this.fillVertexTemplate(n,"a_position",e.z||0,{size:1,offset:2}),this.fillVertexTemplate(n,"a_position",this.scaleOrder(e.order),{size:1,offset:3}),this.fillVertexTemplate(n,"a_shape",0,{size:4}),this.fillVertexTemplate(n,"a_shape",e.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(n,"a_texcoord",0,{size:2}),this.fillVertexTemplate(n,"a_offset",0,{size:2}),this.fillVertexTemplate(n,"a_color",Kl.mult(r,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&t.variant.shader_point&&(i=e.outline_color||mo.defaults.outline.color,this.fillVertexTemplate(n,"a_outline_color",Kl.mult(i,255),{size:4}),this.fillVertexTemplate(n,"a_outline_edge",e.outline_edge_pct||mo.defaults.outline.width,{size:1})),this.selection&&this.fillVertexTemplate(n,"a_selection_color",Kl.mult(e.selection_color,255),{size:4}),this.fillVertexTemplate(n,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&e.stick&&(this.fillVertexTemplate(n,"a_is_stick",0,{size:1}),this.fillVertexTemplate(n,"a_stick_height",e.stick.height,{size:1})),this.vertex_template},buildQuad:function(e,t,i,r,n,o,a,s,l,u,c,h,f,d,_,p,g,v,m){return t[0]<=0||t[1]<=0?0:function(e,t,i,r){var n,o,a,s,l,u,c=r.quad,h=r.quad_normalize,f=r.offset,d=r.offsets,_=r.offsets_alt,p=r.pre_angles,g=r.pre_angles_alt,v=r.angle,m=r.angles,y=r.angles_alt,x=r.is_flat,b=r.elevate_by_altitude,w=r.build_stick_points,A=r.color,T=r.stick_color,k=r.curve,E=r.texcoord_scale,M=r.texcoord_normalize,R=r.pre_angles_normalize,S=r.angles_normalize,P=r.offsets_normalize,h=h||1,z=c[0]/2*h,N=c[1]/2*h,O=[[-z,-N],[z,-N],[z,N],[-z,N]],I=t.vertex_elements,L=t.vertex_count,C=t.vertex_layout.index,F=C.a_texcoord,D=C.a_position,j=C.a_shape,U=C.a_offset,G=C.a_offsets,B=C.a_offsets_alt,V=C.a_pre_angles,q=C.a_pre_angles_alt,Y=C.a_angles,X=C.a_angles_alt,W=C.a_is_flat,Z=C.a_is_stick,K=C.a_color;F&&(M=M||1,u=[[o=(n=Pr(E||pu,4))[0],a=n[1]],[s=n[2],a],[s,l=n[3]],[o,l]]);for(var $=0,J=e.length,Q=0;Q<J;Q++){var ee=e[Q];if(w){for(var te=.5*h,ie=+h,re=[[-te,0],[+te,0],[+te,ie],[-te,ie]],ne=0;ne<4;ne++)F&&(i[F+0]=u[ne][0]*M,i[F+1]=u[ne][1]*M),i[D+0]=ee[0],i[D+1]=ee[1],b&&(i[D+2]=Kr.clamp(ee[2],0,32767)),i[j+0]=re[ne][0],i[j+1]=re[ne][1],i[j+2]=0,i[K+0]=T[0],i[K+1]=T[1],i[K+2]=T[2],i[K+3]=T[3],i[Z+0]=255,t.addVertex(i);I.push(L+0),I.push(L+1),I.push(L+2),I.push(L+2),I.push(L+3),I.push(L+0),L+=4,$+=2}for(var oe=0;oe<4;oe++)F&&(i[F+0]=u[oe][0]*M,i[F+1]=u[oe][1]*M),i[D+0]=ee[0],i[D+1]=ee[1],b&&(i[D+2]=Kr.clamp(ee[2],0,32767)),i[j+0]=O[oe][0],i[j+1]=O[oe][1],i[j+2]=v,i[K+0]=A[0],i[K+1]=A[1],i[K+2]=A[2],i[K+3]=A[3],i[U+0]=f[0],i[U+1]=f[1],i[W+0]=x?255:0,w&&(i[Z+0]=0),k&&(i[V+0]=R*p[0],i[V+1]=R*p[1],i[V+2]=R*p[2],i[V+3]=R*p[3],i[Y+0]=S*m[0],i[Y+1]=S*m[1],i[Y+2]=S*m[2],i[Y+3]=S*m[3],i[G+0]=P*d[0],i[G+1]=P*d[1],i[G+2]=P*d[2],i[G+3]=P*d[3],_&&(i[B+0]=P*_[0],i[B+1]=P*_[1],i[B+2]=P*_[2],i[B+3]=P*_[3],i[q+0]=R*g[0],i[q+1]=R*g[1],i[q+2]=R*g[2],i[q+3]=R*g[3],i[X+0]=S*y[0],i[X+1]=S*y[1],i[X+2]=S*y[2],i[X+3]=S*y[3])),t.addVertex(i);I.push(L+0),I.push(L+1),I.push(L+2),I.push(L+2),I.push(L+3),I.push(L+0),L+=4,$+=2}return $}(e,_,p,{quad:t,quad_normalize:256,offset:s,offsets:l,offsets_alt:u,pre_angles:o,pre_angles_alt:a,angle:4096*i,angles:r,angles_alt:n,is_flat:f,elevate_by_altitude:d,build_stick_points:g,stick_color:g&&Kl.mult(v,255),color:Kl.mult(m||mo.defaults.color,255),curve:h,texcoord_scale:c,texcoord_normalize:65535,pre_angles_normalize:Eh,angles_normalize:Mh,offsets_normalize:64})},build:function(e,t,i){var r=e.label;return"curved"===r.type?this.buildCurvedLabel(r,e,t,i):this.buildStraightLabel(r,e,t,i)},buildStraightLabel:function(e,t,i,r){var n,o=this.makeVertexTemplate(t,i),a=e.angle||t.angle,s="point"!==e.type?(n=t.size[e.type],pu):(n=t.size,t.texcoords||pu);i.uniforms=i.uniforms||{},t.label_texture?(i.uniforms.u_texture=t.label_texture,i.uniforms.u_point_type=2,i.uniforms.u_apply_color_blocks=!1):(t.texture?(i.uniforms.u_texture=t.texture,i.uniforms.u_point_type=1):(i.uniforms.u_texture=this.textureManager.default,i.uniforms.u_point_type=3),i.uniforms.u_apply_color_blocks=!0);var l=e.offset,u=this.defines.TANGRAM_POINT_DRAW_STICK&&!t.label_texture&&t.stick&&0<t.stick.height,c=this.buildQuad([e.position],n,a,null,null,null,null,l,null,null,s,!1,e.isFlat(),t.elevate_by_altitude,i.vertex_data,o,u,u&&t.stick.color,t.color),h=t.linked&&t.linked.label.id;return this.trackLabel(e,h,i,c,r,u),c},buildCurvedLabel:function(e,t,i,r){for(var n=this.makeVertexTemplate(t,i),o=e.angle,a=0,s=0;s<2;s++)for(var l=0;l<e.num_segments;l++){var u=t.size[e.type][l],c=pu,h=this.getTileMesh(r.tile,this.meshVariantTypeForDraw(t));h.uniforms=h.uniforms||{},h.uniforms.u_texture=t.label_texture,h.uniforms.u_point_type=2,h.uniforms.u_apply_color_blocks=!1;var f=e.offset||[0,0],d=e.position,_=e.angles[l],p=e.offsets[l],g=e.pre_angles[l],v=e.num_segments-l-1,m=e.alt_angles[v],y=e.alt_pre_angles[v],x=e.alt_offsets[v],b=this.buildQuad([d],u,o,_,m,g,y,f,p,x,c,!0,e.isFlat(),t.elevate_by_altitude,h.vertex_data,n,!1,!1,t.color);a+=b;var w=t.linked&&t.linked.label.id;this.trackLabel(e,w,i,b,r,!1)}return a},trackLabel:function(e,t,i,r,n,o){var a=5<arguments.length&&void 0!==o&&o;i.labels=i.labels||{},i.labels.collision=i.labels.collision||{},i.labels["non-collision"]=i.labels["non-collision"]||{};var s=e.layout.collide?i.labels.collision:i.labels["non-collision"];s[e.id]=s[e.id]||{container:{label:e.text_data?Object.assign(e.toJSON(),{text_data:e.text_data}):e.toJSON(),linked:t},ranges:[]};var l=2*r,u=i.vertex_data.offset-i.vertex_data.stride*l;s[e.id].ranges.push([u,l,a])},buildLines:function(e,t,i,r){return this.build(t,i,r)},buildPoints:function(e,t,i,r){return this.build(t,i,r)},buildPolygons:function(e,t,i,r){return this.build(t,i,r)},vertexLayoutForMeshVariant:function(e){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:ou.SHORT,normalized:!1},{name:"a_shape",size:4,type:ou.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:ou.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:ou.SHORT,normalized:!1},{name:"a_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:ou.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:ou.UNSIGNED_BYTE,normalized:!0}],this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&t.push({name:"a_is_stick",size:1,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:ou.FLOAT,normalized:!1}),this.vertex_layout=new du(t),(t=t.map(function(e){return Object.assign({},e)})).forEach(function(e){"a_outline_color"!==e.name&&"a_outline_edge"!==e.name||(e.static=null)}),this.vertex_layout_shader_point=new du(t)),e.shader_point?this.vertex_layout_shader_point:this.vertex_layout},meshVariantTypeForDraw:function(e){var t=e.label_texture||e.texture||this.default_mesh_variant.key;return null==Rh.variants[t]&&(Rh.variants[t]={key:t,shader_point:t===this.default_mesh_variant.key,order:e.label_texture?1:0}),Rh.variants[t]},makeMesh:function(e,t,i){var r=2<arguments.length&&void 0!==i?i:{},r=Object.assign({},r,{fade_in_time:this.fade_in_time});return nu.makeMesh.call(this,e,t,r)}});var Sh=[0,.33,.66,.99],Ph=function(e,t,i,r,n){for(var o=[{type:"straight",tolerance:n.no_curving?1.8:1.5},{type:"curved"},{type:"straight",tolerance:2.3}],a=0;a<o.length;a++){var s=o[a],l=void 0;if("straight"===s.type?l=new Nh(t,i,r,n,s.tolerance):"curved"===s.type&&!n.no_curving&&2<i.length&&(l=new Oh(e,i,r,n)),l&&!l.throw_away)return l}return!1},zh=function(){function i(e,t){pr(this,i),this.id=bc.nextLabelId(),this.layout=t,this.position=[],this.angle=0,this.offset=t.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=e,this._circles=void 0,this.placed=null}return vr(i,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:wc(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var e=this.getAABB(),t=e.left,i=e.top,r=e.right,n=e.bottom;return kn.pointInTile([t,i])&&kn.pointInTile([r,n])}},{key:"getAABBForSegment",value:function(e,t,i,r){var n,o=this.unit_scale,a=t/2,s=i/2,l=Pr(e,2),u=l[0],c=l[1];0===this.offset[0]&&0===this.offset[1]||(u+=(n=Kl.rot(this.offset,this.angle))[0]*o,c-=n[1]*o);var h=[[Math.cos(r),-Math.sin(r)],[Math.sin(r),Math.cos(r)]],f=Kl.multMatrix(h,[-a,-s]),d=Kl.multMatrix(h,[a,-s]),_=Kl.multMatrix(h,[a,s]),p=Kl.multMatrix(h,[-a,s]);return{left:u+Math.min(f[0],d[0],_[0],p[0]),top:c+Math.max(f[1],d[1],_[1],p[1]),right:u+Math.max(f[0],d[0],_[0],p[0]),bottom:c+Math.min(f[1],d[1],_[1],p[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(e){for(var t=[e[0]],i=0,r=0,n=0,o=t,a=!1,s=1;s<e.length;s++){var l=e[s],u=e[s-1],c=Kl.length(Kl.sub(l,u));l[0]>u[0]?1===n?(t.push(l),r<(i+=c)&&(o=t,r=i,a=!1)):(t=[u,l],r<(i=c)&&(o=t,r=i,a=!1),n=1):l[0]<u[0]?-1===n?(t.unshift(l),r<(i+=c)&&(o=t,r=i,a=!0)):(t=[l,u],r<(i=c)&&(o=t,r=i,a=!0),n=-1):(-1===n?t.unshift(l):(t.push(l),n=1),r<(i+=c)&&(o=t,r=i,a=-1===n))}return[o,a]}}]),i}(),Nh=function(){br(s,zh);var a=Rr(s);function s(e,t,i,r,n){var o;return pr(this,s),(o=a.call(this,i,r)).type="straight",o.size=e,o.throw_away=!o.fit(e,t,r,n),o}return vr(s,[{key:"fit",value:function(e,t,i,r){var n,o=this.unit_scale,a=Pr(zh.splitLineByOrientation(t),2);t=a[0],n=a[1],"number"==typeof i.orientation&&(this.offset[1]+=1.2*(e[1]-i.vertical_buffer),n&&(this.offset[1]*=-1),-1===i.orientation&&(this.offset[1]*=-1));for(var s=Lh(t),l=e[0]*o,u=0;u<t.length-1;u++)for(var c=t[u],h=0,f=0,d=u+1,_=void 0;d<t.length;){var p=t[d-1],g=t[d],v=Ih(p,g);if(d!==u+1&&(h+=function(e,t){var i,r;r=t<e?(i=t,e):(i=e,t);for(;r-i>Math.PI;)i+=2*Math.PI;return Math.abs(r-i)}(v,_)),.1<Math.abs(h))break;if(l/(f+=s[d-1])<r){var m=Kl.mult(Kl.add(c,g),.5);return this.angle=-v,Math.abs(this.angle-Math.PI/2)<.01&&(this.angle=-Math.PI/2,"number"==typeof i.orientation&&(this.offset[1]*=-1)),this.position=m,this.breach=!this.inTileBounds(),!0}_=v,d++}return!1}},{key:"getBoundingCircles",value:function(){var e,t,i,r,n,o,a,s,l,u,c,h,f,d;return this._circles||(e=this.unit_scale,n=-(i=(t=this.size[0]/2*e)*Math.cos(this.angle)),o=-(r=t*Math.sin(this.angle)),a=this.offset[0]*e,s=this.offset[1]*e,u=(l=Pr(this.position,2))[0],c=l[1],c*=-1,a&&(h=[i,r],Kl.normalize(h),h[0]*=a,h[1]*=a,u+=h[0],c+=h[1]),s&&(f=[r,-i],Kl.normalize(f),f[0]*=s,f[1]*=s,u-=f[0],c-=f[1]),i+=u,r+=c,n+=u,o+=c,d=this.size[1]/2*e,this._circles=Rc(i,r,n,o,d)),this._circles}},{key:"getAABB",value:function(){var e,t,i,r,n;return this._aabb||(e=this.unit_scale,t=this.size,i=this.layout.buffer,r=(t[0]+2*i[0])*e,n=(t[1]+2*i[1])*e,this._aabb=this.getAABBForSegment(this.position,r,n,this.angle)),this._aabb}}]),s}(),Oh=function(){br(V,zh);var o=Rr(V);function V(e,t,i,r){var n;return pr(this,V),(n=o.call(this,i,r)).type="curved",n.positions=[],n.angles=[],n._aabbs=[],n.pre_angles=[],n.offsets=[],n.num_segments=e.length,n.sizes=e,n.alt_angles=[],n.alt_pre_angles=[],n.alt_offsets=[],n.throw_away=!n.fit(n.sizes,t,r),n}return vr(V,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:wc(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(e,t,i){var r,n=this.unit_scale,o=Math.max.apply(Math,zr(e.map(function(e){return e[1]}))),a=o*n,s=Pr(zh.splitLineByOrientation(t),2);t=s[0],r=s[1],"number"==typeof i.orientation&&(this.offset[1]+=1.2*(o-i.vertical_buffer),r&&(this.offset[1]*=-1),-1===i.orientation&&(this.offset[1]*=-1));var l=Lh(t),u=e.map(function(e){return e[0]*n}),c=l.reduce(function(e,t){return e+t},0),h=u.reduce(function(e,t){return e+t},0);if(c<h)return!1;var f=t.length-1;if(f<2)return!1;var d=V.curvaturePlacement(t,c,l,h,0,f),_=t[d];if(-1===d||f-d<2)return!1;this.position=_;for(var p=0;p<u.length;p++){this.positions[p]=[],this.offsets[p]=[],this.angles[p]=[],this.pre_angles[p]=[];for(var g=0;g<Sh.length;g++){var v=Sh[g],m=Pr(V.scaleLine(v,t),2),y=m[0],x=m[1],_=y[d],b=V.placeAtIndex(d,y,x,u),w=b.positions,A=b.offsets,T=b.angles,k=b.pre_angles,E=A.map(function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])/n});if(0===v){this.angle=1/T.length*T.reduce(function(e,t){return e+t});for(var M=0;M<w.length;M++){var R=w[M],S=k[M],P=u[M],z=S+T[M];this._aabbs.push(this.getAABBForSegment(R,P,a,z))}}this.positions[p].push(w[p]),this.offsets[p].push(E[p]),this.angles[p].push(T[p]),this.pre_angles[p].push(k[p])}}for(var u=e.slice().reverse().map(function(e){return e[0]*n}),N=0;N<u.length;N++){this.alt_offsets[N]=[],this.alt_angles[N]=[],this.alt_pre_angles[N]=[];for(var O=0;O<Sh.length;O++){var I=Sh[O],L=Pr(V.scaleLine(I,t),2),C=L[0],F=L[1];_=C[d];var D=V.placeAtIndex(d,C,F,u),j=D.offsets,U=D.angles,G=D.pre_angles,B=j.map(function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])/n});0===I&&(this.alt_angle=1/U.length*U.reduce(function(e,t){return e+t})),this.alt_offsets[N].push(B[N]),this.alt_angles[N].push(U[N]),this.alt_pre_angles[N].push(G[N])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var e=[],t=this.unit_scale,i=0;i<this.positions.length;i++){var r=this.sizes[i],n=this.angles[i][0],o=this.positions[i][0],a=r[0]/2*t,s=a*Math.cos(n),l=a*Math.sin(n),u=-s,c=-l,h=Pr(o,2),f=h[0],d=h[1],_=Rc(s+=f,l+=d*=-1,u+=f,c+=d,r[1]/2*t);Array.prototype.push.apply(e,_)}this._circles=e}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var e=1/0,t=-1/0,i=-1/0,r=1/0,n=0;n<this._aabbs.length;n++)var o=this._aabbs[n],e=Math.min(e,o.left),t=Math.max(t,o.top),i=Math.max(i,o.right),r=Math.min(r,o.bottom);this._aabb={left:e,top:t,right:i,bottom:r}}return this._aabb}}],[{key:"curvaturePlacement",value:function(e,t,i,r,n,o){n=n||0,o=o||e.length-1;for(var a=[],s=n+1;s<o;s++){var l=e[s-1],u=e[s],c=e[s+1],h=Kl.perp(u,l),f=Kl.perp(c,u),d=Kl.angleBetween(h,f);1<d&&(d=1/0),a.push(d)}a.push(1/0);for(var _=[],p=[],g=n,v=0,m=0;m<n;m++)v+=i[m];for(;v+r<t;){for(var y=v+r,x=v,b=g,w=0;b<o&&x+i[b]<y&&(w+=a[b])!==1/0;)x+=i[b],b++;if(0===w)return g;var A=w/(b-g);_.push(w),p.push(A),v+=i[g],g++}if(0===_.length)return-1;var T=Math.min.apply(null,_),k=p[_.indexOf(T)];return T<1.3&&k<.4?_.indexOf(T):-1}},{key:"scaleLine",value:function(n,o){var a=[o[0]],s=[];return o.forEach(function(e,t){var i,r;t!==o.length-1&&(i=Kl.sub(o[t+1],o[t]),r=Kl.mult(i,1+n),a.push(Kl.add(a[t],r)),s.push(Kl.length(r)))}),[a,s]}},{key:"placeAtIndex",value:function(e,t,i,r){var n=t[e],o=Pr(V.getIndicesAndOffsets(e,i,r),2),a=o[0],s=o[1],l=V.getPositionsFromIndicesAndOffsets(t,a,s),u=Pr(V.getAnglesFromIndicesAndOffsets(n,a,t,l),3);return{positions:l,offsets:u[0],angles:u[1],pre_angles:u[2]}}},{key:"getIndicesAndOffsets",value:function(e,t,i){for(var r=i.length,n=[],o=[],a=0,s=0,l=0;a<r;){for(var u=i[a];a<r&&s+.5*u<=l+t[e];){var c=s-l+.5*u;o.push(c),n.push(e),s+=u,u=i[++a]}l+=t[e],e++}return[n,o]}},{key:"getPositionsFromIndicesAndOffsets",value:function(e,t,i){for(var r=[],n=0;n<t.length;n++){var o=t[n],a=i[n],s=Ih(e[o],e[o+1]),l=Kl.rot([a,0],s),u=Kl.add(e[o],l);r.push(u)}return r}},{key:"getAnglesFromIndicesAndOffsets",value:function(e,t,i,r){for(var n,o,a=[],s=[],l=[],u=0;u<r.length;u++){var c,h,f=r[u],d=t[u],_=Kl.sub(f,e),p=-Kl.angle(_),g=(n=i[d],o=i[d+1],-Ih(n,o))-p;0<u&&(c=a[u-1],h=s[u-1],Math.abs(p-c)>Math.PI&&(p+=c<p?-2*Math.PI:2*Math.PI),Math.abs(h-g)>Math.PI&&(g+=h<g?-2*Math.PI:2*Math.PI)),a.push(p),s.push(g),l.push(_)}return[l,a,s]}}]),V}();function Ih(e,t){var i=Kl.sub(t,e);return Kl.angle(i)}function Lh(e){for(var t=[],i=0;i<e.length-1;i++){var r=e[i],n=e[i+1],o=Math.hypot(r[0]-n[0],r[1]-n[1]);t.push(o)}return t}var Ch=Object.create(Rh);Object.assign(Ch,{name:"text",super:Rh,built_in:!0,init:function(e){var t=0<arguments.length&&void 0!==e?e:{};nu.init.call(this,t),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(e,t){this.super.makeVertexTemplate.apply(this,arguments);var i=t.vertex_data.vertex_layout;return this.fillVertexTemplate(i,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(i,"a_offsets",0,{size:4}),this.fillVertexTemplate(i,"a_angles",0,{size:4}),this.fillVertexTemplate(i,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(i,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(i,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(t,e,i){var r=this,n=i.tile,o=t.geometry.type;e.can_articulate="LineString"===o||"MultiLineString"===o,e.supersample_text="LineString"===o||"MultiLineString"===o;var a=this.parseTextFeature(t,e,i,n);a&&(a instanceof Array?a.forEach(function(e){e.feature=t,e.context=i,e.layout.vertex=!1,r.queueFeature(e,n)}):(a.feature=t,a.context=i,a.layout.vertex=!1,this.queueFeature(a,n)),Ro.addStyle(this.name,n.id))},endData:function(n){var o=this,e=this.queues[n.id];return delete this.queues[n.id],this.collideAndRenderTextLabels(n,this.name,e).then(function(e){var t=e.labels,i=e.texts;return t&&i&&(o.texts[n.id]=i,t.forEach(function(e){var t=e.text_settings_key,i=o.texts[n.id][t]&&o.texts[n.id][t][e.text],r=o.feature_style;r.label=e.label,e.label.text_data={text_info:i,text_settings_key:t,text:e.text},r.label_texture=o.textureManager.default,i.text_settings.can_articulate?(r.size={},"straight"===e.label.type?r.size.straight=i.size.logical_size:r.size.curved=i.segment_sizes.map(function(e){return e.logical_size})):r.size=i.size.logical_size,nu.addFeature.call(o,e.feature,e.draw,e.context)})),o.freeText(n),nu.endData.call(o,n).then(function(e){if(e){for(var t in e.meshes)e.meshes[t].uniforms.u_apply_color_blocks=!0;n.mesh_data[o.name]=e}return e})})},_preprocess:function(e){return this.preprocessText(e)},buildTextLabels:function(e,t){for(var i=[],r=0;r<t.length;r++){var n,o=t[r],a=this.texts[e.id][o.text_settings_key][o.text],s=void 0;o.layout.vertical_buffer=a.vertical_buffer,s=a.text_settings.can_articulate?(n=a.segment_sizes.map(function(e){return e.collision_size}),o.layout.no_curving=a.no_curving,this.buildLabels(n,o.feature.geometry,o.layout,a.size.collision_size)):this.buildLabels(a.size.collision_size,o.feature.geometry,o.layout);for(var l=0;l<s.length;l++){var u=Object.create(o);u.label=s[l],i.push(u)}}return i},buildLabels:function(e,t,i,r){var n,o,a="Point"!==t.type,s=[];if("LineString"===t.type)Array.prototype.push.apply(s,this.buildLineLabels(t.coordinates,e,a,i,r));else if("MultiLineString"===t.type)for(var l=t.coordinates,u=0;u<l.length;++u)Array.prototype.push.apply(s,this.buildLineLabels(l[u],e,a,i,r));else if("Point"===t.type)s.push(new Sc(t.coordinates,e,a,i));else if("MultiPoint"===t.type)for(var c=t.coordinates,h=0;h<c.length;++h)s.push(new Sc(c[h],e,a,i));else{"Polygon"===t.type?(n=Jr.centroid(t.coordinates),s.push(new Sc(n,e,a,i))):"MultiPolygon"===t.type&&(o=Jr.multiCentroid(t.coordinates),s.push(new Sc(o,e,a,i)))}return s},buildLineLabels:function(e,t,i,r,n){var o,a=[],s=Math.min(r.subdiv,e.length-1);if(1<s)for(var l=(e.length-1)/s,u=0;u<s;u++){var c=Math.floor(u*l),h=Math.floor((u+1)*l)+1,f=e.slice(c,h),d=Ph(t,n,f,i,r);d&&a.push(d)}return a.length<s&&((o=Ph(t,n,e,i,r))&&a.push(o)),a},vertexLayoutForMeshVariant:function(){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:ou.SHORT,normalized:!1},{name:"a_shape",size:4,type:ou.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:ou.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:ou.SHORT,normalized:!1},{name:"a_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:ou.SHORT,normalized:!1},{name:"a_offsets",size:4,type:ou.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:ou.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:ou.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:ou.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:ou.SHORT,normalized:!1}],this.vertex_layout=new du(e)),this.vertex_layout},meshVariantTypeForDraw:Rh.meshVariantTypeForDraw}),Ch.texture_id=0;var Fh=Object.create(ju);Object.assign(Fh,{name:"raster",super:ju,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(e){return e.color=e.color||mo.defaults.color,this.super._preprocess.apply(this,arguments)}});var Dh=Object.create(Rh);Object.assign(Dh,{name:"custom_icons",collision:!1,init:function(e){var t=0<arguments.length&&void 0!==e?e:{};Rh.init.call(this,t)},loadTexture:function(e,t,i){var r,n=e.width,o=e.height,a=e.items,s=document.createElement("canvas"),l=kn.device_pixel_ratio,u=this.sources[t],c={sprites:{}};if(s.width=n*l,s.height=o*l,u){var h,f=a.length,d=s.getContext("2d");for(d.scale(l,l);h=a[--f];){var _,p=u.getIconBitmapByObjectId(h.meta.objectId,h.meta.id);p&&((_=cl(p))?An("error",_):(d.drawImage(p,h.x,h.y,h.width,h.height),c.sprites[h.meta.id]=[h.x,h.y,h.width,h.height]))}}return c.element=s,(r=this.textureManager.create(this.gl,i,c)).retain(),r.loading.then(function(e){return e.name})},buildRasterTextures:function(e,t){return un.postMessage(this.main_thread_target+".loadTexture",e.rasters,e.source,e.texture_name).then(function(e){return t.textures.push(e),t})},addFeature:function(e,t,i){var r=i.tile.rasters,n={};r.items.forEach(function(e){n[e.meta.id]=[e.x,e.y,e.width,e.height]});var o="".concat(i.tile.source,"_dyn_").concat(i.tile.coords.key,"_").concat(this.generation,"_").concat(i.tile.id);t.texture=i.tile.texture_name=o;var a=Object.assign({},jh,{name:o,width:r.width,height:r.height,sprites:n,manager:this.textureManager});zo.prototype.calculateSprites.apply(a),this.textureManager.textures[o]=a,Rh.addFeature.apply(this,arguments),delete this.textureManager.textures[o]}});var jh={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},Uh=Object.create(ju);Object.assign(Uh,{name:"overlays",super:ju,init:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.selection=t.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!ln.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var e=!1;for(var t in this.sources)if(this.sources[t]instanceof _l){e=!0;break}return!!e&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",ru,"Raster"),!0)},loadTextures:function(a,e){var s,l,u,c=this.sources[e],t=a.name;if(a.overlays_config.forEach(function(e){var t,i=e.texcoords,r=e.id,n=c.getMapObjectById(r),o=n.getBitmap();o&&((t=cl(o=hl(o,o.width,o.height)))?An("error",t):(s||((s=document.createElement("canvas")).width=a.width,s.height=a.height,l=s.getContext("2d")),l.save(),l.globalAlpha=n.getOpacity(),i.forEach(function(e){return l.drawImage(o,e[0],e[1],e[2],e[3])}),l.restore(),u=!0))}),u){a.element=s;var i={};return i[t]=a,this.super.loadTextures.call(this,i)}var r=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:r.name,width:r.width,height:r.height,loaded:r.loaded}])},buildRasterTextures:function(e,i){var t=this.sources[e.source].tileTexture(e);return t?un.postMessage(this.main_thread_target+".loadTextures",t,e.source).then(function(e){if(!e||e.length<1)return i;if(e.some(function(e){return!e.loaded}))return null;var t=e[0].name;return i.uniforms=i.uniforms||{},i.textures=i.textures||[],i.uniforms.u_raster=t,i.uniforms.u_raster_offset=[0,0,1],i.textures.push(t),i}):Promise.resolve(i)}});var Gh=Object.create(nu),Bh=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(Gh,{name:"skybox",built_in:!0,vertex_shader_src:"uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",fragment_shader_src:"varying vec4 v_color;void main(void){gl_FragColor=v_color;}",selection:!1,blend:"inlay",blend_order:1,init:function(){nu.init.apply(this,arguments),this.selection=!1},_preprocess:function(e){return e.color={top:mo.createColorPropertyCache(e.color.zenith),bottom:mo.createColorPropertyCache(e.color.horizon),fog:mo.createColorPropertyCache(e.color.fog)},e},vertexLayoutForMeshVariant:function(){var e;return this.vertex_layout||(e=[{name:"a_position",size:2,type:ou.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:ou.FLOAT,normalized:!0},{name:"a_color",size:4,type:ou.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:ou.FLOAT,normalized:!0}],this.vertex_layout=new du(e)),this.vertex_layout},makeVertexTemplate:function(){var e=0;return this.vertex_template[e++]=0,this.vertex_template[1]=0,this.vertex_template},parseFeature:function(e,t,i){var r=this.feature_style;return t.color&&t.color.top&&t.color.bottom&&(r.color_top=this.parseColor(t.color.top,i),r.color_bottom=this.parseColor(t.color.bottom,i),r.color_fog=this.parseColor(t.color.fog||"white",i),Array.isArray(r.color_fog)&&(r.color_fog=r.color_fog.slice(),r.color_fog[3]=0)),r},buildGeometry:function(e,t,i){for(var r=this.makeVertexTemplate(t),n=i.vertex_data,o=i.vertex_data.vertex_layout,a=n.vertex_layout.index.a_position,s={top:t.color_top,bottom:t.color_bottom},l={top:t.color_bottom,bottom:t.color_fog},u=0,c=Bh.length-1;u<c;u+=2){r[a+0]=Bh[u],r[a+1]=Bh[u+1];var h=u<12,f=0<Bh[u+1],d=h?s:l;this.fillVertexTemplate(o,"a_is_sky",h?1:0,{size:1}),this.fillVertexTemplate(o,"a_is_top",f?1:0,{size:1}),this.fillVertexTemplate(o,"a_color",Kl.mult(f?d.top:d.bottom,255),{size:4}),n.addVertex(r)}return 4}});var Vh=function(){function e(){pr(this,e),this.styles={},this.base_styles={},this.register(Object.create(ju)),this.register(Object.create(ac)),this.register(Object.create(dc)),this.register(Object.create(Rh)),this.register(Object.create(Ch)),this.register(Object.create(Fh)),this.register(Object.create(Dh)),this.register(Object.create(Uh)),this.register(Object.create(Gh))}return vr(e,[{key:"init",value:function(){Vl.removeBlock("global"),Vl.removeBlock("setup"),Vl.addBlock("global","#ifdef TANGRAM_VERTEX_SHADER\nvec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}\n#endif\nvec4 worldPosition(){return v_world_position;}\n#ifdef TANGRAM_VERTEX_SHADER\nvec4 wrapWorldPosition(vec4 world_position){\n#if defined(TANGRAM_WORLD_POSITION_WRAP)\nvec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;\n#endif\nreturn world_position;}\n#endif\n#if defined(TANGRAM_VERTEX_SHADER)\nvec3 worldNormal(){return TANGRAM_NORMAL;}\n#elif defined(TANGRAM_FRAGMENT_SHADER)\nvec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}\n#endif\n"),Vl.addBlock("global","void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}"),Vl.addBlock("global","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nattribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;\n#endif\n"),Vl.addBlock("global","uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);\n#ifdef TANGRAM_VIEW_PAN_SNAP_RATE\nposition.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));\n#else\nposition.xy=position_snap;\n#endif\n}"),Vl.replaceBlock("utils","#ifndef UTILS\n#define UTILS\nbool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}\n#endif\n"),Vl.replaceBlock("setup","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nif(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;\n#endif\n"),Vl.defines.TANGRAM_EPSILON=1e-5,Vl.defines.TANGRAM_LAYER_DELTA=1/16384,Vl.defines.TANGRAM_TILE_SCALE="vec3(".concat(Jr.tile_scale,"., ").concat(Jr.tile_scale,"., u_meters_per_pixel * ").concat(Jr.tile_size,".)"),Vl.defines.TANGRAM_HEIGHT_SCALE=Jr.height_scale,Vl.defines.TANGRAM_ALPHA_TEST=.1,ac.dash_textures={}}},{key:"destroy",value:function(i){var r=this;Object.keys(this.styles).forEach(function(e){var t=r.styles[e];t.gl===i&&(An("trace","StyleManager.destroy: destroying render style ".concat(t.name)),t.base&&r.remove(t.name),t.destroy())})}},{key:"register",value:function(e){this.styles[e.name]=e,this.base_styles[e.name]=e}},{key:"remove",value:function(e){delete this.styles[e]}},{key:"mix",value:function(t,i){if(t.mixed)return t;t.mixed={};var e=[];t.mix&&(Array.isArray(t.mix)?e.push.apply(e,zr(t.mix)):e.push(t.mix),(e=e.map(function(e){return i[e]}).filter(function(e){return e&&e!==t})).forEach(function(e){return t.mixed[e.name]=!0})),e.push(t),t.animated=e.some(function(e){return e&&e.animated}),t.texcoords=e.some(function(e){return e&&e.texcoords}),t.base=e.map(function(e){return e.base}).filter(function(e){return e}).pop(),t.lighting=e.map(function(e){return e.lighting}).filter(function(e){return null!=e}).pop(),t.texture=e.map(function(e){return e.texture}).filter(function(e){return e}).pop(),t.raster=e.map(function(e){return e.raster}).filter(function(e){return null!=e}).pop(),t.dash=e.map(function(e){return e.dash}).filter(function(e){return null!=e}).pop(),t.dash_background_color=e.map(function(e){return e.dash_background_color}).filter(function(e){return null!=e}).pop(),e.some(function(e){return e.hasOwnProperty("blend")&&e.blend})&&(t.blend=e.map(function(e){return e.hasOwnProperty("blend")&&e.blend}).filter(function(e){return e}).pop()),t.blend_order=e.map(function(e){return e.blend_order}).filter(function(e){return null!=e}).pop(),t.defines=Object.assign.apply(Object,[{}].concat(zr(e.map(function(e){return e.defines}).filter(function(e){return e})))),t.material=Object.assign.apply(Object,[{}].concat(zr(e.map(function(e){return e.material}).filter(function(e){return e}))));var r=e.map(function(e){return e.draw}).filter(function(e){return e});return 0<r.length&&(t.draw=ul.apply(void 0,[{}].concat(zr(r)))),this.mixShaders(t,i,e),t}},{key:"mixShaders",value:function(e,i,t){var a={},r=t.map(function(e){return e.shaders}).filter(function(e){return e});if(a.defines=Object.assign.apply(Object,[{}].concat(zr(r.map(function(e){return e.defines}).filter(function(e){return e})))),a.uniforms={},a._uniforms=e.shaders&&e.shaders.uniforms||{},a._uniform_scopes={},t.filter(function(e){return e.shaders&&e.shaders.uniforms}).forEach(function(e){for(var t in e.shaders.uniforms)!function(t){a._uniform_scopes[t]=e.name,Object.defineProperty(a.uniforms,t,{enumerable:!0,configurable:!0,get:function(){return void 0!==a._uniforms[t]?a._uniforms[t]:i[a._uniform_scopes[t]].shaders.uniforms!==a.uniforms?i[a._uniform_scopes[t]].shaders.uniforms[t]:void 0},set:function(e){a._uniforms[t]=e}})}(t)}),a.extensions=Object.keys(r.map(function(e){return e.extensions}).filter(function(e){return e}).reduce(function(t,e){return"string"==typeof e?t[e]=!0:e.forEach(function(e){return t[e]=!0}),t},{})||{}),e.shaders&&e.shaders.blocks)for(var n in e.shaders.block_scopes=e.shaders.block_scopes||{},e.shaders.blocks){var o,s=e.shaders.blocks[n];e.shaders.block_scopes[n]=e.shaders.block_scopes[n]||[],Array.isArray(s)?(o=e.shaders.block_scopes[n]).push.apply(o,zr(s.map(function(){return e.name}))):e.shaders.block_scopes[n].push(e.name)}var l={};return r.forEach(function(e){if(e.blocks){a.blocks=a.blocks||{},a.block_scopes=a.block_scopes||{};var t={};for(var i in e.blocks){var r=e.blocks[i],n=e.block_scopes[i];a.blocks[i]=a.blocks[i]||[],a.block_scopes[i]=a.block_scopes[i]||[],r=Array.isArray(r)?r:[r],n=Array.isArray(n)?n:[n];for(var o=0;o<r.length;o++)l[n[o]]||(t[n[o]]=!0,a.blocks[i].push(r[o]),a.block_scopes[i].push(n[o]))}Object.assign(l,t)}}),Object.assign(e.mixed,l),e.shaders=a,e}},{key:"create",value:function(e,t,i){var r=2<arguments.length&&void 0!==i?i:{},n=ul({},t);return n.name=e,(n=this.mix(n,r)).base&&this.base_styles[n.base]?this.styles[e]=n=Object.assign(Object.create(this.base_styles[n.base]),n):n.base=null,n}},{key:"build",value:function(i){var r=this,e=Object.keys(i).sort(function(e,t){return r.inheritanceDepth(e,i)-r.inheritanceDepth(t,i)});for(var t in this.styles)this.base_styles[t]?this.styles[t].reset():delete this.styles[t];var n={};return e.forEach(function(e){n[e]=r.create(e,i[e],n)}),this.styles}},{key:"initStyles",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};for(var i in this.styles)this.styles[i].init(t)}},{key:"inheritanceDepth",value:function(t,i){for(var r=this,e=0;;){var n=i[t];if(!n)break;if(!n.mix)break;if(e++,Array.isArray(n.mix)){e+=Math.max.apply(Math,zr(n.mix.map(function(e){if(t!==e)return r.inheritanceDepth(e,i)})));break}if(t===n.mix)break;t=n.mix}return e}}]),e}();function qh(e){return null==e}var Hh={isNothing:qh,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:qh(e)?[]:[e]},repeat:function(e,t){for(var i="",r=0;r<t;r+=1)i+=e;return i},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var i,r,n,o;if(t)for(i=0,r=(o=Object.keys(t)).length;i<r;i+=1)e[n=o[i]]=t[n];return e}};function Yh(e,t){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name="YAMLException",this.reason=e,this.mark=t,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}((Yh.prototype=Object.create(Error.prototype)).constructor=Yh).prototype.toString=function(e){var t=this.name+": ";return t+=this.reason||"(unknown reason)",!e&&this.mark&&(t+=" "+this.mark.toString()),t};var Xh=Yh;function Wh(e,t,i,r,n){this.name=e,this.buffer=t,this.position=i,this.line=r,this.column=n}Wh.prototype.getSnippet=function(e,t){var i,r,n,o,a;if(!this.buffer)return null;for(e=e||4,t=t||75,i="",r=this.position;0<r&&-1==="\0\r\n\x85\u2028\u2029".indexOf(this.buffer.charAt(r-1));)if(--r,this.position-r>t/2-1){i=" ... ",r+=5;break}for(n="",o=this.position;o<this.buffer.length&&-1==="\0\r\n\x85\u2028\u2029".indexOf(this.buffer.charAt(o));)if((o+=1)-this.position>t/2-1){n=" ... ",o-=5;break}return a=this.buffer.slice(r,o),Hh.repeat(" ",e)+i+a+n+"\n"+Hh.repeat(" ",e+this.position-r+i.length)+"^"},Wh.prototype.toString=function(e){var t,i="";return this.name&&(i+='in "'+this.name+'" '),i+="at line "+(this.line+1)+", column "+(this.column+1),e||(t=this.getSnippet())&&(i+=":\n"+t),i};var Zh=Wh,Kh=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],$h=["scalar","sequence","mapping"];var Jh=function(t,e){var i,r;if(e=e||{},Object.keys(e).forEach(function(e){if(-1===Kh.indexOf(e))throw new Xh('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(e){return e},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=(i=e.styleAliases||null,r={},null!==i&&Object.keys(i).forEach(function(t){i[t].forEach(function(e){r[String(e)]=t})}),r),-1===$h.indexOf(this.kind))throw new Xh('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function Qh(e,t,r){var n=[];return e.include.forEach(function(e){r=Qh(e,t,r)}),e[t].forEach(function(i){r.forEach(function(e,t){e.tag===i.tag&&n.push(t)}),r.push(i)}),r.filter(function(e,t){return-1===n.indexOf(t)})}function ef(e){this.include=e.include||[],this.implicit=e.implicit||[],this.explicit=e.explicit||[],this.implicit.forEach(function(e){if(e.loadKind&&"scalar"!==e.loadKind)throw new Xh("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=Qh(this,"implicit",[]),this.compiledExplicit=Qh(this,"explicit",[]),this.compiledTypeMap=function(){var e,t,i={};function r(e){i[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return i}(this.compiledImplicit,this.compiledExplicit)}ef.DEFAULT=null,ef.create=function(e,t){var i,r;switch(arguments.length){case 1:i=ef.DEFAULT,r=e;break;case 2:i=e,r=t;break;default:throw new Xh("Wrong number of arguments for Schema.create function")}if(i=Hh.toArray(i),r=Hh.toArray(r),!i.every(function(e){return e instanceof ef}))throw new Xh("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!r.every(function(e){return e instanceof Jh}))throw new Xh("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new ef({include:i,explicit:r})};var tf=ef,rf=new tf({explicit:[new Jh("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new Jh("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new Jh("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]});var nf=new Jh("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"});var of=new Jh("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});var af=new Jh("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,i,r,n,o=e.length,a=0,s=!1;if(!o)return!1;if("-"!==(t=e[a])&&"+"!==t||(t=e[++a]),"0"===t){if(a+1===o)return!0;if("b"===(t=e[++a])){for(a++;a<o;a++)if("_"!==(t=e[a])){if("0"!==t&&"1"!==t)return!1;s=!0}return s}if("x"===t){for(a++;a<o;a++)if("_"!==(t=e[a])){if(!(48<=(r=e.charCodeAt(a))&&r<=57||65<=r&&r<=70||97<=r&&r<=102))return!1;s=!0}return s}for(;a<o;a++)if("_"!==(t=e[a])){if(!(48<=(i=e.charCodeAt(a))&&i<=55))return!1;s=!0}return s}for(;a<o;a++)if("_"!==(t=e[a])){if(":"===t)break;if(!(48<=(n=e.charCodeAt(a))&&n<=57))return!1;s=!0}return!!s&&(":"!==t||/^(:[0-5]?[0-9])+$/.test(e.slice(a)))},construct:function(e){var t,i,r=e,n=1,o=[];return-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),"-"!==(t=r[0])&&"+"!==t||("-"===t&&(n=-1),t=(r=r.slice(1))[0]),"0"===r?0:"0"===t?"b"===r[1]?n*parseInt(r.slice(2),2):"x"===r[1]?n*parseInt(r,16):n*parseInt(r,8):-1!==r.indexOf(":")?(r.split(":").forEach(function(e){o.unshift(parseInt(e,10))}),r=0,i=1,o.forEach(function(e){r+=e*i,i*=60}),n*r):n*parseInt(r,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!Hh.isNegativeZero(e)},represent:{binary:function(e){return"0b"+e.toString(2)},octal:function(e){return"0"+e.toString(8)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return"0x"+e.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),sf=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var lf=/^[-+]?[0-9]+e/;var uf=new tf({include:[rf],implicit:[nf,of,af,new Jh("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!!sf.test(e)},construct:function(e){var t,i=e.replace(/_/g,"").toLowerCase(),r="-"===i[0]?-1:1,n=[];return 0<="+-".indexOf(i[0])&&(i=i.slice(1)),".inf"===i?1==r?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===i?NaN:0<=i.indexOf(":")?(i.split(":").forEach(function(e){n.unshift(parseFloat(e,10))}),i=0,t=1,n.forEach(function(e){i+=e*t,t*=60}),r*i):r*parseFloat(i,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||Hh.isNegativeZero(e))},represent:function(e,t){var i;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Hh.isNegativeZero(e))return"-0.0";return i=e.toString(10),lf.test(i)?i.replace("e",".e"):i},defaultStyle:"lowercase"})]}),cf=new tf({include:[uf]}),hf=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$");var ff=new Jh("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&null!==hf.exec(e)},construct:function(e){var t,i,r,n,o,a,s,l=0,u=null,c=hf.exec(e);if(null===c)throw new Error("Date resolve error");if(t=+c[1],i=c[2]-1,r=+c[3],!c[4])return new Date(Date.UTC(t,i,r));if(n=+c[4],o=+c[5],a=+c[6],c[7]){for(l=c[7].slice(0,3);l.length<3;)l+="0";l=+l}return c[9]&&(u=6e4*(60*+c[10]+ +(c[11]||0)),"-"===c[9]&&(u=-u)),s=new Date(Date.UTC(t,i,r,n,o,a,l)),u&&s.setTime(s.getTime()-u),s},instanceOf:Date,represent:function(e){return e.toISOString()}});var df=new Jh("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),_f=hs.Buffer,pf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var gf=new Jh("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;for(var t,i=0,r=e.length,n=pf,o=0;o<r;o++)if(!(64<(t=n.indexOf(e.charAt(o))))){if(t<0)return!1;i+=6}return i%8==0},construct:function(e){for(var t,i=e.replace(/[\r\n=]/g,""),r=i.length,n=pf,o=0,a=[],s=0;s<r;s++)s%4==0&&s&&(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)),o=o<<6|n.indexOf(i.charAt(s));return 0==(t=r%4*6)?(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)):18==t?(a.push(o>>10&255),a.push(o>>2&255)):12==t&&a.push(o>>4&255),_f?new _f(a):a},predicate:function(e){return _f&&_f.isBuffer(e)},represent:function(e){for(var t,i="",r=0,n=e.length,o=pf,a=0;a<n;a++)a%3==0&&a&&(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]),r=(r<<8)+e[a];return 0==(t=n%3)?(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]):2==t?(i+=o[r>>10&63],i+=o[r>>4&63],i+=o[r<<2&63],i+=o[64]):1==t&&(i+=o[r>>2&63],i+=o[r<<4&63],i+=o[64],i+=o[64]),i}}),vf=Object.prototype.hasOwnProperty,mf=Object.prototype.toString;var yf=new Jh("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;for(var t,i,r,n=[],o=e,a=0,s=o.length;a<s;a+=1){if(t=o[a],r=!1,"[object Object]"!==mf.call(t))return!1;for(i in t)if(vf.call(t,i)){if(r)return!1;r=!0}if(!r)return!1;if(-1!==n.indexOf(i))return!1;n.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),xf=Object.prototype.toString;var bf=new Jh("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;for(var t,i,r=e,n=new Array(r.length),o=0,a=r.length;o<a;o+=1){if(t=r[o],"[object Object]"!==xf.call(t))return!1;if(1!==(i=Object.keys(t)).length)return!1;n[o]=[i[0],t[i[0]]]}return!0},construct:function(e){if(null===e)return[];for(var t,i,r=e,n=new Array(r.length),o=0,a=r.length;o<a;o+=1)t=r[o],i=Object.keys(t),n[o]=[i[0],t[i[0]]];return n}}),wf=Object.prototype.hasOwnProperty;var Af=new tf({include:[cf],implicit:[ff,df],explicit:[gf,yf,bf,new Jh("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,i=e;for(t in i)if(wf.call(i,t)&&null!==i[t])return!1;return!0},construct:function(e){return null!==e?e:{}}})]});var Tf=new Jh("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(e){return void 0===e},represent:function(){return""}});var kf=new Jh("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(e){if(null===e)return!1;if(0===e.length)return!1;var t=e,i=/\/([gim]*)$/.exec(e),r="";if("/"===t[0]){if(i&&(r=i[1]),3<r.length)return!1;if("/"!==t[t.length-r.length-1])return!1}return!0},construct:function(e){var t=e,i=/\/([gim]*)$/.exec(e),r="";return"/"===t[0]&&(i&&(r=i[1]),t=t.slice(1,t.length-r.length-1)),new RegExp(t,r)},predicate:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},represent:function(e){var t="/"+e.source+"/";return e.global&&(t+="g"),e.multiline&&(t+="m"),e.ignoreCase&&(t+="i"),t}});try{var Ef=function(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}()}catch(e){"undefined"!=typeof window&&(Ef=window.esprima)}var Mf=new Jh("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(e){if(null===e)return!1;try{var t="("+e+")",i=Ef.parse(t,{range:!0});return"Program"!==i.type||1!==i.body.length||"ExpressionStatement"!==i.body[0].type||"FunctionExpression"!==i.body[0].expression.type?!1:!0}catch(e){return!1}},construct:function(e){var t,i="("+e+")",r=Ef.parse(i,{range:!0}),n=[];if("Program"!==r.type||1!==r.body.length||"ExpressionStatement"!==r.body[0].type||"FunctionExpression"!==r.body[0].expression.type)throw new Error("Failed to resolve function");return r.body[0].expression.params.forEach(function(e){n.push(e.name)}),t=r.body[0].expression.body.range,new Function(n,i.slice(t[0]+1,t[1]-1))},predicate:function(e){return"[object Function]"===Object.prototype.toString.call(e)},represent:function(e){return e.toString()}}),Rf=tf.DEFAULT=new tf({include:[Af],explicit:[Tf,kf,Mf]}),Sf=Object.prototype.hasOwnProperty,Pf=1,zf=2,Nf=3,Of=4,If=1,Lf=2,Cf=3,Ff=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Df=/[\x85\u2028\u2029]/,jf=/[,\[\]\{\}]/,Uf=/^(?:!|!!|![a-z\-]+!)$/i,Gf=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Bf(e){return 10===e||13===e}function Vf(e){return 9===e||32===e}function qf(e){return 9===e||32===e||10===e||13===e}function Hf(e){return 44===e||91===e||93===e||123===e||125===e}function Yf(e){return 48===e?"\0":97===e?"\x07":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"\x1b":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"\x85":95===e?"\xa0":76===e?"\u2028":80===e?"\u2029":""}for(var Xf=new Array(256),Wf=new Array(256),Zf=0;Zf<256;Zf++)Xf[Zf]=Yf(Zf)?1:0,Wf[Zf]=Yf(Zf);function Kf(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Rf,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function $f(e,t){return new Xh(t,new Zh(e.filename,e.input,e.position,e.line,e.position-e.lineStart))}function Jf(e,t){throw $f(e,t)}function Qf(e,t){e.onWarning&&e.onWarning.call(null,$f(e,t))}var ed={YAML:function(e,t,i){var r,n,o;null!==e.version&&Jf(e,"duplication of %YAML directive"),1!==i.length&&Jf(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&Jf(e,"ill-formed argument of the YAML directive"),n=parseInt(r[1],10),o=parseInt(r[2],10),1!==n&&Jf(e,"unacceptable YAML version of the document"),e.version=i[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&Qf(e,"unsupported YAML version of the document")},TAG:function(e,t,i){var r,n;2!==i.length&&Jf(e,"TAG directive accepts exactly two arguments"),r=i[0],n=i[1],Uf.test(r)||Jf(e,"ill-formed tag handle (first argument) of the TAG directive"),Sf.call(e.tagMap,r)&&Jf(e,'there is a previously declared suffix for "'+r+'" tag handle'),Gf.test(n)||Jf(e,"ill-formed tag prefix (second argument) of the TAG directive"),e.tagMap[r]=n}};function td(e,t,i,r){var n,o,a,s;if(t<i){if(s=e.input.slice(t,i),r)for(n=0,o=s.length;n<o;n+=1)9===(a=s.charCodeAt(n))||32<=a&&a<=1114111||Jf(e,"expected valid JSON character");else Ff.test(s)&&Jf(e,"the stream contains non-printable characters");e.result+=s}}function id(e,t,i,r){var n,o,a,s;for(Hh.isObject(i)||Jf(e,"cannot merge mappings; the provided source object is unacceptable"),a=0,s=(n=Object.keys(i)).length;a<s;a+=1)o=n[a],Sf.call(t,o)||(t[o]=i[o],r[o]=!0)}function rd(e,t,i,r,n,o){var a,s;if(n=String(n),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(a=0,s=o.length;a<s;a+=1)id(e,t,o[a],i);else id(e,t,o,i);else e.json||Sf.call(i,n)||!Sf.call(t,n)||Jf(e,"duplicated mapping key"),t[n]=o,delete i[n];return t}function nd(e){var t=e.input.charCodeAt(e.position);10===t?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):Jf(e,"a line break is expected"),e.line+=1,e.lineStart=e.position}function od(e,t,i){for(var r=0,n=e.input.charCodeAt(e.position);0!==n;){for(;Vf(n);)n=e.input.charCodeAt(++e.position);if(t&&35===n)for(;10!==(n=e.input.charCodeAt(++e.position))&&13!==n&&0!==n;);if(!Bf(n))break;for(nd(e),n=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===n;)e.lineIndent++,n=e.input.charCodeAt(++e.position)}return-1!==i&&0!==r&&e.lineIndent<i&&Qf(e,"deficient indentation"),r}function ad(e){var t=e.position,i=e.input.charCodeAt(t);return 45!==i&&46!==i||i!==e.input.charCodeAt(t+1)||i!==e.input.charCodeAt(t+2)||(t+=3,0!==(i=e.input.charCodeAt(t))&&!qf(i))?void 0:1}function sd(e,t){1===t?e.result+=" ":1<t&&(e.result+=Hh.repeat("\n",t-1))}function ld(e,t){var i,r,n,o,a,s,l,u,c,h=e.input.charCodeAt(e.position);if(34===h){for(e.kind="scalar",e.result="",e.position++,i=r=e.position;0!==(h=e.input.charCodeAt(e.position));){if(34===h)return td(e,i,e.position,!0),e.position++,1;if(92===h){if(td(e,i,e.position,!0),Bf(h=e.input.charCodeAt(++e.position)))od(e,!1,t);else if(h<256&&Xf[h])e.result+=Wf[h],e.position++;else if(0<(a=120===(c=h)?2:117===c?4:85===c?8:0)){for(n=a,o=0;0<n;n--)h=e.input.charCodeAt(++e.position),u=void 0,0<=(a=48<=(l=h)&&l<=57?l-48:97<=(u=32|l)&&u<=102?u-97+10:-1)?o=(o<<4)+a:Jf(e,"expected hexadecimal character");e.result+=(s=o)<=65535?String.fromCharCode(s):String.fromCharCode(55296+(s-65536>>10),56320+(s-65536&1023)),e.position++}else Jf(e,"unknown escape sequence");i=r=e.position}else Bf(h)?(td(e,i,r,!0),sd(e,od(e,!1,t)),i=r=e.position):e.position===e.lineStart&&ad(e)?Jf(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Jf(e,"unexpected end of the stream within a double quoted scalar")}}function ud(e,t){var i,r,n=e.tag,o=e.anchor,a=[],s=!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),r=e.input.charCodeAt(e.position);0!==r&&45===r&&qf(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,od(e,!0,-1)&&e.lineIndent<=t)a.push(null),r=e.input.charCodeAt(e.position);else if(i=e.line,cd(e,t,Nf,!1,!0),a.push(e.result),od(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===i||e.lineIndent>t)&&0!==r)Jf(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=n,e.anchor=o,e.kind="sequence",e.result=a,!0)}function cd(e,t,i,r,n){var o,a,s,l,u,c,h,f,d=1,_=!1,p=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=a=s=Of===i||Nf===i,r&&od(e,!0,-1)&&(_=!0,e.lineIndent>t?d=1:e.lineIndent===t?d=0:e.lineIndent<t&&(d=-1)),1===d)for(;function(e){var t,i,r,n=!1,o=!1,a=e.input.charCodeAt(e.position);if(33===a){if(null!==e.tag&&Jf(e,"duplication of a tag property"),60===(a=e.input.charCodeAt(++e.position))?(n=!0,a=e.input.charCodeAt(++e.position)):33===a?(o=!0,i="!!",a=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){for(;0!==(a=e.input.charCodeAt(++e.position))&&62!==a;);e.position<e.length?(r=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Jf(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!qf(a);)33===a&&(o?Jf(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),Uf.test(i)||Jf(e,"named tag handle cannot contain such characters"),o=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),jf.test(r)&&Jf(e,"tag suffix cannot contain flow indicator characters")}return r&&!Gf.test(r)&&Jf(e,"tag name cannot contain such characters: "+r),n?e.tag=r:Sf.call(e.tagMap,i)?e.tag=e.tagMap[i]+r:"!"===i?e.tag="!"+r:"!!"===i?e.tag="tag:yaml.org,2002:"+r:Jf(e,'undeclared tag handle "'+i+'"'),1}}(e)||function(e){var t,i=e.input.charCodeAt(e.position);if(38===i){for(null!==e.anchor&&Jf(e,"duplication of an anchor property"),i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!qf(i)&&!Hf(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&Jf(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),1}}(e);)od(e,!0,-1)?(_=!0,s=o,e.lineIndent>t?d=1:e.lineIndent===t?d=0:e.lineIndent<t&&(d=-1)):s=!1;if(s=s&&(_||n),1!==d&&Of!==i||(h=Pf===i||zf===i?t:t+1,f=e.position-e.lineStart,1===d?s&&(ud(e,f)||function(e,t,i){var r,n,o,a,s=e.tag,l=e.anchor,u={},c={},h=null,f=null,d=null,_=!1,p=!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=u),a=e.input.charCodeAt(e.position);0!==a;){if(r=e.input.charCodeAt(e.position+1),o=e.line,63!==a&&58!==a||!qf(r)){if(!cd(e,i,zf,!1,!0))break;if(e.line===o){for(a=e.input.charCodeAt(e.position);Vf(a);)a=e.input.charCodeAt(++e.position);if(58===a)qf(a=e.input.charCodeAt(++e.position))||Jf(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(rd(e,u,c,h,f,null),h=f=d=null),n=_=!(p=!0),h=e.tag,f=e.result;else{if(!p)return e.tag=s,e.anchor=l,1;Jf(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!p)return e.tag=s,e.anchor=l,1;Jf(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===a?(_&&(rd(e,u,c,h,f,null),h=f=d=null),n=_=p=!0):_?n=!(_=!1):Jf(e,"incomplete explicit mapping pair; a key node is missed"),e.position+=1,a=r;if((e.line===o||e.lineIndent>t)&&(cd(e,t,Of,!0,n)&&(_?f=e.result:d=e.result),_||(rd(e,u,c,h,f,d),h=f=d=null),od(e,!0,-1),a=e.input.charCodeAt(e.position)),e.lineIndent>t&&0!==a)Jf(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&rd(e,u,c,h,f,null),p&&(e.tag=s,e.anchor=l,e.kind="mapping",e.result=u),p}(e,f,h))||function(e,t){var i,r,n,o,a,s,l,u,c,h=!0,f=e.tag,d=e.anchor,_={},p=e.input.charCodeAt(e.position);if(91===p)s=!(n=93),r=[];else{if(123!==p)return;n=125,s=!0,r={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=r),p=e.input.charCodeAt(++e.position);0!==p;){if(od(e,!0,t),(p=e.input.charCodeAt(e.position))===n)return e.position++,e.tag=f,e.anchor=d,e.kind=s?"mapping":"sequence",e.result=r,1;h||Jf(e,"missed comma between flow collection entries"),c=null,o=a=!1,63===p&&qf(e.input.charCodeAt(e.position+1))&&(o=a=!0,e.position++,od(e,!0,t)),i=e.line,cd(e,t,Pf,!1,!0),u=e.tag,l=e.result,od(e,!0,t),p=e.input.charCodeAt(e.position),!a&&e.line!==i||58!==p||(o=!0,p=e.input.charCodeAt(++e.position),od(e,!0,t),cd(e,t,Pf,!1,!0),c=e.result),s?rd(e,r,_,u,l,c):o?r.push(rd(e,null,_,u,l,c)):r.push(l),od(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(h=!0,p=e.input.charCodeAt(++e.position)):h=!1}Jf(e,"unexpected end of the stream within a flow collection")}(e,h)?p=!0:(a&&function(e,t){var i,r,n,o,a=If,s=!1,l=t,u=0,c=!1,h=e.input.charCodeAt(e.position);if(124===h)r=!1;else{if(62!==h)return;r=!0}for(e.kind="scalar",e.result="";0!==h;)if(43===(h=e.input.charCodeAt(++e.position))||45===h)If===a?a=43===h?Cf:Lf:Jf(e,"repeat of a chomping mode identifier");else{if(!(0<=(n=48<=(o=h)&&o<=57?o-48:-1)))break;0==n?Jf(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Jf(e,"repeat of an indentation width identifier"):(l=t+n-1,s=!0)}if(Vf(h)){for(;Vf(h=e.input.charCodeAt(++e.position)););if(35===h)for(;!Bf(h=e.input.charCodeAt(++e.position))&&0!==h;);}for(;0!==h;){for(nd(e),e.lineIndent=0,h=e.input.charCodeAt(e.position);(!s||e.lineIndent<l)&&32===h;)e.lineIndent++,h=e.input.charCodeAt(++e.position);if(!s&&e.lineIndent>l&&(l=e.lineIndent),Bf(h))u++;else{if(e.lineIndent<l){a===Cf?e.result+=Hh.repeat("\n",u):a===If&&s&&(e.result+="\n");break}for(r?Vf(h)?(c=!0,e.result+=Hh.repeat("\n",u+1)):c?(c=!1,e.result+=Hh.repeat("\n",u+1)):0===u?s&&(e.result+=" "):e.result+=Hh.repeat("\n",u):e.result+=s?Hh.repeat("\n",u+1):Hh.repeat("\n",u),s=!0,u=0,i=e.position;!Bf(h)&&0!==h;)h=e.input.charCodeAt(++e.position);td(e,i,e.position,!1)}}return 1}(e,h)||function(e,t){var i,r,n=e.input.charCodeAt(e.position);if(39===n){for(e.kind="scalar",e.result="",e.position++,i=r=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(td(e,i,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return 1;i=r=e.position,e.position++}else Bf(n)?(td(e,i,r,!0),sd(e,od(e,!1,t)),i=r=e.position):e.position===e.lineStart&&ad(e)?Jf(e,"unexpected end of the document within a single quoted scalar"):(e.position++,r=e.position);Jf(e,"unexpected end of the stream within a single quoted scalar")}}(e,h)||ld(e,h)?p=!0:!function(e){var t,i,r=e.input.charCodeAt(e.position);if(42===r){for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!qf(r)&&!Hf(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Jf(e,"name of an alias node must contain at least one character"),i=e.input.slice(t,e.position),e.anchorMap.hasOwnProperty(i)||Jf(e,'unidentified alias "'+i+'"'),e.result=e.anchorMap[i],od(e,!0,-1),1}}(e)?function(e,t,i){var r,n,o,a,s,l,u,c=e.kind,h=e.result,f=e.input.charCodeAt(e.position);if(!qf(f)&&!Hf(f)&&35!==f&&38!==f&&42!==f&&33!==f&&124!==f&&62!==f&&39!==f&&34!==f&&37!==f&&64!==f&&96!==f&&(63!==f&&45!==f||!(qf(r=e.input.charCodeAt(e.position+1))||i&&Hf(r)))){for(e.kind="scalar",e.result="",n=o=e.position,a=!1;0!==f;){if(58===f){if(qf(r=e.input.charCodeAt(e.position+1))||i&&Hf(r))break}else if(35===f){if(qf(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&ad(e)||i&&Hf(f))break;if(Bf(f)){if(s=e.line,l=e.lineStart,u=e.lineIndent,od(e,!1,-1),e.lineIndent>=t){a=!0,f=e.input.charCodeAt(e.position);continue}e.position=o,e.line=s,e.lineStart=l,e.lineIndent=u;break}}a&&(td(e,n,o,!1),sd(e,e.line-s),n=o=e.position,a=!1),Vf(f)||(o=e.position+1),f=e.input.charCodeAt(++e.position)}if(td(e,n,o,!1),e.result)return 1;e.kind=c,e.result=h}}(e,h,Pf===i)&&(p=!0,null===e.tag&&(e.tag="?")):(p=!0,null===e.tag&&null===e.anchor||Jf(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===d&&(p=s&&ud(e,f))),null!==e.tag&&"!"!==e.tag)if("?"===e.tag){for(l=0,u=e.implicitTypes.length;l<u;l+=1)if((c=e.implicitTypes[l]).resolve(e.result)){e.result=c.construct(e.result),e.tag=c.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else Sf.call(e.typeMap,e.tag)?(c=e.typeMap[e.tag],null!==e.result&&c.kind!==e.kind&&Jf(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+c.kind+'", not "'+e.kind+'"'),c.resolve(e.result)?(e.result=c.construct(e.result),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):Jf(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")):Jf(e,"unknown tag !<"+e.tag+">");return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||p}function hd(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var i=new Kf(e,t);for(i.input+="\0";32===i.input.charCodeAt(i.position);)i.lineIndent+=1,i.position+=1;for(;i.position<i.length-1;)!function(e){var t,i,r,n,o=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap={},e.anchorMap={};0!==(n=e.input.charCodeAt(e.position))&&(od(e,!0,-1),n=e.input.charCodeAt(e.position),!(0<e.lineIndent||37!==n));){for(a=!0,n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!qf(n);)n=e.input.charCodeAt(++e.position);for(r=[],(i=e.input.slice(t,e.position)).length<1&&Jf(e,"directive name must not be less than one character in length");0!==n;){for(;Vf(n);)n=e.input.charCodeAt(++e.position);if(35===n){for(;0!==(n=e.input.charCodeAt(++e.position))&&!Bf(n););break}if(Bf(n))break;for(t=e.position;0!==n&&!qf(n);)n=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==n&&nd(e),Sf.call(ed,i)?ed[i](e,i,r):Qf(e,'unknown document directive "'+i+'"')}od(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,od(e,!0,-1)):a&&Jf(e,"directives end mark is expected"),cd(e,e.lineIndent-1,Of,!1,!0),od(e,!0,-1),e.checkLineBreaks&&Df.test(e.input.slice(o,e.position))&&Qf(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ad(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,od(e,!0,-1)):e.position<e.length-1&&Jf(e,"end of the stream or a document separator is expected")}(i);return i.documents}function fd(e,t,i){for(var r=hd(e,i),n=0,o=r.length;n<o;n+=1)t(r[n])}function dd(e,t){var i=hd(e,t);if(0!==i.length){if(1===i.length)return i[0];throw new Xh("expected a single document in the stream, but found more")}}var _d={loadAll:fd,load:dd,safeLoadAll:function(e,t,i){fd(e,t,Hh.extend({schema:Af},i))},safeLoad:function(e,t){return dd(e,Hh.extend({schema:Af},t))}},pd=Object.prototype.toString,gd=Object.prototype.hasOwnProperty,vd=9,md=10,yd=13,xd=32,bd=33,wd=34,Ad=35,Td=37,kd=38,Ed=39,Md=42,Rd=44,Sd=45,Pd=58,zd=62,Nd=63,Od=64,Id=91,Ld=93,Cd=96,Fd=123,Dd=124,jd=125,Ud={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Gd=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function Bd(e){this.schema=e.schema||Rf,this.indent=Math.max(1,e.indent||2),this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Hh.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var i,r,n,o,a,s,l;if(null===t)return{};for(i={},n=0,o=(r=Object.keys(t)).length;n<o;n+=1)a=r[n],s=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(l=e.compiledTypeMap[a])&&gd.call(l.styleAliases,s)&&(s=l.styleAliases[s]),i[a]=s;return i}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Vd(e,t){for(var i,r=Hh.repeat(" ",t),n=0,o=-1,a="",s=e.length;n<s;)n=-1===(o=e.indexOf("\n",n))?(i=e.slice(n),s):(i=e.slice(n,o+1),o+1),i.length&&"\n"!==i&&(a+=r),a+=i;return a}function qd(e,t){return"\n"+Hh.repeat(" ",e.indent*t)}function Hd(e){this.source=e,this.result="",this.checkpoint=0}function Yd(e,t,i,r){var n,o,a,s,l,u,c,h,f,d,_,p,g,v,m,y,x,b,w,A,T;if(0!==t.length)if(-1===Gd.indexOf(t)){for(n=!0,o=t.length?t.charCodeAt(0):0,a=xd===o||xd===t.charCodeAt(t.length-1),Sd!==o&&Nd!==o&&Od!==o&&Cd!==o||(n=!1),l=s=a||-1<e.flowLevel&&e.flowLevel<=i?(a&&(n=!1),!1):!r,u=!0,c=new Hd(t),h=!1,d=f=0,_=e.indent*i,-1===(p=e.lineWidth)&&(p=9007199254740991),_<40?p-=_:p=40,v=0;v<t.length;v++){if(g=t.charCodeAt(v),n){if(vd!==(T=g)&&md!==T&&yd!==T&&Rd!==T&&Id!==T&&Ld!==T&&Fd!==T&&jd!==T&&Ad!==T&&kd!==T&&Md!==T&&bd!==T&&Dd!==T&&zd!==T&&Ed!==T&&wd!==T&&Td!==T&&Pd!==T&&!Ud[T]&&!Wd(T))continue;n=!1}u&&g===Ed&&(u=!1),m=Ud[g],y=Wd(g),(m||y)&&(g!==md&&g!==wd&&g!==Ed?l=s=!1:g===md&&(u=!(h=!0),0<v&&t.charCodeAt(v-1)===xd&&(s=l=!1),s&&(x=v-f,f=v,d<x&&(d=x))),g!==wd&&(u=!1),c.takeUpTo(v),c.escapeChar())}if(n&&function(e,t){for(var i=0,r=e.implicitTypes.length;i<r;i+=1)if(e.implicitTypes[i].resolve(t))return 1}(e,t)&&(n=!1),b="",(s||l)&&(w=0,t.charCodeAt(t.length-1)===md&&(w+=1,t.charCodeAt(t.length-2)===md&&(w+=1)),0===w?b="-":2===w&&(b="+")),(l&&d<p||null!==e.tag)&&(s=!1),h||(l=!1),n)e.dump=t;else if(u)e.dump="'"+t+"'";else if(s)A=function(e,t){var i,r="",n=0,o=e.length,a=/\n+$/.exec(e);a&&(o=a.index+1);for(;n<o;)i=e.indexOf("\n",n),n=o<i||-1===i?(r&&(r+="\n\n"),r+=Xd(e.slice(n,o),t),o):(r&&(r+="\n\n"),r+=Xd(e.slice(n,i),t),i+1);a&&"\n"!==a[0]&&(r+=a[0]);return r}(t,p),e.dump=">"+b+"\n"+Vd(A,_);else if(l)b||(t=t.replace(/\n$/,"")),e.dump="|"+b+"\n"+Vd(t,_);else{if(!c)throw new Error("Failed to dump scalar value");c.finish(),e.dump='"'+c.result+'"'}}else e.dump="'"+t+"'";else e.dump="''"}function Xd(e,t){if(""===e)return e;for(var i,r,n=/[^\s] [^\s]/g,o="",a=0,s=0,l=n.exec(e);l;)t<(i=l.index)-s&&(r=a!==s?a:i,o&&(o+="\n"),o+=e.slice(s,r),s=r+1),a=i+1,l=n.exec(e);return o&&(o+="\n"),s!==a&&e.length-s>t?o+=e.slice(s,a)+"\n"+e.slice(a+1):o+=e.slice(s),o}function Wd(e){return!(32<=e&&e<=126||133===e||160<=e&&e<=55295||57344<=e&&e<=65533||65536<=e&&e<=1114111)}function Zd(e,t,i){for(var r,n,o,a=i?e.explicitTypes:e.implicitTypes,s=0,l=a.length;s<l;s+=1)if(((n=a[s]).instanceOf||n.predicate)&&(!n.instanceOf||"object"==typeof t&&t instanceof n.instanceOf)&&(!n.predicate||n.predicate(t))){if(e.tag=i?n.tag:"?",n.represent){if(o=e.styleMap[n.tag]||n.defaultStyle,"[object Function]"===pd.call(n.represent))r=n.represent(t,o);else{if(!gd.call(n.represent,o))throw new Xh("!<"+n.tag+'> tag resolver accepts not "'+o+'" style');r=n.represent[o](t,o)}e.dump=r}return 1}}function Kd(e,t,i,r,n,o){e.tag=null,e.dump=i,Zd(e,i,!1)||Zd(e,i,!0);var a=pd.call(e.dump);r=r&&(e.flowLevel<0||e.flowLevel>t);var s,l,u="[object Object]"===a||"[object Array]"===a;if(u&&(l=-1!==(s=e.duplicates.indexOf(i))),(null!==e.tag&&"?"!==e.tag||l||2!==e.indent&&0<t)&&(n=!1),l&&e.usedDuplicates[s])e.dump="*ref_"+s;else{if(u&&l&&!e.usedDuplicates[s]&&(e.usedDuplicates[s]=!0),"[object Object]"===a)r&&0!==Object.keys(e.dump).length?(function(e,t,i,r){var n,o,a,s,l,u,c="",h=e.tag,f=Object.keys(i);if(!0===e.sortKeys)f.sort();else if("function"==typeof e.sortKeys)f.sort(e.sortKeys);else if(e.sortKeys)throw new Xh("sortKeys must be a boolean or a function");for(n=0,o=f.length;n<o;n+=1)u="",r&&0===n||(u+=qd(e,t)),s=i[a=f[n]],Kd(e,t+1,a,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&1024<e.dump.length)&&(e.dump&&md===e.dump.charCodeAt(0)?u+="?":u+="? "),u+=e.dump,l&&(u+=qd(e,t)),Kd(e,t+1,s,!0,l)&&(e.dump&&md===e.dump.charCodeAt(0)?u+=":":u+=": ",c+=u+=e.dump));e.tag=h,e.dump=c||"{}"}(e,t,e.dump,n),l&&(e.dump="&ref_"+s+e.dump)):(function(e,t,i){for(var r,n,o,a="",s=e.tag,l=Object.keys(i),u=0,c=l.length;u<c;u+=1)o="",0!==u&&(o+=", "),n=i[r=l[u]],Kd(e,t,r,!1,!1)&&(1024<e.dump.length&&(o+="? "),o+=e.dump+": ",Kd(e,t,n,!1,!1)&&(a+=o+=e.dump));e.tag=s,e.dump="{"+a+"}"}(e,t,e.dump),l&&(e.dump="&ref_"+s+" "+e.dump));else if("[object Array]"===a)r&&0!==e.dump.length?(function(e,t,i,r){for(var n="",o=e.tag,a=0,s=i.length;a<s;a+=1)Kd(e,t+1,i[a],!0,!0)&&(r&&0===a||(n+=qd(e,t)),n+="- "+e.dump);e.tag=o,e.dump=n||"[]"}(e,t,e.dump,n),l&&(e.dump="&ref_"+s+e.dump)):(function(e,t,i){for(var r="",n=e.tag,o=0,a=i.length;o<a;o+=1)Kd(e,t,i[o],!1,!1)&&(0!==o&&(r+=", "),r+=e.dump);e.tag=n,e.dump="["+r+"]"}(e,t,e.dump),l&&(e.dump="&ref_"+s+" "+e.dump));else{if("[object String]"!==a){if(e.skipInvalid)return;throw new Xh("unacceptable kind of an object to dump "+a)}"?"!==e.tag&&Yd(e,e.dump,t,o)}null!==e.tag&&"?"!==e.tag&&(e.dump="!<"+e.tag+"> "+e.dump)}return 1}function $d(e,t){var i,r,n=[],o=[];for(!function e(t,i,r){var n,o,a;if(null!==t&&"object"==typeof t)if(-1!==(o=i.indexOf(t)))-1===r.indexOf(o)&&r.push(o);else if(i.push(t),Array.isArray(t))for(o=0,a=t.length;o<a;o+=1)e(t[o],i,r);else for(n=Object.keys(t),o=0,a=n.length;o<a;o+=1)e(t[n[o]],i,r)}(e,n,o),i=0,r=o.length;i<r;i+=1)t.duplicates.push(n[o[i]]);t.usedDuplicates=new Array(r)}function Jd(e,t){var i=new Bd(t=t||{});return i.noRefs||$d(e,i),Kd(i,0,e,!0,!0)?i.dump+"\n":""}Hd.prototype.takeUpTo=function(e){var t;if(e<this.checkpoint)throw(t=new Error("position should be > checkpoint")).position=e,t.checkpoint=this.checkpoint,t;return this.result+=this.source.slice(this.checkpoint,e),this.checkpoint=e,this},Hd.prototype.escapeChar=function(){var e=this.source.charCodeAt(this.checkpoint),t=Ud[e]||function(e){var t,i,r=e.toString(16).toUpperCase();if(e<=255)t="x",i=2;else if(e<=65535)t="u",i=4;else{if(!(e<=4294967295))throw new Xh("code point within a string may not be greater than 0xFFFFFFFF");t="U",i=8}return"\\"+t+Hh.repeat("0",i-r.length)+r}(e);return this.result+=t,this.checkpoint+=1,this},Hd.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)};var Qd={dump:Jd,safeDump:function(e,t){return Jd(e,Hh.extend({schema:Af},t))}};function e_(e){return function(){throw new Error("Function "+e+" is deprecated and cannot be used.")}}var t_={Type:Jh,Schema:tf,FAILSAFE_SCHEMA:rf,JSON_SCHEMA:uf,CORE_SCHEMA:cf,DEFAULT_SAFE_SCHEMA:Af,DEFAULT_FULL_SCHEMA:Rf,load:_d.load,loadAll:_d.loadAll,safeLoad:_d.safeLoad,safeLoadAll:_d.safeLoadAll,dump:Qd.dump,safeDump:Qd.safeDump,YAMLException:Xh,MINIMAL_SCHEMA:rf,SAFE_SCHEMA:Af,DEFAULT_SCHEMA:Rf,scan:e_("scan"),parse:e_("parse"),compose:e_("compose"),addConstructor:e_("addConstructor")},i_=function(){function r(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;pr(this,r),this.url=e,!t||zn(t)&&!zn(this.url)?this.path=Pn(this.url):this.path=t,this.path_for_parent=t||this.path,this.parent=i,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))}return vr(r,[{key:"load",value:function(){return e=this.url,new Promise(function(i,r){"string"==typeof e?kn.io(e).then(function(e){try{var t=function(e){var t;try{t=t_.safeLoad(e,{json:!0})}catch(e){throw e}return t}(e);i(t)}catch(e){r(e)}},r):(e=Object.assign({},e),i(e))});var e}},{key:"resourceFor",value:function(e){return{url:this.urlFor(e),path:this.pathFor(e),type:this.typeFor(e)}}},{key:"urlFor",value:function(e){return r_(e)?e:zn(e)&&this.container?this.parent.urlFor(this.path_for_parent+e):function(e,t){if(!e||!zn(e))return e;var i,r="/"!==e[0];return t?(i=document.createElement("a")).href=t:i=window.location,e=r?Pn(i.href)+e:(i.origin||i.protocol+"//"+i.host)+e}(e,this.path)}},{key:"pathFor",value:Pn},{key:"typeFor",value:function(e){var t=(e=e.split("/").pop()).lastIndexOf(".");if(-1<t)return e.substring(t+1)}},{key:"isContainer",value:function(){return!1}}]),r}();function r_(e){return!(!e||"global."!==e.slice(0,7))}function n_(e){return null!=e}function o_(e){return"("+e+")"}function a_(e){return"$"===e[0]?"context['"+e.substring(1)+"']":"context.feature.properties['"+e+"']"}function s_(e,t){return o_(("string"==typeof(i=t)?'"'+i+'"':i)+" === "+a_(e));var i}function l_(e,t){return o_(e.filter(n_).map(function(e){return o_(e.join(" && "))}).join(" "+t+" "))}function u_(e,t,i){return t&&0<t.length?l_(t.map(function(e){return c_(e,i)}),"||"):"true"}function c_(e,t){var i=[];if("function"==typeof e)return[o_(e.toString()+"(context)")];if(Array.isArray(e))return[u_(0,e,t)];if(null==e)return["true"];for(var r,n,o,a,s,l,u,c,h=Object.keys(e),f=0;f<h.length;f++){var d=h[f],_=e[d],p=_r(_);if("string"===p||"number"===p)i.push(s_(d,_));else if("boolean"===p)i.push((c=_,o_(a_(d)+(c?" != ":" == ")+"null")));else if("not"===d)i.push("!"+o_(c_(_,t).join(" && ")));else if("any"===d)i.push(u_(0,_,t));else if("all"===d)i.push(function(e,t){return e&&0<e.length?l_(e.map(function(e){return c_(e,t)}),"&&"):"true"}(_,t));else if("none"===d)i.push("!"+o_(u_(0,_,t)));else if(Array.isArray(_))i.push(function(t,e){return o_(e.map(function(e){return s_(t,e)}).join(" || "))}(d,_));else if("object"===p&&null!=_)(_.max||_.min)&&i.push((r=d,n=_,u=l=s=a=void 0,l=[],u=(o=t)&&"function"==typeof o.rangeTransform&&o.rangeTransform,n.max&&(a=u?u(n.max):n.max,l.push(a_(r)+" < "+a)),n.min&&(s=u?s=u(n.min):n.min,l.push(a_(r)+" >= "+s)),o_(l.join(" && "))));else{if(null!=_)throw new Error("Unknown Query syntax: "+_);i.push(" true ")}}return 0===h.length?["true"]:i}function h_(e,t){return null==e?function(){return!0}:new Function("context","return "+o_(c_(e,t).join(" && "))+";")}var f_=["filter","draw","visible","enabled","data"],d_={};var __=["any","all","not","none"],p_=function(){function h(e){var t,i=e.layer,r=e.name,n=e.parent,o=e.draw,a=e.visible,s=e.enabled,l=e.filter,u=e.styles;if(pr(this,h),this.id=h.id++,this.config_data=i.data,this.parent=n,this.name=r,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=o,this.filter=l,this.styles=u,this.is_built=!1,s=void 0===s?a:s,this.parent&&!1===this.parent.visible?this.enabled=!1:this.enabled=!1!==s,this.draw)for(var c in this.draw){this.draw[c]=null==this.draw[c]?{}:this.draw[c],"object"!==_r(this.draw[c])?(t="Draw group '".concat(c,"' for layer ").concat(this.full_name," is invalid, must be an object, "),An("warn",t+="but was set to `".concat(c,": ").concat(this.draw[c],"` instead")),delete this.draw[c]):this.draw[c].layer_name=this.full_name}}return vr(h,[{key:"build",value:function(){An("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){this.draw=kn.stringsToFunctions(this.draw,mo.wrapFunction),this.calculatedDraw=function(e){var t=[];{var i;e.parent&&(i=e.parent.calculatedDraw||[],t.push.apply(t,zr(i)))}return t.push(e.draw),t}(this)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=kn.stringsToFunctions(this.filter,mo.wrapFunction);var e=_r(this.filter);if(null==this.filter||"object"===e||"function"===e)try{this.buildZooms(),this.buildPropMatches(),null!=this.filter&&("function"==typeof this.filter||0<Object.keys(this.filter).length)?this.filter=h_(this.filter,y_):this.filter=null}catch(e){var t="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");An("warn",t+="failed with error '".concat(e.message,"', stack trace: ").concat(e.stack))}else{var i="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");An("warn",i+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var e=this.filter&&this.filter.$zoom,t=_r(e);if(null!=e&&"function"!==t){if(this.zooms={},"number"===t)this.zooms[e]=!0;else if(Array.isArray(e))for(var i=0;i<e.length;i++)this.zooms[e[i]]=!0;else if("object"===t&&(null!=e.min||null!=e.max))for(var r=e.min||0,n=e.max||25,o=r;o<n;o++)this.zooms[o]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var n=this;this.filter&&!Array.isArray(this.filter)&&"function"!=typeof this.filter&&Object.keys(this.filter).forEach(function(e){if(-1===__.indexOf(e)){var t=n.filter[e],i=_r(t),r=Array.isArray(t);if(!r&&"string"!==i&&"number"!==i)return;"$"===e[0]?(n.context_prop_matches=n.context_prop_matches||[],n.context_prop_matches.push([e.substring(1),r?t:[t]])):(n.feature_prop_matches=n.feature_prop_matches||[],n.feature_prop_matches.push([e,r?t:[t]])),delete n.filter[e]}})}},{key:"doPropMatches",value:function(e){if(this.feature_prop_matches)for(var t=0;t<this.feature_prop_matches.length;t++){var i=this.feature_prop_matches[t],r=e.feature.properties[i[0]];if(null==r||-1===i[1].indexOf(r))return!1}if(this.context_prop_matches)for(var n=0;n<this.context_prop_matches.length;n++){var o=this.context_prop_matches[n],a=e[o[0]];if(null==a||-1===o[1].indexOf(a))return!1}return!0}},{key:"doesMatch",value:function(t){if(!this.enabled)return!1;if(this.is_built||this.build(),null!=this.zooms&&!this.zooms[t.zoom])return!1;if(!this.doPropMatches(t))return!1;var e;if(this.filter instanceof Function)try{e=this.filter(t)}catch(e){var i="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");An("error",i+="failed with error '".concat(e.message,"', stack trace: ").concat(e.stack),t.feature)}else e=null==this.filter;return!!e&&(this.children_to_parse&&(function(e,t,i){for(var r in t){var n,o=t[r];"object"!==_r(o)||Array.isArray(o)?(n="Layer value must be an object: cannot create layer '".concat(r,": ").concat(JSON.stringify(o),"'"),n+=", under parent layer '".concat(e.full_name,"'."),i[e.name]&&(n+=" The parent name '".concat(e.name,"' is also the name of a style, did you mean to create a 'draw' group"),e.parent&&(n+=" under '".concat(e.parent.name,"'")),n+=" instead?"),An("warn",n)):b_(r,o,e,i)}}(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}]),h}();p_.id=0;var g_,v_=function(){br(r,p_);var i=Rr(r);function r(e){var t;return pr(this,r),(t=i.call(this,e)).is_leaf=!0,t}return r}(),m_=function(){br(r,p_);var i=Rr(r);function r(e){var t;return pr(this,r),(t=i.call(this,e)).is_tree=!0,t.layers=e.layers||[],t}return vr(r,[{key:"addLayer",value:function(e){this.layers.push(e)}},{key:"buildDrawGroups",value:function(e){var t=[],i=[];if(!function e(t,i,r,n){var o=!1;if(0===i.length)return;for(var a=0;a<i.length;a++){var s=i[a];s.is_leaf?s.doesMatch(t)&&(o=!0,r.push(s),n.push(s.id)):s.is_tree&&s.doesMatch(t)&&(o=!0,e(t,s.layers,r,n)||(r.push(s),n.push(s.id)))}return o}(e,[this],t,i),0<t.length){var r=function(e){if(1<e.length){for(var t=e[0],i=1;i<e.length;i++)t+="/"+e[i];return t}return e[0]}(i);if(void 0===d_[r]){for(var n=t.map(function(e){return e&&!1!==e.visible&&e.calculatedDraw}),o={},a=0;a<n.length;a++){var s=n[a];if(s)for(var l=0;l<s.length;l++){var u=s[l];for(var c in u)o[c]=!0}}for(var h in o)d_[r]=d_[r]||{},d_[r][h]=function(e,i){for(var r,t=0,n=0;n<e.length;n++)e[n].length>t&&(t=e[n].length);if(0===t)return null;for(var o={visible:!0},a=0;a<t;a++)(function(t){if(r=[],e.forEach(function(e){e[t]&&e[t][i]&&-1===r.indexOf(e[t][i])&&r.push(e[t][i])}),0===r.length)return;r.sort(function(e,t){return(e&&e.layer_name)>(t&&t.layer_name)?1:-1}),ul.apply(void 0,[o].concat(zr(r))),delete o.layer_name})(a);return!1===o.visible?null:o}(n,h),d_[r][h]?(d_[r][h].key=r+"/"+h,d_[r][h].layers=t.map(function(e){return e&&e.full_name}),d_[r][h].group=h):delete d_[r][h];d_[r]&&0===Object.keys(d_[r]).length&&(d_[r]=null)}return d_[r]}}}]),r}(),y_={rangeTransform:function(e){return"string"==typeof e&&"px2"===e.trim().slice(-3)?"".concat(parseFloat(e)," * context.meters_per_pixel_sq"):e}};function x_(e){return-1<f_.indexOf(e)}function b_(e,t,i,r){var n,o={name:e,layer:t=null==t?{}:t,parent:i,styles:r},a=Pr(function(e){var t={},i={};for(var r in e)x_(r)?t[r]=e[r]:i[r]=e[r];return[t,i]}(t),2),s=a[0],l=a[1],u=(n=l,0===Object.keys(n).length),c=u&&null!=i?v_:m_,h=new c(Object.assign(o,s));return h.enabled&&(i&&i.addLayer(h),h.children_to_parse=u?null:l),h}var w_=/^global\.(.+)$/,A_=g_={loadScene:function(e,t){var r=this,i=1<arguments.length&&void 0!==t?t:{},n=i.path,o=i.type,a=[];return this.loadSceneRecursive({url:e,path:n,type:o},null,a).then(function(e){return r.finalize(e)}).then(function(e){var t=e.config,i=e.bundle;return t?(0<a.length&&a.forEach(function(e){var t="Failed to import scene: ".concat(e.url);An("error",t,e),r.trigger("error",{type:"scene_import",message:t,error:e,url:e.url})}),{config:t,bundle:i}):Promise.reject(a[0])})},loadSceneRecursive:function(e,t,i){var r=this,n=e.url,o=e.path,a=(e.type,2<arguments.length&&void 0!==i?i:[]);if(!n)return Promise.resolve({});var s=new i_(n,o,t);return s.load().then(function(i){if(null==i.import)return r.normalize(i,s),{config:i,bundle:s};Array.isArray(i.import)||(i.import=[i.import]);var t=[];return i.import.forEach(function(e){"object"===_r(e)&&(e=On(new Blob([JSON.stringify(e)]))),t.push(s.resourceFor(e))}),delete i.import,Promise.all(t.map(function(e){return r.loadSceneRecursive(e,s,a)})).then(function(e){e.forEach(function(e){return r.normalize(e.config,e.bundle)});var t=e.map(function(e){return e.config});return i=ul.apply(void 0,zr(t).concat([i])),r.normalize(i,s),{config:i,bundle:s}})}).catch(function(e){return e.url=n,a.push(e),{}})},normalize:function(e,t){return this.normalizeDataSources(e,t),this.normalizeFonts(e,t),this.normalizeTextures(e,t),this.hoistTextures(e,t),{config:e,bundle:t}},normalizeDataSources:function(e,t){for(var i in e.sources=e.sources||{},e.sources)this.normalizeDataSource(e.sources[i],t);return e},normalizeDataSource:function(e,t){if(e.url&&(e.url=t.urlFor(e.url)),e.scripts)for(var i in Array.isArray(e.scripts)&&(e.scripts=e.scripts.reduce(function(e,t){return e[t]=t,e},{})),e.scripts)e.scripts[i]=t.urlFor(e.scripts[i]);return e},normalizeFonts:function(e,t){for(var i in e.fonts=e.fonts||{},e.fonts){var r;Array.isArray(e.fonts[i])?e.fonts[i].forEach(function(e){e.url=e.url&&t.urlFor(e.url)}):(r=e.fonts[i]).url=r.url&&t.urlFor(r.url)}return e},normalizeTextures:function(e,t){if(e.textures=e.textures||{},e.textures)for(var i in e.textures){var r=e.textures[i];r.url&&(r.url=t.urlFor(r.url))}},hoistTextures:function(r,n){var o=this;if(r.styles){for(var e in r.styles)!function(e){var i=r.styles[e],t=i.texture;"string"!=typeof t||r.textures[t]||(i.texture=o.hoistTexture(t,r,n)),i.material&&["emission","ambient","diffuse","specular","normal"].forEach(function(e){var t=null!=i.material[e]&&i.material[e].texture;"string"!=typeof t||r.textures[t]||(i.material[e].texture=o.hoistTexture(t,r,n))})}(e)}if(this.hoistStyleShaderUniformTextures(r,n,{include_globals:!1}),r.layers)for(var t=[r.layers];0<t.length;){var i=t.pop();if("object"===_r(i)&&!Array.isArray(i))for(var a in i)if("draw"===a){var s,l,u=i[a];for(var c in u){u[c].texture&&("string"!=typeof(s=u[c].texture)||r.textures[s]||(u[c].texture=this.hoistTexture(s,r,n))),u[c].outline&&u[c].outline.texture&&("string"!=typeof(l=u[c].outline.texture)||r.textures[l]||(u[c].outline.texture=this.hoistTexture(l,r,n)))}}else{if(x_(a))continue;t.push(i[a])}}},hoistStyleShaderUniformTextures:function(o,a,e){var s=this,l=e.include_globals;if(o.styles)for(var t in o.styles){var i=o.styles[t];i.shaders&&i.shaders.uniforms&&Ll.parseUniforms(i.shaders.uniforms).forEach(function(e){var t=e.type,i=e.value,r=e.key,n=e.uniforms;"sampler2D"!==t||"string"!=typeof i||o.textures[i]||!l&&r_(i)||(n[r]=s.hoistTexture(i,o,a))})}},hoistTexture:function(e,t,i){var r=r_(e),n=r?e:i.urlFor(e),o=r?"texture-".concat(n):n;return t.textures[o]={url:n},o},applyGlobalProperties:function(e){if(!e.global||0===Object.keys(e.global).length)return e;var o=function e(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:".";var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};r=r?r+i:"";for(var o in t){var a=r+o,s=t[o];"object"!==_r(n[a]=s)||Array.isArray(s)||e(s,i,a,n)}return n}(e.global);return function e(t){if("string"==typeof t){var i=function e(t,i,r){var n=2<arguments.length&&void 0!==r?r:[];if(-1<n.indexOf(t))An({level:"warn",once:!0},"Global properties: cyclical reference detected",n);else{n.push(t);var o=w_.exec(t);if(o){var a=o[1];if(a){var s=i[a];if(void 0!==s)return"string"==typeof s&&w_.exec(s)?e(s,i,n):s;An({level:"warn",once:!0},"Global property not found: "+t)}else An({level:"warn",once:!0},"Invalid global property reference: "+t)}}}(t,o);void 0!==i&&(t=i)}else if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]=e(t[r]);else if("object"===_r(t))for(var n in t)t[n]=e(t[n]);return t}(e)},finalize:function(e){var t=e.config,i=e.bundle;return t?(t.global=t.global||{},t.scene=t.scene||{},t.cameras=t.cameras||{},t.lights=t.lights||{},t.styles=t.styles||{},t.layers=t.layers||{},t.camera&&(t.cameras.default=t.camera),0===Object.keys(t.cameras).length&&(t.cameras.default={}),0!==Object.keys(t.lights).length&&!Object.keys(t.lights).every(function(e){return!1===t.lights[e].visible})||(t.lights.default_light={type:"directional"}),{config:t,bundle:i}):{}}};No(g_);var T_=function(){function e(){pr(this,e),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10}return vr(e,[{key:"sourceTiles",value:function(e,t){return this.coords[e.key]&&this.coords[e.key].sources&&this.coords[e.key].sources[t.name]}},{key:"addTile",value:function(e){var t=e.coords.key,i=this.coords[t];(i=i||(this.coords[t]={descendants:0})).sources||(i.sources={}),i.sources[e.source.name]||(i.sources[e.source.name]={});for(var r=(i.sources[e.source.name][e.style_zoom]=e).coords.z-1;0<=r;r--){var n=Vo.coordinateAtZoom(e.coords,r);this.coords[n.key]||(this.coords[n.key]={descendants:0}),this.coords[n.key].descendants++}}},{key:"removeTile",value:function(e){var t=this.sourceTiles(e.coords,e.source),i=e.coords.key;t&&(delete t[e.style_zoom],0===Object.keys(t).length&&(delete this.coords[i].sources[e.source.name],0===Object.keys(this.coords[i].sources).length&&(delete this.coords[i].sources,0===this.coords[i].descendants&&delete this.coords[i])));for(var r=e.coords.z-1;0<=r;r--){var n=Vo.coordinateAtZoom(e.coords,r);this.coords[n.key]&&0<this.coords[n.key].descendants&&(this.coords[n.key].descendants--,0!==this.coords[n.key].descendants||this.coords[n.key].sources||delete this.coords[n.key])}}},{key:"getAncestor",value:function(e,t){var i=e.coords,r=e.style_zoom,n=e.source,o=1<arguments.length&&void 0!==t?t:1;if(!(o>this.max_proxy_ancestor_depth)){if(r>n.max_coord_zoom){var a=this.sourceTiles(i,n);if(a)for(var s=r-1;s>=n.max_coord_zoom;s--)if(a[s]&&a[s].loaded)return a[s];r=n.max_coord_zoom}r--;var l=Vo.coordinateAtZoom(i,i.z-1),u=this.sourceTiles(l,n);return u&&u[r]&&u[r].loaded?u[r]:0<l.z?this.getAncestor({coords:l,style_zoom:r,source:n},o+1):void 0}}},{key:"getDescendants",value:function(e,t){var i=e.coords,r=e.style_zoom,n=e.source,o=1<arguments.length&&void 0!==t?t:1,a=[];if(r>=n.max_coord_zoom){var s=this.sourceTiles(i,n);if(s)for(var l=Math.max(Jr.default_view_max_zoom,r+this.max_proxy_descendant_depth),u=r+1;u<=l;u++)if(s[u]&&s[u].loaded)return a.push(s[u]),a;return a}if(this.coords[i.key]&&0<this.coords[i.key].descendants){r++;for(var c=Vo.childrenForCoordinate(i),h=0;h<c.length;h++){var f=c[h],d=this.sourceTiles(f,n);d&&d[r]&&d[r].loaded?a.push(d[r]):o<=this.max_proxy_descendant_depth&&f.z<=n.max_coord_zoom&&a.push.apply(a,zr(this.getDescendants({coords:f,source:n,style_zoom:r},o+1)))}}return a}}]),e}(),k_=function(){function o(e,t,i,r){pr(this,o),Object.assign(this,e),this.placed=null,this._tile=r;var n=Jr.unitsPerMeter(r.coords.z)*Math.pow(2,i-r.style_zoom);this.layout=Object.assign({},e.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=n,this.position=Jr.tileSpaceToMeters(this.position,r.coords.z,r.min),this._worldToScreen=t,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0}return vr(o,[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){var e,t,i,r,n,o,a;return this._screenSpaceBoundingBox||((e=this._worldToScreen(this.position,!0))[0]+=this.offset[0],e[1]+=this.offset[1],t=this.size[0]/2+this.layout.buffer[0],i=this.size[1]/2+this.layout.buffer[1],r=e[0]-t,n=e[0]+t,o=e[1]-i,a=e[1]+i,this._screenSpaceBoundingBox={left:r,bottom:a,right:n,top:o}),this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles="point"===this.type?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var e=this._tile.coords.z,t=this._tile.min,i=Jr.tileSpaceToMeters([this.sides[0],this.sides[1]],e,t),r=Jr.tileSpaceToMeters([this.sides[2],this.sides[3]],e,t),n=Pr(this._worldToScreen(i,!0),2),o=n[0],a=n[1],s=Pr(this._worldToScreen(r,!0),2);return Rc(o,a,s[0],s[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var e=[],t=this.circles,i=this._tile.coords.z,r=this._tile.min,n=0;n<t.length-2;n+=3){var o=Jr.tileSpaceToMeters([t[n],-t[n+1]],i,r),a=t[n+2]/Jr.unitsPerMeter(i),s=[o[0]+a,o[1]],l=this._worldToScreen(o,!0),u=this._worldToScreen(s,!0),c=Kr.getLineLength(l[0],l[1],u[0],u[1]);e.push(l[0],l[1],c)}return e}}]),o}(),E_={mainThreadLabelCollisionPass:function(t,a,e,u,i,r){R_=M_,M_={};var s={},l={},n=[],c=e.worldToScreen.bind(e),h=new z_(r);for(var o in t.forEach(function(o){for(var e in o.meshes)o.meshes[e].forEach(function(e){if(e.labels){for(var t in h.trackMesh(e),e.labels["non-collision"]){var i=P_(e.labels["non-collision"][t],e,c,a,o);i.label.text_data&&h.insertLabel(i,o)}for(var r in e.labels.collision){var n;s[r]||(n=P_(e.labels.collision[r],e,c,a,o),s[r]=n.label,l[r]=n)}}})}),l){var f=l[o];f.linked&&(f.linked=l[f.linked]),n.push(f)}var d=e.getViewport(),_=d.width,p=d.height;return Ro.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new ko(_,p,30)}),Ro.addStyle("main","main"),Ro.collide(n,"main","main").then(function(e){return e.forEach(function(e){var i,r,n,t,o,a,s=e.mesh,l=e.label.getTile();s.valid&&(!(i=0)!==e.show||u&&e.label.breach&&!R_[e.label.id]||(i=1),i&&(M_[e.label.id]=!0),e.label.text_data&&h.insertLabel(e,l),r=s.vertex_layout.offset.a_shape,n=s.vertex_layout.stride,o=(t=s.vertex_layout.attribs.find(function(e){return"a_shape"===e.name})).byte_size/t.size,r+=3*o,a=!0,e.ranges.forEach(function(e){if(a){for(var t=0;t<e[1];t++){if(s.vertex_data[e[0]+t*n+r]===i)return void(a=!1);s.vertex_data[e[0]+t*n+r]=i}h.trackMesh(s)}}))}),h.createTextures(i).then(function(){return h.updateMeshes()})}).then(function(e){e.forEach(function(e){return e.valid&&e.upload()}),t.forEach(function(e){e.labeled=!0}),n=[],l={},s={}})}},M_={},R_={},S_=120===new Uint8Array(new Uint32Array([305419896]).buffer)[0];function P_(e,t,i,r,n){var o=e.container,a=o.label,s=o.linked,l=e.ranges;return{label:new k_(a,i,r,n),linked:s,ranges:l,mesh:t}}var z_=function(){function t(e){pr(this,t),this.textureManager=Lo(e),this.tiles={},this.meshes=[],this.containers=[]}return vr(t,[{key:"insertLabel",value:function(e,t){var i=e.label.text_data,r=i.text_settings_key,n=i.text,o=i.text_info;this.containers.push(e);var a=this._ensureTextSection(t,r);a[n]?e.label.text_data.text_info=a[n]:a[n]=o}},{key:"trackMesh",value:function(e){-1===this.meshes.indexOf(e)&&this.meshes.push(e)}},{key:"updateMeshes",value:function(){var h=this;return this.containers.forEach(function(e){var t,i,r,n,o,a,s,l,u,c;e.label.text_data&&(t=e.label.getTile(),(i=e.mesh).valid?(r=e.label.type,n=e.label.text_data.text_info,h.tiles[t.id]&&h.tiles[t.id].textures&&(o=h.tiles[t.id].textures[0],i.uniforms.u_texture=o,-1===i.textures.indexOf(o)&&i.textures.push(o),"point"===r||"straight"===r?(a="point"===r?n.align[e.label.align].texcoords:n.texcoords[r].texcoord,h.setTexCoords(i,e,a)):"curved"===r&&(s=n.segments.length,l=n.texcoords_stroke,u=n.texcoords.curved,h.setTexCoords(i,e,function(e){return e<s?l[e]:u[e-s].texcoord})))):h.tiles[t.id]&&h.tiles[t.id].textures&&(c=h.tiles[t.id].textures[0],h.textureManager.release(c)))}),this.meshes}},{key:"setTexCoords",value:function(e,t,_){var i,r,n,o,a,p,g=_ instanceof Function;g||(r=(i=Pr(_,4))[0],n=i[1],o=i[2],a=i[3],p=[[r,n],[o,n],[o,a],[r,a]]);var v=e.vertex_layout.stride,m=new DataView(e.vertex_data.buffer),y=e.vertex_layout.offset.a_texcoord;t.ranges.forEach(function(e,t){var i,r,n,o,a,s=Pr(e,3),l=s[0],u=s[1],c=s[2];g&&(r=(i=Pr(_(t),4))[0],n=i[1],o=i[2],a=i[3],p=[[r,n],[o,n],[o,a],[r,a]]);for(var h=c?u/2:0;h<u;h++){var f=p[h%4],d=l+h*v;m.setUint16(d+y,65535*f[0],S_),m.setUint16(d+y+2,65535*f[1],S_)}})}},{key:"createTextures",value:function(n){var o=this;return Promise.all(Object.values(this.tiles).map(function(e){var t=e.id,i=e.key,r=e.texts;return o._createTexturesForTile(n,r,"labels-".concat(i,"-").concat(t),t,o.textureManager).then(function(e){e.length&&(e.forEach(function(e){o.textureManager.retain(e),1<o.textureManager.getRetainCount(e)&&o.textureManager.release(e)}),o.tiles[t].textures=e)})}))}},{key:"_createTexturesForTile",value:function(e,t,i,r,n){var o=new Dc,a=o.setTextureTextPositions(t);return o.rasterize(t,a,r,i,e,n)}},{key:"_ensureTile",value:function(e){var t=e.id,i=e.key;return this.tiles[t]||(this.tiles[t]={id:t,key:i,texts:{}}),this.tiles[t]}},{key:"_ensureTextSection",value:function(e,t){var i=this._ensureTile(e).texts;return i[t]||(i[t]={}),i[t]}}]),t}(),N_=function(){function n(e){var r=this,t=e.scene,i=e.view;pr(this,n),this._scene=t,this._view=i,this._visible_tiles={},this._pyramid=new T_,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=Tn(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),un.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache(function(){var e=.1;navigator&&navigator.deviceMemory?e=5*navigator.deviceMemory/100:window&&window.screen&&(e=window.screen.width/512*window.screen.height/512*.03*3,e=Math.min(e,1));return 1024*e*1024*1024}(),function(e,t,i){r._visible_tiles[e]&&r._visible_tiles[e]===t||t.destroy()})}return vr(n,[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile(function(e){return e.destroy()}),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(e){this._visible_tiles[e.key]=e,this._pyramid.addTile(e)}},{key:"hasTile",value:function(e){return void 0!==this._visible_tiles[e]}},{key:"_forgetTile",value:function(e){var t,i;this.hasTile(e)&&(t=this._visible_tiles[e],this._pyramid.removeTile(t),delete this._visible_tiles[e],t.loaded?this._tile_cache.add(t.key,t,function(e){var t=0;for(var i in e.meshes)for(var r=e.meshes[i],n=0;n<r.length;n++){var o=r[n];t+=o.buffer_size;for(var a=0;a<o.textures.length;a++)t+=e.textureManager.getByteLength(o.textures[a])}return t}(t)):(i=this._tile_cache.get(t.key))?this._tile_cache.drop(i.key):t.destroy(),this._tileBuildStop(t))}},{key:"removeTile",value:function(e){this._forgetTile(e),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(e){for(var t in this._visible_tiles)e(this._visible_tiles[t])}},{key:"removeTiles",value:function(e){for(var t in this._visible_tiles)e(this._visible_tiles[t])&&this.removeTile(t)}},{key:"removeCachedTiles",value:function(i){var r=this;this._tile_cache.forEach(function(e,t){i(t)&&r._tile_cache.drop(e)})}},{key:"updateTilesForView",value:function(e){var t=0<arguments.length&&void 0!==e&&e;this._visible_coords={};for(var i=this._view.findVisibleTileCoordinates(),r=0;r<i.length;r++){var n=i[r];this._visible_coords[n.key]=n}this.updateTileStates(t)}},{key:"updateTileStates",value:function(e){var t=0<arguments.length&&void 0!==e&&e;for(var i in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(i,t);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(e){if(e.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[e.coords.key])return!1;for(var t in this._visible_coords)if(Vo.isDescendant(e.coords,this._visible_coords[t]))return!1}return!e.isProxy()}},{key:"_updateLabels",value:function(){var e,t=this;this._building_tiles&&0!==Object.keys(this._building_tiles).length||(Dc.pruneTextCache(),e=this._renderable_tiles.sort(O_),E_.mainThreadLabelCollisionPass(e,function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,r=Math.pow(10,i);return Math.round(Math.floor(e*t)/t*r)/r}(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then(function(){t._is_labeled=!So.hasPendingTasks(),t._scene.immediateRedraw(),t._update_labels_on_queue_check=!1}))}},{key:"_updateProxyTiles",value:function(){var n,o=this,a=this._view.lookAtManipulator.getZoomDirection();0!==a&&(n=!1,this.forEachVisibleTile(function(e){var t;if(e.setProxyFor(null),1===a)e.built||(t=o._pyramid.getAncestor(e))&&(t.setProxyFor(e),n=!0);else if(-1===a&&!e.built)for(var i=o._pyramid.getDescendants(e),r=0;r<i.length;r++)i[r].setProxyFor(e),n=!0}),n||this._view.lookAtManipulator.resetZoomDirection())}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var e in this._renderable_tiles=[],this._visible_tiles){var t=this._visible_tiles[e],i=this._tile_cache.get(e);t.loaded?(this._renderable_tiles.push(t),i&&i!==t&&this._tile_cache.drop(e)):i&&(i.generation===this._scene.generation?this._renderable_tiles.push(i):this._tile_cache.drop(e))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(e,t){var i=t.has_volatile_data?this._scene.getWorkers(zl)[0]:t.tiled?this._scene.getWorkers(Pl)[Math.abs(e.x+e.y+e.z)%this._scene.num_workers]:this._scene.getWorkers(Pl)[t.id%this._scene.num_workers];return i}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var e=this._renderable_tiles,t={},i=0;i<e.length;i++){var r=e[i];Object.keys(r.meshes).forEach(function(e){return t[e]=!0})}return this._active_styles=Object.keys(t),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var e=!1;for(var t in this._visible_tiles){if(!this._visible_tiles[t].built){e=!0;break}}return e}},{key:"updateTilesVisibilityCounters",value:function(){var t=this;Object.keys(this._visible_coords).forEach(function(e){e in t._tile_visibility_counters||(t._tile_visibility_counters[e]=0)});var e=Object.keys(this._tile_visibility_counters),i=[];e.forEach(function(e){e in t._visible_coords?(t._tile_visibility_counters[e]++,30<=t._tile_visibility_counters[e]&&i.push(t._visible_coords[e])):(t._tile_visibility_counters[e]--,t._tile_visibility_counters[e]<=0&&delete t._tile_visibility_counters[e])}),i.length&&this.loadCoordinates(i)}},{key:"loadCoordinates",value:function(e){var l=this;e.sort(function(e,t){var i=l._view.lookAtManipulator.getLookAtData().position,r=Jr.metersPerTile(e.z)/2,n=Jr.metersForTile(e);n.x+=r,n.y-=r;var o=Jr.metersForTile(t);o.x+=r,o.y-=r;var a=Math.abs(i[0]-n.x)+Math.abs(i[1]-n.y),s=Math.abs(i[0]-o.x)+Math.abs(i[1]-o.y);return(e.center_dist=a)<(t.center_dist=s)?-1:s===a?0:1}),e.forEach(function(e){return l.loadCoordinate(e)})}},{key:"_keepCoordinate",value:function(e,t){var i=1<arguments.length&&void 0!==t&&t,r=this._visible_coords[e];if(r.z===this._view.center_tile.z)for(var n in this._scene.sources){var o,a,s,l=this._scene.sources[n];l.builds_geometry_tiles&&l.includesTile(r,this._view.lookAtManipulator.getLookAtData().tile_level)&&((o=Vo.normalizedKey(r,l,this._view.lookAtManipulator.getLookAtData().tile_level))&&!this.hasTile(o)&&((a=i&&this._tile_cache.get(o))||(this._all_visible_tiles_are_cached=!1),s=a||new Vo({source:l,coords:r,worker:this.getWorkerForTile(r,l),style_zoom:kn.zoomToTileLevel(r.z),view:this._view,sceneId:this._scene.id}),"ObjectSource"===l.config.type&&(s.syncedAt=l.getSyncedAt()),this.keepTile(s)))}}},{key:"loadCoordinate",value:function(e){if(e.z===this._view.center_tile.z)for(var t in this._scene.sources){var i,r=this._scene.sources[t];r.builds_geometry_tiles&&r.includesTile(e,this._view.lookAtManipulator.getLookAtData().tile_level)&&(i=Vo.normalizedKey(e,r,this._view.lookAtManipulator.getLookAtData().tile_level),this.hasTile(i)&&this.buildTile(this._visible_tiles[i]))}}},{key:"buildTile",value:function(e,t){this._building_tiles&&this._building_tiles[e.key]||e.built&&e.generation===this._scene.generation||(this._tileBuildStart(e.key),e.build(this._scene.generation,t))}},{key:"buildTileStylesCompleted",value:function(e){var t=e.tile,i=e.progress;if(null==this._visible_tiles[t.key])Vo.abortBuild(t,this._scene.id);else if(t.generation!==this._scene.generation)Vo.abortBuild(t,this._scene.id);else{if(t.id<this._visible_tiles[t.key].id)return void Vo.abortBuild(t,this._scene.id);t=this._visible_tiles[t.key].merge(t),i.done&&(t.built=!0),t.buildMeshes(this._scene.styles,i),this.updateTileStates(),this._scene.requestRedraw()}i.done&&this._tileBuildStop(t)}},{key:"buildTileError",value:function(e){this._forgetTile(e.key),Vo.abortBuild(e,this._scene.id)}},{key:"_tileBuildStart",value:function(e){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[e]=!0}},{key:"_tileBuildStop",value:function(e){this._building_tiles&&(e.source&&e.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[e.key],this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&0!==Object.keys(this._building_tiles).length||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!So.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(e,t){var i=t.source;return!this._visible_tiles[e]&&(t.generation!==this._scene.generation||"ObjectSource"===i.config.type&&i.getSyncedAt()>t.syncedAt)}}]),n}();function O_(e,t){var i=e.coords,r=t.coords;return i.z-r.z||i.x-r.x||i.y-r.y}function I_(t){pr(this,I_),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=t.BACK,this.defaults.blending=!1,this.defaults.blending_src=t.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=t.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=t.ONE,this.defaults.blending_dst_alpha=t.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,t.depthFunc(t.LESS),this.culling=new L_({cull:this.defaults.culling,face:this.defaults.culling_face},function(e){e.cull?(t.enable(t.CULL_FACE),t.cullFace(e.face)):t.disable(t.CULL_FACE)}),this.blending=new L_({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},function(e){e.blend?(t.enable(t.BLEND),e.src_alpha&&e.dst_alpha?t.blendFuncSeparate(e.src,e.dst,e.src_alpha,e.dst_alpha):t.blendFunc(e.src,e.dst)):t.disable(t.BLEND)}),this.depth_write=new L_({depth_write:this.defaults.depth_write},function(e){t.depthMask(e.depth_write)}),this.depth_test=new L_({depth_test:this.defaults.depth_test},function(e){e.depth_test?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)})}var L_=function(){function i(e,t){pr(this,i),t(e),this.value=e,this.setup=t}return vr(i,[{key:"get",value:function(){return this.value}},{key:"set",value:function(e){JSON.stringify(this.value)!==JSON.stringify(e)&&(this.setup(e),this.value=e)}}]),i}(),C_=function(){function e(){pr(this,e),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null}return vr(e,[{key:"setCanvas",value:function(e,t){this.canvas=e,this.gl=t}},{key:"screenshot",value:function(e){var i=this,t=(0<arguments.length&&void 0!==e?e:{}).background;return null!=this.queue_screenshot||(this.queue_screenshot={background:t},this.queue_screenshot.promise=new Promise(function(e,t){i.queue_screenshot.resolve=e,i.queue_screenshot.reject=t})),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(null!=this.queue_screenshot){var e=this.canvas.width,t=this.canvas.height,i=new Uint8Array(e*t*4);this.gl.readPixels(0,0,e,t,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i);for(var r=(r=this.queue_screenshot.background)&&"transparent"!==r?mo.parseColor(r).slice(0,3).map(function(e){return 255*e}):null,n=new Uint8ClampedArray(e*t*4),o=0;o<t;o++)for(var a=0;a<e;a++){var s=4*((t-o-1)*e+a),l=4*(o*e+a),u=i[3+s];n[0+l]=255*i[0+s]/u,n[1+l]=255*i[1+s]/u,n[2+l]=255*i[2+s]/u,n[3+l]=u,r&&(u/=255,n[0+l]=n[0+l]*u+r[0]*(1-u),n[1+l]=n[1+l]*u+r[1]*(1-u),n[2+l]=n[2+l]*u+r[2]*(1-u),n[3+l]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var c=this.screenshot_canvas;c.width=e,c.height=t,this.screenshot_context=this.screenshot_context||c.getContext("2d");var h=this.screenshot_context,f=new ImageData(n,e,t);h.putImageData(f,0,0);for(var d=c.toDataURL("image/png"),_=atob(d.slice(22)),p=new Uint8Array(_.length),g=0;g<_.length;++g)p[g]=_.charCodeAt(g);var v=new Blob([p],{type:"image/png"});this.queue_screenshot.resolve({url:d,blob:v,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var r=this;if("function"!=typeof window.MediaRecorder||!this.canvas||"function"!=typeof this.canvas.captureStream)return An("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return An("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var n=this.video_capture={};n.chunks=[],n.stream=this.canvas.captureStream(),n.options={mimeType:"video/webm"},n.media_recorder=new MediaRecorder(n.stream,n.options),n.media_recorder.ondataavailable=function(e){var t,i;0<e.data.size&&n.chunks.push(e.data),n.resolve&&(i=On(t=new Blob(n.chunks,{type:n.options.mimeType})),n.stream&&(n.stream.getTracks()||[]).forEach(function(e){e.stop(),n.stream.removeTrack(e)}),n.stream=null,n.media_recorder=null,r.video_capture=null,n.resolve({url:i,blob:t,type:"webm"}))},n.media_recorder.start()}catch(e){return this.video_capture=null,An("error","Scene video capture failed",e),!1}return!0}},{key:"stopVideoCapture",value:function(){var i=this;return this.video_capture?(this.video_capture.promise=new Promise(function(e,t){i.video_capture.resolve=e,i.video_capture.reject=t}),this.video_capture.media_recorder.stop(),this.video_capture.promise):(An("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}]),e}(),F_=function(){function e(){pr(this,e),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1}return vr(e,[{key:"init",value:function(e,t,i,r,n,o){return this.scene_id=e,this.textureManager=Lo(e),this._worker_id=t,An.setLevel(i),kn.device_pixel_ratio=r,cu.setElementIndexUint(n),Hl.setPrefix(this._worker_id),this._style_manager=new Vh,this._importExternalScripts(o),bc.id_prefix=t,this._isConfigured=!1,t}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(e){var t;0!==e.length&&(An("debug","loading custom data source scripts in worker:",e),t=Object.getOwnPropertyNames(window),importScripts.apply(void 0,zr(e)),Object.getOwnPropertyNames(window).forEach(function(e){-1===t.indexOf(e)&&(self[e]=window[e])}))}},{key:"updateConfig",value:function(e,t){var i,r=e.config,n=e.generation,o=e.introspection,r=JSON.parse(r);for(var a in i=t,Object.assign(kl,i),this._generation=n,this._isConfigured=!1,r.layers)r.layers[a]&&(r.layers[a].data=kn.stringsToFunctions(r.layers[a].data));this.global=kn.stringsToFunctions(r.global),this._createDataSources(r),r.styles=kn.stringsToFunctions(r.styles,mo.wrapFunction),this.styles=this._style_manager.build(r.styles),self.is_fake_worker=ln.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:o,id:this.scene_id}),delete self.is_fake_worker,this.layers=function(e,t){d_={};var i={};for(var r in e){var n=e[r];n&&(i[r]=b_(r,n,null,t))}return i}(r.layers,this._style_manager.styles),this._configuring=this._syncTextures(r.textures)}},{key:"_createDataSources",value:function(t){var i=this;this._last_config_sources=this._config_sources||{},this._config_sources=t.sources;var e=this.sources,r=[];for(var n in t.sources=kn.stringsToFunctions(t.sources),this.sources={},self.is_fake_worker=ln.is_main,t.sources)if(JSON.stringify(this._last_config_sources[n])!==JSON.stringify(t.sources[n])){var o=void 0;try{o=In.create(Object.assign({},t.sources[n],{name:n}),this.sources)}catch(e){An("error","Error creating source.",e.message,t.sources[n]);continue}o&&(this.sources[n]=o,r.push(n))}else this.sources[n]=e[n];delete self.is_fake_worker,r.forEach(function(e){for(var t in i.tiles)i.tiles[t].source===e&&delete i.tiles[t]})}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(t){var i=this;if((this._isConfigured=!0)!==t.loaded)t.loading=!0,t.loaded=!1,t.error=null,this._loadTileSourceData(t).then(function(){if(i.getTile(t.id)){t.loading=!1,t.loaded=!0;try{Vo.buildGeometry(t,i)}catch(e){t.error=e.toString(),un.postMessage("TileManager_".concat(i.scene_id,".buildTileError"),Vo.slice(t))}}else An("trace","stop tile build after data source load because tile was removed. Key: ".concat(t.key,", id: ").concat(t.id))},function(e){t.loading=!1,t.loaded=!1,t.error=e.stack,An("error","tile load error for tile with key ".concat(t.key," and id ").concat(t.id,": ").concat(t.error)),un.postMessage("TileManager_".concat(i.scene_id,".buildTileError"),Vo.slice(t))});else{An("trace","used worker cache for tile with key ".concat(t.key," and id ").concat(t.id));try{Vo.buildGeometry(t,this)}catch(e){t.error=e.toString(),un.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),Vo.slice(t))}}}},{key:"buildTile",value:function(e){var t,i=e.tile,r=this.getTile(i.id);r&&r.loading||(i=this.tiles[i.id]=Object.assign(r||{},i),this._isConfigured?this._onConfig(i):(t=this).awaitConfiguration().then(function(){return t._onConfig(i)}))}},{key:"_loadTileSourceData",value:function(e){return this.sources[e.source]?this.sources[e.source].load(e):(e.source_data={},Promise.resolve(e))}},{key:"getTile",value:function(e){return this.tiles[e]}},{key:"removeTile",value:function(e){var t=this.tiles[e];null!=t&&(!0===t.loading&&(An("trace","cancel tile load for tile id ".concat(e)),t.loading=!1,Vo.cancel(t)),delete this.tiles[e],An("trace","remove tile from cache, tile id: ".concat(e)))}},{key:"queryFeatures",value:function(e){var o=this,a=e.filter,s=e.visible,l=e.geometry,t=e.tile_ids,u=[],i=t.map(function(e){return o.tiles[e]}).filter(function(e){return e});return null!=a&&(a=-1<["{","["].indexOf(a[0])?JSON.parse(a):a,a=kn.stringsToFunctions(a,mo.wrapFunction)),a=h_(a,y_),i.forEach(function(n){for(var e in n.source_data.layers)!function(r){n.source_data.layers[r].features.forEach(function(e){var t,i;!0===s&&e.generation!==o._generation||!1===s&&e.generation===o._generation||((t=mo.getFeatureParseContext(e,n,o.global)).source=n.source,t.layer=r,a(t)&&(i={type:e.type,properties:e.properties},!0===l&&(i.geometry=Jr.copyGeometry(e.geometry),Jr.tileSpaceToLatlng(i.geometry,n.coords.z,n.min)),u.push(i)))})}(e)}),u}},{key:"resetFeatureSelection",value:function(){Hl.reset()}},{key:"_syncTextures",value:function(e){var t=[];return e&&t.push.apply(t,zr(Object.keys(e))),An("trace","sync textures to worker:",t),0<t.length?this.textureManager.syncTexturesToWorker(t):Promise.resolve()}},{key:"profile",value:function(e){console.profile("worker ".concat(this._worker_id,": ").concat(e))}},{key:"profileEnd",value:function(e){console.profileEnd("worker ".concat(this._worker_id,": ").concat(e))}},{key:"terminate",value:function(){this.dispose()}}]),e}();(ln.is_worker||self.H&&self.H.DEBUG)&&un.addTarget("self",new F_);var D_=function(){function l(e,t){pr(this,l),t=t||{},No(this),this.id=l.id++,this.textureManager=Lo(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new Th(this,t),this.tile_manager=new N_({scene:this,view:this.view}),this.num_workers=t.numWorkers||2,!0===t.disableVertexArrayObjects&&(ql.disabled=!0),kn.device_pixel_ratio=t.devicePixelRatio,this.config=null,this.config_source=e,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new Vh,this.building=null,this.dirty=!0,t.preUpdate&&this.subscribe({pre_update:t.preUpdate}),t.postUpdate&&this.subscribe({post_update:t.postUpdate}),this.render_loop=!t.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new C_,this.selection=null,this.introspection=!0===t.introspection,this.viewport=t.viewport,this.container=t.container,this.canvas=null,this.contextOptions=t.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=l.generation,this.last_complete_generation=l.generation,this.log_level=t.logLevel||"warn",An.setLevel(this.log_level),An.reset()}return vr(l,[{key:"load",value:function(e,t){var r=this,i=0<arguments.length&&void 0!==e?e:null,n=1<arguments.length&&void 0!==t?t:{};return this.initializing||(An.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(n="string"==typeof n?{base_path:n}:n).blocking=void 0===n.blocking||n.blocking,!1!==this.render_loop&&this.setupRenderLoop(),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(i,n).then(function(){return r.createWorkers()}).then(function(){r.resetFeatureSelection();var e="object"===_r(r.config_source)||r.hasSubscribersFor("load"),t=r.updateConfig({serialize_funcs:e,normalize:!1,load_event:!0,fade_in:!0});if(!0===n.blocking)return t}).then(function(){r.updating--,r.initializing=null,r.initialized=!0,r.last_valid_config_source=r.config_source,r.last_valid_options={base_path:n.base_path,file_type:n.file_type},r.requestRedraw()}).catch(function(e){var t,i;if(r.initializing=null,r.updating=0,i="YAMLException"===e.name?(t="yaml","Error parsing scene YAML"):"Error initializing scene",r.trigger("error",{type:t,message:i,error:e,url:r.config_source}),i="Scene.load() failed to load ".concat(r.config_source,": ").concat(e.message),r.last_valid_config_source)return An("warn",i,e),An("info","Scene.load() reverting to last valid configuration"),r.load(r.last_valid_config_source,r.last_valid_base_path);throw An("error",i,e),e})),this.initializing}},{key:"destroy",value:function(){var e;this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl&&(this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},Vl.reset(),(e=this.gl.getExtension("WEBGL_lose_context"))&&e.loseContext(),this.gl=null),this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),An.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=Ol.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:kn.device_pixel_ratio},this.contextOptions)),navigator.appVersion.includes("iPhone")&&this.gl.depthRange(.994,1)}catch(e){throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),ql.init(this.gl),this.render_states=new I_(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var e,t;if(void 0!==W_&&(t="("+W_+")()",K_&&""!==Z_&&(t+="\n//# sourceMappingURL="+K_.slice(0,K_.lastIndexOf("/")+1)+Z_),e=On(new Blob([t],{type:"application/javascript"}))),!e)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return e}},{key:"updateExternalScripts",value:function(){var i=zr(this.external_scripts||[]),e=[];if(this.config.scene.scripts)for(var t in this.config.scene.scripts)-1===e.indexOf(this.config.scene.scripts[t])&&e.push(this.config.scene.scripts[t]);for(var r in this.config.sources){var n=this.config.sources[r];if(n.scripts)for(var o in n.scripts)-1===e.indexOf(n.scripts[o])&&e.push(n.scripts[o])}return this.external_scripts=e,!(this.external_scripts.length===i.length&&this.external_scripts.every(function(e,t){return e===i[t]}))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(i){var r=this,n=!!this.gl.getExtension("OES_element_index_uint"),o=[];this._workers=[];for(var a=0;a<this.num_workers;a++)!function(){var e=new Worker(i);r._workers[a]=e,un.addWorker(e),An("debug","Scene.makeWorkers: initializing worker ".concat(a));var t=a;o.push(un.postMessage(e,"self.init",r.id,a,r.log_level,kn.device_pixel_ratio,n,r.external_scripts).then(function(e){return An("debug","Scene.makeWorkers: initialized worker ".concat(e)),e},function(e){return An("error","Scene.makeWorkers: failed to initialize worker ".concat(t,":"),e),Promise.reject(e)}))}();var e=new F_;return this._workers.push(e),o.push(e.init(this.id,a,this.log_level,kn.device_pixel_ratio,n,[])),this.next_worker=0,Promise.all(o).then(function(){var e;An.setWorkers(r._workers.slice(0,r.num_workers)),e=i,void 0===Mn&&"function"!=typeof(Mn=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)&&(Mn=null,An("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),Mn&&Mn(e)})}},{key:"getWorkers",value:function(t){return this._workers.filter(function(e){switch(t){case Pl:return e instanceof Worker;case zl:return e instanceof F_;default:return!0}})}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&(An.setWorkers(null),this._workers.forEach(function(e){e.terminate()}),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||0===Object.keys(this.sources).length)}},{key:"handleViewportUpdate",value:function(){var e=this.viewport,t=e.width,i=e.height;0<t&&0<i&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&Ol.resize(this.gl,t,i,kn.device_pixel_ratio))}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),So.setState({user_moving_view:this.view.user_input_active}),So.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var e=this;this.render_loop_active||setTimeout(function(){e.renderLoop()},0)}},{key:"update",value:function(){var e=this.dirty,t=!!this.selection&&this.selection.hasPendingRequests(),i=!(!1===e&&!1===t||!1===this.initialized||0<this.updating||!1===this.ready());return this.trigger("pre_update",i),this.view.update(),i&&(this.dirty=!1,this.render({main:e,selection:t}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",i),!0!==this.animated&&!this.view.isAnimating()||(this.dirty=!0),this.frame++,An("trace","Scene.render()"),!0)}},{key:"render",value:function(e){var t=this,i=e.main,r=e.selection,n=this.gl;if(Object.keys(this.lights).forEach(function(e){return t.lights[e].update()}),i&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),r){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,this.canvas.width,this.canvas.height),n.clearColor.apply(n,zr(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:r})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(e,t){var i=this,r=0<arguments.length&&void 0!==e?e:"program",n=(1<arguments.length&&void 0!==t?t:{}).allow_blend,o=this.gl,n=null==n||n;this.clearFrame();for(var a,s=nu.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map(function(e){return i.styles[e]}).filter(function(e){return e})),l=0,u=0,c=0;c<s.length;c++){var h,f,d=s[c],_=u-(h=parseInt(d.name));(d.clean_depth||_)&&(this.render_states.depth_write.value.depth_write?o.clear(o.DEPTH_BUFFER_BIT):(o.depthMask(!0),o.clear(o.DEPTH_BUFFER_BIT),o.depthMask(!1)),_&&(u=h)),d.blend!==a&&(f=Object.assign({},nu.render_states[d.blend],{blend:n&&d.blend}),this.setRenderState(f));var p="translucent"===d.blend&&"program"===r;p&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(d.name,r),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),l+=this.renderStyle(d.name,r),p&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),a=d.blend}return l}},{key:"renderStyle",value:function(s,l){for(var u,c=this,h=this.styles[s],f=!0,d=0,_=this.tile_manager.getRenderableTiles(),e=Math.max.apply(Math,zr(_.map(function(e){return e.meshes[s]?Math.max.apply(Math,zr(e.meshes[s].map(function(e){return e.variant.order}))):-1}))),t=0;t<e+1;t++){var i=function(t){for(var e=0;e<_.length;e++){var i=_[e];if(null!=i.meshes[s]&&i.shouldProxyForStyle(s))for(var r=i.meshes[s].filter(function(e){return e.variant.order===t}),n=0,o=r.length;n<o;n+=1){var a=r[n];if(!0===f&&(f=!1,!(u=c.setupStyle(h,l))))return{v:0};c.view.setupTile(i,u),c.selection.setupDiscards(u),h.render(a)&&c.requestRedraw(),d+=a.geometry_count}}}(t);if("object"===_r(i))return i.v}return d}},{key:"setupStyle",value:function(t,e){var i;try{if(!(i=t.getProgram(e)))return}catch(e){return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(t.name),style:t,shader_errors:t.program&&t.program.shader_errors})}for(var r in i.use(),t.setup(),this.view.setupProgram(i),this.lights)this.lights[r].setupProgram(i);return i}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(e){var t,i,r=0<arguments.length&&void 0!==e?e:{},n=r.depth_test,o=r.depth_write,a=r.cull_face,s=r.blend;this.initialized&&(t=this.render_states,n=!1!==n&&t.defaults.depth_test,o=!1!==o&&t.defaults.depth_write,a=!1!==a&&t.defaults.culling,s=null!=s?s:t.defaults.blending,i=this.gl,t.depth_test.set({depth_test:n}),t.depth_write.set({depth_write:o}),t.culling.set({cull:a,face:t.defaults.culling_face}),!s||"opaque"===s?t.blending.set({blend:!1}):"overlay"===s||"inlay"===s||"translucent"===s?t.blending.set({blend:!0,src:i.SRC_ALPHA,dst:i.ONE_MINUS_SRC_ALPHA,src_alpha:i.ONE,dst_alpha:i.ONE_MINUS_SRC_ALPHA}):"add"===s?t.blending.set({blend:!0,src:i.ONE,dst:i.ONE}):"multiply"===s&&t.blending.set({blend:!0,src:i.ZERO,dst:i.SRC_COLOR}))}},{key:"getFeatureAt",value:function(e,t,i){var r,n=t.radius,o=t.top_most_only;this.initialized?(r={x:e.x/this.view.size.css.width,y:e.y/this.view.size.css.height},n=0<n?{x:n/this.view.size.css.width,y:n/this.view.size.css.height}:null,this.selection.getFeatureAt(r,{radius:n,top_most_only:o},i)):An("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},i=t.filter,r=t.unique,l=void 0===r||r,n=t.group_by,u=void 0===n?null:n,o=t.visible,a=void 0===o?null:o,s=t.geometry,c=void 0!==s&&s,i=kn.serializeWithFunctions(i),h=this.tile_manager.getRenderableTiles().map(function(e){return e.id});return un.postMessage(this._workers,"self.queryFeatures",{filter:i,visible:a,geometry:c,tile_ids:h}).then(function(e){var r=[],n={},o={},a=(l="string"==typeof l?[l]:l)&&function(e){return JSON.stringify(Array.isArray(l)?Nl(e,l):e)},s=(u=("string"==typeof u||Array.isArray(u))&&u)&&function(e){return Array.isArray(u)?JSON.stringify(Nl(e,u)):e[u]};return e.forEach(function(e){return e.forEach(function(e){if(a){var t=a(e);if(n[t])return;n[t]=!0}var i;s?(i=s(e.properties),o[i]=o[i]||[],o[i].push(e)):r.push(e)})}),s?o:r})}},{key:"loadScene",value:function(e,t){var r=this,i=0<arguments.length&&void 0!==e?e:null,n=1<arguments.length&&void 0!==t?t:{},o=n.base_path,a=n.file_type;return this.config_source=i||this.config_source,"string"==typeof this.config_source?this.base_path=Pn(o||this.config_source):this.base_path=Pn(o),this.config_path=this.base_path,A_.loadScene(this.config_source,{path:this.base_path,type:a}).then(function(e){var t=e.config,i=e.bundle;return r.config=t,r.config_bundle=i,r.config})}},{key:"createDataSources",value:function(){var t=this,i=[],e=Object.keys(this.sources),r=0;for(var n in this.config.sources){var o=this.config.sources[n],a=this.sources[n];try{var s=Object.assign({},o,{name:n,id:r++});if(this.sources[n]=In.create(s,this.sources),!this.sources[n])throw{}}catch(e){delete this.sources[n];var l="Could not create data source: ".concat(e.message);An("warn","Scene: ".concat(l),o),this.trigger("warning",{type:"sources",source:o,message:l})}In.changed(this.sources[n],a)&&i.push(n)}for(var u in e.forEach(function(e){t.config.sources[e]||(delete t.sources[e],i.push(e))}),0<i.length&&this.tile_manager.removeTiles(function(e){return-1<i.indexOf(e.source.name)}),this.config.layers){var c=this.config.layers[u];!1!==c.enabled&&c.data&&this.sources[c.data.source]&&(this.sources[c.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var e=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then(function(){return e.textureManager.createDefault(e.gl)})}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var e in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[e].setGL(this.gl);this.dirty=!0}},{key:"createLights",value:function(){for(var e in this.lights={},this.config.lights){var t;this.config.lights[e]&&"object"===_r(this.config.lights[e])&&((t=this.config.lights[e]).name=e.replace("-","_"),t.visible=!1!==t.visible,t.visible&&(this.lights[t.name]=$l.create(this.view,t)))}$l.inject(this.lights)}},{key:"setBackground",value:function(){var e,t=this.config.scene.background;this.background={},t&&t.color&&(this.background.color=mo.parseColor(t.color)),this.background.color||(this.background.color=[0,0,0,0]),1===this.background.color[3]?this.canvas.style.backgroundColor="rgba(".concat(this.background.color.map(function(e){return Math.floor(255*e)}).join(", "),")"):this.canvas.style.backgroundColor="transparent",(e=this.gl).clearColor.apply(e,zr(this.background.color))}},{key:"setIntrospection",value:function(e){var t=this;return e!==this.introspection?(this.introspection=e||!1,this.updating++,this.updateConfig({normalize:!1}).then(function(){return t.updating--})):Promise.resolve()}},{key:"updateConfig",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},i=t.load_event,r=void 0!==i&&i,n=t.serialize_funcs,o=t.normalize,a=void 0===o||o;t.fade_in;this.generation=++l.generation,this.updating++,this.config=A_.applyGlobalProperties(this.config),a?A_.normalize(this.config,this.config_bundle):(A_.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),A_.normalizeTextures(this.config,this.config_bundle)),this.trigger(r?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),Fc.loadFonts(this.config.fonts),this.updateStyles();var s=this.syncConfigToWorker({serialize_funcs:n});return this.updating--,this.view.updateBounds(),this.requestRedraw(),s}},{key:"syncConfigToWorker",value:function(e){var t=(0<arguments.length&&void 0!==e?e:{}).serialize_funcs,i=void 0===t||t?kn.serializeWithFunctions(this.config):JSON.stringify(this.config);return un.postMessage(this._workers,"self.updateConfig",{config:i,generation:this.generation,introspection:this.introspection},Rl)}},{key:"createListeners",value:function(){var t=this;this.listeners={},this.listeners.view={move:function(){return t.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return t.dirty=!0},warning:function(e){return t.trigger("warning",Object.assign({type:"textures"},e))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(e){return t.trigger("error",Object.assign({type:"scene"},e))}},A_.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),A_.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&un.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new Hl(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(e){var t=(0<arguments.length&&void 0!==e?e:{}).background,i=void 0===t?"white":t;return this.requestRedraw(),this.media_capture.screenshot({background:i})}},{key:"pixelRatio",value:function(){return kn.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(e){console.profile("main thread: ".concat(e)),un.postMessage(this._workers,"self.profile",e)}},{key:"_profileEnd",value:function(e){console.profileEnd("main thread: ".concat(e)),un.postMessage(this._workers,"self.profileEnd",e)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}},{key:"animated",get:function(){var t=this;return void 0!==this.config.scene.animated?this.config.scene.animated:this.tile_manager.getActiveStyles().some(function(e){return t.styles[e]&&t.styles[e].animated})}}],[{key:"create",value:function(e,t){return new l(e,1<arguments.length&&void 0!==t?t:{})}}]),l}();D_.id=0,D_.generation=0;var j_=function(){br(u,zo);var l=Rr(u);function u(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};pr(this,u);var n=Math.pow(2,r.coords.z),o=Math.abs(Math.floor(r.coords.x/n)),a=Math.abs(n*o-Math.abs(r.coords.x)),s=r.coords;return r.coords={x:a,y:s.y,z:s.z},l.call(this,e,t,i,r)}return vr(u,[{key:"load",value:function(r){var n=this;if(!r||!r.uid)return Sr(wr(u.prototype),"load",this).call(this,r);var o=r.coords,a=new Uint8Array([0,0,0,0]);return this.loading=new Promise(function(e,t){var i=H.map.DataModel.invoke(r.uid,"requestTileAsPromise",[o.x,o.y,o.z])||null;i?i.then(function(e){var t=e.data;n.loaded=!0,t&&!(t instanceof ArrayBuffer)&&("IMG"===t.tagName.toUpperCase()||"CANVAS"===t.tagName.toUpperCase())?n.setElement(t,r):n.setData(1,1,a,{filtering:"nearest"})},function(){n.loaded=!1}).then(e,function(e){return t(e)}):t(new Error("Unable to invoke on target "+r.uid))}),this.loading}}]),u}();Oo.register(j_,function(e){return e&&e.uid});var U_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",G_=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],B_=1,V_="undefined"!=typeof BigInt?BigInt:Number;function q_(e){var t=e;return t&V_(1)&&(t=~t),+(t>>=V_(1)).toString()}function H_(e){for(var t="",i=V_(e);31<i;){var r=i&V_(31)|V_(32);t+=U_[r],i>>=V_(5)}return t+U_[i]}function Y_(e){var t=V_(e),i=t<0;return t<<=V_(1),i&&(t=~t),H_(t)}var X_={encode:function(e){var t=e.precision,i=void 0===t?5:t,r=e.thirdDim,n=void 0===r?0:r,o=e.thirdDimPrecision,a=void 0===o?0:o,s=e.polyline,l=Math.pow(10,i),u=Math.pow(10,a),c=function(e,t,i){if(e<0||15<e)throw new Error("precision out of range. Should be between 0 and 15");if(i<0||15<i)throw new Error("thirdDimPrecision out of range. Should be between 0 and 15");if(t<0||7<t||4===t||5===t)throw new Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");var r=i<<7|t<<4|e;return H_(B_)+H_(r)}(i,n,a),h=[],f=V_(0),d=V_(0),_=V_(0);return s.forEach(function(e){var t=V_(Math.round(e[0]*l));h.push(Y_(t-f)),f=t;var i,r=V_(Math.round(e[1]*l));h.push(Y_(r-d)),d=r,n&&(i=V_(Math.round(e[2]*u)),h.push(Y_(i-_)),_=i)}),[].concat(zr(c),h).join("")},decode:function(e){for(var t=function(e){var r=V_(0),n=V_(0),o=[];if(e.split("").forEach(function(e){var t,i=V_((t=e.charCodeAt(0),G_[t-45]));r|=(i&V_(31))<<n,(i&V_(32))===V_(0)?(o.push(r),r=V_(0),n=V_(0)):n+=V_(5)}),0<n)throw new Error("Invalid encoding");return o}(e),i=function(e,t){if(+e.toString()!==B_)throw new Error("Invalid format version");var i=+t.toString();return{precision:15&i,thirdDim:i>>4&7,thirdDimPrecision:i>>7&15}}(t[0],t[1]),r=Math.pow(10,i.precision),n=Math.pow(10,i.thirdDimPrecision),o=i.thirdDim,a=0,s=0,l=0,u=[],c=2;c<t.length;){a+=q_(t[c])/r,s+=q_(t[c+1])/r,o?(l+=q_(t[c+2])/n,u.push([a,s,l]),c+=3):(u.push([a,s]),c+=2)}if(c!==t.length)throw new Error("Invalid encoding. Premature ending reached");return xr(xr({},i),{},{polyline:u})},ABSENT:0,LEVEL:1,ALTITUDE:2,ELEVATION:3};self.H=self.H||{},self.H.gl={DataSource:In,Geo:Jr,MathUtils:Kr,Scene:D_,Task:So,Tile:Vo,WorkerBroker:un,log:An,SceneLoader:A_,yaml:t_,flexpolyline:X_}}()};e()}();

/**!
 * The code below uses open source software. Please visit the URL below for an overview of the licenses: 
 * https://sdk.venues.here.com/v3/3.1/HERE_NOTICE 
 */
this.H=this.H||{},this.H.venues=function(e){"use strict";function t(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function f(e,t,n){return(f=s()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(r){var i=s();return function(){var e,t=v(r);if(i){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?d(e):t}(this,e)}}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t(".H_l_right .venues-ui__drawings .trigger.button--active .arrow {\n  transform: rotate(90deg); }\n\n.H_l_right .venues-ui__drawings .drawings {\n  right: 45px;\n  left: initial; }\n");var m=function(){l(r,H.map.Feature);var n=g(r);function r(e){var t;return h(this,r),(t=n.call(this)).id=e.id,t.model=e,t}return u(r,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var e=T(this.model.getCenter(),2),t=e[0],n=e[1];return new H.geo.Point(n,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}]),r}(),_=function(){l(r,H.map.Feature);var n=g(r);function r(e){var t;return h(this,r),(t=n.call(this)).id=e.id,t.model=e,t}return u(r,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return f(H.geo.Rect,b(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var e=T(this.model.getCenter(),2),t=e[0],n=e[1];return new H.geo.Point(n,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(t){return this.getLevels().find(function(e){return e.id===t})}},{key:"getLevels",value:function(){var t=this.getData().getLevels().map(function(e){return e.getId()});return this.getVenue().getLevels().filter(function(e){return-1!==t.indexOf(e.id)})}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getId())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}]),r}(),E=function(){l(r,H.map.Feature);var n=g(r);function r(e){var t;return h(this,r),(t=n.call(this)).id=e.id,t.model=e,t}return u(r,[{key:"getGeometry",value:function(t){return this.getGeometries().find(function(e){return e.id===t})}},{key:"getGeometries",value:function(){var t=this.getData().getGeometries().map(function(e){return e.getId()});return this.getDrawing().getVenue().getGeometries().filter(function(e){return-1!==t.indexOf(e.id)})}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}]),r}();function I(e,t,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((e-n)*a+(t-r)*s)/(a*a+s*s);1<u?(n=i,r=o):0<u&&(n+=a*u,r+=s*u)}return(a=e-n)*a+(s=t-r)*s}function M(e,t,n,r){var i={id:void 0===e?null:e,type:t,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,n=e.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)A(e,t);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<t.length;r++)A(e,t[r]);else if("MultiPolygon"===n)for(r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++)A(e,t[r][i])}(i),i}function A(e,t){for(var n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function O(e,t,n,r){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=t.id;if(n.promoteId?u=t.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)k(i,s);else if("MultiPoint"===o)for(var l=0;l<i.length;l++)k(i[l],s);else if("LineString"===o)S(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(l=0;l<i.length;l++)s=[],S(i[l],s,a,!1),e.push(M(u,"LineString",s,t.properties));return}N(i,s,a,!1)}else if("Polygon"===o)N(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(l=0;l<t.geometry.geometries.length;l++)O(e,{id:u,geometry:t.geometry.geometries[l],properties:t.properties},n,r);return}for(l=0;l<i.length;l++){var c=[];N(i[l],c,a,!0),s.push(c)}}e.push(M(u,o,s,t.properties))}}function k(e,t){t.push(w(e[0])),t.push(C(e[1])),t.push(0)}function S(e,t,n,r){for(var i,o,a=0,s=0;s<e.length;s++){var u=w(e[s][0]),l=C(e[s][1]);t.push(u),t.push(l),t.push(0),0<s&&(a+=r?(i*l-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(l-o,2))),i=u,o=l}var c=t.length-3;t[2]=1,function e(t,n,r,i){for(var o,a=i,s=r-n>>1,u=r-n,l=t[n],c=t[n+1],h=t[r],v=t[r+1],f=n+3;f<r;f+=3){var d=I(t[f],t[f+1],l,c,h,v);if(a<d)o=f,a=d;else if(d===a){var g=Math.abs(f-s);g<u&&(o=f,u=g)}}i<a&&(3<o-n&&e(t,n,o,i),t[o+2]=a,3<r-o&&e(t,o,r,i))}(t,0,c,n),t[2+c]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function N(e,t,n,r){for(var i=0;i<e.length;i++){var o=[];S(e[i],o,n,r),t.push(o)}}function w(e){return e/360+.5}function C(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:1<n?1:n}function P(e,t,n,r,i,o,a,s){if(r/=t,(n/=t)<=o&&a<r)return e;if(a<n||r<=o)return null;for(var u=[],l=0;l<e.length;l++){var c=e[l],h=c.geometry,v=c.type,f=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(n<=f&&d<r)u.push(c);else if(!(d<n||r<=f)){var g=[];if("Point"===v||"MultiPoint"===v)x(h,g,n,r,i);else if("LineString"===v)V(h,g,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===v)R(h,g,n,r,i,!1);else if("Polygon"===v)R(h,g,n,r,i,!0);else if("MultiPolygon"===v)for(var p=0;p<h.length;p++){var y=[];R(h[p],y,n,r,i,!0),y.length&&g.push(y)}if(g.length){if(s.lineMetrics&&"LineString"===v){for(p=0;p<g.length;p++)u.push(M(c.id,v,g[p],c.tags));continue}"LineString"!==v&&"MultiLineString"!==v||(1===g.length?(v="LineString",g=g[0]):v="MultiLineString"),"Point"!==v&&"MultiPoint"!==v||(v=3===g.length?"Point":"MultiPoint"),u.push(M(c.id,v,g,c.tags))}}}return u.length?u:null}function x(e,t,n,r,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];n<=a&&a<=r&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function V(e,t,n,r,i,o,a){for(var s,u,l=D(e),c=0===i?F:U,h=e.start,v=0;v<e.length-3;v+=3){var f=e[v],d=e[v+1],g=e[v+2],p=e[v+3],y=e[v+4],m=0===i?f:d,_=0===i?p:y,E=!1;a&&(s=Math.sqrt(Math.pow(f-p,2)+Math.pow(d-y,2))),m<n?n<_&&(u=c(l,f,d,p,y,n),a&&(l.start=h+s*u)):r<m?_<r&&(u=c(l,f,d,p,y,r),a&&(l.start=h+s*u)):G(l,f,d,g),_<n&&n<=m&&(u=c(l,f,d,p,y,n),E=!0),r<_&&m<=r&&(u=c(l,f,d,p,y,r),E=!0),!o&&E&&(a&&(l.end=h+s*u),t.push(l),l=D(e)),a&&(h+=s)}var I=e.length-3;f=e[I],d=e[I+1],g=e[I+2],n<=(m=0===i?f:d)&&m<=r&&G(l,f,d,g),I=l.length-3,o&&3<=I&&(l[I]!==l[0]||l[I+1]!==l[1])&&G(l,l[0],l[1],l[2]),l.length&&t.push(l)}function D(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function R(e,t,n,r,i,o){for(var a=0;a<e.length;a++)V(e[a],t,n,r,i,o,!1)}function G(e,t,n,r){e.push(t),e.push(n),e.push(r)}function F(e,t,n,r,i,o){var a=(o-t)/(r-t);return e.push(o),e.push(n+(i-n)*a),e.push(1),a}function U(e,t,n,r,i,o){var a=(o-n)/(i-n);return e.push(t+(r-t)*a),e.push(o),e.push(1),a}function B(e,t){for(var n=[],r=0;r<e.length;r++){var i,o=e[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=j(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(j(o.geometry[s],t))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],l=0;l<o.geometry[s].length;l++)u.push(j(o.geometry[s][l],t));i.push(u)}n.push(M(o.id,a,i,o.tags))}return n}function j(e,t){var n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(var r=0;r<e.length;r+=3)n.push(e[r]+t,e[r+1],e[r+2]);return n}function Y(e,t){if(e.transformed)return e;var n,r,i,o=1<<e.z,a=e.x,s=e.y;for(n=0;n<e.features.length;n++){var u=e.features[n],l=u.geometry,c=u.type;if(u.geometry=[],1===c)for(r=0;r<l.length;r+=2)u.geometry.push(z(l[r],l[r+1],t,o,a,s));else for(r=0;r<l.length;r++){var h=[];for(i=0;i<l[r].length;i+=2)h.push(z(l[r][i],l[r][i+1],t,o,a,s));u.geometry.push(h)}}return e.transformed=!0,e}function z(e,t,n,r,i,o){return[Math.round(n*(e*r-i)),Math.round(n*(t*r-o))]}function Z(e,t,n,r,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,K(a,e[s],o,i);var u=e[s].minX,l=e[s].minY,c=e[s].maxX,h=e[s].maxY;u<a.minX&&(a.minX=u),l<a.minY&&(a.minY=l),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function K(e,t,n,r){var i=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)J(a,i,e,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)J(a,i[s],e,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var l=i[u];for(s=0;s<l.length;s++)J(a,l[s],e,n,!0,0===s)}if(a.length){var c=t.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var v={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==t.id&&(v.id=t.id),e.features.push(v)}}function J(e,t,n,r,i,o){var a=r*r;if(0<r&&t.size<(i?a:r))n.numPoints+=t.length/3;else{for(var s=[],u=0;u<t.length;u+=3)(0===r||t[u+2]>a)&&(n.numSimplified++,s.push(t[u]),s.push(t[u+1])),n.numPoints++;i&&function(e,t){for(var n=0,r=0,i=e.length,o=i-2;r<i;o=r,r+=2)n+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(0<n===t)for(r=0,i=e.length;r<i/2;r+=2){var a=e[r],s=e[r+1];e[r]=e[i-2-r],e[r+1]=e[i-1-r],e[i-2-r]=a,e[i-1-r]=s}}(s,o),e.push(s)}}function W(e,t){var n=(t=this.options=function(e,t){for(var n in t)e[n]=t[n];return e}(Object.create(this.options),t)).debug;if(t.maxZoom<0||24<t.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(e,t){var n=[];if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)O(n,e.features[r],t,r);else"Feature"===e.type?O(n,e,t):O(n,{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(this.stats={},this.total=0),(r=function(e,t){var n=t.buffer/t.extent,r=e,i=P(e,1,-1-n,n,0,-1,2,t),o=P(e,1,1-n,2+n,0,-1,2,t);return(i||o)&&(r=P(e,1,-n,1+n,0,-1,2,t)||[],i&&(r=B(i,1).concat(r)),o&&(r=r.concat(B(o,-1)))),r}(r,t)).length&&this.splitTile(r,0,0,0),n&&r.length}function X(e,t,n){return 32*((1<<e)*n+t)+e}W.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},W.prototype.splitTile=function(e,t,n,r,i,o,a){for(var s=[e,t,n,r],u=this.options,l=u.debug;s.length;){r=s.pop(),n=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,h=X(t,n,r),v=this.tiles[h];if(!v&&(v=this.tiles[h]=Z(e,t,n,r,u),this.tileCoords.push({z:t,x:n,y:r}),l)){var f="z"+t;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(v.source=e,i){if(t===u.maxZoom||t===i)continue;var d=1<<i-t;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(t===u.indexMaxZoom||v.numPoints<=u.indexMaxPoints)continue;if(v.source=null,0!==e.length){var g,p,y,m,_,E,I=.5*u.buffer/u.extent,M=.5-I,A=.5+I,O=1+I;g=p=y=m=null,_=P(e,c,n-I,n+A,0,v.minX,v.maxX,u),E=P(e,c,n+M,n+O,0,v.minX,v.maxX,u),e=null,_&&(g=P(_,c,r-I,r+A,1,v.minY,v.maxY,u),p=P(_,c,r+M,r+O,1,v.minY,v.maxY,u),_=null),E&&(y=P(E,c,r-I,r+A,1,v.minY,v.maxY,u),m=P(E,c,r+M,r+O,1,v.minY,v.maxY,u),E=null),s.push(g||[],t+1,2*n,2*r),s.push(p||[],t+1,2*n,2*r+1),s.push(y||[],t+1,2*n+1,2*r),s.push(m||[],t+1,2*n+1,2*r+1)}}},W.prototype.getTile=function(e,t,n){var r=this.options,i=r.extent;r.debug;if(e<0||24<e)return null;var o=1<<e,a=X(e,t=(t%o+o)%o,n);if(this.tiles[a])return Y(this.tiles[a],i);for(var s,u=e,l=t,c=n;!s&&0<u;)u--,l=Math.floor(l/2),c=Math.floor(c/2),s=this.tiles[X(u,l,c)];return s&&s.source?(this.splitTile(s.source,u,l,c,e,t,n),this.tiles[a]?Y(this.tiles[a],i):null):null};function q(e){for(var t,n,r=[],i=[],o=0,a=e.coordinates.length;o<a;o+=1){var s=e.coordinates[o],u=(void 0,0<(n=function(e){for(var t=0,n=e.length,r=0;r<n-1;r+=1){var i=e[r],o=e[r+1];t+=i[0]*o[1]-o[0]*i[1]}return t+=e[n-1][0]*e[0][1]-e[0][0]*e[n-1][1]}(s))?de:n<0?ge:void 0);null!==u&&(u===(t=t||u)&&i.length&&(r.push(i),i=[]),i.push(s))}return 0<i.length&&r.push(i),1===r.length?(e.type=ee,e.coordinates=r[0]):1<r.length?(e.type=re,e.coordinates=r):e=null,e}function Q(e,t,n,r,i){return function(e){var t=e.x,n=e.y,r=360*(t-.5),i=Math.exp(Math.PI*(.5-n)/.25)-1,o=Math.exp(Math.PI*(.5-n)/.25)+1;return[r,180*Math.asin(i/o)/Math.PI]}(function(e,t,n,r,i){var o=1<<t,a=[];return a[0]=(e[0]/i+n)/o,a[1]=(e[1]/i+r)/o,{x:a[0],y:a[1]}}(e,t,n,r,i))}var $="Point",ee="Polygon",te="MultiPoint",ne="MultiLineString",re="MultiPolygon",ie={fillColor:"#e0e0e0",outlineColor:"#829DB4",outlineWidth:1},oe={fill:"#333333",size:13},ae={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},se=18,ue=18,le=24,ce={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},he=1,ve=2,fe=3,de="CW",ge="CCW";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function pe(e){var t=e.addressList,n=void 0===t?[]:t,r=e.geometries,i=void 0===r?[]:r,o=e.entity,a=void 0===o?null:o,s=e.name,u=void 0===s?"":s,l=e.icon,c=void 0===l?"":l;h(this,pe),this.addressList=n,this.geometries=i,this.icon=c,this.entity=a,this.name=u}var ye,me,_e,Ee,Ie,Me,Ae,Oe=(function(e,t){e.exports=function(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==a(t)&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,n){function c(e){return(c="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}var o=n(1),r=n(7),F=r.get,x=(r.deepValue,r.isArray),i=function(){function G(e,t){var n=t.location,r=void 0===n?0:n,i=t.distance,o=void 0===i?100:i,a=t.threshold,s=void 0===a?.6:a,u=t.maxPatternLength,l=void 0===u?32:u,c=t.caseSensitive,h=void 0!==c&&c,v=t.tokenSeparator,f=void 0===v?/ +/g:v,d=t.findAllMatches,g=void 0!==d&&d,p=t.minMatchCharLength,y=void 0===p?1:p,m=t.id,_=void 0===m?null:m,E=t.keys,I=void 0===E?[]:E,M=t.shouldSort,A=void 0===M||M,O=t.getFn,L=void 0===O?F:O,T=t.sortFn,b=void 0===T?function(e,t){return e.score-t.score}:T,k=t.tokenize,S=void 0!==k&&k,N=t.matchAllTokens,w=void 0!==N&&N,C=t.includeMatches,P=void 0!==C&&C,x=t.includeScore,V=void 0!==x&&x,D=t.verbose,R=void 0!==D&&D;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,G),this.options={location:r,distance:o,threshold:s,maxPatternLength:l,isCaseSensitive:h,tokenSeparator:f,findAllMatches:g,minMatchCharLength:y,id:_,keys:I,includeMatches:P,includeScore:V,shouldSort:A,getFn:L,sortFn:b,verbose:R,tokenize:S,matchAllTokens:w},this.setCollection(e),this._processKeys(I)}return function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(G.prototype,[{key:"setCollection",value:function(e){return this.list=e}},{key:"_processKeys",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&"string"==typeof e[0])for(var t=0,n=e.length;t<n;t+=1){var r=e[t];this._keyWeights[r]=1,this._keyNames.push(r)}else{for(var i=0,o=0,a=e.length;o<a;o+=1){var s=e[o];if(!s.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var u=s.name;if(this._keyNames.push(u),!s.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var l=s.weight;if(l<0||1<l)throw new Error('"weight" property in key must bein the range of [0, 1)');this._keyWeights[u]=l,i+=l}if(1<i)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var n=this._prepareSearchers(e),r=n.tokenSearchers,i=n.fullSearcher,o=this._search(r,i);return this._computeScore(o),this.options.shouldSort&&this._sort(o),t.limit&&"number"==typeof t.limit&&(o=o.slice(0,t.limit)),this._format(o)}},{key:"_prepareSearchers",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),r=0,i=n.length;r<i;r+=1)t.push(new o(n[r],this.options));return{tokenSearchers:t,fullSearcher:new o(e,this.options)}}},{key:"_search",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0,n=this.list,r={},i=[];if("string"==typeof n[0]){for(var o=0,a=n.length;o<a;o+=1)this._analyze({key:"",value:n[o],record:o,index:o},{resultMap:r,results:i,tokenSearchers:e,fullSearcher:t});return i}for(var s=0,u=n.length;s<u;s+=1)for(var l=n[s],c=0,h=this._keyNames.length;c<h;c+=1){var v=this._keyNames[c];this._analyze({key:v,value:this.options.getFn(l,v),record:l,index:s},{resultMap:r,results:i,tokenSearchers:e,fullSearcher:t})}return i}},{key:"_analyze",value:function(e,t){var k=this,S=e.key,n=e.arrayIndex,r=void 0===n?-1:n,i=e.value,o=e.record,a=e.index,s=t.tokenSearchers,N=void 0===s?[]:s,w=t.fullSearcher,u=t.resultMap,C=void 0===u?{}:u,l=t.results,P=void 0===l?[]:l;!function e(t,n,r,i){if(null!=n)if("string"==typeof n){var o=!1,a=-1,s=0;k._log("\nKey: ".concat(""===S?"--":S));var u=w.search(n);if(k._log('Full text: "'.concat(n,'", score: ').concat(u.score)),k.options.tokenize){for(var l=n.split(k.options.tokenSeparator),c=l.length,h=[],v=0,f=N.length;v<f;v+=1){var d=N[v];k._log('\nPattern: "'.concat(d.pattern,'"'));for(var g=!1,p=0;p<c;p+=1){var y=l[p],m=d.search(y),_={};m.isMatch?(_[y]=m.score,g=o=!0,h.push(m.score)):(_[y]=1,k.options.matchAllTokens||h.push(1)),k._log('Token: "'.concat(y,'", score: ').concat(_[y]))}g&&(s+=1)}a=h[0];for(var E=h.length,I=1;I<E;I+=1)a+=h[I];a/=E,k._log("Token score average:",a)}var M=u.score;-1<a&&(M=(M+a)/2),k._log("Score average:",M);var A=!k.options.tokenize||!k.options.matchAllTokens||s>=N.length;if(k._log("\nCheck Matches: ".concat(A)),(o||u.isMatch)&&A){var O={key:S,arrayIndex:t,value:n,score:M};k.options.includeMatches&&(O.matchedIndices=u.matchedIndices);var L=C[i];L?L.output.push(O):(C[i]={item:r,output:[O]},P.push(C[i]))}}else if(x(n))for(var T=0,b=n.length;T<b;T+=1)e(T,n[T],r,i)}(r,i,o,a)}},{key:"_computeScore",value:function(e){this._log("\n\nComputing score:\n");for(var t=this._keyWeights,n=!!Object.keys(t).length,r=0,i=e.length;r<i;r+=1){for(var o=e[r],a=o.output,s=a.length,u=1,l=0;l<s;l+=1){var c=a[l],h=c.key,v=n?t[h]:1,f=0===c.score&&t&&0<t[h]?Number.EPSILON:c.score;u*=Math.pow(f,v)}o.score=u,this._log(o)}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,function(e,t){if("object"===c(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t},2)),n=null}var r=[];this.options.includeMatches&&r.push(function(e,t){var n=e.output;t.matches=[];for(var r=0,i=n.length;r<i;r+=1){var o=n[r];if(0!==o.matchedIndices.length){var a={indices:o.matchedIndices,value:o.value};o.key&&(a.key=o.key),o.hasOwnProperty("arrayIndex")&&-1<o.arrayIndex&&(a.arrayIndex=o.arrayIndex),t.matches.push(a)}}}),this.options.includeScore&&r.push(function(e,t){t.score=e.score});for(var i=0,o=e.length;i<o;i+=1){var a=e[i];if(this.options.id&&(a.item=this.options.getFn(a.item,this.options.id)[0]),r.length){for(var s={item:a.item},u=0,l=r.length;u<l;u+=1)r[u](a,s);t.push(s)}else t.push(a.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}]),G}();e.exports=i},function(e,t,n){var d=n(2),g=n(3),I=n(6),r=function(){function E(e,t){var n=t.location,r=void 0===n?0:n,i=t.distance,o=void 0===i?100:i,a=t.threshold,s=void 0===a?.6:a,u=t.maxPatternLength,l=void 0===u?32:u,c=t.isCaseSensitive,h=void 0!==c&&c,v=t.tokenSeparator,f=void 0===v?/ +/g:v,d=t.findAllMatches,g=void 0!==d&&d,p=t.minMatchCharLength,y=void 0===p?1:p,m=t.includeMatches,_=void 0!==m&&m;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E),this.options={location:r,distance:o,threshold:s,maxPatternLength:l,isCaseSensitive:h,tokenSeparator:f,findAllMatches:g,includeMatches:_,minMatchCharLength:y},this.pattern=h?e:e.toLowerCase(),this.pattern.length<=l&&(this.patternAlphabet=I(this.pattern))}return function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(E.prototype,[{key:"search",value:function(e){var t=this.options,n=t.isCaseSensitive,r=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var i={isMatch:!0,score:0};return r&&(i.matchedIndices=[[0,e.length-1]]),i}var o=this.options,a=o.maxPatternLength,s=o.tokenSeparator;if(this.pattern.length>a)return d(e,this.pattern,s);var u=this.options,l=u.location,c=u.distance,h=u.threshold,v=u.findAllMatches,f=u.minMatchCharLength;return g(e,this.pattern,this.patternAlphabet,{location:l,distance:c,threshold:h,findAllMatches:v,minMatchCharLength:f,includeMatches:r})}}]),E}();e.exports=r},function(e,t){var c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:/ +/g,r=new RegExp(t.replace(c,"\\$&").replace(n,"|")),i=e.match(r),o=!!i,a=[];if(o)for(var s=0,u=i.length;s<u;s+=1){var l=i[s];a.push([e.indexOf(l),l.length-1])}return{score:o?.5:1,isMatch:o,matchedIndices:a}}},function(e,t,n){var F=n(4),U=n(5);e.exports=function(e,t,n,r){for(var i=r.location,o=void 0===i?0:i,a=r.distance,s=void 0===a?100:a,u=r.threshold,l=void 0===u?.6:u,c=r.findAllMatches,h=void 0!==c&&c,v=r.minMatchCharLength,f=void 0===v?1:v,d=r.includeMatches,g=void 0!==d&&d,p=o,y=e.length,m=l,_=e.indexOf(t,p),E=t.length,I=[],M=0;M<y;M+=1)I[M]=0;if(-1!==_){var A=F(t,{errors:0,currentLocation:_,expectedLocation:p,distance:s});if(m=Math.min(A,m),-1!==(_=e.lastIndexOf(t,p+E))){var O=F(t,{errors:0,currentLocation:_,expectedLocation:p,distance:s});m=Math.min(O,m)}}_=-1;for(var L=[],T=1,b=E+y,k=1<<(E<=31?E-1:30),S=0;S<E;S+=1){for(var N=0,w=b;N<w;)F(t,{errors:S,currentLocation:p+w,expectedLocation:p,distance:s})<=m?N=w:b=w,w=Math.floor((b-N)/2+N);b=w;var C=Math.max(1,p-w+1),P=h?y:Math.min(p+w,y)+E,x=Array(P+2);x[P+1]=(1<<S)-1;for(var V=P;C<=V;V-=1){var D=V-1,R=n[e.charAt(D)];if(R&&(I[D]=1),x[V]=(x[V+1]<<1|1)&R,0!==S&&(x[V]|=(L[V+1]|L[V])<<1|1|L[V+1]),x[V]&k&&(T=F(t,{errors:S,currentLocation:D,expectedLocation:p,distance:s}))<=m){if(m=T,(_=D)<=p)break;C=Math.max(1,2*p-_)}}if(F(t,{errors:S+1,currentLocation:p,expectedLocation:p,distance:s})>m)break;L=x}var G={isMatch:0<=_,score:0===T?.001:T};return g&&(G.matchedIndices=U(I,f)),G}},function(e,t){e.exports=function(e,t){var n=t.errors,r=void 0===n?0:n,i=t.currentLocation,o=void 0===i?0:i,a=t.expectedLocation,s=void 0===a?0:a,u=t.distance,l=void 0===u?100:u,c=r/e.length,h=Math.abs(s-o);return l?c+h/l:h?1:c}},function(e,t){e.exports=function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=[],r=-1,i=-1,o=0,a=e.length;o<a;o+=1){var s=e[o];s&&-1===r?r=o:s||-1===r||((i=o-1)-r+1>=t&&n.push([r,i]),r=-1)}return e[o-1]&&t<=o-r&&n.push([r,o-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,r=0;r<n;r+=1)t[e.charAt(r)]=0;for(var i=0;i<n;i+=1)t[e.charAt(i)]|=1<<n-i-1;return t}},function(e,t){var c=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},h=function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)},v=function(e){return"string"==typeof e},f=function(e){return"number"==typeof e};e.exports={get:function(e,t){var l=[];return function e(t,n){if(n){var r=n.indexOf("."),i=n,o=null;-1!==r&&(i=n.slice(0,r),o=n.slice(r+1));var a=t[i];if(null!=a)if(o||!v(a)&&!f(a))if(c(a))for(var s=0,u=a.length;s<u;s+=1)e(a[s],o);else o&&e(a,o);else l.push(h(a))}else l.push(t)}(e,t),l},isArray:c,isString:v,isNum:f,toString:h}}])}(ye={exports:{}},ye.exports),ye.exports),Le=(me=Oe)&&me.__esModule&&Object.prototype.hasOwnProperty.call(me,"default")?me.default:me,Te=(Oe.Fuse,{keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2}),be=function(){function t(e){h(this,t),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=e,this.init()}return u(t,[{key:"init",value:function(){var e=this.venueModel.getGeometries().reduce(function(e,t){var n=e;return n[t.getId()]=t,n},{});this.initEntityList(this.venueModel.entities),this.initIconList(e),this.levels_=this.venueModel.getLevels().map(function(e){return{levelId:e.getId(),levelName:e.getName(),drawingId:e.getDrawing().getId(),drawingName:e.getDrawing().getName()}});var t=[].concat(b(this.searchListEntities_),b(this.searchListIcons_));this.searchList_=t.sort(function(e,t){return e.name.localeCompare(t.name)}),this.fuseSearch_=new Le(this.searchList_,Te)}},{key:"initEntityList",value:function(e){var t=(0<arguments.length&&void 0!==e?e:[]).map(function(e){return new pe({geometries:e.getGeometries(),addressList:e.getInternalAddress()||[],name:e.getName()||"",entity:e})});this.searchListEntities_=t}},{key:"initIconList",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.searchListIcons_=Object.values(t).filter(function(e){return e.getIcon()}).map(function(e){var t=e.getIcon();return new pe({geometries:[e],icon:t.getSVG(),name:t.ar})})}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var e=this.searchListIcons_.reduce(function(e,t){var n=e;return n[t.name]=t.name,n},{});return Object.keys(e)}},{key:"find",value:function(e){var t=0<arguments.length&&void 0!==e?e:"";return""===t?this.searchList_:this.fuseSearch_.search(t)}},{key:"groupByLevel",value:function(e){var n=0<arguments.length&&void 0!==e?e:this.searchList_;return this.levels_?b(this.levels_.flatMap(function(t){return L(L({},t),{},{results:n.filter(function(e){return function(e,t){return 0<e.geometries.length&&e.geometries.find(function(e){return Number(e.getLevel().getId())===Number(t.levelId)})}(e,t)})})})):[]}}]),t}(),ke="MFS",Se=0,Ne=1,we=2,Ce=3,Pe=4,xe=2,Ve=0,De=1,Re=2,Ge=3,He="Point",Fe="LineString",Ue="Polygon",Be="MultiPoint",je="MultiLineString",Ye="MultiPolygon",ze=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),Ze=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"}),Ke=Object.freeze((c(_e={},Ze.THEME,"themeUrls"),c(_e,Ze.THEME_MAP,"themeMapUrl"),c(_e,Ze.PRESETS,"presetsUrl"),c(_e,Ze.SDK_STRINGS,"stringsUrl"),_e)),Je=Object.freeze((c(Ee={},Ze.THEME,"themeOverrides"),c(Ee,Ze.THEME_MAP,"themeMapOverrides"),c(Ee,Ze.PRESETS,"presetOverrides"),c(Ee,Ze.SDK_STRINGS,"stringsOverrides"),c(Ee,Ze.INPUT_COLORS,"inputColorOverrides"),Ee)),We=(Object.freeze((c(Ie={},Ze.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),c(Ie,Ze.SDK_STRINGS,["Standard","SDK","sdk/standard"]),c(Ie,Ze.V4_THEME_FAMILY,["modern","standard"]),c(Ie,Ze.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),c(Ie,Ze.NAV_THEME,["Factory","MapEditor"]),c(Ie,Ze.ICON,["Multicolor","Standard","TheBase","Factory"]),Ie)),Object.freeze((c(Me={},Ze.THEME,"Modern"),c(Me,Ze.THEME_MAP,"Standard"),c(Me,Ze.PRESETS,"Standard"),c(Me,Ze.SDK_STRINGS,"Standard"),c(Me,Ze.ICON_FILE,"Standard"),c(Me,Ze.INPUT_COLORS,"Standard"),c(Me,Ze.BASE_MAP_INFO,"Standard"),c(Me,Ze.CONFIG_PROFILE,"factory"),c(Me,Ze.NAV_THEME,"Factory"),c(Me,Ze.NAV_NAME_THEME,"FactoryName"),c(Me,Ze.NAV_PROP_MAP,"Standard"),c(Me,Ze.NAV_STRINGS,"Standard"),c(Me,Ze.NAV_THEME_MAP,"Standard"),c(Me,Ze.NAV_NAME_THEME_MAP,"StandardName"),c(Me,Ze.V4_THEME_FAMILY,"Standard"),c(Me,Ze.V4_MAPTYPE_THEME,"Standard"),c(Me,Ze.ICON,"Multicolor"),c(Me,Ze.MARKER,"Standard"),Me))),Xe=Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"}),qe=Object.freeze((c(Ae={},Xe.V5_MAP,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_DIRECTORY:"COMMUNITY_DIRECTORY",COMMUNITY_DETAIL:"COMMUNITY_DETAIL",LEVEL_GEOMETRY:"LEVEL_GEOMETRY",DRAWING_ENTITY:"DRAWING_ENTITY"}),c(Ae,Xe.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"}),c(Ae,Xe.V5_NAV,{JSON_NAV:"JSON_NAV",BINARY_NAV:"BINARY_NAV",JSON_ENHANCED_NAV:"JSON_ENHANCED_NAV",BINARY_ENHANCED_NAV:"BINARY_ENHANCED_NAV"}),c(Ae,Xe.V5_INFO,{GEOMETRY_INFO:"GEOMETRY_INFO"}),c(Ae,Xe.SVG,{PLAIN:"PLAIN",PRETTY:"PRETTY",PRETTY_HORIZONTAL_LABEL:"PRETTY_HORIZONTAL_LABEL"}),c(Ae,Xe.KML,{RASTER:"RASTER",VECTOR:"VECTOR",RASTER_HORIZONTAL:"RASTER_HORIZONTAL",VECTOR_HORIZONTAL:"VECTOR_HORIZONTAL"}),c(Ae,Xe.PNG,{LOW_RESOLUTION:"LOW_RESOLUTION",HIGH_RESOLUTION:"HIGH_RESOLUTION",LOW_RESOLUTION_GEO:"LOW_RESOLUTION_GEO",HIGH_RESOLUTION_GEO:"HIGH_RESOLUTION_GEO",LOW_RESOLUTION_HORIZONTAL:"LOW_RESOLUTION_HORIZONTAL",HIGH_RESOLUTION_HORIZONTAL:"HIGH_RESOLUTION_HORIZONTAL",LOW_RESOLUTION_HORIZONTAL_GEO:"LOW_RESOLUTION_HORIZONTAL_GEO",HIGH_RESOLUTION_HORIZONTAL_GEO:"HIGH_RESOLUTION_HORIZONTAL_GEO"}),Ae));function Qe(){}function $e(){$e.init.call(this)}function et(e){return void 0===e._maxListeners?$e.defaultMaxListeners:e._maxListeners}function tt(e,t,n,r){var i,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new Qe,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=et(e))&&0<i&&a.length>i){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,console.warn}}else a=o[t]=n,++e._eventsCount;return e}function nt(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function rt(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function it(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}Qe.prototype=Object.create(null),($e.EventEmitter=$e).usingDomains=!1,$e.prototype.domain=void 0,$e.prototype._events=void 0,$e.prototype._maxListeners=void 0,$e.defaultMaxListeners=10,$e.init=function(){this.domain=null,$e.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Qe,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$e.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},$e.prototype.getMaxListeners=function(){return et(this)},$e.prototype.emit=function(e,t,n,r){var i,o,a,s,u,l,c,h="error"===e;if(l=this._events)h=h&&null==l.error;else if(!h)return!1;if(c=this.domain,h){if(i=t,c)return(i=i||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,i.domain=c,i.domainThrown=!1,c.emit("error",i),!1;if(i instanceof Error)throw i;var v=new Error('Uncaught, unspecified "error" event. ('+i+")");throw v.context=i,v}if(!(o=l[e]))return!1;var f="function"==typeof o;switch(a=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=it(e,r),o=0;o<r;++o)i[o].call(n)}(o,f,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=it(e,i),a=0;a<i;++a)o[a].call(n,r)}(o,f,this,t);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=it(e,o),s=0;s<o;++s)a[s].call(n,r,i)}(o,f,this,t,n);break;case 4:!function(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=it(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}(o,f,this,t,n,r);break;default:for(s=new Array(a-1),u=1;u<a;u++)s[u-1]=arguments[u];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=it(e,i),a=0;a<i;++a)o[a].apply(n,r)}(o,f,this,s)}return!0},$e.prototype.on=$e.prototype.addListener=function(e,t){return tt(this,e,t,!1)},$e.prototype.prependListener=function(e,t){return tt(this,e,t,!0)},$e.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,nt(this,e,t)),this},$e.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,nt(this,e,t)),this},$e.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Qe:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Qe,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},$e.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Qe,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Qe:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Qe,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(;this.removeListener(e,t[t.length-1]),t[0];);return this},$e.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},$e.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):rt.call(e,t)},$e.prototype.listenerCount=rt,$e.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var ot,at="venues-ui-button--active",st="venues-ui-button",ut="venues-ui__drawings",lt="data-drawing",ct=function(){function a(e,t,n){var r=this;h(this,a),this.clickHandler=n,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",ut);var i=document.createElement("div");i.setAttribute("class","trigger ".concat(st));var o=document.createElement("div");o.setAttribute("class","arrow arrow--down"),i.appendChild(o),i.addEventListener("click",function(){i.classList.toggle(at),r.containerButtons.classList.toggle("drawings--open")}),this.containerDiv.appendChild(i),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),t&&this.update(t),e.appendChild(this.containerDiv)}return u(a,[{key:"drawButton",value:function(e,t,n){var r=this,i=document.createElement("div"),o=Number(n)===Number(e);i.setAttribute("class",o?"".concat(st," ").concat(at):st),i.innerHTML=t,i.setAttribute(lt,e),i.addEventListener("click",function(){r.switch(e),r.clickHandler(e)}),this.containerButtons.appendChild(i)}},{key:"switch",value:function(e){this.containerButtons.querySelectorAll(".".concat(ut," .").concat(at)).forEach(function(e){return e.setAttribute("class",st)});var t=this.containerButtons.querySelector("[".concat(lt,"='").concat(e,"']"));t&&t.setAttribute("class","".concat(st," ").concat(at))}},{key:"update",value:function(n){var r=this;this.containerButtons.innerHTML="";var e=function(e){var t=e.getDrawings();return new Map(t.map(function(e){var t=e.getDisplayName()||e.getName();return[e.getId(),t]}))}(n);0<e.size&&e.forEach(function(e,t){return r.drawButton(t,e,n.getRootDrawing().getId())})}}]),a}(),ht="venues-ui-button--active",vt="venues-ui-button",ft="data-level",dt="venues-ui__levels",gt=function(){function o(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4;h(this,o),this.clickHandler=r,this.levelButtonCount=i,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(dt)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","levels"),this.containerUI.appendChild(this.containerButtons),t&&this.update(t,n),e.appendChild(this.containerUI)}return u(o,[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(e,t){var n=this,r=document.createElement("div");r.innerHTML=t,r.style.fontSize="".concat(Math.max(Math.min(28.8/t.length,11.52),10),"px"),r.style.display="block",r.setAttribute("class",vt),r.setAttribute(ft,e),r.addEventListener("click",function(){n.switch(e),n.clickHandler(e)}),this.containerButtons.appendChild(r)}},{key:"drawScrollButtons",value:function(){var e=this;this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(vt," ").concat(vt,"--up"));var t=document.createElement("div");t.setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(t),this.buttonScrollUp.addEventListener("click",function(){return e.scroll(1)}),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(vt," ").concat(vt,"--down"));var n=document.createElement("div");n.setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(n),this.buttonScrollDown.addEventListener("click",function(){return e.scroll(-1)}),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(e){var t=0<arguments.length&&void 0!==e?e:0,n=Array.from(this.containerButtons.querySelectorAll(".".concat(vt))).reverse(),r=[];if(0<=t){this.currentScrollIndex=Math.min(this.currentScrollIndex+t,n.length-this.levelButtonCount);var i=Math.min(this.currentScrollIndex,n.length-this.levelButtonCount),o=Math.min(this.currentScrollIndex+this.levelButtonCount,n.length);r=n.slice(i,o)}else if(t<0){this.currentScrollIndex=Math.max(this.currentScrollIndex+t,0);var a=Math.max(0,this.currentScrollIndex),s=Math.min(n.length,this.currentScrollIndex+this.levelButtonCount);r=n.slice(a,s)}n.forEach(function(e){-1!==r.indexOf(e)?e.style.display="block":e.style.display="none"}),this.buttonScrollDown&&(0===this.currentScrollIndex?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===n.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(e){this.containerButtons.querySelectorAll(".".concat(ht)).forEach(function(e){return e.setAttribute("class",vt)});var t=this.containerButtons.querySelector(".".concat(dt," [").concat(ft,"='").concat(e,"']"));if(t){var n=Array.from(this.containerButtons.querySelectorAll(".".concat(vt))).reverse();t.setAttribute("class","".concat(vt," ").concat(ht));var r=n.indexOf(t);(r<this.currentScrollIndex||r>=this.currentScrollIndex+4)&&this.scroll(r-this.currentScrollIndex)}}},{key:"update",value:function(e,t){var n=this,r=function(e){return new Map((0<arguments.length&&void 0!==e?e:[]).map(function(e){return[e.getZIndex(),e.getShortName()||e.getDisplayName()||e.getName()]}))}(function(e,t){if(t!==ze.FLATTEN)return e.getLevels();var n=e.getVenueModel().getLevelMapFlattenedByZIndex_();return Object.values(n).map(function(e){return e[0]})}(e,t).sort(function(e,t){return t.getZIndex()-e.getZIndex()})),i=e.getMainLevel().getZIndex();this.clear(),r.forEach(function(e,t){return n.drawLevelButton(t,e)}),r.size>this.levelButtonCount&&(r.size>this.levelButtonCount+1?this.currentScrollIndex=Math.min(Array.from(r).reverse().findIndex(function(e){return e[0]===i}),r.size-this.levelButtonCount):this.currentScrollIndex=0,this.drawScrollButtons(),this.scroll(0)),this.switch(i)}}]),o}(),pt={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED"},yt=(Object.freeze((c(ot={},pt.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),c(ot,pt.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),c(ot,pt.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),c(ot,pt.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),c(ot,pt.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),c(ot,pt.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),c(ot,pt.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),c(ot,pt.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),c(ot,pt.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}),ot)),new $e);yt.EVENT_NAME=pt,yt.on("newListener",function(e){});function mt(t,n){var r,i,o,a,s,u=0;Object.keys(n).forEach(function(e){for(i=n[e],null==(a=i.priority)&&(a=0),s=!1;!s;)u<t.length?(r=t[u],null==(o=r.priority)&&(o=0)):o=Number.MAX_VALUE,a<=o&&(t.splice(u,0,i),s=!0),u+=1})}var _t,Et,It,Mt,At,Ot,Lt,Tt,bt=Math.PI/180,kt=180/Math.PI,St=function(){function g(){h(this,g)}return u(g,null,[{key:"toRadians",value:function(e){return e*bt}},{key:"toDegrees",value:function(e){return e*kt}},{key:"getInverseTransform",value:function(e){var t=e[0]*e[3]-e[1]*e[2],n=[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,0,0];return n[4]=-(n[0]*e[4]+n[2]*e[5]),n[5]=-(n[1]*e[4]+n[3]*e[5]),n}},{key:"applyTransformToPoint",value:function(e,t){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}},{key:"transformProduct",value:function(e,t){var n=[0,0,0,0,0,0];return n[0]=t[0]*e[0]+t[2]*e[1],n[1]=t[1]*e[0]+t[3]*e[1],n[2]=t[0]*e[2]+t[2]*e[3],n[3]=t[1]*e[2]+t[3]*e[3],n[4]=t[0]*e[4]+t[2]*e[5]+t[4],n[5]=t[1]*e[4]+t[3]*e[5]+t[5],n}},{key:"convertLonLatToMerc",value:function(e){var t=e[0]*bt,n=e[1]*bt,r=Math.sin(n);return[.5+t/(2*Math.PI),.5-Math.log((1+r)/(1-r))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(e){var t=2*Math.PI*(e[0]-.5),n=Math.atan(Math.sinh(2*Math.PI*(.5-e[1])));return[t/bt,n/bt]}},{key:"getTransformScale",value:function(e){return Math.sqrt(e[0]*e[3]-e[1]*e[2])}},{key:"getLonLatToMercTransform",value:function(e){var t=[1/360,0,0,-1/(360*Math.cos(e[1]*bt)),0,0],n=g.applyTransformToPoint(t,e),r=g.convertLonLatToMerc(e);return t[4]=r[0]-n[0],t[5]=r[1]-n[1],t}},{key:"getNatToMercTransform",value:function(e){var t=[e[4],e[5]],n=g.getLonLatToMercTransform(t);return g.transformProduct(e,n)}},{key:"convertMxMy2LonLat",value:function(e,t){return e.length&&t.length?g.applyTransformToPoint(e,t):[]}},{key:"convertLonLat2MxMy",value:function(e,t){if(!e.length||!t.length)return[];var n=g.getInverseTransform(e);return g.applyTransformToPoint(n,t)}},{key:"getFlattenedQuadraticBezierCurve",value:function(e,t,n,r){var i=[],o=3<arguments.length&&void 0!==r?r:10;o<1&&(o=6);for(var a=0;a<=o;a+=1){var s=a/o,u=(1-s)*(1-s),l=2*s*(1-s),c=s*s,h=u*e[0]+l*t[0]+c*n[0],v=u*e[1]+l*t[1]+c*n[1];i.push([h,v])}return i}},{key:"getFlattenedCubicBezierCurve",value:function(e,t,n,r,i){var o=[],a=4<arguments.length&&void 0!==i?i:10;a<1&&(a=6);for(var s=0;s<=a;s+=1){var u=s/a,l=(1-u)*(1-u)*(1-u),c=3*u*(1-u)*(1-u),h=3*u*u*(1-u),v=u*u*u,f=l*e[0]+c*t[0]+h*n[0]+v*r[0],d=l*e[1]+c*t[1]+h*n[1]+v*r[1];o.push([f,d])}return o}},{key:"getRectangularCoordinatesOfLabelArea",value:function(e,t,n){var r=!(2<arguments.length&&void 0!==n)||n,i=T(e,6),o=i[0],a=i[1],s=i[2],u=i[3],l=i[5],c=g.getDeltaLonLatForMeterAtGivenLonLat(o,a),h=e[4];return r?(l&&(h*=-1),null!=t&&(h=(h+=t<0?2*Math.PI+t:t)<0?2*Math.PI+h:h)):h=0,g.getRectVerticesFromSignatureRectRepresentation([o,a],{xLength:s,yLength:u},h,c)}},{key:"getRotatedPoint",value:function(e,t,n,r){var i=!(2<arguments.length&&void 0!==n)||n,o=3<arguments.length&&void 0!==r?r:[0,0],a=Math.cos(t),s=Math.sin(t),u=e[0]-o[0],l=e[1]-o[1],c=[];return[(c=i?[u*a+l*s,l*a-u*s]:[u*a-l*s,l*a+u*s])[0]+o[0],c[1]+o[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(e,t,n,r,i){var o=t.xLength,a=t.yLength,s=!(4<arguments.length&&void 0!==i)||i,u=T(e,2),l=u[0],c=u[1],h=o/2,H=a/2,v=T(r,2),f=v[0],d=v[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map(function(e){return[e[0]*h,e[1]*H]}).map(function(e){return g.getRotatedPoint(e,n,s)}).map(function(e){return[e[0]*f,e[1]*d]}).map(function(e){return[e[0]+l,e[1]+c]})}},{key:"getScaleFactorForRectInSpace",value:function(e,t,n,r){var i=e/n,o=t/r;return o<i?o:i}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(e,t){return[1/6371e3*(180/Math.PI)/Math.cos(t*Math.PI/180),1/6371e3*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(e){var t=0<arguments.length&&void 0!==e?e:[],n=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]];return t.reduce(function(e,t){return[[Math.min(t[0],e[0][0]),Math.min(t[1],e[0][1])],[Math.max(t[0],e[1][0]),Math.max(t[1],e[1][1])]]},n)}},{key:"isPointInBoundingBox",value:function(e,t){if(e&&t){var n=T(e,2),r=n[0],i=n[1],o=T(t,2),a=T(o[0],2),s=a[0],u=a[1],l=T(o[1],2),c=l[0],h=l[1];return r<=c&&s<=r&&i<=h&&u<=i}}},{key:"isPointOnLineSegment",value:function(e,t,n){var r=T(e,2),i=r[0],o=r[1],a=T(t,2),s=a[0],u=a[1],l=T(n,2),c=l[0],h=l[1],v=(u-o)*(h-o)<=0;return s===c?s===i&&v:o-h==(h-u)/(c-s)*(i-c)&&v}},{key:"rayIntersectLineSegment",value:function(e,t,n){var r=T(e,2),i=r[0],o=r[1],a=T(t,2),s=a[0],u=a[1],l=T(n,2),c=l[0],h=l[1];if(s===c)return!1;var v=(i-s)/(c-s);return 0<=v&&v<1&&o<(h-u)*v+u}},{key:"isPointInPolygon",value:function(e,t){var n=T(e,2),r=n[0],i=n[1],o=t.length;if(o<3)return!1;var a=0,s=t[o-1];return t.forEach(function(e){g.rayIntersectLineSegment([r,i],s,e)&&(a+=1),s=e}),a%2!=0}},{key:"isPointOnLineString",value:function(e,t){var n=T(e,2),r=n[0],i=n[1],o=t.length;if(o<2)return!1;for(var a=t[o-1],s=0;s<o;s+=1){var u=t[s];if(g.isPointOnLineSegment([r,i],a,u))return!0;a=t[s]}return!1}},{key:"getAreaOfPolygon",value:function(e){var t=e.length;if(t<3)return null;var n=0,r=e[t-1];return e.forEach(function(e){n+=.5*function(e,t){var n=T(e,2),r=n[0],i=n[1],o=T(t,2),a=o[0];return r*o[1]-i*a}(r,e),r=e}),n}},{key:"getDistanceBetweenPoints",value:function(e,t){var n=T(e,2),r=n[0],i=n[1],o=T(t,2),a=r-o[0],s=i-o[1];return Math.sqrt(a*a+s*s)}}]),g}(),Nt=function(){function e(){h(this,e)}return u(e,null,[{key:"get",value:function(t,e){return fetch(t,1<arguments.length&&void 0!==e?e:{method:"GET"}).then(function(e){return e.ok?e.json():Promise.reject(new Error("Call failed for ".concat(t," : ").concat(e.status," ").concat(e.statusText)))})}}]),e}(),wt=function(){function O(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];h(this,O),e&&Object.assign(this,e),this.splitIconGeomBasisGeomType_=t,this.splitIconGeomBasisGeomType_&&this.splitMultiGeom()}return u(O,[{key:"flattenIconShape",value:function(e){var t=0<arguments.length&&void 0!==e&&e;if(!this.isFlattened){var n=[],r=this.g;r&&r.forEach(function(e){var c,h=[];e.shp&&e.shp.forEach(function(e){var t,n=T(e,7),r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],l=n[6];switch(r){case Se:case Ne:h.push(e),c=[i,o];break;case we:t=St.getFlattenedQuadraticBezierCurve(c,[i,o],[a,s]),c=[a,s];break;case Ce:t=St.getFlattenedCubicBezierCurve(c,[i,o],[a,s],[u,l]),c=[u,l];break;case Pe:h.push(e),c=void 0}t&&(t.splice(0,2),t.forEach(function(e){h.push([1].concat(b(e)))}))}),n.push(L(L({},e),{shp:h}))}),t&&(this.g_original=r),this.g=n,this.isFlattened=!0}}},{key:"splitMultiGeom",value:function(){var e=this;if(this.isIconGeomSplittedBasisGeomType)return this.isIconWithHole;this.splitIconGeomBasisGeomType_||(this.splitIconGeomBasisGeomType_=!0);var p=xe,t=this.g,y=[],m=[],n=!1,_=!0,E=-1,I=Ve,M=De,A=Re,r=Ge;return!!t&&(t.forEach(function(v){var f,d=[],g=[];v.gt===r||(v.shp.forEach(function(e){var t,n,r=T(e,7),i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=null;switch(i){case Se:d.push([o,a]),f=[o,a],_||E!==M&&E!==I||y.push(L(L({},v),{},{st:p},{gt:E,shp:m})),E=I,_=!(m=[]),m.push(e);break;case Ne:d.push([o,a]),f=[o,a],E===A||E!==I&&E!==M||(E=M,m.push(e));break;case we:(h=St.getFlattenedQuadraticBezierCurve(f,[o,a],[s,u],15)).splice(0,2),(t=d).push.apply(t,b(h)),f=[s,u],E===A||E!==I&&E!==M||(E=M,m.push(e));break;case Ce:(h=St.getFlattenedCubicBezierCurve(f,[o,a],[s,u],[l,c],15)).splice(0,2),(n=d).push.apply(n,b(h)),f=[l,c],E===A||E!==I&&E!==M||(E=M,m.push(e));break;case Pe:m.push(e),E=A,_=!0,2<d.length&&g.push({shp:m,area:St.getAreaOfPolygon(d),points:d,children:[]}),f=void 0,d=[]}},e),O.getLinkedParentChildPolygonArray(g).forEach(function(e){var t=[];t.push.apply(t,b(e.shp)),e.children.forEach(function(e){n=!0,t.push.apply(t,b(e.shp))}),y.push(L(L({},v),{},{st:p},{gt:Re,shp:t}))}))},this),this.g=y,this.isIconGeomSplittedBasisGeomType=!0,this.isIconWithHole=n,this.isIconWithHole)}},{key:"getIconWithOriginTranslatedToIconCenter",value:function(){var t=new O(this,this.splitIconGeomBasisGeomType_),c=Number.parseInt(t.w,10)/2*1,h=Number.parseInt(t.h,10)/2*1;return t.g=[],this.g&&this.g.forEach(function(e){var l=[];e.shp&&e.shp.forEach(function(e){var t=T(e,7),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6];switch(n){case 0:case 1:l.push([n,r-c,i-h]);break;case 2:l.push([n,r-c,i-h,o-c,a-h]);break;case 3:l.push([n,r-c,i-h,o-c,a-h,s-c,u-h]);break;case 4:l.push(e)}}),t.g.push(L(L({},e),{shp:l}))}),t}},{key:"getTransformedIconThatFitsInLabelArea",value:function(e,t,n){var r=1<arguments.length&&void 0!==t?t:0,i=!(2<arguments.length&&void 0!==n)||n,o=new O(this,this.splitIconGeomBasisGeomType_),_=O.getParamForTransformedIconThatFitsInLabelArea(o,e,r,i),a=_.scaleFactor;o.w=a,o.h=a;var s=[];return o.g&&o.g.forEach(function(e){var m=[];e.shp&&e.shp.forEach(function(e){var t=T(e,7),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=T(O.getTransformedIconPointThatFitsInLabelArea([r,i],_),2),c=l[0],h=l[1],v=T(O.getTransformedIconPointThatFitsInLabelArea([o,a],_),2),f=v[0],d=v[1],g=T(O.getTransformedIconPointThatFitsInLabelArea([s,u],_),2),p=g[0],y=g[1];switch(n){case Se:case Ne:m.push([n,c,h]);break;case we:m.push([n,c,h,f,d]);break;case Ce:m.push([n,c,h,f,d,p,y]);break;case Pe:m.push(e)}}),s.push(L(L({},e),{shp:m}))}),o.g=s,o}},{key:"getSVG",value:function(e){var t,n,r='<?xml version="1.0" encoding="utf-8"?>',i=this.w?this.w:50,o=this.h?this.h:50,a=this.g;if(r+='<svg viewBox="0 0 '.concat(i," ").concat(o,'" xmlns="http://www.w3.org/2000/svg" width="').concat(i,'" height="').concat(o,'">'),r+="<g>",a&&0<a.length)for(var s=0;s<a.length;s+=1){r+="<path ",a[s].gw&&(r+=' stroke-width="'.concat(a[s].gw,'"')),e?r+=' fill="'.concat(e,'"'):a[s].os&&a[s].os.m?r+=' fill="'.concat(a[s].os.m,'"'):r+=0===s?' fill="#006BB7"':' fill="#ffffff"',r+=' d="';for(var u=0;u<a[s].shp.length;u+=1)for(var l=0;l<a[s].shp[u].length;l+=1){if(0===l)r+=(t=a[s].shp[u][l],n=void 0,(c(n={},Se,"M"),c(n,Ne,"L"),c(n,we,"Q"),c(n,Ce,"C"),c(n,Pe,"Z"),n)[t]);else r+=a[s].shp[u][l];0===l||l+1===a[s].shp[u][l].length?r+="":r+=" "}r+='" ></path>'}return r+="</g>",r+="</svg>"}}],[{key:"getParamForTransformedIconThatFitsInLabelArea",value:function(e,t,n,r){var i=2<arguments.length&&void 0!==n?n:0,o=!(3<arguments.length&&void 0!==r)||r,a=T(t,5),s=a[0],u=a[1],l=a[2],c=a[3],h=a[4],v=(o?0:h)+i,f=T(St.getDeltaLonLatForMeterAtGivenLonLat(s,u),2),d=f[0],g=f[1],p=[Number.parseInt(e.w,10),Number.parseInt(e.h,10)],y=p[0],m=p[1];return{labelCenterX:s,labelCenterY:u,iconWidth:y,iconHeight:m,deltaLonPerMeter:d,deltaLatPerMeter:g,scaleFactor:St.getScaleFactorForRectInSpace(l,c,y,m),effectiveRotation:v}}},{key:"getTransformedIconPointThatFitsInLabelArea",value:function(e,t){var n=T(e,2),r=n[0],i=n[1];if(void 0===r||void 0===i||null===r||null===i)return[];var o=t.labelCenterX,a=t.labelCenterY,s=t.iconWidth,u=t.iconHeight,l=t.deltaLonPerMeter,c=t.deltaLatPerMeter,h=t.scaleFactor,v=t.effectiveRotation,f=r,d=i;f-=1*s/2,d-=1*u/2,d*=-1;var g=f*=h*l,p=d*=h*c;return f=g*Math.cos(v)+p*Math.sin(v),d=p*Math.cos(v)-g*Math.sin(v),[f+=o,d+=a]}},{key:"getWebGLSuitableCoordinatesOfIconSubGeom",value:function(e){var o,t=e.st,n=e.gt,r=e.shp,a=[];if(t!==xe||!r||!n)return a;switch(n){case Re:r.forEach(function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2];switch(n){case Se:(o=[]).push([r,i]);break;case Ne:o.push([r,i]);break;case Pe:a.push(o)}});break;case De:r.forEach(function(e){var t=T(e,3),n=t[1],r=t[2];a.push([n,r])})}return a}},{key:"getLinkedParentChildPolygonArray",value:function(e){var t=[];e.sort(function(e,t){return Math.abs(t.area)-Math.abs(e.area)});for(var n=0;n<e.length;n+=1){for(var r=null,i=e[n],o=i.points[0],a=n-1;0<=a;a-=1){var s=e[a];if(i.area*s.area<0){var u=St.isPointInPolygon(o,s.points);if(u=u||St.isPointOnLineString(o,s.points)){r=s;break}}}r?r.children.push(i):t.push(i)}return t}}]),O}(),Ct=Object.freeze({TEXT:"",ICON:"icon:",IMAGE:"icon:"}),Pt=Object.freeze({VALUE:"<value>",SHORT:"<short>",LONG:"<long>",FULL:"<full>"}),xt=Object.freeze({NONE:0,TEXT:1,ICON:2,IMAGE:3}),Vt=(Object.freeze({font:"Arial, Helvetica, sans-serif",minFont:9,maxFont:28,caps:!1,fill:"black",outline:null,outlineWidth:0,padding:0,bgFill:null,bgOutline:null,bgOutlineWidth:0,bgPadding:null,bgR:0,bgShadow:null,zmin:null}),yt.EVENT_NAME),Dt=["resetBaseMetaFileRules_","updateOverridableComponents"],Rt=function(){function i(e,t,n){if(h(this,i),!e)throw new Error("one should not instantiate object of this class without apt payload");var r=function(t){var n=[];return Dt.forEach(function(e){t[e]||n.push(e)}),0<n.length?n:null}(this);if(r)throw new Error("function definition missing in the implementation ".concat(r.join()));this.metaFileIdentifier=t,this.metaInformation_=n,this.basedata_=L({},e),this.baseOverrides_=[],this.customOverrides_=[],this.resetBaseMetaFileRules_()}return u(i,[{key:"applyOverride",value:function(e,t,n){var r=!(1<arguments.length&&void 0!==t)||t,i=2<arguments.length&&void 0!==n&&n;if(e){i||(r?this.customOverrides_.push(e):this.baseOverrides_.push(e)),this.updateOverridableComponents(e);var o=this.getMetaInformation();if(!i&&o&&o.config.emitEventOnOverrideUpdate){var a={applyOverride:!0,metaFileIdentifier:this.metaFileIdentifier,isCustomOverride:r,metaInformation:o,overrideJson:e};yt.emit(Vt.META_DATA_MODEL_UPDATED,a)}}}},{key:"undoOverride",value:function(){var t=this;if(0!==this.customOverrides_.length){var e=this.customOverrides_.pop();this.resetBaseMetaFileRules_(),this.baseOverrides_.forEach(function(e){return t.applyOverride(e,!1,!0)}),this.customOverrides_.forEach(function(e){return t.applyOverride(e,!0,!0)});var n=this.getMetaInformation();if(n&&n.config.emitEventOnOverrideUpdate){var r={metaFileIdentifier:this.metaFileIdentifier,undoOverride:!0,metaInformation:n,overrideJson:e};yt.emit(Vt.META_DATA_MODEL_UPDATED,r)}}}},{key:"getMetaInformation",value:function(){return this.metaInformation_}},{key:"basedata_",get:function(){return this.basedata__},set:function(e){this.basedata__||(this.basedata__=e)}}]),i}(),Gt=Ze.PRESETS,Ht=function(){l(r,Rt);var n=g(r);function r(e,t){return h(this,r),n.call(this,e,Gt,t)}return u(r,[{key:"resetBaseMetaFileRules_",value:function(){this.property_trees=null,this.named_groups=null,this.named_keys=null,this.updateOverridableComponents(this.basedata_)}},{key:"updateOverridableComponents",value:function(e){this.property_trees=e.property_trees,this.named_groups=e.named_groups,this.named_keys=e.named_keys}},{key:"getPropertyTree",value:function(e){var n,r,i=this,t=this.property_trees[e],o=[];return t.forEach(function(e){switch(e.input){case"named_group":n=i.getNamedGroup(i.getKeyKey(e)),o=[].concat(b(o),b(n));break;case"named_key":if(r=i.getKeyName(e)){var t=i.getNamedKey(r);t.k=i.getKeyKey(e),t.name=r,o.push(t)}else o.push(i.getNamedKey(i.getKeyKey(e)));break;default:o.push(e)}},this),o}},{key:"getNamedGroup",value:function(e){return this.named_groups[e]}},{key:"getNamedKey",value:function(e){return this.named_keys[e]}}],[{key:"getMetaFileIdentifier",value:function(){return Gt}},{key:"getKeyKey",value:function(e){return e.k}},{key:"getKeyName",value:function(e){return e.name}},{key:"getKeyKeys",value:function(e){return e.ks}},{key:"getKeyInput",value:function(e){return e.input}},{key:"getKeyIsArray",value:function(e){return e.is_array}},{key:"getKeyValues",value:function(e){return e.v}},{key:"getKeyFixedValue",value:function(e){return e.fixed_value}},{key:"getKeyRequired",value:function(e){return e.required}}]),r}(),Ft=Ze.SDK_STRINGS,Ut=function(){l(r,Rt);var n=g(r);function r(e,t){return h(this,r),n.call(this,e,Ft,t)}return u(r,[{key:"resetBaseMetaFileRules_",value:function(){this.stringsTable={},this.updateOverridableComponents(this.basedata_)}},{key:"updateOverridableComponents",value:function(e){e&&this.updateTranslationsStringMap(e.translations)}},{key:"updateTranslationsStringMap",value:function(t){var n=this;t&&Object.keys(t).forEach(function(e){n.addToStringsTable(e,t[e])},this)}},{key:"addToStringsTable",value:function(e,t){this.stringsTable[e]=t}},{key:"translate",value:function(e,t){var n=t;if(this.stringsTable){var r=this.stringsTable[e];if(r)if(r.en)n=r.en;else if(r.en)n=r.en;else{var i=Object.keys(r);n=0<i.length?r[i.pop()]:t}}return n}}],[{key:"getMetaFileIdentifier",value:function(){return Ft}}]),r}(),Bt=Ze.THEME,jt=function(){l(r,Rt);var n=g(r);function r(e,t){return h(this,r),n.call(this,e,Bt,t)}return u(r,[{key:"resetBaseMetaFileRules_",value:function(){var e=this.basedata_;this.ft=e.ft,this.name=e.nm,this.iurl=e.iurl,this.styleMap={},this.iconInfoMap={},this.labelStyleMap={},this.markerMap={},this.updateOverridableComponents(e)}},{key:"updateOverridableComponents",value:function(e){e&&(this.updateStyleMap(e.s),this.updateIconInfoMap(e.i,e.iurl),this.updateLabelStyleMap(e.l),this.updateMarkerMap(e.m))}},{key:"updateStyleMap",value:function(e){this.styleMap=L(L({},this.styleMap),e)}},{key:"updateIconInfoMap",value:function(r,i){var o=this;r&&Object.keys(r).forEach(function(e){var t=r[e],n=i||o.iurl;n&&t.rurl&&(t.url=n+t.rurl),o.iconInfoMap[e]=t},this)}},{key:"updateLabelStyleMap",value:function(e){this.labelStyleMap=L(L({},this.labelStyleMap),e)}},{key:"updateMarkerMap",value:function(e){this.markerMap=L(L({},this.markerMap),e)}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(e){return this.styleMap?this.styleMap[e]:null}},{key:"getGeometryDefaultStyle",value:function(){return this.styleMap?this.styleMap.Object:null}},{key:"getLabelStyle",value:function(e){return this.labelStyleMap?this.labelStyleMap[e]:null}},{key:"getLabelDefaultStyle",value:function(){return this.labelStyleMap?this.labelStyleMap.default:null}},{key:"getMarker",value:function(e){return this.markerMap&&e?this.markerMap[e]:null}},{key:"getIconInfo",value:function(e){return this.iconInfoMap&&e?this.iconInfoMap[e]:null}}],[{key:"getMetaFileIdentifier",value:function(){return Bt}}]),r}(),Yt=function(){function e(){h(this,e)}return u(e,null,[{key:"createShortAddress",value:function(e){return e&&Array.isArray(e)?e[1]:null}},{key:"createLongAddress",value:function(e){return e&&Array.isArray(e)?e[0]+" "+e[1]:null}},{key:"createFullAddress",value:function(e){var t;return e&&Array.isArray(e)?(t=3===e.length?e[2]+" ":"",t+=e[0]+" "+e[1]):null}}]),e}(),zt=Ze.THEME_MAP,Zt=function(){l(r,Rt);var n=g(r);function r(e,t){return h(this,r),n.call(this,e,zt,t)}return u(r,[{key:"resetBaseMetaFileRules_",value:function(){var e=this.basedata_;this.ft=e.ft,this.styleTreeList=[],this.labelTreeList=[],this.updateOverridableComponents(e)}},{key:"updateOverridableComponents",value:function(e){this.updateLabelTreeList(e.label),this.updateStyleTreeList(e.style)}},{key:"updateLabelTreeList",value:function(e){e&&mt(this.labelTreeList,e)}},{key:"updateStyleTreeList",value:function(e){e&&mt(this.styleTreeList,e)}}],[{key:"getMetaFileIdentifier",value:function(){return zt}},{key:"extractThemeMapPayload",value:function(e){return{labelType:e.lt,labelRef:e.r,styleName:e.n}}},{key:"getGeomStyleLookupTag",value:function(e,t){var n=e?e.styleName:null;return n=n===Pt.VALUE?t:n}},{key:"getLabelRefConstructed",value:function(e,t,n){var r=e;switch(e){case Pt.VALUE:r=n;break;case Pt.SHORT:r=Yt.createShortAddress(t);break;case Pt.LONG:r=Yt.createLongAddress(t);break;case Pt.FULL:r=Yt.createFullAddress(t)}return r}},{key:"getLabelInfoConstructed",value:function(e,t,n,r){var i={lt:e,entry:n};switch(e){case xt.NONE:break;case xt.TEXT:n.trans?i.ar=t:i.r=t;break;case xt.ICON:i.iconIdentifier=t,r?i=L(L({},r),i):i.error=!0;break;case xt.IMAGE:i.url=t;break;default:i=null}return i}}]),r}(),Kt=Ze.THEME,Jt=Ze.THEME_MAP,Wt=Ze.PRESETS,Xt=Ze.SDK_STRINGS,qt=function(){function e(){h(this,e),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.iconCache={},this.imageCache={},this.releaseSettings_={}}return u(e,[{key:"instantiateMetaFileAccessor_",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];switch(e){case Kt:this[Kt]=f(jt,n.concat([this]));break;case Jt:this[Jt]=f(Zt,n.concat([this]));break;case Wt:this[Wt]=f(Ht,n.concat([this]));break;case Xt:this[Xt]=f(Ut,n.concat([this]));break;default:return null}return this[e]}},{key:"applyOverride",value:function(e,t){this[e]&&this[e].applyOverride(t)}},{key:"undoOverride",value:function(e){this[e]&&this[e].undoOverride()}},{key:"getTheme",value:function(){return this[Kt]||{}}},{key:"getThemeMap",value:function(){return this[Jt]||{}}},{key:"getPresets",value:function(){return this[Wt]||{}}},{key:"getStrings",value:function(){return this[Xt]||{}}},{key:"getIcon",value:function(e){return e&&e.iconIdentifier?this.iconCache[e.iconIdentifier]:null}},{key:"getImage",value:function(e){return this.imageCache[e]}},{key:"extractGeomStyle",value:function(e){var t=e.valueEntry,n=e.value,r=Zt.extractThemeMapPayload(t),i=Zt.getGeomStyleLookupTag(r,n);return this.getTheme()?this.getTheme().getGeometryStyle(i):null}},{key:"getStyle",value:function(n,e){var r=this,t=1<arguments.length&&void 0!==e&&e,i=this.getThemeMap().styleTreeList,o=this.processValueEntry_.bind(this);if(null===i||0===i.length||!this.getTheme())return null;var a=this.getTheme().getGeometryDefaultStyle(),s=this.extractGeomStyle.bind(this),u=n.getAddress(),l=n.getEntities(),c=null,h=null,v={};return l&&0<l.length?i.find(function(t){return h=l.find(function(e){return c=o({geometry:n,entity:e,address:u,valueEntry:t,value:void 0,returnValueFunction:s,valueEntryIdentified:v})},r)},this):i.find(function(e){return c=o({geometry:n,entity:h,address:u,valueEntry:e,value:void 0,returnValueFunction:s,valueEntryIdentified:v})},this),c||t||(c=a),c?JSON.parse(JSON.stringify(c)):void 0}},{key:"getLabelValue",value:function(e){var t=e.address,n=e.valueEntry,r=e.value,i=Zt.extractThemeMapPayload(n),o=i.labelType,a=i.labelRef,s=Zt.getLabelRefConstructed(a,t,r),u=o===xt.ICON?this.getTheme().getIconInfo(s):null,l=Zt.getLabelInfoConstructed(o,s,n,u);return l?JSON.parse(JSON.stringify(l)):void 0}},{key:"convertLabelToText",value:function(e){if(e){var t=e.r,n=e.ar,r=e.lt;if(t)return t;if(n){var i;switch(r){case xt.TEXT:i=Ct.TEXT+n;break;case xt.ICON:i=Ct.ICON+n;break;case xt.IMAGE:i=Ct.IMAGE+n;break;default:return null}return this.getStrings().translate(i,n)}}return null}},{key:"getLabelStyle",value:function(e,t){var n=1<arguments.length&&void 0!==t&&t,r=this.getTheme(),i=r.getLabelDefaultStyle(),o={};if(e){var a=e.t,s=e.zmin,u=e.l;a&&(o.t=a),s&&(o.zmin=s);var l=r.getLabelStyle(u);l&&(o=L(L({},o),l))}return o||n||(o=i),o}},{key:"getLabelConstantsSet_",value:function(){var e=this.getThemeMap().labelTreeList,t=this.processValueEntry_.bind(this);return null==e||0===e.length?{isInsufficientInput:!0}:{labelTreeList:e,returnValueFunction:this.getLabelValue.bind(this),processValueEntry:t}}},{key:"getGeometryLabelInfo",value:function(t){var n=this,e=this.getLabelConstantsSet_(),r=e.isInsufficientInput,i=e.labelTreeList,o=e.returnValueFunction,a=e.processValueEntry;if(r)return null;var s=t.getAddress(),u=null;return i.find(function(e){return(u=a({geometry:t,address:s,valueEntry:e,returnValueFunction:o}))&&(u.r=n.convertLabelToText(u)),u}),u?JSON.parse(JSON.stringify(u)):void 0}},{key:"getEntityLabelInfo",value:function(t){var e=this.getLabelConstantsSet_(),n=e.isInsufficientInput,r=e.labelTreeList,i=e.returnValueFunction,o=e.processValueEntry;if(n)return null;var a=null;return r.find(function(e){return a=o({entity:t,valueEntry:e,returnValueFunction:i})}),a?JSON.parse(JSON.stringify(a)):void 0}},{key:"getLabelInfo",value:function(o){var a=this,e=this.getLabelConstantsSet_(),t=e.isInsufficientInput,n=e.labelTreeList,s=e.returnValueFunction,u=e.processValueEntry;if(t)return null;var l=o.getAddress(),c=o.getEntities(),h=null;if(c&&1<c.length){var v=null;n.find(function(t){var n,r=null,i=!1;return c.forEach(function(e){n=u({entity:e,valueEntry:t,returnValueFunction:s}),(r=a.convertLabelToText(n))&&0<r.length&&(v?v+=", "+r:(v=r,i=!0))},a),i||(n=u({geometry:o,address:l,valueEntry:t,returnValueFunction:s}),(r=a.convertLabelToText(n))&&0<r.length&&(v?v+=", "+r:v=r,i=!0)),i&&(h={lt:a.TEXT_LABEL_TYPE,r:v}),i},this)}else{var r=c?c[0]:null;n.find(function(e){return(h=u({geometry:o,entity:r,address:l,valueEntry:e,returnValueFunction:s}))&&(h.r=a.convertLabelToText(h)),h},this)}return h?JSON.parse(JSON.stringify(h)):void 0}},{key:"processValueEntry_",value:function(e){var i=this,o=e.geometry,a=e.entity,s=e.address,t=e.valueEntry,n=e.value,u=e.returnValueFunction,l=null,r=t.ks;if(void 0!==r&&r.find(function(e){var t,n;if(e.gk&&o)t=e.gk,n=o.properties[t];else if(e.ek&&a)t=e.ek,n=a.properties[t];else if(e.ak&&s){if((t=e.ak)===s[0])n=T(s,2)[1]}if(void 0!==n){if(e.v){var r=e.v[n];if(void 0!==r&&void 0!==(l=i.processValueEntry_({geometry:o,entity:a,address:s,valueEntry:r,value:n,returnValueFunction:u})))return!0}if(void 0!==(l=u({geometry:o,entity:a,address:s,valueEntry:e,value:n})))return!0}return!1},this))return l;return u?u({geometry:o,entity:a,address:s,valueEntry:t,value:n}):l}},{key:"setIcon",value:function(e,t){e&&t&&(this.iconCache[e]=t)}},{key:"setReleaseSettings_",value:function(e){this.releaseSettings_=e}}]),e}(),Qt={NODES_LB:"mfs.micello.com",US_1:"mfs-us-1.micello.com",US_2:"mfs-us-2.micello.com",AU_1:"mfs-au-1.micello.com",AU_2:"mfs-au-2.micello.com",EU_1:"mfs-eu-1.micello.com",SG_1:"mfs-sg-1.micello.com",HUB:"mfs-hub-master.micello.com",PREVIEW:"preview.micello.com/mfs",FACTORY:"factory-mfs.micello.com",CIT:"integration.mfs.hub.venues.ext.here.com",STG:"alpha.mfs.hub.venues.ext.here.com"},$t=Qt.HUB,en=Object.freeze({MFILE:"MFILE",MVAR:"MVAR",MPATH:"MPATH",MKEY:"MKEY",MPATTERN:"MPATTERN",MPACKAGE:"MPACKAGE"}),tn=(Object.freeze((c(_t={},en.MFILE,"/mfile"),c(_t,en.MVAR,"/mvar"),c(_t,en.MPATH,"/mpath"),c(_t,en.MKEY,"/mkey"),c(_t,en.MPATTERN,"/mpattern"),c(_t,en.MPACKAGE,"/mpackage"),_t)),Object.freeze(Object.values(Qt).reduce(function(e,t){return L(L({},e),{},c({},t,{key:null}))},{}))),nn=Object.freeze({apiKey:null,dataApiType:ke,fileHost:$t,queryParamMap:tn}),rn=Xe.GEO_JSON,on=qe[rn],an=on.COMMUNITY_MAP,sn=on.COMMUNITY_ENTITY,un=on.GEOJSON_LEVEL_GEOMETRY,ln=function(){function t(e){h(this,t),this.baseApi=e}return u(t,[{key:"getBaseAPI",value:function(){return this.baseApi}},{key:"getCommunityMap",value:function(e,t,n){return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(e,rn,an,null,t,n))}},{key:"getCommunityEntity",value:function(e,t,n){return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(e,rn,sn,null,t,n))}},{key:"getGeoJsonLevelGeometry",value:function(e,t,n,r){var i="/".concat(t);return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(e,rn,un,i,n,r))}}]),t}(),cn=Object.freeze({MAP:"MAP",META:"META",CUSTOMER:"CUSTOMER"}),hn=Object.freeze((c(Et={},cn.MAP,"/map"),c(Et,cn.META,"/meta"),c(Et,cn.CUSTOMER,"/customer"),Et)),vn=Object.freeze({METACONFIG:"METACONFIG",OVERRIDES:"OVERRIDES",DATAHOSTS:"DATAHOSTS"}),fn=Object.freeze((c(It={},vn.METACONFIG,"/metaConfig"),c(It,vn.OVERRIDES,"/overrides"),c(It,vn.DATAHOSTS,"/map/dataHosts"),It)),dn=Object.freeze({V4:"V4",V5:"V5"}),gn=(Object.freeze((c(Mt={},dn.V4,"/v4"),c(Mt,dn.V5,"/v5"),Mt)),Object.freeze((c(At={},Ze.THEME,"/theme/v5"),c(At,Ze.THEME_MAP,"/thememap/v5"),c(At,Ze.PRESETS,"/presets/v5"),c(At,Ze.SDK_STRINGS,"/strings/v5"),c(At,Ze.ICON_FILE,"/iconfile/v5"),c(At,Ze.INPUT_COLORS,"/miceditor/inputcolors"),c(At,Ze.BASE_MAP_INFO,"/miceditor/basemapinfo"),c(At,Ze.CONFIG_PROFILE,"/miceditor/configprofile"),c(At,Ze.NAV_THEME,"/navtheme/v5"),c(At,Ze.NAV_NAME_THEME,"/navtheme/v5"),c(At,Ze.NAV_PROP_MAP,"/navpropmap/v5"),c(At,Ze.NAV_STRINGS,"/strings/v5/nav"),c(At,Ze.NAV_THEME_MAP,"/navthememap/v5"),c(At,Ze.NAV_NAME_THEME_MAP,"/navthememap/v5"),c(At,Ze.V4_THEME_FAMILY,"/theme/v4"),c(At,Ze.V4_MAPTYPE_THEME,"/theme/v4"),c(At,Ze.ICON,"/theme/icon/v5"),c(At,Ze.MARKER,"/theme/marker"),c(At,Ze.PERMISSIONS,"/auth/stringroles"),c(At,Ze.NAICS_ARRAY,"/naics/2012/array"),c(At,Ze.NAICS_MAP,"/naics/2012/map"),At))),pn=Object.freeze((c(Ot={},Xe.GEO_JSON,"/geojson"),c(Ot,Xe.V5_MAP,"/v5_map"),c(Ot,Xe.V5_NAV,"/v5_nav"),c(Ot,Xe.V5_INFO,"/v5_info"),c(Ot,Xe.KML,"/kml"),c(Ot,Xe.SVG,"/svg"),c(Ot,Xe.PNG,"/png"),Ot)),yn=Object.freeze((c(Lt={},Xe.V5_MAP,{COMMUNITY_MAP:"/com-map",COMMUNITY_DIRECTORY:"/com-dir",COMMUNITY_DETAIL:"/com-detail",LEVEL_GEOMETRY:"/level-geom",DRAWING_ENTITY:"/drawing-entity"}),c(Lt,Xe.GEO_JSON,{COMMUNITY_MAP:"/com-map",COMMUNITY_ENTITY:"/com-entity",PATH_LEVEL_GEOMETRY:"/path-level-geom",GEOJSON_LEVEL_GEOMETRY:"/geojson-level-geom"}),c(Lt,Xe.V5_NAV,{JSON_NAV:"/json",BINARY_NAV:"/bin",JSON_ENHANCED_NAV:"/json-enh",BINARY_ENHANCED_NAV:"/bin-enh"}),c(Lt,Xe.V5_NAV,{JSON_NAV:"/json",BINARY_NAV:"/bin",JSON_ENHANCED_NAV:"/json-enh",BINARY_ENHANCED_NAV:"/bin-enh"}),c(Lt,Xe.V5_INFO,{GEOMETRY_INFO:"/geom-info"}),c(Lt,Xe.SVG,{PLAIN:"/plain",PRETTY:"/pretty",PRETTY_HORIZONTAL_LABEL:"/pretty"}),c(Lt,Xe.KML,{RASTER:"/raster",RASTER_HORIZONTAL:"/raster",VECTOR:"/vector",VECTOR_HORIZONTAL:"/vector"}),c(Lt,Xe.PNG,{LOW_RESOLUTION:"/lo-res",HIGH_RESOLUTION:"/high-res",LOW_RESOLUTION_GEO:"/lo-res-geo",HIGH_RESOLUTION_GEO:"/high-res-geo",LOW_RESOLUTION_HORIZONTAL:"/lo-res",HIGH_RESOLUTION_HORIZONTAL:"/high-res",LOW_RESOLUTION_HORIZONTAL_GEO:"/lo-res-geo",HIGH_RESOLUTION_HORIZONTAL_GEO:"/high-res-geo"}),Lt)),mn=Object.freeze({venueId:null,language:"-",mapVersion:"-",entityVersion:"-",fileVersion:null,themeName:We[Ze.THEME]}),_n=Object.freeze({MFILE:"MFILE",MPATH:"MPATH",MVAR:"MVAR"}),En=Object.freeze((c(Tt={},_n.MFILE,"/mfile"),c(Tt,_n.MPATH,"/mpath"),c(Tt,_n.MVAR,"/mvar"),Tt)),In=function(){function e(){h(this,e)}return u(e,[{key:"getBaseUrl",value:function(e){var t=!(0<arguments.length&&void 0!==e)||e,n="".concat(this.hostConfig_.fileHost).concat(t?"/ms/v1":"");return n.startsWith("https://")||n.startsWith("http://")||(n="https://".concat(n)),n}},{key:"getFileServiceBaseUrl",value:function(e){var t=0<arguments.length&&void 0!==e?e:_n.MFILE;if(_n[t])return"".concat(this.getBaseUrl()).concat(En[t])}},{key:"getGlobalMetaBaseUrl",value:function(e){var t=hn[cn.META],n=this.getFileServiceBaseUrl(e);return"".concat(n).concat(t)}},{key:"getVenueMapBaseUrl",value:function(e){var t=this.getFileServiceBaseUrl(e),n=hn[cn.MAP];return"".concat(t).concat(n)}},{key:"getGlobalMetaFileUrl",value:function(e,t,n,r){var i=1<arguments.length&&void 0!==t?t:We[e],o=2<arguments.length?n:void 0,a=3<arguments.length?r:void 0,s=this.getGlobalMetaBaseUrl(a),u=gn[e],l=null===i||""===i?"":"/".concat(i);switch(e){case Ze.THEME:case Ze.THEME_MAP:case Ze.PRESETS:case Ze.SDK_STRINGS:case Ze.ICON_FILE:case Ze.INPUT_COLORS:case Ze.BASE_MAP_INFO:case Ze.CONFIG_PROFILE:case Ze.NAV_THEME:case Ze.NAV_NAME_THEME:case Ze.NAV_PROP_MAP:case Ze.NAV_STRINGS:case Ze.NAV_THEME_MAP:case Ze.NAV_NAME_THEME_MAP:case Ze.V4_THEME_FAMILY:s+="".concat(u).concat(l);break;case Ze.ICON:case Ze.MARKER:case Ze.V4_MAPTYPE_THEME:s+=0<l.length&&o&&0<o.length?"".concat(u).concat(l,"/").concat(o):"".concat(u);break;case Ze.PERMISSIONS:case Ze.NAICS_ARRAY:case Ze.NAICS_MAP:s+="".concat(u)}return s}}]),e}(),Mn=function(){l(o,In);var n=g(o);function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return h(this,o),(e=n.call(this)).productAPI={},e.hostConfig_=t,e.isHostCustom=!1,e}return u(o,[{key:"getGeoJsonApi",value:function(){return this.productAPI[Xe.GEO_JSON]||(this.productAPI[Xe.GEO_JSON]=new ln(this)),this.productAPI[Xe.GEO_JSON]}},{key:"getMapProductUrlPath",value:function(e,t,n,r){var i=!(1<arguments.length&&void 0!==t)||t,o=2<arguments.length?n:void 0,a=3<arguments.length?r:void 0,s=this.getVersionedVenueUrl(e,i,a);return o&&(s+="".concat(pn[o])),s}},{key:"getMapProductFileUrl",value:function(e,t,n,r,i,o){var a=yn[Xe[t]][n],s=this.getMapProductUrlPath(e,!0,t,i);return n&&(s+="".concat(a)),r&&(s+="".concat(r)),!o&&0!==o||(s+="/fv/".concat(o)),s}},{key:"getMetaConfigUrl",value:function(e,t){var n=fn[vn.METACONFIG],r=this.getVersionedVenueUrl(e,!0,t);return r+="".concat(n)}},{key:"getMetaFileUrl",value:function(e,t,n){var r=2<arguments.length&&void 0!==n?n:We[t];if(e){var i,o=Ke[t];return"object"===a(e[o])&&e[o][r]?i=new URL(e[o][r]):"string"==typeof e[o]&&(i=new URL(e[o])),i?this.isHostCustom?"".concat(this.getBaseUrl(!1)).concat(i.pathname):i.toString():null}}},{key:"getMetaOverrideFileUrls",value:function(e,t,n,r){var i=3<arguments.length&&void 0!==r?r:We[n];if(!t||!t.communityOverrides||!t.communityOverrides[e])return[];var o=Je[n],a=t.communityOverrides[e][o]||{};return Array.isArray(a)?a:a[i]?a[i]:[]}},{key:"getVersionedVenueUrl",value:function(e,t,n){var r=2<arguments.length?n:void 0,i=!(1<arguments.length&&void 0!==t)||t?this.getFileServiceBaseUrl(r):"";return i+=o.getVersionedVenuePathSegment(e)}},{key:"getNormalizedUrl",value:function(e){if(this.isHostCustom){var t=new URL(e);return"".concat(this.getBaseUrl(!1)).concat(t.pathname)}return e}},{key:"getMetaConfig",value:function(n){var r=this;if(!n)return null;var i={venueId:n.cid};Object.values(Ke).forEach(function(t){n[t]&&("string"==typeof n[t]?i[t]=n[t]:(i[t]={},Object.keys(n[t]).forEach(function(e){i[t][e]=n[t][e]})))});var e={},o=n.communityOverrides[i.venueId];return Object.keys(o).forEach(function(t){if(Array.isArray(o[t]))e[t]=o[t].map(function(e){return"".concat(r.getFileServiceBaseUrl()).concat(e)});else if("object"===a(o[t])){var n={};Object.keys(o[t]).forEach(function(e){Array.isArray(o[t][e])&&(n[e]=o[t][e].map(function(e){return"".concat(r.getFileServiceBaseUrl()).concat(e)}))}),e[t]=n}}),i.communityOverrides=c({},i.venueId,e),L(L({},n),i)}}],[{key:"getVersionedVenuePathSegment",value:function(e,t,n){var r=1<arguments.length&&void 0!==t?t:"-",i=2<arguments.length&&void 0!==n?n:"-",o=hn[cn.MAP];return"".concat(o,"/").concat(e,"/mv/").concat(r,"/ev/").concat(i)}},{key:"getVenueConfig",value:function(e){var t=L(L({},mn),e);return t.mapVersion=Number(t.mapVersion)||"-",t.entityVersion=Number(t.entityVersion)||"-",t.fileVersion=Number(t.fileVersion)||null,t.venueId=Number(t.venueId),t}}]),o}(),An=function(){l(s,Mn);var n=g(s);function s(e){var t;return h(this,s),(t=n.call(this,e)).setAndUpdateHostConfig_(e),e.fileHost&&(t.isHostCustom=!0),t}return u(s,[{key:"setAndUpdateHostConfig_",value:function(e){var t=e.apiKey,n=e.fileHost,r={};Object.keys(nn.queryParamMap).forEach(function(e){r[e]={key:t}}),n&&(r[n]={key:t}),this.hostConfig_={apiKey:t,dataApiType:ke,fileHost:n||$t,queryParamMap:L(L({},r),nn.QUERY_PARAM_MAP_DEFAULT)}}},{key:"addServer",value:function(e,t){var n=-1<e.indexOf("://")?e.split("://")[1]:e,r=this.hostConfig_.queryParamMap[n]?L(L({},this.hostConfig_.queryParamMap[n]),t):t;Object.keys(r).forEach(function(e){null!==r[e]&&void 0!==r[e]&&""!==r[e]||delete r[e]}),this.hostConfig_.queryParamMap[n]=r}},{key:"appendQueryParams",value:function(e){var t=this.hostConfig_.queryParamMap,n=-1<e.indexOf("://")?e.split("://")[1]:e,r=t[T(Object.keys(t).filter(function(e){return n.startsWith(e)}).sort(function(e,t){return t.length-e.length}),1)[0]];return s.appendParamList(e,r)}},{key:"fetch",value:function(e,t,n,r){var i=3<arguments.length&&void 0!==r&&r,o=e;return o.startsWith("http://")&&(o=o.replace(/http:\/\//gm,"https://")),i||(o=this.appendQueryParams(o)),Nt.get(o,t,n)}},{key:"getMapProductFileUrl",value:function(e,t,n,r,i,o){return p(v(s.prototype),"getMapProductFileUrl",this).call(this,e,t,n,r,i,o)}},{key:"getGlobalMetaFileUrl",value:function(e,t,n,r,i){var o=4<arguments.length&&void 0!==i?i:0,a=p(v(s.prototype),"getGlobalMetaFileUrl",this).call(this,e,t,n,r);return r&&r===en.MPATH&&(a=s.appendParamList(a,{fvhistory:o})),a}}],[{key:"appendParamList",value:function(e,t){if(!t||"object"!==a(t))return e;var n=e.split("?"),r=T(n,2)[1],i=void 0===r?"":r;return Object.keys(t).filter(function(e){return-1===i.indexOf("".concat(e,"="))}).forEach(function(e){i+="&".concat(e,"=").concat(t[e])}),0<(i=i.startsWith("&")?i.substr(1):i).length?"".concat(n[0],"?").concat(i):e}}]),s}(),On=function(){function i(){h(this,i)}return u(i,null,[{key:"isPointOnGeoJSONLineString",value:function(e,t){var n=!1;if(t&&1<t.length)for(var r=0,i=0,o=1;o<t.length;o+=1)if(r=t[o-1],i=t[o],St.isPointOnLineSegment(e,r,i)){n=!0;break}return n}},{key:"isPointOnGeoJSONMultiLineString",value:function(e,t){for(var n=!1,r=0;r<t.length;r+=1)if(i.isPointOnGeoJSONLineString(e,t[r])){n=!0;break}return n}},{key:"isPointInsideGeoJSONPolygon",value:function(e,t){var n=!1;if(St.isPointInPolygon(e,t[0])&&(n=!0),n)for(var r=1;r<t.length;r+=1)if(St.isPointInPolygon(e,t[r])){n=!1;break}return n}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(e,t){for(var n=t.length,r=0;r<n;r+=1)if(i.isPointInsideGeoJSONPolygon(e,t[r]))return!0;return!1}},{key:"convertIntAddressToGeometryAddressListFormat",value:function(e){if(e&&"string"==typeof e){var t=[];return e.split(" ").forEach(function(e){t.push.apply(t,b(e.split(" ")))}),t}return null}},{key:"getGeometriesByLonLat",value:function(t,e,n){for(var r=2<arguments.length&&void 0!==n&&n,i=[],o=e.filter(function(e){return St.isPointInBoundingBox(t,e.getBoundingBox())}),a=0;a<o.length;a+=1){var s=o[a];if(s.isPointInsideGeometry(t,!0)&&(i.push(s),!r))break}return i.sort(function(e,t){return t.getZIndex()-e.getZIndex()})}}]),i}(),Ln=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;h(this,r),this.venueModel=n,this.id=e,this.properties=L({geometry:[],int_address:[]},t)}return u(r,[{key:"getId",value:function(){return this.id}},{key:"getGeometries",value:function(){var n=this;return this.properties.geometry.filter(function(e){return T(e,2)[1]}).map(function(e){var t=T(e,1)[0];return n.venueModel.getGeometryById(t)})}},{key:"getInternalAddress",value:function(){return this.properties.int_address||[]}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getProperties",value:function(){return this.properties}},{key:"getLabelInfo",value:function(){return this.venueModel.metaInformation_.getEntityLabelInfo(this)}}]),r}(),Tn=function(){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;h(this,r),this.id=e.id,this.properties=e.properties||{},this.labelArea=e.label_area||[],this.geometry=e.geometry||{},this.location=e.location||{},this.level=t,this.zIndex=n,this.state_={isHighlighted:!1,highlightedStyle:{}}}return u(r,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getAddress",value:function(){return On.convertIntAddressToGeometryAddressListFormat(this.getInternalAddress())}},{key:"getInternalAddress",value:function(){return this.properties.int_address||""}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.getMetaInformation_().getIcon(this.getLabelInfo())}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelInfo",value:function(){return this.getMetaInformation_().getLabelInfo(this)}},{key:"getLabelStyle",value:function(){return L({fill:"#333333"},this.getMetaInformation_().getLabelStyle(this.getStyle()))}},{key:"getGeometryLabelInfo",value:function(){return this.getMetaInformation_().getGeometryLabelInfo(this)}},{key:"getEntities",value:function(){var t=this;return(this.properties.entities||[]).map(function(e){return t.level.getDrawing().getVenueModel().getEntityById(e)})}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var e=this.getType(),t=this.getCoordinates(),n=[];switch(e){case He:n=[t,t];break;case Be:case Fe:n=t;break;case je:case Ue:n=t.reduce(function(e,t){return e.concat(t)},[]);break;case Ye:n=t.reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,t){return e.concat(t)},[])}return St.getBoundingBoxVertices(n)}},{key:"isIcon",value:function(){var e=this.getLabelInfo();return e&&e.lt===xt.ICON}},{key:"isPointInsideGeometry",value:function(e,t){var n,r=1<arguments.length&&void 0!==t&&t,i=!1;switch(this.getType()){case He:n=this.getLabelArea()&&St.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),i=St.isPointInPolygon(e,n);break;case Be:break;case Fe:i=r&&On.isPointOnGeoJSONLineString(e,this.getCoordinates());break;case je:i=r&&On.isPointOnGeoJSONMultiLineString(e,this.getCoordinates());break;case Ue:i=On.isPointInsideGeoJSONPolygon(e,this.getCoordinates());break;case Ye:i=On.isPointInsideGeoJSONMultiPolygon(e,this.getCoordinates())}return i}},{key:"highlight",value:function(e,t){var n=!(0<arguments.length&&void 0!==e)||e,r=1<arguments.length?t:void 0;this.state_.isHighlighted=n,this.state_.highlightedStyle=n?r:{}}},{key:"isHighlighted",value:function(){return Boolean(this.state_.isHighlighted)}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return L({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}]),r}(),bn=function(){function o(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],i=3<arguments.length?arguments[3]:void 0;h(this,o),this.id=e,this.properties=L({},n),this.zIndexCount=0,this.geometries=r.map(function(e){return t.zIndexCount+=1,new Tn(e,t,t.zIndexCount)}),this.drawing=i}return u(o,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties["short name"]||""}},{key:"getZIndex",value:function(){return Number(this.properties.zlevel)}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map(function(e){return e.toJSON()})}},{key:"getGeometryById",value:function(t){return this.geometries.find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(e){return 0<arguments.length&&void 0!==e&&e?this.geometries.sort(function(e,t){return t.getZIndex()-e.getZIndex()}):this.geometries.sort(function(e,t){return e.getZIndex()-t.getZIndex()})}},{key:"getGeometriesByAddress",value:function(t){return this.geometries.filter(function(e){return e.getInternalAddress()===t})}},{key:"isMain",value:function(){return Boolean(this.properties.main)}}]),o}(),kn=function(){function a(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],o=4<arguments.length?arguments[4]:void 0;h(this,a),this.venueModel=o,this.levels=i.map(function(e){return new bn(e.id,e.properties,e.features,t)}),this.id=e,this.properties=n,this.frame_=r}return u(a,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return Boolean(this.properties.is_root)}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){var e=this.frame_,t=e.height,n=e.width,r=e.transform,i=T(St.getBoundingBoxVertices([St.convertMxMy2LonLat(r,[0,0]),St.convertMxMy2LonLat(r,[0,t]),St.convertMxMy2LonLat(r,[n,0]),St.convertMxMy2LonLat(r,[n,t])]),2),o=i[0],a=i[1];return[a[1],o[0],o[1],a[0]]}},{key:"getCenter",value:function(){var e=this.frame_;if(e)return St.convertMxMy2LonLat(e.transform,[e.width/2,e.height/2])}},{key:"getGeometryById",value:function(t,e){return e?e.getGeometryById(t):this.getGeometries().find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(){return this.levels.flatMap(function(e){return e.getGeometries()})}},{key:"getLevelById",value:function(t){return this.levels.find(function(e){return e.getId()===t})}},{key:"getLevelByZIndex",value:function(t){return this.levels.find(function(e){return e.getZIndex()===t})}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find(function(e){return e.isMain()})}},{key:"getVenueModel",value:function(){return this.venueModel}}]),a}(),Sn=ze.STANDARD,Nn=function(){function o(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new qt;h(this,o),this.metaInformation_=i,this.id=e.id,this.location=e.location||{},this.properties=L({},e.properties),this.drawings=e.drawings.map(function(e){var t=e.levels.map(function(e){var t=e.id;return r.find(function(e){return e.id===t})});return new kn(e.id,e.properties,e.ref_frame,t,n)}),this.entities=t.entities.map(function(e){return new Ln(e.id,e.properties,n)})}return u(o,[{key:"getDisplaySettings",value:function(){return this.metaInformation_.releaseSettings_.displayOptions.display||Sn}},{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){var e=T(St.getBoundingBoxVertices(this.getDrawings().flatMap(function(e){var t=T(e.getBoundingBox(),4),n=t[0];return[[t[1],t[2]],[t[3],n]]})),2),t=e[0],n=e[1];return[n[1],t[0],t[1],n[0]]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getEntityById",value:function(t){return this.entities.find(function(e){return e.id===t})}},{key:"getGeometryById",value:function(t){return this.getGeometries().find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(){return this.getLevels().sort(function(e,t){return e.getZIndex()-t.getZIndex()}).flatMap(function(e){return e.getGeometries()})}},{key:"getGeometriesByLonLat",value:function(n,e,t){var r=this,i=!(2<arguments.length&&void 0!==t)||t,o=(1<arguments.length&&void 0!==e?e:[]).map(function(e){return r.getLevelById(e)});0===o.length&&(o=this.drawings.filter(function(e){var t=e.getBoundingBox();return St.isPointInBoundingBox(n,t)}).flatMap(function(e){return e.getLevels()}));return On.getGeometriesByLonLat(n,o.flatMap(function(e){return e.getGeometries(!0)}),i)}},{key:"getDrawingById",value:function(t){return this.drawings.find(function(e){return e.getId()===t})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find(function(e){return e.isRoot()})}},{key:"getLevelById",value:function(t){return this.getLevels().find(function(e){return e.getId()===t})}},{key:"getLevelsByZIndex",value:function(e){var t=0<arguments.length&&void 0!==e?e:0;return this.getLevels().filter(function(e){return Number(e.getZIndex())===Number(t)})}},{key:"getLevels",value:function(){return this.drawings.flatMap(function(e){return e.getLevels()})}},{key:"getLevelMapFlattenedByZIndex_",value:function(){return this.getLevels().reduce(function(e,t){var n=t.getZIndex(),r=e;return r[n]||(r[n]=[]),r[n].push(t),r},{})}},{key:"getIconsInformation",value:function(){var n=new Map;return this.getGeometries().filter(function(e){return e.isIcon()}).forEach(function(e){var t=e.getLabelInfo();n.set(t.iconIdentifier,t)}),Array.from(n.values())}}]),o}(),wn="vfs.venue.maps.api.here.com",Cn=function(){l(a,Mn);var o=g(a);function a(e){var t,n=e.apiKey,r=e.fileHost,i=e.token;return h(this,a),t=o.call(this,{apiKey:n,fileHost:r||wn,token:i}),r&&(t.isHostCustom=!0),t}return u(a,[{key:"fetch",value:function(e,t,n){var r=this.hostConfig_,i=r.apiKey,o=r.token,a=L({method:"GET",headers:{}},t),s=e;if(s.startsWith("http://")&&(s=s.replace(/http:\/\//gm,"https://")),o){var u="Bearer ",l=o.startsWith(u)?o:"".concat(u).concat(o);a.headers instanceof Headers?a.headers.append("Authorization",l):a.headers.Authorization=l}else i&&(s="".concat(s,"?apiKey=").concat(i));return Nt.get(s,a,n)}}]),a}(),Pn={isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}},xn=Object.keys(Ke).map(function(e){return{identifier:e,name:void 0,url:void 0}}),Vn=function(){function a(e){var t=e.apiKey,n=e.baseUrl,r=e.token,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];h(this,a);var o={apiKey:t,fileHost:n,token:r};this.dataApi_=i?new An(o):new Cn(o)}return u(a,[{key:"load",value:function(n,e){var r=this,t=1<arguments.length&&void 0!==e?e:{},i=L(L({},Pn),t),o=i.isIconsEnabled,a=i.isMetaEnabled,s=i.iconOptions,u=i.metaOptions;return Promise.resolve().then(function(){return a?r.getMeta_(n,u).catch(function(e){return Promise.resolve()}):new qt}).then(function(e){return r.getVenue_(n,e)}).then(function(e){if(yt.emit(pt.VENUE_MAP_DATA_LOADED,{data:e}),o){var t=e.getIconsInformation();return r.getIcons_(n,e.metaInformation_,t,s).then(function(){return e})}return e})}},{key:"getVenue_",value:function(t,o){var n=this;return this.getCommunityMap_(t).then(function(e){return Promise.all([Promise.resolve(e),n.getCommunityEntity_(t),n.getLevels_(t,e.drawings.flatMap(function(e){return e.levels.map(function(e){return e.id})}))])}).then(function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2];return new Nn(n,r,void 0===i?[]:i,o)})}},{key:"getCommunityMap_",value:function(t){return this.dataApi_.getGeoJsonApi().getCommunityMap(t).catch(function(e){return Promise.reject(new Error("Community map load failed for venue id ".concat(t,' with error "\n ').concat(e.message,'"')))})}},{key:"getCommunityEntity_",value:function(t){return this.dataApi_.getGeoJsonApi().getCommunityEntity(t).catch(function(e){return Promise.reject(new Error("Community Entity failed for venue id ".concat(t,' with error "').concat(e.message,'"')))})}},{key:"getLevels_",value:function(e,t){var n=this,r=1<arguments.length&&void 0!==t?t:[];return Promise.all(r.map(function(t){return n.dataApi_.getGeoJsonApi().getGeoJsonLevelGeometry(e,t).catch(function(e){return Promise.reject(new Error("Level load failed for level id ".concat(t,' with error: "').concat(e.message,'"')))})}))}},{key:"getIcon_",value:function(e,n,t,r){var i=2<arguments.length&&void 0!==t?t:{},o=3<arguments.length&&void 0!==r&&r,a=i.iconIdentifier,s=i.url;return a&&s?this.dataApi_.fetch(this.dataApi_.getNormalizedUrl(s)).then(function(e){var t=new wt(L(L({},i),e),o);return n.setIcon(a,t),t}):Promise.reject(new Error("Issue with icon data, iconIdentifier and url should be available: ".concat(i)))}},{key:"getIcons_",value:function(e,n,t,r){var i=this,o=2<arguments.length&&void 0!==t?t:[],a=(3<arguments.length&&void 0!==r?r:{}).isMultiObjectToSplit;return Promise.all(o.map(function(t){return i.getIcon_(e,n,t,a).catch(function(e){return Promise.resolve(t)})})).catch(function(e){return Promise.resolve()})}},{key:"getMeta_",value:function(t,e,n){var r=this,i=1<arguments.length&&void 0!==e?e:{},o=2<arguments.length&&void 0!==n?n:xn,a=new qt;return Promise.resolve().then(function(){return r.getMetaConfig_(t,i).then(function(e){return a.releaseSettings_=e.settings,r.dataApi_.getMetaConfig(e)})}).then(function(e){return r.getMetaFiles_(e,a,o).then(function(){return r.getMetaOverrides_(t,e,a,o)})}).then(function(){return a})}},{key:"getMetaConfig_",value:function(e){var t=this.dataApi_.getMetaConfigUrl(e);return this.dataApi_.fetch(t).catch(function(e){return Promise.reject(e)})}},{key:"getMetaFiles_",value:function(i,o,e,t){var a=this,n=2<arguments.length&&void 0!==e?e:[],s=!(3<arguments.length&&void 0!==t)||t;return Promise.all(n.map(function(e){var t=e.identifier,n=e.name,r=e.url;return!r&&s&&(r=a.dataApi_.getMetaFileUrl(i,t,n)),r=r||a.dataApi_.getGlobalMetaFileUrl(t,n),a.dataApi_.fetch(r).then(function(e){return o.instantiateMetaFileAccessor_(t,e),e}).catch(function(e){return Promise.resolve()})}))}},{key:"getMetaOverrides_",value:function(i,o,a,e){var s=this,t=3<arguments.length&&void 0!==e?e:[];return Promise.all(t.map(function(e){var t=e.identifier,n=e.name,r=function(e,t){return i&&o&&s.dataApi_.getMetaOverrideFileUrls(i,o,e,t)||[]}(t,n);return Promise.all(r.map(function(e){return s.dataApi_.fetch(e).then(function(e){return a[t]&&a[t].applyOverride(e,!1),Promise.resolve()}).catch(function(e){return Promise.resolve()})}))}))}}]),a}(),Dn=function(){l(c,H.map.Feature);var t=g(c);function c(e){var n;if(h(this,c),n=t.call(this),!(e instanceof Nn))throw new Error("It is mandatory to provide valid instance of venueModel");return n.venueModel=e,n.search_=new be(e),n.status_={activeDrawingId:e.getRootDrawing().getId(),activeLevelIndex:e.getRootDrawing().getMainLevel().getZIndex()},n.mapObjectStore_=n.getDefaultMapObjectsStore_(),n.drawings=e.getDrawings().map(function(e){var t=new _(e);return t.setParentEventTarget(d(n)),t}),n.levels=e.getLevels().map(function(e){var t=new E(e);return t.setParentEventTarget(n.drawings.find(function(e){return e.getId()===t.getData().getDrawing().getId()})),t}),n.geometries=e.getGeometries().map(function(e){var t=new m(e);return t.setParentEventTarget(n.levels.find(function(e){return e.getId()===t.getData().getLevel().getId()})),t}),n}return u(c,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return f(H.geo.Rect,b(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var e=T(this.venueModel.getCenter(),2),t=e[0],n=e[1];return new H.geo.Point(n,t)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(t){return this.drawings.find(function(e){return e.getId()===t})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(t){return this.levels.find(function(e){return e.getId()===t})}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(t){return this.geometries.find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var t=this;return this.getData().getDisplaySettings()===ze.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map(function(e){return t.getLevel(e.getId())}):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map(function(e){return t.getLevel(e.getId())})}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(e){if(this.status_.activeDrawingId!==e){var t=this.venueModel.getDrawingById(e);if(!t)throw new Error("Drawing ".concat(e," was not found"));var n=this.status_.activeDrawingId;this.status_.activeDrawingId=e,this.setActiveLevelIndex(t.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(c.EVENTS.DRAWING_CHANGE,e,n))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(e){if(this.venueModel.getLevelsByZIndex(e)){var t=this.status_.activeLevelIndex;this.status_.activeLevelIndex=e,this.dispatchEvent(new H.util.ChangeEvent(c.EVENTS.LEVEL_CHANGE,e,t))}}},{key:"isActive",value:function(){var e=this.getParentEventTarget();return!!e&&this===e.activeVenue}},{key:"getHighlightedGeometries",value:function(){var t=this;return this.venueModel.getGeometries().filter(function(e){return e.isHighlighted()}).map(function(e){return t.getGeometry(e.getId())})}},{key:"setHighlightedGeometries",value:function(e,t,n){var r=!(0<arguments.length&&void 0!==e)||e,i=1<arguments.length&&void 0!==t?t:[],o=2<arguments.length&&void 0!==n?n:{},a=L(L({},ae),o),s=a.fillColor,u=a.outlineColor,l=a.outlineWidth;i.forEach(function(e){e.getData().highlight(r,{m:s,o:u,w:l})}),this.dispatchEvent(c.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(e,t){var n=0<arguments.length&&void 0!==e?e:this.getActiveLevelIndex(),r=1<arguments.length&&void 0!==t?t:this.getActiveDrawing();return this.mapObjectStore_[n][r.getId()]}},{key:"setMapObjects",value:function(e,t,n){var r=0<arguments.length&&void 0!==e?e:[],i=1<arguments.length&&void 0!==t?t:this.getActiveLevelIndex(),o=2<arguments.length&&void 0!==n?n:this.getActiveDrawing();this.mapObjectStore_[i]&&this.mapObjectStore_[i][o.getId()]&&(this.mapObjectStore_[i][o.getId()]=b(r)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:"";return this.search_.find(n).flatMap(function(e){return e.geometries.map(function(e){return t.getGeometry(e.getId())})})}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach(function(e){Object.values(e).forEach(function(e){return e.forEach(function(e){return e.setVisibility(!1)})})}),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getId()].forEach(function(e){return e.setVisibility(!0)})}},{key:"getDefaultMapObjectsStore_",value:function(){var i=this,o=this.getData().getDisplaySettings()===ze.FLATTEN;return this.venueModel.getLevels().reduce(function(e,t){var n=t.getZIndex(),r=L({},e);return r[n]||(r[n]={}),r[n][t.getDrawing().getId()]=[],o&&(r[n][i.venueModel.getRootDrawing().getId()]=[]),r},{})}}]),c}();Dn.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"};var Rn=function(){function e(){h(this,e)}return u(e,null,[{key:"getIconLayer",value:function(e){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==e?e:[]).flatMap(function(e){return e.getData().getGeometries()}).filter(function(e){return e.isIcon()&&e.getIcon()}).map(function(e){var t=T(e.getLabelArea(),2),n=t[0],r=t[1],i=e.getLevel(),o=e.getIcon().getSVG();return{type:"Feature",properties:{id:e.getId(),geometryId:e.getId(),levelId:i.getId(),name:e.getDisplayName(),venueId:i.getDrawing().getVenueModel().getId(),url:o?"data:image/svg+xml;utf8,".concat(encodeURIComponent(o)):""},geometry:{type:$,coordinates:[n,r]}}})}}},{key:"getLabelLayer",value:function(e){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==e?e:[]).flatMap(function(e){return e.getData().getGeometries()}).filter(function(e){return e.getDisplayName()&&!e.isIcon()}).map(function(e){var t=T(e.getLabelArea(),2),n=t[0],r=t[1],i=e.getLabelStyle(),o=i.fill,a=i.zmin,s=e.getLevel();return{type:"Feature",properties:{id:e.getId(),geometryId:e.getId(),levelId:s.getId(),venueId:s.getDrawing().getVenueModel().getId(),name:e.getDisplayName(),minZoom:a||15,textFillColor:o.toLowerCase()},geometry:{type:$,coordinates:[n,r]}}})}}},{key:"getGeometryLayer",value:function(e){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==e?e:[]).flatMap(function(e){return e.getData().getGeometries()}).filter(function(e){return e.getType()!==$}).map(function(e){var t=e.getHighlightedStyle()||{},n=t.m,r=t.o,i=t.w,o=L({},e.getStyle()),a=o.m,s=o.o,u=o.w,l=ie,c=l.fillColor,h=l.outlineColor,v=l.outlineWidth,f=e.getLevel();return{type:"Feature",properties:{id:e.getId(),fillColor:(n||a||c).toLowerCase(),geometryId:e.getId(),levelId:f.getId(),venueId:f.getDrawing().getVenueModel().getId(),outlineColor:(r||s||h).toLowerCase(),outlineWidth:(i||u||v)/3,zIndex:e.getZIndex()},geometry:{type:e.getType(),coordinates:e.getCoordinates()}}})}}},{key:"getFootprintLayer",value:function(e){return{type:"FeatureCollection",features:e.flatMap(function(e){var t=e.getData().getRootDrawing().getMainLevel().getId(),n=e.getLevel(t).getData().getGeometries().filter(function(e){return e.getType()===ee});return[{type:"Feature",properties:{isFootprint:!0,levelId:t,venueId:e.getId(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:n.map(function(e){return e.getCoordinates()})}},{type:"Feature",properties:{isFootprint:!0,levelId:t,venueId:e.getId(),zIndex:2,venueName:e.getName()},geometry:{type:"Point",coordinates:e.getCenter().toGeoJSON().coordinates.slice(0,2)}}]})}}}]),e}(),Gn=function(){function a(){h(this,a)}return u(a,null,[{key:"getIconsTextures",value:function(e){var i={},o={},a=(0<arguments.length&&void 0!==e?e:[]).reduce(function(e,t){var n=t.properties.name;return e[n]||(e[n]=[]),e[n].push(t),e},{});return Object.keys(a).forEach(function(e){var n="texture".concat(e),r="sprite".concat(e),t=a[e][0].properties.url;i[n]={url:t,sprites:c({},r,[0,0,50,50])},a[e].forEach(function(e){var t=e.properties;o["icon".concat(t.name)]={filter:{name:t.name,$zoom:{min:se}},draw:{points:{interactive:!0,priority:1,size:[[15,"5%"],[16,"10%"],[17,"15%"],[18,"25%"],[19,"35%"],[20,"40%"],[21,"50%"]],texture:n,sprite:r}}}})}),{textures:i,iconLayers:o}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:ce.FOOTPRINT},draw:{polygons:{interactive:!0,color:"#AF91B4",order:2},lines:{color:"#613F8E",width:"2px",order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){return{data:{source:"venues",layer:ce.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}}}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:ue}},data:{source:"venues",layer:ce.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:oe.size},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(e){return L({data:{source:"venues",layer:ce.ICON}},e)}},{key:"getStyle",value:function(e){var t=a.getIconsTextures(0<arguments.length&&void 0!==e?e:[]),n=t.textures,r=t.iconLayers,i={venue_footprints:a.getFootprintLayer(),venue_geometries:a.getGeometryLayer(),venue_labels:a.getTextLayer(),venue_icons:a.getIconLayer(r)},o=H.gl.yaml.safeDump({sources:{venues:{max_zoom:le,type:"GeoJSONTileSource"}},layers:i,textures:n});return new H.map.Style(o)}}]),a}(),Hn={type:"FeatureCollection",features:[]},Fn={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},Un=function(){l(r,H.map.provider.RemoteTileProvider);var n=g(r);function r(e){var t;return h(this,r),(t=n.call(this,e)).venues=[],t.activeVenue=null,t.dataLayers_={},t.tileIndexes_={},t.addEventListener(Dn.EVENTS.ACTIVE_VENUE_CHANGE,t.activeVenueChangeHandler_,void 0,d(t)),t}return u(r,[{key:"setStyle",value:function(e){return this.setStyleInternal(e)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(e,t){var n=e.properties;return this.activeVenue&&n.venueId===this.activeVenue.getId()?t!==ce.FOOTPRINT&&this.activeVenue.getActiveLevels().some(function(e){return e.id===n.levelId}):!0===n.isFootprint&&t===ce.FOOTPRINT}},{key:"requestInternal",value:function(s,u,l,e){function c(e){for(var t=0;t<e.length;t+=1)e[t]=e[t].map(function(e){return Q(e,l,s,u,Fn.extent)})}var h=this,v={};return Object.keys(this.tileIndexes_).forEach(function(t){var e=h.tileIndexes_[t].getTile(l,s,u);v[t]=e?function(e){var t=[],n=e&&e.features;if(n)for(var r=0,i=n.length;r<i;r+=1){var o=n[r],a=o.type,s=void 0,u=!1;switch(a){case he:s={type:te,coordinates:o.geometry.map(function(e){return e.slice()})};break;case ve:case fe:s={type:ne,coordinates:o.geometry.map(function(e){return e.map(function(e){return e.slice()})})},a===fe&&null==(s=q(s))&&(u=!0);break;default:u=!0}u||t.push({geometry:s,id:o.id,properties:o.tags,type:"Feature"})}return{type:"FeatureCollection",features:t}}(e):Hn,v[t].features=v[t].features.filter(function(e){return h.isFeatureVisible_(e,t)});for(var n=0;n<v[t].features.length;n+=1){var r=v[t].features[n],i=r.geometry.type;if(i===ee||i===ne)c(r.geometry.coordinates);else if(i===re)r.geometry.coordinates.map(c);else for(var o=r.geometry.coordinates,a=0;a<o.length;a+=1)o[a]=Q(o[a],l,s,u,Fn.extent)}}),e(v),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(t){return t?this.venues.find(function(e){return e.getId()===Number(t)}):this.activeVenue}},{key:"setActiveVenue",value:function(e){var t=this.activeVenue;this.activeVenue=e,this.dispatchEvent(new H.util.ChangeEvent(Dn.EVENTS.ACTIVE_VENUE_CHANGE,e,t)),this.reload()}},{key:"addVenue",value:function(e,t){var n=1<arguments.length&&void 0!==t&&t;if(!(e instanceof Dn))throw new Error("Invalid argument");var r=e.getId();if(this.getVenue(r))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(r," before adding new"));e.setParentEventTarget(this),this.venues.push(e),n||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:[];0<n.length&&(n.forEach(function(e){e instanceof Dn&&t.addVenue(e,!0)}),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(e){if(e instanceof Dn&&-1<this.venues.indexOf(e)){var t=e.getId();this.activeVenue&&this.activeVenue.getId()===t&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(e),1),this.reloadData_(),this.reloadStyle_(),this.reload()}}},{key:"getFeatureProxy",value:function(e,t,n){var r=e.geometryId,i=e.venueId,o=this.getVenue(i);return r?n(o.getGeometries().find(function(e){return e.id===r})):o&&n(o),!0}},{key:"addVenueEventListeners_",value:function(e){e&&(e.addEventListener(Dn.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),e.addEventListener(Dn.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),e.addEventListener(Dn.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(e){e&&(e.removeEventListener(Dn.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),e.removeEventListener(Dn.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),e.removeEventListener(Dn.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(e){var t=e.oldValue,n=e.newValue;t&&(this.removeVenueEventListeners_(t),t.updateMapObjectsVisibility_()),n&&(this.addVenueEventListeners_(n),n.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadData_([ce.VECTOR]),this.reload()}},{key:"createDataLayers_",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:Object.keys(ce),r=ce.FOOTPRINT,i=ce.ICON,o=ce.TEXT,a=ce.VECTOR;n.forEach(function(e){switch(e){case a:t.dataLayers_[a]=Rn.getGeometryLayer(t.venues);break;case r:t.dataLayers_[r]=Rn.getFootprintLayer(t.venues);break;case i:t.dataLayers_[i]=Rn.getIconLayer(t.venues);break;case o:t.dataLayers_[o]=Rn.getLabelLayer(t.venues);break;default:throw new Error("Unsupported Layer ".concat(e))}})}},{key:"createTileIndexes_",value:function(e){var t=this;(0<arguments.length&&void 0!==e?e:Object.keys(ce)).forEach(function(e){t.tileIndexes_[e]=function(e,t){return new W(e,t)}(t.dataLayers_[e],Fn)})}},{key:"reloadData_",value:function(e){var t=0<arguments.length&&void 0!==e?e:Object.keys(ce);this.createDataLayers_(t),this.createTileIndexes_(t)}},{key:"reloadStyle_",value:function(){var e=this.dataLayers_[ce.ICON]?this.dataLayers_[ce.ICON].features:[],t=Gn.getStyle(e);this.setStyle(t)}}]),r}(),Bn=function(){l(o,H.service.Service);var i=g(o);function o(e){var t;h(this,o),t=i.call(this,o,e);var n={apiKey:e.apikey,baseUrl:e.baseUrl&&e.baseUrl.getHost(),token:e.token};n.apiKey||n.token||(n.apiKey=t.getUrl().getQuery().apikey);var r=e.useLegacy||!1;return t.venueService_=new Vn(n,r),t}return u(o,[{key:"loadVenue",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{};return this.venueService_.load(e,n).then(function(e){return new Dn(e)})}}]),o}();Bn.CONFIG_KEY="venues",H.service.Platform.prototype.getVenuesService=function(e){return this.createService(Bn,e)};var jn=function(){l(i,H.ui.Control);var r=g(i);function i(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return h(this,i),(t=r.call(this)).provider_=null,t.levelSelectorUI_=null,t.setAlignment(n&&n.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),t.addClass("venues-ui"),e instanceof Dn&&t.setVenue(e),t}return u(i,[{key:"renderInternal",value:function(e,t){p(v(i.prototype),"renderInternal",this).call(this,e,t),this.createLevelSelectorUI_(e),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(e){e instanceof Dn&&(this.removeEventListeners_(),this.venue=e,this.provider_=e.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(e){var t=this;e.innerHTML="",this.levelSelectorUI_=null;this.levelSelectorUI_=new gt(e,null,null,function(e){return t.venue.setActiveLevelIndex(e)})}},{key:"update_",value:function(){if(this.levelSelectorUI_){var e=this.venue.getActiveDrawing().getData(),t=this.venue.getData().getDisplaySettings();this.levelSelectorUI_.update(e,t),this.levelChangeHandler_()}}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(Dn.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(Dn.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(Dn.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(Dn.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(Dn.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(Dn.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(e){this.setVenue(e.newValue)}}]),i}(),Yn=function(){l(i,H.ui.Control);var r=g(i);function i(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return h(this,i),(t=r.call(this)).provider_=null,t.drawingSelectorUI_=null,t.addClass("venues-ui"),t.setAlignment(n&&n.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),e instanceof Dn&&t.setVenue(e),t}return u(i,[{key:"renderInternal",value:function(e,t){p(v(i.prototype),"renderInternal",this).call(this,e,t),this.createDrawingSelectorUI_(e),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(e){e instanceof Dn&&(this.removeEventListeners_(),this.venue=e,this.provider_=e.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(e.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(e){var t=this;e.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new ct(e,null,function(e){return t.venue.setActiveDrawing(e)})}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(Dn.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(Dn.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(Dn.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(Dn.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(e){this.setVenue(e.newValue)}}]),i}(),zn=Object.freeze({__proto__:null,DrawingControl:Yn,LevelControl:jn});return t(".venues-ui * {\n  font-family: 'Fira Sans', 'Helvetica Neue', Helvetica, sans-serif;\n  color: #0F1621; }\n\n.venues-ui .arrow {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-repeat: no-repeat;\n  background-position: center; }\n  .venues-ui .arrow--up {\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"); }\n  .venues-ui .arrow--down {\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"); }\n\n.venues-ui .venues-ui-button {\n  display: block;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  font-size: 16px;\n  font-weight: 600;\n  background-color: #fff;\n  border: none;\n  border-bottom: 1px solid #9FA2A6;\n  cursor: pointer;\n  overflow: hidden;\n  color: #6e737a;\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap; }\n  .venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {\n    background-color: #f0f0f0;\n    color: #0F1621; }\n\n@keyframes fade {\n  0% {\n    opacity: 0; }\n  100% {\n    opacity: 1; } }\n\n.venues-ui__drawings .drawings {\n  position: absolute;\n  top: 0;\n  right: 45px;\n  display: none;\n  opacity: 0;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__drawings .drawings--open {\n    display: block;\n    opacity: 1;\n    animation: fade 1s; }\n  .venues-ui__drawings .drawings .venues-ui-button {\n    width: auto;\n    padding: 0 10px; }\n    .venues-ui__drawings .drawings .venues-ui-button:first-of-type {\n      border-top-left-radius: 5px;\n      border-top-right-radius: 5px; }\n    .venues-ui__drawings .drawings .venues-ui-button:last-of-type {\n      border-bottom-left-radius: 5px;\n      border-bottom-right-radius: 5px; }\n\n.venues-ui__drawings .trigger {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__drawings .trigger .arrow {\n    transform: rotate(0);\n    transition: 0.4s; }\n  .venues-ui__drawings .trigger.venues-ui-button--active .arrow {\n    transform: rotate(90deg);\n    transition: 0.4s; }\n\n.venues-ui__levels {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__levels .levels {\n    overflow: hidden; }\n  .venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {\n    border-radius: 0; }\n  .venues-ui__levels .venues-ui-button:first-of-type {\n    border-top-left-radius: 5px;\n    border-top-right-radius: 5px; }\n  .venues-ui__levels .venues-ui-button:last-of-type {\n    border-bottom-left-radius: 5px;\n    border-bottom-right-radius: 5px; }\n  .venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {\n    opacity: 0.5; }\n\n.venues-ui__directory {\n  position: absolute;\n  top: 10px;\n  right: 60px;\n  bottom: calc(100% - 45px);\n  width: 350px;\n  overflow: hidden;\n  background: white;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__directory.active {\n    bottom: 10px; }\n  .venues-ui__directory .directory__list {\n    top: 80px;\n    bottom: 20px;\n    position: absolute;\n    overflow-y: scroll;\n    right: 10px;\n    left: 10px;\n    font-size: 12px; }\n    .venues-ui__directory .directory__list svg {\n      width: 25px;\n      height: 25px; }\n  .venues-ui__directory .directory__heading {\n    margin: 8px;\n    font-size: 15px;\n    font-weight: normal;\n    cursor: pointer; }\n  .venues-ui__directory .directory__input {\n    margin: 10px; }\n    .venues-ui__directory .directory__input input {\n      width: 100%;\n      padding: 5px 0; }\n  .venues-ui__directory .directory__trigger {\n    position: absolute;\n    right: 10px;\n    top: 15px;\n    width: 10px;\n    height: 10px; }\n    .venues-ui__directory .directory__trigger .arrow {\n      transform: rotate(0);\n      transition: 0.4s; }\n    .venues-ui__directory .directory__trigger--active .arrow {\n      transform: rotate(-180deg);\n      transition: 0.4s; }\n"),e.Drawing=_,e.Geometry=m,e.Level=E,e.Provider=Un,e.Service=Bn,e.Venue=Dn,e.ui=zn,e}({});
}).call(self);
export default H;